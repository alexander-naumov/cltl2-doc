<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Survey of Concepts</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-19 00:40:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 192--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse150.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse148.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse148.html#tailclmse148.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse149.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch29.html#clmse149.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">29.3   </span> <a 
 id="x183-42700029.3"></a>Survey of Concepts</h3>
<!--l. 194--><p class="noindent" >This section discusses various aspects of the condition system by topic, illustrating
them with extensive examples. The next section contains deﬁnitions of speciﬁc
functions, macros, and other facilities.
<!--l. 198--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.1   </span> <a 
 id="x183-42800029.3.1"></a>Signaling Errors</h4>
<!--l. 200--><p class="noindent" >Conceptually, signaling an error in a program is an admission by that program
that it does not know how to continue and requires external intervention. Once an
error is signaled, any decision about how to continue must come from the
“outside.”
<!--l. 205--><p class="indent" >   The simplest way to signal an error is to use the <a 
href="clmse151.html#x185-472012r984">error</a> function with
<a 
href="clmse112.html#x139-263003r687">format</a>-style arguments describing the error for the sake of the user interface. If
<a 
href="clmse151.html#x185-472012r984">error</a> is called and there are no active handlers (described in sections <a 
href="#x183-42900029.3.2">29.3.2<!--tex4ht:ref: TRAPPING-ERRORS --></a>
and <a 
href="#x183-43000029.3.3">29.3.3<!--tex4ht:ref: HANDLING-CONDITIONS --></a>), the debugger will be entered and the error message will be typed out.
For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (defun factorial (x)
</td></tr></table>
<!--l. 211--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (cond ((or (not (typep x &#x2019;integer)) (minusp x))</td></tr></table>
<!--l. 212--><p class="indent" >    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (error &#x0022;~S is not a valid argument to FACTORIAL.&#x0022;</td></tr></table>
<!--l. 213--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      x))</td></tr></table>
<!--l. 214--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              ((zerop x) 1)</td></tr></table>
<!--l. 215--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (t (* x (factorial (- x 1))))))</td></tr></table>
<!--l. 216--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> FACTORIAL</td></tr></table>
<!--l. 217--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (factorial 20)</td></tr></table>
<!--l. 218--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> 2432902008176640000</td></tr></table>
<!--l. 219--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (factorial -1)</td></tr></table>
<!--l. 220--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Error: -1 is not a valid argument to FACTORIAL.</td></tr></table>
                                                                          

                                                                          
<!--l. 221--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">To continue, type :CONTINUE followed by an option number:</td></tr></table>
<!--l. 222--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 1: Return to Lisp Toplevel.</td></tr></table>
<!--l. 223--><p class="indent" >                                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Debug&#x003E;</td></tr></table>
<!--l. 225--><p class="indent" >
</div>
</div>
<!--l. 226--><p class="noindent" >In general, a call to <a 
href="clmse151.html#x185-472012r984">error</a> cannot directly return. Unless special work has been done to
override this behavior, the debugger will be entered and there will be no option to
simply continue.
<!--l. 230--><p class="indent" >   The only exception may be that some implementations may provide debugger
commands for interactively returning from individual stack frames; even then,
however, such commands should never be used except by someone who has read
the erring code and understands the consequences of continuing from that point.
In particular, the programmer should feel conﬁdent about writing code like this:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun wargames:no-win-scenario ()
</td></tr></table>
<!--l. 237--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (when (true) (error &#x0022;Pushing the button would be stupid.&#x0022;))</td></tr></table>
<!--l. 238--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (push-the-button))</td></tr></table>
<!--l. 240--><p class="indent" >
</div>
</div>
<!--l. 241--><p class="noindent" >In this scenario, there should be no chance that the function <a 
href="clmse151.html#x185-472012r984">error</a> will return and the
button will be pushed.
<!--l. 245--><p class="noindent" ><b>Remark:</b> It should be noted that the notion of “no chance” that the button will be
pushed is relative only to the language model; it assumes that the language is accurately
implemented. In practice, compilers have bugs, computers have glitches, and users have
been known to interrupt at inopportune moments and use the debugger to return from
arbitrary stack frames. Such violations of the language model are beyond the scope of
the condition system but not necessarily beyond the scope of potential failures that the
programmer should consider and defend against. The possibility of such unusual
failures may of course also inﬂuence the design of code meant to handle less
drastic situations, such as maintaining a database uncorrupted.—KMP and
GLS
<!--l. 260--><p class="indent" >   In some cases, the programmer may have a single, well-deﬁned idea of a
                                                                          

                                                                          
reasonable recovery strategy for this particular error. In that case, he can
use the function <a 
href="clmse150.html#x184-447004r948">cerror</a>, which speciﬁes information about what would
happen if the user did simply continue from the call to <a 
href="clmse150.html#x184-447004r948">cerror</a>. For example:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (defun factorial (x)
</td></tr></table>
<!--l. 265--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (cond ((not (typep x &#x2019;integer))</td></tr></table>
<!--l. 266--><p class="indent" >    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (error &#x0022;~S is not a valid argument to FACTORIAL.&#x0022;</td></tr></table>
<!--l. 267--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      x))</td></tr></table>
<!--l. 268--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              ((minusp x)</td></tr></table>
<!--l. 269--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (let ((x-magnitude (- x)))</td></tr></table>
<!--l. 270--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 (cerror &#x0022;Compute -(~D!) instead.&#x0022;</td></tr></table>
<!--l. 271--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         &#x0022;(-~D)! is not deﬁned.&#x0022; x-magnitude)</td></tr></table>
<!--l. 272--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 (- (factorial x-magnitude))))</td></tr></table>
<!--l. 273--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              ((zerop x) 1)</td></tr></table>
<!--l. 274--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (t (* x (factorial (- x 1))))))</td></tr></table>
<!--l. 275--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> FACTORIAL</td></tr></table>
<!--l. 276--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (factorial -3)</td></tr></table>
<!--l. 277--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Error: (-3)! is not deﬁned.</td></tr></table>
<!--l. 278--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">To continue, type :CONTINUE followed by an option number:</td></tr></table>
<!--l. 279--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 1: Compute -(3!) instead.</td></tr></table>
<!--l. 280--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 2: Return to Lisp Toplevel.</td></tr></table>
<!--l. 281--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Debug&#x003E; :continue 1</td></tr></table>
<!--l. 282--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> -6</td></tr></table>
<!--l. 284--><p class="indent" >
</div>
</div>
<!--l. 287--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.2   </span> <a 
 id="x183-42900029.3.2"></a>Trapping Errors</h4>
<!--l. 290--><p class="noindent" >By default, a call to <a 
href="clmse151.html#x185-472012r984">error</a> will force entry into the debugger. You can override that
behavior in a variety of ways. The simplest (and most blunt) tool for inhibiting
entry to the debugger on an error is to use <a 
href="clmse150.html#x184-457002r958">ignore-errors</a>. In the normal situation,
forms in the body of <a 
href="clmse150.html#x184-457002r958">ignore-errors</a> are evaluated sequentially and the last value is
                                                                          

                                                                          
returned. If a condition of type <a 
href="clmse151.html#x185-472012r984">error</a> is signaled, <a 
href="clmse150.html#x184-457002r958">ignore-errors</a> immediately
returns two values, namely <a 
href="clmse31.html#x42-74002r18">nil</a> and the condition that was signaled; the
debugger is not entered and no error message is printed. For example:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (setq ﬁlename &#x0022;nosuchﬁle&#x0022;)
</td></tr></table>
<!--l. 299--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> &#x0022;nosuchﬁle&#x0022;</td></tr></table>
<!--l. 300--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (ignore-errors (open ﬁlename :direction :input))</td></tr></table>
<!--l. 301--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> NIL and #&#x003C;FILE-ERROR 3437523&#x003E;</td></tr></table>
<!--l. 303--><p class="indent" >
</div>
</div>
<!--l. 304--><p class="noindent" >The second return value is an object that represents the kind of error. This is
explained in greater detail in section <a 
href="#x183-43100029.3.4">29.3.4<!--tex4ht:ref: OBJECT-0RIENTED-BASIS --></a>.
<!--l. 307--><p class="indent" >   In many cases, however, <a 
href="clmse150.html#x184-457002r958">ignore-errors</a> is not desirable because it deals with too
many kinds of errors. Contrary to the belief of some, a program that
does not enter the debugger is not necessarily better than one that does.
Excessive use of <a 
href="clmse150.html#x184-457002r958">ignore-errors</a> may keep the program out of the debugger, but
it may not increase the program&#x2019;s reliability, because the program may
continue to run after encountering errors other than those you meant
to work past. In general, it is better to attempt to deal only with the
particular kinds of errors that you believe could legitimately happen. That
way, if an unexpected error comes along, you will still ﬁnd out about
it.
<!--l. 317--><p class="indent" >   <a 
href="clmse150.html#x184-457002r958">ignore-errors</a> is a useful special case built from a more general facility,
<a 
href="clmse150.html#x184-456002r957">handler-case</a>, that allows the programmer to deal with particular kinds of
conditions (including non-error conditions) without aﬀecting what happens when
other kinds of conditions are signaled. For example, an eﬀect equivalent to that of
<a 
href="clmse150.html#x184-457002r958">ignore-errors</a> above is achieved in the following example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (setq ﬁlename &#x0022;nosuchﬁle&#x0022;)
</td></tr></table>
<!--l. 323--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> &#x0022;nosuchﬁle&#x0022;</td></tr></table>
<!--l. 324--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (handler-case (open ﬁlename :direction :input)</td></tr></table>
<!--l. 325--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (error (condition)</td></tr></table>
                                                                          

                                                                          
<!--l. 326--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (values nil condition)))</td></tr></table>
<!--l. 327--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> NIL and #&#x003C;FILE-ERROR 3437525&#x003E;</td></tr></table>
<!--l. 329--><p class="indent" >
</div>
</div>
<!--l. 330--><p class="noindent" >However, using <a 
href="clmse150.html#x184-456002r957">handler-case</a>, one can indicate a more speciﬁc condition type than
just “error.” Condition types are explained in detail later, but the syntax looks
roughly like the following: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (makunbound &#x2019;ﬁlename)
</td></tr></table>
<!--l. 334--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> FILENAME</td></tr></table>
<!--l. 335--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (handler-case (open ﬁlename :direction :input)</td></tr></table>
<!--l. 336--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (ﬁle-error (condition)</td></tr></table>
<!--l. 337--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (values nil condition)))</td></tr></table>
<!--l. 338--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Error: The variable FILENAME is unbound.</td></tr></table>
<!--l. 339--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">To continue, type :CONTINUE followed by an option number:</td></tr></table>
<!--l. 340--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 1: Retry getting the value of FILENAME.</td></tr></table>
<!--l. 341--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 2: Specify a value of FILENAME to use this time.</td></tr></table>
<!--l. 342--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 3: Specify a value of FILENAME to store and use.</td></tr></table>
<!--l. 343--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 4: Return to Lisp Toplevel.</td></tr></table>
<!--l. 344--><p class="indent" >                                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Debug&#x003E;</td></tr></table>
<!--l. 346--><p class="indent" >
</div>
</div>
<!--l. 349--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.3   </span> <a 
 id="x183-43000029.3.3"></a>Handling Conditions</h4>
<!--l. 352--><p class="noindent" >Blind transfer of control to a <a 
href="clmse150.html#x184-456002r957">handler-case</a> is only one possible kind of
recovery action that can be taken when a condition is signaled. The low-level
mechanism oﬀers great ﬂexibility in how to continue once a condition has been
signaled.
<!--l. 357--><p class="indent" >   The basic idea behind condition handling is that a piece of code called the
<i>signaler</i> recognizes and announces the existence of an exceptional situation using
<a 
href="clmse150.html#x184-447006r949">signal</a> or some function built on <a 
href="clmse150.html#x184-447006r949">signal</a> (such as <a 
href="clmse151.html#x185-472012r984">error</a>).
                                                                          

                                                                          
<!--l. 361--><p class="indent" >   The process of signaling involves the search for and invocation of a
<i>handler</i>, a piece of code that will attempt to deal appropriately with the
situation.
<!--l. 365--><p class="indent" >   If a handler is found, it may either <i>handle</i> the situation, by performing
some non-local transfer of control, or <i>decline</i> to handle it, by failing to
perform a non-local transfer of control. If it declines, other handlers are
sought.
<!--l. 369--><p class="indent" >   Since the lexical environment of the signaler might not be available to
handlers, a data structure called a <i>condition</i> is created to represent explicitly the
relevant state of the situation. A condition either is created explicitly using
<a 
href="clmse150.html#x184-462002r961">make-condition</a> and then passed to a function such as <a 
href="clmse150.html#x184-447006r949">signal</a>, or is created
implicitly by a function such as <a 
href="clmse150.html#x184-447006r949">signal</a> when given appropriate non-condition
arguments.
<!--l. 376--><p class="indent" >   In order to handle the error, a handler is permitted to use any non-local
transfer of control such as <a 
href="clmse42.html#x54-128002r104">go</a> to a tag in a <a 
href="clmse42.html#x54-126002r101">tagbody</a>, <a 
href="clmse137.html#x168-343002r840">return</a> from a <a 
href="clmse41.html#x53-113002r87">block</a>, or <a 
href="clmse44.html#x56-141002r116">throw</a>
to a <a 
href="clmse44.html#x56-139006r114">catch</a>. In addition, structured abstractions of these primitives are provided for
convenience in exception handling.
<!--l. 382--><p class="indent" >   A handler can be made dynamically accessible to a program by use of
<a 
href="clmse150.html#x184-458002r959">handler-bind</a>. For example, to create a handler for a condition of type
<a 
href="clmse151.html#x185-472061r1008">arithmetic-error</a>, one might write:  <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(handler-bind ((arithmetic-error <i>handler</i>))<i>body</i>)
</td></tr></table>
<!--l. 394--><p class="indent" >
</div>
</div>
<!--l. 395--><p class="noindent" >The handler is a function of one argument, the condition. If a condition of the
designated type is signaled while the <i>body</i> is executing (and there are no
intervening handlers), the handler would be invoked on the given condition,
allowing it the option of transferring control. For example, one might write a
macro that executes a body, returning either its value(s) or the two values <a 
href="clmse31.html#x42-74002r18">nil</a> and
the condition: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmacro without-arithmetic-errors (&#x0026;body forms)
</td></tr></table>
<!--l. 402--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((tag (gensym)))</td></tr></table>
                                                                          

                                                                          
<!--l. 403--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ‘(block ,tag</td></tr></table>
<!--l. 404--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (handler-bind ((arithmetic-error</td></tr></table>
<!--l. 405--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         #&#x2019;(lambda (c)     ;Argument c is a condition</td></tr></table>
<!--l. 406--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                             (return-from ,tag (values nil c)))))</td></tr></table>
<!--l. 407--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         ,@body))))</td></tr></table>
<!--l. 408--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 409--><p class="indent" >
</div>
</div>
<!--l. 411--><p class="indent" >   The handler is executed in the dynamic context of the signaler, except
that the set of available condition handlers will have been rebound to
the value that was active at the time the condition handler was made
active. If a handler declines (that is, it does not transfer control), other
handlers are sought. If no handler is found and the condition was signaled by
<a 
href="clmse151.html#x185-472012r984">error</a> or <a 
href="clmse150.html#x184-447004r948">cerror</a> (or some function such as <a 
href="clmse150.html#x184-449002r952">assert</a> that behaves like these
functions), the debugger is entered, still in the dynamic context of the
signaler.
<!--l. 420--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.4   </span> <a 
 id="x183-43100029.3.4"></a>Object-Oriented Basis of Condition Handling</h4>
<!--l. 423--><p class="noindent" >Of course, the ability of the handler to usefully handle an exceptional situation is
related to the quality of the information it is provided. For example, if all errors
were signaled by <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(error &#x0022;<i>some format string</i>&#x0022;)
</td></tr></table>
<!--l. 428--><p class="indent" >
</div>
</div>
<!--l. 429--><p class="noindent" >then the only piece of information that would be accessible to the handler would
be an object of type <a 
href="clmse151.html#x185-472018r987">simple-error</a> that had a slot containing the format
string.
<!--l. 433--><p class="indent" >   If this were done, <a 
href="clmse96.html#x119-223004r558">string-equal</a> would be the preferred way to tell one error
from another, and it would be very hard to allow ﬂexibility in the presentation of
                                                                          

                                                                          
error messages because existing handlers would tend to be broken by even tiny
variations in the wording of an error message. This phenomenon has been
the major failing of most error systems previously available in Lisp. It is
fundamentally important to decouple the error message string (the human
interface) from the objects that formally represent the error state (the program
interface). We therefore have the notion of typed conditions, and of formal
operations on those conditions that make them inspectable in a structured
way.
<!--l. 444--><p class="indent" >   This object-oriented approach to condition handling has the following
important advantages over a text-based approach:
      <ul class="itemize1">
      <li class="itemize">Conditions are classiﬁed according to subtype relationships, making it
      easy to test for categories of conditions.
      </li>
      <li class="itemize">Conditions  have  named  slot  values  through  which  parameters  are
      conveyed from the program that signals the condition to the program
      that handles it.
      </li>
      <li class="itemize">Inheritance  of  methods  and  slots  reduces  the  amount  of  explicit
      speciﬁcation necessary to achieve various interesting eﬀects.</li></ul>
<!--l. 460--><p class="indent" >   Some condition types are deﬁned by this document, but the set of condition
types is extensible using <a 
href="clmse150.html#x184-460002r960">deﬁne-condition</a>. Common Lisp condition types are in
fact CLOS classes, and condition objects are ordinary CLOS objects;
<a 
href="clmse150.html#x184-460002r960">deﬁne-condition</a> merely provides an abstract interface that is a bit more
convenient than <a 
href="clmse146.html#x179-413022r877">defclass</a> for deﬁning conditions.
<!--l. 467--><p class="indent" >   Here, as an example, we deﬁne a two-argument function called divide that
is patterned after the <a 
href="clmse106.html#x131-239016r594">/</a> function but does some stylized error checking:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun divide (numerator denominator)
</td></tr></table>
<!--l. 471--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (cond ((or (not (numberp numerator))</td></tr></table>
<!--l. 472--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (not (numberp denominator)))</td></tr></table>
<!--l. 473--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (error &#x0022;(DIVIDE &#x2019;~S &#x2019;~S) - Bad arguments.&#x0022;</td></tr></table>
                                                                          

                                                                          
<!--l. 474--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                numerator denominator))</td></tr></table>
<!--l. 475--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((zerop denominator)</td></tr></table>
<!--l. 476--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (error &#x2019;division-by-zero</td></tr></table>
<!--l. 477--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                :operator &#x2019;divide</td></tr></table>
<!--l. 478--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                :operands (list numerator denominator)))</td></tr></table>
<!--l. 479--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (t ...)))</td></tr></table>
<!--l. 481--><p class="indent" >
</div>
</div>
<!--l. 482--><p class="noindent" >Note that in the ﬁrst clause we have used <a 
href="clmse151.html#x185-472012r984">error</a> with a string argument and in the
second clause we have named a particular condition type, <a 
href="clmse151.html#x185-472067r1011">division-by-zero</a>. In
the case of a string argument, the condition type that will be signaled is
<a 
href="clmse151.html#x185-472018r987">simple-error</a>.
<!--l. 487--><p class="indent" >   The particular kind of error that is signaled may be important in cases where
handlers are active. For example, <a 
href="clmse151.html#x185-472018r987">simple-error</a> inherits from type <a 
href="clmse151.html#x185-472012r984">error</a>, which in
turn inherits from type <a 
href="clmse151.html#x185-472006r981">condition</a>. On the other hand, <a 
href="clmse151.html#x185-472067r1011">division-by-zero</a> inherits
from <a 
href="clmse151.html#x185-472061r1008">arithmetic-error</a>, which inherits from <a 
href="clmse151.html#x185-472012r984">error</a>, which inherits from <a 
href="clmse151.html#x185-472006r981">condition</a>. So
if a handler existed for <a 
href="clmse151.html#x185-472061r1008">arithmetic-error</a> while a <a 
href="clmse151.html#x185-472067r1011">division-by-zero</a> condition was
signaled, that handler would be tried; however, if a <a 
href="clmse151.html#x185-472018r987">simple-error</a> condition were
signaled in the same context, the handler for type <a 
href="clmse151.html#x185-472061r1008">arithmetic-error</a> would not be
tried.
<!--l. 498--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.5   </span> <a 
 id="x183-43200029.3.5"></a>Restarts</h4>
<!--l. 501--><p class="noindent" >In older Lisp dialects (such as MacLisp), an attempt to signal an error of a given
type often carried with it an implicit promise to support the standard recovery
strategy for that type of error. If the signaler knew the type of error but for
whatever reason was unable to deal with the standard recovery strategy for that
kind of error, it was necessary to signal an untyped error (for which there was no
deﬁned recovery strategy). This sometimes led to confusion when people signaled
typed errors without realizing the full implications of having done so,
but more often than not it meant that users simply avoided typed errors
altogether.
<!--l. 511--><p class="indent" >   The Common Lisp Condition System, which is modeled after the Zetalisp
condition system, corrects this troublesome aspect of previous Lisp dialects by
creating a clear separation between the act of signaling an error of a particular
                                                                          

                                                                          
type and the act of saying that a particular way of recovery is appropriate.
In the divide example above, simply signaling an error does not imply
a willingness on the part of the signaler to cooperate in any corrective
action. For example, the following sample interaction illustrates that the
only recovery action oﬀered for this error is “Return to Lisp Toplevel”:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (+ (divide 3 0) 7)
</td></tr></table>
<!--l. 520--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Error: Attempt to divide 3 by 0.</td></tr></table>
<!--l. 521--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">To continue, type :CONTINUE followed by an option number:</td></tr></table>
<!--l. 522--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 1: Return to Lisp Toplevel.</td></tr></table>
<!--l. 523--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Debug&#x003E; :continue 1</td></tr></table>
<!--l. 524--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Returned to Lisp Toplevel.</td></tr></table>
<!--l. 525--><p class="indent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E;</td></tr></table>
<!--l. 527--><p class="indent" >
</div>
</div>
<!--l. 528--><p class="noindent" >When an error is detected and the function <a 
href="clmse151.html#x185-472012r984">error</a> is called, execution cannot continue
normally because <a 
href="clmse151.html#x185-472012r984">error</a> will not directly return. Control can be transferred to
other points in the program, however, by means of specially established
“restarts.”
<!--l. 533--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.6   </span> <a 
 id="x183-43300029.3.6"></a>Anonymous Restarts</h4>
<!--l. 535--><p class="noindent" >The simplest kind of restart involves structured transfer of control using a macro
called <a 
href="clmse150.html#x184-464002r963">restart-case</a>. The <a 
href="clmse150.html#x184-464002r963">restart-case</a> form allows execution of a piece of code in a
context where zero or more restarts are active, and where if one of those restarts
is “invoked,” control will be transferred to the corresponding clause in the
<a 
href="clmse150.html#x184-464002r963">restart-case</a> form. For example, we could rewrite the previous divide example as
follows. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun divide (numerator denominator)
</td></tr></table>
                                                                          

                                                                          
<!--l. 542--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (loop</td></tr></table>
<!--l. 543--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (restart-case</td></tr></table>
<!--l. 544--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (return</td></tr></table>
<!--l. 545--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (cond ((or (not (numberp numerator))</td></tr></table>
<!--l. 546--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (not (numberp denominator)))</td></tr></table>
<!--l. 547--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 (error &#x0022;(DIVIDE &#x2019;~S &#x2019;~S) - Bad arguments.&#x0022;</td></tr></table>
<!--l. 548--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         numerator denominator))</td></tr></table>
<!--l. 549--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                ((zerop denominator)</td></tr></table>
<!--l. 550--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 (error &#x2019;division-by-zero</td></tr></table>
<!--l. 551--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        :operator &#x2019;divide</td></tr></table>
<!--l. 552--><p class="indent" >     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        :operands (list numerator denominator)))</td></tr></table>
<!--l. 553--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                (t ...)))</td></tr></table>
<!--l. 554--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (nil (arg1 arg2)</td></tr></table>
<!--l. 555--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          :report &#x0022;Provide new arguments for use by DIVIDE.&#x0022;</td></tr></table>
<!--l. 556--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          :interactive</td></tr></table>
<!--l. 557--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (lambda ()</td></tr></table>
<!--l. 558--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (list (prompt-for &#x2019;number &#x0022;Numerator: &#x0022;)</td></tr></table>
<!--l. 559--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (prompt-for &#x2019;number &#x0022;Denominator: &#x0022;)))</td></tr></table>
<!--l. 560--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (setq numerator arg1 denominator arg2))</td></tr></table>
<!--l. 561--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (nil (result)</td></tr></table>
<!--l. 562--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          :report &#x0022;Provide a value to return from DIVIDE.&#x0022;</td></tr></table>
<!--l. 563--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          :interactive</td></tr></table>
<!--l. 564--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (lambda () (list (prompt-for &#x2019;number &#x0022;Result: &#x0022;)))</td></tr></table>
<!--l. 565--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (return result)))))</td></tr></table>
<!--l. 567--><p class="indent" >
</div>
</div>
<!--l. 570--><p class="noindent" ><b>Remark:</b> The function prompt-for used in this chapter in a number of places is
not a part of Common Lisp. It is used in the examples in this chapter only
to keep the presentation simple. It is assumed to accept a type speciﬁer and
optionally a format string and associated arguments. It uses the format string and
associated arguments as part of an interactive prompt, and uses <a 
href="clmse111.html#x138-257003r653">read</a> to read a Lisp
object; however, only an object of the type indicated by the type speciﬁer is
accepted.
<!--l. 579--><p class="indent" >   The question of whether or not prompt-for (or something like it) would be
a useful addition to Common Lisp is under consideration by X3J13, but as
of January 1989 no action has been taken. In spite of its use in a number of
examples, nothing in the Common Lisp Condition System depends on this
                                                                          

                                                                          
function.
<!--l. 586--><p class="indent" >   In the example, the <a 
href="clmse31.html#x42-74002r18">nil</a> at the head of each clause means that it is
an “anonymous” restart. Anonymous restarts are typically invoked only
from within the debugger. As we shall see later, it is possible to have
“named restarts” that may be invoked from code without the need for user
intervention.
<!--l. 592--><p class="indent" >   If the arguments to anonymous restarts are not optional, then special
information must be provided about what the debugger should use as arguments.
Here the :interactive keyword is used to specify that information.
<!--l. 596--><p class="indent" >   The :report keyword introduces information to be used when presenting the
restart option to the user (by the debugger, for example).
<!--l. 599--><p class="indent" >   Here is a sample interaction that takes advantage of the restarts provided by
the revised deﬁnition of divide: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (+ (divide 3 0) 7)
</td></tr></table>
<!--l. 602--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Error: Attempt to divide 3 by 0.</td></tr></table>
<!--l. 603--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">To continue, type :CONTINUE followed by an option number:</td></tr></table>
<!--l. 604--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 1: Provide new arguments for use by the DIVIDE function.</td></tr></table>
<!--l. 605--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 2: Provide a value to return from the DIVIDE function.</td></tr></table>
<!--l. 606--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 3: Return to Lisp Toplevel.</td></tr></table>
<!--l. 607--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Debug&#x003E; :continue 1</td></tr></table>
<!--l. 608--><p class="indent" >                                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">1</td></tr></table>
<!--l. 609--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Numerator: 4</td></tr></table>
<!--l. 610--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Denominator: 2</td></tr></table>
<!--l. 611--><p class="indent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> 9</td></tr></table>
<!--l. 613--><p class="indent" >
</div>
</div>
<!--l. 615--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.7   </span> <a 
 id="x183-43400029.3.7"></a>Named Restarts</h4>
<!--l. 617--><p class="noindent" >In addition to anonymous restarts, one can have named restarts, which can be
invoked by name from within code. As a trivial example, one could write
<div class=lisp><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(restart-case (invoke-restart &#x2019;foo 3)
</td></tr></table>
<!--l. 620--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (foo (x) (+ x 1)))</td></tr></table>
<!--l. 622--><p class="indent" >
</div>
</div>
<!--l. 623--><p class="noindent" >to add 3 to 1, returning 4. This trivial example is conceptually analogous to writing:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(+ (catch &#x2019;something (throw &#x2019;something 3)) 1)
</td></tr></table>
<!--l. 627--><p class="indent" >
</div>
</div>
<!--l. 629--><p class="indent" >   For a more realistic example, the code for the function <a 
href="clmse35.html#x47-86004r53">symbol-value</a> might
signal an unbound variable error as follows: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(restart-case (error &#x0022;The variable ~S is unbound.&#x0022; variable)
</td></tr></table>
<!--l. 632--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (continue ()</td></tr></table>
<!--l. 633--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      :report</td></tr></table>
<!--l. 634--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (lambda (s)     ;Argument s is a stream</td></tr></table>
<!--l. 635--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (format s &#x0022;Retry getting the value of ~S.&#x0022; variable))</td></tr></table>
<!--l. 636--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (symbol-value variable))</td></tr></table>
<!--l. 637--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (use-value (value)</td></tr></table>
<!--l. 638--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      :report</td></tr></table>
<!--l. 639--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (lambda (s)     ;Argument s is a stream</td></tr></table>
<!--l. 640--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (format s &#x0022;Specify a value of ~S to use this time.&#x0022;</td></tr></table>
<!--l. 641--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  variable))</td></tr></table>
<!--l. 642--><p class="indent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    value)</td></tr></table>
<!--l. 643--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (store-value (value)</td></tr></table>
<!--l. 644--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      :report</td></tr></table>
<!--l. 645--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (lambda (s)     ;Argument s is a stream</td></tr></table>
<!--l. 646--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (format s &#x0022;Specify a value of ~S to store and use.&#x0022;</td></tr></table>
                                                                          

                                                                          
<!--l. 647--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  variable))</td></tr></table>
<!--l. 648--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (setf (symbol-value variable) value)</td></tr></table>
<!--l. 649--><p class="indent" >                                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    value))</td></tr></table>
<!--l. 651--><p class="indent" >
</div>
</div>
<!--l. 652--><p class="noindent" >If this were part of the implementation of <a 
href="clmse35.html#x47-86004r53">symbol-value</a>, then it would be possible for
users to write a variety of automatic handlers for unbound variable errors. For
example, to make unbound variables evaluate to themselves, one might write
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(handler-bind ((unbound-variable
</td></tr></table>
<!--l. 657--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 #&#x2019;(lambda (c)     ;Argument c is a condition</td></tr></table>
<!--l. 658--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (when (ﬁnd-restart &#x2019;use-value)</td></tr></table>
<!--l. 659--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (invoke-restart &#x2019;use-value</td></tr></table>
<!--l. 660--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                       (cell-error-name c))))))</td></tr></table>
<!--l. 661--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>body</i>)</td></tr></table>
<!--l. 663--><p class="indent" >
</div>
</div>
<!--l. 665--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.8   </span> <a 
 id="x183-43500029.3.8"></a>Restart Functions</h4>
<!--l. 667--><p class="noindent" >For commonly used restarts, it is conventional to deﬁne a program interface that
hides the use of <a 
href="clmse150.html#x184-468008r969">invoke-restart</a>. Such program interfaces to restarts are called
<i>restart functions</i>.
<!--l. 671--><p class="indent" >   The normal convention is for the function to share the name of the restart.
The pre-deﬁned functions <a 
href="clmse150.html#x184-470002r972">abort</a>, <a 
href="clmse150.html#x184-470004r973">continue</a>, <a 
href="clmse150.html#x184-470006r974">muﬄe-warning</a>, <a 
href="clmse150.html#x184-470008r975">store-value</a>, and
<a 
href="clmse150.html#x184-470010r976">use-value</a> are restart functions. With <a 
href="clmse150.html#x184-470010r976">use-value</a> the above example of <a 
href="clmse150.html#x184-458002r959">handler-bind</a>
could have been written more concisely as <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(handler-bind ((unbound-variable
</td></tr></table>
                                                                          

                                                                          
<!--l. 676--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   #&#x2019;(lambda (c)     ;Argument c is a condition</td></tr></table>
<!--l. 677--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (use-value (cell-error-name c)))))</td></tr></table>
<!--l. 678--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>body</i>)</td></tr></table>
<!--l. 680--><p class="indent" >
</div>
</div>
<!--l. 682--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.9   </span> <a 
 id="x183-43600029.3.9"></a>Comparison of Restarts and Catch/Throw</h4>
<!--l. 684--><p class="noindent" >One important feature that <a 
href="clmse150.html#x184-464002r963">restart-case</a> (or <a 
href="clmse150.html#x184-465002r964">restart-bind</a>) oﬀers that <a 
href="clmse44.html#x56-139006r114">catch</a> does
not is the ability to reason about the available points to which control might be
transferred without actually attempting the transfer. One could, for example,
write <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ignore-errors (throw ...))
</td></tr></table>
<!--l. 690--><p class="indent" >
</div>
</div>
<!--l. 691--><p class="noindent" >which is a sort of poor man&#x2019;s variation of <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(when (ﬁnd-restart &#x2019;something)
</td></tr></table>
<!--l. 693--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (invoke-restart &#x2019;something))</td></tr></table>
<!--l. 695--><p class="indent" >
</div>
</div>
<!--l. 696--><p class="noindent" >but there is no way to use <a 
href="clmse150.html#x184-457002r958">ignore-errors</a> and <a 
href="clmse44.html#x56-141002r116">throw</a> to simulate something like
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(when (and (ﬁnd-restart &#x2019;something)
</td></tr></table>
                                                                          

                                                                          
<!--l. 699--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (ﬁnd-restart &#x2019;something-else))</td></tr></table>
<!--l. 700--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (invoke-restart &#x2019;something))</td></tr></table>
<!--l. 702--><p class="indent" >
</div>
</div>
<!--l. 703--><p class="noindent" >or even just <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(when (and (ﬁnd-restart &#x2019;something)
</td></tr></table>
<!--l. 705--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (yes-or-no-p &#x0022;Do something? &#x0022;))</td></tr></table>
<!--l. 706--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (invoke-restart &#x2019;something))</td></tr></table>
<!--l. 708--><p class="indent" >
</div>
</div>
<!--l. 709--><p class="noindent" >because the degree of inspectability that comes with simply writing <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ignore-errors (throw ...))
</td></tr></table>
<!--l. 712--><p class="indent" >
</div>
</div>
<!--l. 713--><p class="noindent" >is too primitive—getting the desired information also forces transfer of control,
perhaps at a time when it is not desirable.
<!--l. 716--><p class="indent" >   Many programmers have previously evolved strategies like the following on a
case-by-case basis: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defvar *foo-tag-is-available* nil)
</td></tr></table>
<!--l. 719--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 720--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun fn-1 ()</td></tr></table>
<!--l. 721--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (catch &#x2019;foo</td></tr></table>
<!--l. 722--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (let ((*foo-tag-is-available* t))</td></tr></table>
<!--l. 723--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      ... (fn-2) ...)))</td></tr></table>
<!--l. 724--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
                                                                          

                                                                          
<!--l. 725--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun fn-2 ()</td></tr></table>
<!--l. 726--><p class="indent" >                                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...</td></tr></table>
<!--l. 727--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (if *foo-tag-is-available* (throw &#x2019;foo t))</td></tr></table>
<!--l. 728--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 730--><p class="indent" >
</div>
</div>
<!--l. 731--><p class="noindent" >The facility provided by <a 
href="clmse150.html#x184-464002r963">restart-case</a> and <a 
href="clmse150.html#x184-468006r968">ﬁnd-restart</a> is intended to provide a
standardized protocol for this sort of information to be communicated between
programs that were developed independently so that individual variations from
program to program do not thwart the overall modularity and debuggability of
programs.
<!--l. 737--><p class="indent" >   Another diﬀerence between the restart facility and the <a 
href="clmse44.html#x56-139006r114">catch</a>/<a 
href="clmse44.html#x56-141002r116">throw</a> facility is
that a <a 
href="clmse44.html#x56-139006r114">catch</a> with any given tag completely shadows any outer pending <a 
href="clmse44.html#x56-139006r114">catch</a> that
uses the same tag. Because of the presence of <a 
href="clmse150.html#x184-468002r966">compute-restarts</a>, however, it is
possible to see shadowed restarts, which may be very useful in some situations
(particularly in an interactive debugger).
                                                                          

                                                                          
<!--l. 746--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.10   </span> <a 
 id="x183-43700029.3.10"></a>Generalized Restarts</h4>
<!--l. 749--><p class="noindent" ><a 
href="clmse150.html#x184-464002r963">restart-case</a> is a mechanism that allows only imperative transfer of control for its
associated restarts. <a 
href="clmse150.html#x184-464002r963">restart-case</a> is built on a lower-level mechanism called
<a 
href="clmse150.html#x184-465002r964">restart-bind</a>, which does not force transfer of control.
<!--l. 753--><p class="indent" >   <a 
href="clmse150.html#x184-465002r964">restart-bind</a> is to <a 
href="clmse150.html#x184-464002r963">restart-case</a> as <a 
href="clmse150.html#x184-458002r959">handler-bind</a> is to handler-case. The syntax is
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(restart-bind ((<i>name</i> <i>function</i> . <i>options</i>)) . <i>body</i>)
</td></tr></table>
<!--l. 758--><p class="indent" >
</div>
</div>
<!--l. 759--><p class="noindent" >The <i>body</i> is executed in a dynamic context within which the <i>function</i> will be called
whenever (invoke-restart &#x2019;<i>name</i>) is executed. The <i>options</i> are keyword-style and
are used to pass information such as that provided with the :report keyword in
<a 
href="clmse150.html#x184-464002r963">restart-case</a>.
<!--l. 765--><p class="indent" >   A <a 
href="clmse150.html#x184-464002r963">restart-case</a> expands into a call to <a 
href="clmse150.html#x184-465002r964">restart-bind</a> where the function simply
does an unconditional transfer of control to a particular body of code, passing
along “argument” information in a structured way.
<!--l. 769--><p class="indent" >   It is also possible to write restarts that do not transfer control. Such restarts
may be useful in implementing various special commands for the debugger that
are of interest only in certain situations. For example, one might imagine a
situation where ﬁle space was exhausted and the following was done in an attempt
to free space in directory dir: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(restart-bind ((nil #&#x2019;(lambda () (expunge-directory dir))
</td></tr></table>
<!--l. 775--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    :report-function</td></tr></table>
<!--l. 776--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      #&#x2019;(lambda (stream)</td></tr></table>
<!--l. 777--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          (format stream &#x0022;Expunge ~A.&#x0022;</td></tr></table>
<!--l. 778--><p class="indent" >     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                  (directory-namestring dir)))))</td></tr></table>
<!--l. 779--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (cerror &#x0022;Try this ﬁle operation again.&#x0022;</td></tr></table>
                                                                          

                                                                          
<!--l. 780--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          &#x2019;directory-full :directory dir))</td></tr></table>
<!--l. 782--><p class="indent" >
</div>
</div>
<!--l. 783--><p class="noindent" >In this case, the debugger might be entered and the user could ﬁrst perform the
expunge (which would not transfer control from the debugger context) and then
retry the ﬁle operation: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Lisp&#x003E; (open &#x0022;FOO&#x0022; :direction :output)
</td></tr></table>
<!--l. 787--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Error: The directory PS:&#x003C;JDOE&#x003E; is full.</td></tr></table>
<!--l. 788--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">To continue, type :CONTINUE followed by an option number:</td></tr></table>
<!--l. 789--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 1: Try this ﬁle operation again.</td></tr></table>
<!--l. 790--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 2: Expunge PS:&#x003C;JDOE&#x003E;.</td></tr></table>
<!--l. 791--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> 3: Return to Lisp Toplevel.</td></tr></table>
<!--l. 792--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Debug&#x003E; :continue 2</td></tr></table>
<!--l. 793--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Expunging PS:&#x003C;JDOE&#x003E; ... 3 records freed.</td></tr></table>
<!--l. 794--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Debug&#x003E; :continue 1</td></tr></table>
<!--l. 795--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> #&#x003C;OUTPUT-STREAM &#x0022;PS:&#x003C;JDOE&#x003E;FOO.LSP&#x0022; 2323473&#x003E;</td></tr></table>
<!--l. 797--><p class="indent" >
</div>
</div>
<!--l. 800--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.11   </span> <a 
 id="x183-43800029.3.11"></a>Interactive Condition Handling</h4>
<!--l. 802--><p class="noindent" >When a program does not know how to continue, and no active handler is able to
advise it, the “interactive condition handler,” or “debugger,” can be entered. This
happens implicitly through the use of functions such as <a 
href="clmse151.html#x185-472012r984">error</a> and <a 
href="clmse150.html#x184-447004r948">cerror</a>, or
explicitly through the use of the function <a 
href="clmse150.html#x184-471004r978">invoke-debugger</a>.
<!--l. 807--><p class="indent" >   The interactive condition handler never returns directly; it returns only
through structured non-local transfer of control to specially deﬁned restart points
that can be set up either by the system or by user code. The mechanisms that
support the establishment of such structured restart points for portable code are
outlined in sections <a 
href="#x183-43200029.3.5">29.3.5<!--tex4ht:ref: RESTARTS --></a> through <a 
href="#x183-43700029.3.10">29.3.10<!--tex4ht:ref: LAST-RESTARTS-SECTION --></a>.
                                                                          

                                                                          
<!--l. 814--><p class="indent" >   Actually, implementations may also provide extended debugging facilities that
allow return from arbitrary stack frames. Although such commands are frequently
useful in practice, their eﬀects are implementation-dependent because they violate
the Common Lisp program abstraction. The eﬀect of using such commands is
undeﬁned with respect to Common Lisp.
<!--l. 821--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.12   </span> <a 
 id="x183-43900029.3.12"></a>Serious Conditions</h4>
<!--l. 823--><p class="noindent" >The <a 
href="clmse150.html#x184-457002r958">ignore-errors</a> macro will trap conditions of type <a 
href="clmse151.html#x185-472012r984">error</a>. There are, however,
conditions that are not of type <a 
href="clmse151.html#x185-472012r984">error</a>.
<!--l. 826--><p class="indent" >   Some conditions are not considered errors but are still very serious, so we call
them <i>serious conditions</i> and we use the type <a 
href="clmse151.html#x185-472010r983">serious-condition</a> to represent them.
Conditions such as those that might be signaled for “stack overﬂow” or “storage
exhausted” are in this category.
<!--l. 831--><p class="indent" >   The type <a 
href="clmse151.html#x185-472012r984">error</a> is a subtype of <a 
href="clmse151.html#x185-472010r983">serious-condition</a>, and it would technically be
correct to use the term “serious condition” to refer to all serious conditions
whether errors or not. However, normally we use the term “serious condition” to
refer to things of type <a 
href="clmse151.html#x185-472010r983">serious-condition</a> but not of type <a 
href="clmse151.html#x185-472012r984">error</a>.
<!--l. 837--><p class="indent" >   The point of the distinction between errors and other serious conditions is that
some conditions are known to occur for reasons that are beyond the scope of
Common Lisp to specify clearly. For example, we know that a stack will generally
be used to implement function calling, and we know that stacks tend to be of
ﬁnite size and are prone to overﬂow. Since the available stack size may vary from
implementation to implementation, from session to session, or from function call
to function call, it would be confusing to have expressions such as (ignore-errors
(+ a b)) return a number sometimes and <a 
href="clmse31.html#x42-74002r18">nil</a> other times if a and b were
always bound to numbers and the stack just happened to overﬂow on a
particular call. For this reason, only conditions of type <a 
href="clmse151.html#x185-472012r984">error</a> and not all
conditions of type <a 
href="clmse151.html#x185-472010r983">serious-condition</a> are trapped by <a 
href="clmse150.html#x184-457002r958">ignore-errors</a>. To trap other
conditions, a lower-level facility must be used (such as <a 
href="clmse150.html#x184-458002r959">handler-bind</a> or
<a 
href="clmse150.html#x184-456002r957">handler-case</a>).
<!--l. 851--><p class="indent" >   By convention, the function <a 
href="clmse151.html#x185-472012r984">error</a> is preferred over <a 
href="clmse150.html#x184-447006r949">signal</a> to signal conditions
of type <a 
href="clmse151.html#x185-472010r983">serious-condition</a> (including those of type <a 
href="clmse151.html#x185-472012r984">error</a>). It is the use of the
function <a 
href="clmse151.html#x185-472012r984">error</a>, and not the type of the condition being signaled, that actually
causes the debugger to be entered.
<div class=incompatibility>
                                                                          

                                                                          
<!--l. 857--><p class="noindent" ><b>Compatibility note:</b> The Common Lisp Condition System diﬀers from that of Zetalisp
in this respect. In Zetalisp the debugger is entered for an unhandled signal if the <a 
href="clmse151.html#x185-472012r984">error</a>
function is used <i>or</i> if the condition is of type <a 
href="clmse151.html#x185-472012r984">error</a>.
</div>
<!--l. 864--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.13   </span> <a 
 id="x183-44000029.3.13"></a>Non-Serious Conditions</h4>
<!--l. 866--><p class="noindent" >Some conditions are neither errors nor serious conditions. They are signaled to
give other programs a chance to intervene, but if no action is taken, computation
simply continues normally.
<!--l. 870--><p class="indent" >   For example, an implementation might choose to signal a non-serious (and
implementation-dependent) condition called end-of-line when output reaches the
last character position on a line of character output. In such an implementation,
the signaling of this condition might allow a convenient way for other
programs to intervene, producing output that is truncated at the end of a
line.
<!--l. 877--><p class="indent" >   By convention, the function <a 
href="clmse150.html#x184-447006r949">signal</a> is used to signal conditions that are not
serious. It would be possible to signal serious conditions using <a 
href="clmse150.html#x184-447006r949">signal</a>, and the
debugger would not be entered if the condition went unhandled. However, by
convention, handlers will generally tend to assume that serious conditions and
errors were signaled by calling the <a 
href="clmse151.html#x185-472012r984">error</a> function (and will therefore force entry to
the interactive condition handler) and that they should work to avoid
this.
<!--l. 887--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.14   </span> <a 
 id="x183-44100029.3.14"></a>Condition Types</h4>
<!--l. 889--><p class="noindent" >Some types of conditions are predeﬁned by the system. All types of conditions are
subtypes of <a 
href="clmse151.html#x185-472006r981">condition</a>. That is, (typep <i>x</i> &#x2019;condition) is true if and only if the value
of <i>x</i> is a condition.
<!--l. 893--><p class="indent" >   Implementations supporting multiple (or non-hierarchical) type inheritance are
expressly permitted to exploit multiple inheritance in the tree of condition types
as implementation-dependent extensions, as long as such extensions are
compatible with the speciﬁcations in this chapter. [X3J13 voted in March 1989 <a 
 id="dx183-441001"></a>to
integrate the Condition System and the Object System, so multiple inheritance is
always available for condition types.—GLS]
                                                                          

                                                                          
<!--l. 901--><p class="indent" >   In order to avoid problems in portable code that runs both in systems with
multiple type inheritance and in systems without it, programmers are explicitly
warned that while all correct Common Lisp implementations will ensure that
(typep <i>c</i> &#x2019;condition) is true for all conditions <i>c</i> (and all subtype relationships
indicated in this chapter will also be true), it should <i>not</i> be assumed that two
condition types speciﬁed to be subtypes of the same third type are disjoint. (In
some cases, disjoint subtypes are identiﬁed explicitly, but such disjointness is not
to be assumed by default.) For example, it follows from the subtype descriptions
contained in this chapter that in all implementations (typep <i>c</i> &#x2019;control-error)
implies (typep <i>c</i> &#x2019;error), but note that (typep <i>c</i> &#x2019;control-error) does <i>not</i> imply
(not (typep <i>c</i> &#x2019;cell-error)).
<!--l. 918--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.15   </span> <a 
 id="x183-44200029.3.15"></a>Signaling Conditions</h4>
<!--l. 920--><p class="noindent" >When a condition is signaled, the system tries to locate the most appropriate
handler for the condition and to invoke that handler.
<!--l. 923--><p class="indent" >   Handlers are established dynamically using <a 
href="clmse150.html#x184-458002r959">handler-bind</a> or abstractions built
on <a 
href="clmse150.html#x184-458002r959">handler-bind</a>.
<!--l. 926--><p class="indent" >   If an appropriate handler is found, it is called. In some circumstances, the
handler may <i>decline</i> simply by returning without performing a non-local transfer
of control. In such cases, the search for an appropriate handler is picked up where
it left oﬀ, as if the called handler had never been present.
<!--l. 932--><p class="indent" >   If no handler is found, or if all handlers that were found decline, <a 
href="clmse150.html#x184-447006r949">signal</a> returns
<a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 935--><p class="indent" >   Although it follows from the description above, it is perhaps worth noting
explicitly that the lookup procedure described here will prefer a general but more
(dynamically) local handler over a speciﬁc but less (dynamically) local handler.
Experience with existing condition systems suggests that this is a reasonable
approach and works adequately in most situations. Some care should be taken
when binding handlers for very general kinds of conditions, such as is done in
<a 
href="clmse150.html#x184-457002r958">ignore-errors</a>. Often, binding for a more speciﬁc condition type than <a 
href="clmse151.html#x185-472012r984">error</a> is more
appropriate.
<!--l. 945--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.16   </span> <a 
 id="x183-44300029.3.16"></a>Resignaling Conditions</h4>
                                                                          

                                                                          
<!--l. 947--><p class="noindent" >[The contents of this section are still a subject of some debate within X3J13. The
reader may wish to take this section with a grain of salt.—GLS]
<!--l. 950--><p class="indent" >   Note that signaling a condition has no side eﬀect on that condition,
and that there is no dynamic state contained in a condition object. As
such, it may at times be reasonable and appropriate to consider caching
condition objects for repeated use, re-signaling conditions from within
handlers, or saving conditions away somewhere and re-signaling them
later.
<!--l. 956--><p class="indent" >   For example, it may be desirable for the system to pre-allocate objects of type
<a 
href="clmse151.html#x185-472024r990">storage-condition</a> so that they can be signaled when needed without attempting to
allocate more storage.
<!--l. 961--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.17   </span> <a 
 id="x183-44400029.3.17"></a>Condition Handlers</h4>
<!--l. 964--><p class="noindent" >A <i>handler</i> is a function of one argument, the condition to be handled. The
handler may inspect the object to be sure it is “interested” in handling the
condition.
<!--l. 968--><p class="indent" >   A handler is executed in the dynamic context of the signaler, except that the
set of available condition handlers will have been rebound to the value that was
active at the time the condition handler was made active. The intent
of this is to prevent inﬁnite recursion because of errors in a condition
handler.
<!--l. 973--><p class="indent" >   After inspecting the condition, the handler should take one of the following
actions:
      <ul class="itemize1">
      <li class="itemize">It might <i>decline</i> to handle the condition (by simply returning). When
      this happens, the returned values are ignored and the eﬀect is the same
      as if the handler had been invisible to the mechanism seeking to ﬁnd
      a handler. The next handler in line will be tried, or if no such handler
      exists, the condition will go unhandled.
      </li>
      <li class="itemize">It might <i>handle</i> the condition (by performing some non-local transfer of
      control). This may be done either primitively using <a 
href="clmse42.html#x54-128002r104">go</a>, <a 
href="clmse137.html#x168-343002r840">return</a>, or <a 
href="clmse44.html#x56-141002r116">throw</a>,
      or more abstractly using a function such as <a 
href="clmse150.html#x184-470002r972">abort</a> or <a 
href="clmse150.html#x184-468008r969">invoke-restart</a>.
                                                                          

                                                                          
      </li>
      <li class="itemize">It might signal another condition.
      </li>
      <li class="itemize">It might invoke the interactive debugger.</li></ul>
<!--l. 994--><p class="noindent" >In fact, the latter two actions (signaling another condition or entering the debugger)
are really just ways of putting oﬀ the decision to either handle or decline, or
trying to get someone else to make such a decision. Ultimately, all a handler can
do is to handle or decline to handle.
<!--l. 999--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">29.3.18   </span> <a 
 id="x183-44500029.3.18"></a>Printing Conditions</h4>
<!--l. 1001--><p class="noindent" >When *print-escape* is <a 
href="clmse31.html#x42-74002r18">nil</a> (for example, when the <a 
href="clmse112.html#x139-260014r672">princ</a> function or the
~A directive is used with <a 
href="clmse112.html#x139-263003r687">format</a>), the report method for the condition
will be invoked. This will be done automatically by functions such as
<a 
href="clmse150.html#x184-471004r978">invoke-debugger</a>, <a 
href="clmse150.html#x184-471002r977">break</a>, and <a 
href="clmse150.html#x184-469002r971">warn</a>, but there may still be situations in which it is
desirable to have a condition report under explicit user control. For example,
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(let ((form &#x2019;(open &#x0022;nosuchﬁle&#x0022;)))
</td></tr></table>
<!--l. 1008--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (handler-case (eval form)</td></tr></table>
<!--l. 1009--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (serious-condition (c)</td></tr></table>
<!--l. 1010--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (format t &#x0022;~&#x0026;Evaluation of ~S failed:~%~A&#x0022; form c))))</td></tr></table>
<!--l. 1012--><p class="indent" >
</div>
</div>
<!--l. 1013--><p class="noindent" >might print something like <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Evaluation of (OPEN &#x0022;nosuchﬁle&#x0022;) failed:
</td></tr></table>
<!--l. 1015--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">The ﬁle &#x0022;nosuchﬁle&#x0022; was not found.</td></tr></table>
<!--l. 1017--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 1018--><p class="noindent" >Some suggestions about the form of text typed by report methods:
      <ul class="itemize1">
      <li class="itemize">The message should generally be a complete sentence, beginning with
      a capital letter and ending with appropriate punctuation (usually a
      period).
      </li>
      <li class="itemize">The message should <i>not</i> include any introductory text such as “Error:”
      or “Warning:” and should not be followed by a trailing newline. Such
      text will be added as may be appropriate to context by the routine
      invoking the report method.
      </li>
      <li class="itemize">Except   where   unavoidable,   the   tab   character   (which   is   only
      semi-standard anyway) should not be used in error messages. Its eﬀect
      may vary from one implementation to another and may cause problems
      even  within  an  implementation  because  it  may  do  diﬀerent  things
      depending on the column at which the error report begins.
      </li>
      <li class="itemize">Single-line messages are preferred, but newlines in the middle of long
      messages are acceptable.
      </li>
      <li class="itemize">If any program (for example, the debugger) displays messages indented
      from the prevailing left margin (for example, indented seven spaces
      because they are preﬁxed by the seven-character herald “Error: ”), then
      that program will take care of inserting the appropriate indentation
      into the extra lines of a multi-line error message. Similarly, a program
      that preﬁxes error messages with semicolons so that they appear to be
      comments should take care of inserting a semicolon at the beginning
      of each line in a multi-line error message. (These rules are important
      because, even within a single implementation, there may be more than
      one program that presents error messages to the user, and they may
      use diﬀerent styles of presentation. The caller of <a 
href="clmse151.html#x185-472012r984">error</a> cannot anticipate
      all such possible styles, and so it is incumbent upon the presenter of
      the message to make any necessary adjustments.)</li></ul>
                                                                          

                                                                          
<!--l. 1056--><p class="noindent" >[Note: These recommendations expand upon those in section <a 
href="clmse119.html#x148-28400024.1">24.1<!--tex4ht:ref: ERROR-SIGNALLING-FUNCTIONS --></a>.—GLS]
<!--l. 1058--><p class="indent" >   When *print-escape* is not <a 
href="clmse31.html#x42-74002r18">nil</a>, the object should print in some useful (but
usually fairly abbreviated) fashion according to the style of the implementation. It
is not expected that a condition will be printed in a form suitable for <a 
href="clmse111.html#x138-257003r653">read</a>.
Something like #&#x003C;ARITHMETIC-ERROR 1734&#x003E; is ﬁne.
<!--l. 1065--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx183-445001"></a>to integrate the Condition System and the Object
System. In the original Condition System proposal, no function was provided for
directly accessing or setting the printer for a condition type, or for invoking it; the
techniques described above were the sole interface to reporting. The vote
speciﬁed that, in CLOS terms, condition reporting is mediated through the
<a 
href="clmse146.html#x179-420038r925">print-object</a> method for the condition type (that is, class) in question, with
*print-escape* bound to <a 
href="clmse31.html#x42-74002r18">nil</a>. Specifying (:report <i>fn</i>) to <a 
href="clmse150.html#x184-460002r960">deﬁne-condition</a> when
deﬁning condition type <i>C</i> is equivalent to a separate method deﬁnition:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod print-object ((x <i>C</i>) stream)
</td></tr></table>
<!--l. 1077--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (if *print-escape*</td></tr></table>
<!--l. 1078--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (call-next-method)</td></tr></table>
<!--l. 1079--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (funcall #&#x2019;<i>fn</i> x stream)))</td></tr></table>
<!--l. 1081--><p class="indent" >
</div>
</div>
<!--l. 1082--><p class="noindent" >Note that the method uses <i>fn</i> to print the condition only when *print-escape* has the
value <a 
href="clmse31.html#x42-74002r18">nil</a>.
                                                                          

                                                                          
   <!--l. 1087--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse150.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse148.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse148.html#tailclmse148.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse149.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch29.html#clmse149.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 1087--><p class="indent" >   <a 
 id="tailclmse149.html"></a>  
</body></html> 
