<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>String Construction and Manipulation</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-06 23:16:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 251--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch19.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse101.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse101.html#tailclmse101.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse102.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch18.html#clmse102.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">18.3   </span> <a 
 id="x125-79100018.3"></a>String Construction and Manipulation</h3>
<!--l. 253--><p class="noindent" >Most of the interesting operations on strings may be performed with the generic
sequence functions described in chapter <a 
href="clmch14.html#x99-42400014">14<!--tex4ht:ref: KSEQUE --></a>. The following functions perform
additional operations that are speciﬁc to strings. <div class=new> Note that this remark,
predating the design of the Common Lisp Object System, uses the term “generic”
in a generic sense and not necessarily in the technical sense used by CLOS (see
chapter <a 
href="clmch2.html#x9-200002">2<!--tex4ht:ref: DTYPES --></a>).
</div>
<div class=obsolete>
<div class=defun>
<!--l. 265--><p class="noindent" ><i>[Function]</i><a 
 id="dx125-791001"></a><a 
 id="x125-791002r607"></a><b> make-string</b>  <i>size</i> &#x0026;key  <i>:initial-element</i>
<!--l. 267--><p class="noindent" ><span class="paragraphHead"><a 
 id="x125-792000607"></a></span>
   This returns a string (in fact a simple string) of length <i>size</i>, each of whose
characters has been initialized to the :initial-element argument. If an
:initial-element argument is not speciﬁed, then the string will be initialized in an
implementation-dependent way.
<div class=implementation>
<!--l. 275--><p class="noindent" ><span class="paragraphHead"><a 
 id="x125-79300018.3"></a></span>
   <b>Implementation note:</b> It may be convenient to initialize the string to null
characters, or to spaces, or to garbage (“whatever was there”).
<!--l. 278--><p class="noindent" ><span class="paragraphHead"><a 
 id="x125-79400018.3"></a>
<!--l. 278--><p class="indent" >   </span>
   implementation
</div>
<!--l. 281--><p class="indent" >   A string is really just a one-dimensional array of “string characters” (that is,
those characters that are members of type string-char). More complex character
                                                                          

                                                                          
arrays may be constructed using the function <a 
href="clmse94.html#x116-527002r558">make-array</a>.
</div>
</div>
<div class=newer>
<!--l. 289--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx125-794001"></a>to eliminate the type string-char and to add a
keyword argument :element-type to <a 
href="#x125-567003r608">make-string</a>. The new function description is
as follows.
<div class=defun>
<!--l. 294--><p class="noindent" ><i>[Function]</i><a 
 id="dx125-794002"></a><a 
 id="x125-794003r608"></a><b> make-string</b>  <i>size</i> &#x0026;key  <i>:initial-element</i> <i>:element-type</i>
<!--l. 296--><p class="noindent" ><span class="paragraphHead"><a 
 id="x125-795000608"></a></span>
   This returns a simple string of length <i>size</i>, each of whose characters has been
initialized to the :initial-element argument. If an :initial-element argument is not
speciﬁed, then the string will be initialized in an implementation-dependent
way.
<!--l. 303--><p class="indent" >   The :element-type argument names the type of the elements of the string; a
string is constructed of the most specialized type that can accommodate elements
of the given type. If :element-type is omitted, the type <a 
href="clmse79.html#x97-412002r384">character</a> is the
default.
<!--l. 308--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx125-795001"></a>to clarify that the <i>size</i> argument must be a
non-negative integer less than the value of <a 
href="clmse94.html#x116-529002r560">array-dimension-limit</a>.
</div>
</div>
<div class=defun>
<!--l. 318--><p class="noindent" ><i>[Function]</i><a 
 id="dx125-795002"></a><a 
 id="x125-795003r609"></a><b> string-trim</b>  <i>character-bag</i> <i>string</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx125-795004"></a><a 
 id="x125-795005r610"></a><b> string-left-trim</b>  <i>character-bag</i> <i>string</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx125-795006"></a><a 
 id="x125-795007r611"></a><b> string-right-trim</b>  <i>character-bag</i> <i>string</i>
<!--l. 322--><p class="noindent" ><span class="paragraphHead"><a 
 id="x125-796000611"></a></span>
   <a 
href="#x125-568003r609">string-trim</a> returns a substring of <i>string</i>, with all characters in <i>character-bag</i>
stripped oﬀ the beginning and end. The function <a 
href="#x125-568005r610">string-left-trim</a> is similar but
strips characters oﬀ only the beginning; <a 
href="#x125-568007r611">string-right-trim</a> strips oﬀ only the end.
The argument <i>character-bag</i> may be any sequence containing characters. For
example: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-trim &#x2019;(#\Space #\Tab #\Newline) &#x0022; garbanzo beans
</td></tr></table>
                                                                          

                                                                          
<!--l. 331--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x0022;)  ⇒ &#x0022;garbanzo beans&#x0022;</td></tr></table>
<!--l. 332--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-trim &#x0022; (*)&#x0022; &#x0022; ( *three (silly) words* ) &#x0022;)</td></tr></table>
<!--l. 333--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ &#x0022;three (silly) words&#x0022;</td></tr></table>
<!--l. 334--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-left-trim &#x0022; (*)&#x0022; &#x0022; ( *three (silly) words* ) &#x0022;)</td></tr></table>
<!--l. 335--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ &#x0022;three (silly) words* ) &#x0022;</td></tr></table>
<!--l. 336--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-right-trim &#x0022; (*)&#x0022; &#x0022; ( *three (silly) words* ) &#x0022;)</td></tr></table>
<!--l. 337--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ &#x0022; ( *three (silly) words&#x0022;</td></tr></table>
<!--l. 339--><p class="indent" >
</div>
</div>
<!--l. 340--><p class="noindent" >If no characters need to be trimmed from the <i>string</i>, then either the argument <i>string</i>
itself or a copy of it may be returned, at the discretion of the implementation.
<div class=newer>
<!--l. 345--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx125-796001"></a>to clarify string coercion (see <a 
href="#x125-571002r618">string</a>).
</div>
</div>
<div class=defun>
<!--l. 350--><p class="noindent" ><i>[Function]</i><a 
 id="dx125-796002"></a><a 
 id="x125-796003r612"></a><b> string-upcase</b>  <i>string</i> &#x0026;key  <i>:start</i> <i>:end</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx125-796004"></a><a 
 id="x125-796005r613"></a><b> string-downcase</b>  <i>string</i> &#x0026;key  <i>:start</i> <i>:end</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx125-796006"></a><a 
 id="x125-796007r614"></a><b> string-capitalize</b>  <i>string</i> &#x0026;key  <i>:start</i> <i>:end</i>
<!--l. 354--><p class="noindent" ><span class="paragraphHead"><a 
 id="x125-797000614"></a></span>
   <a 
href="#x125-569003r612">string-upcase</a> returns a string just like <i>string</i> with all lowercase characters
replaced by the corresponding uppercase characters. More precisely, each
character of the result string is produced by applying the function <a 
href="clmse79.html#x97-413002r385">char-upcase</a> to
the corresponding character of <i>string</i>.
<!--l. 361--><p class="indent" >   <a 
href="#x125-569005r613">string-downcase</a> is similar, except that uppercase characters are converted to
lowercase characters (using <a 
href="clmse79.html#x97-413004r386">char-downcase</a>).
<!--l. 364--><p class="indent" >   The keyword arguments :start and :end delimit the portion of the
string to be aﬀected. The result is always of the same length as <i>string</i>,
however.
<!--l. 368--><p class="indent" >   The argument is not destroyed. However, if no characters in the argument
require conversion, the result may be either the argument or a copy of it, at the
implementation&#x2019;s discretion. For example: <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-upcase &#x0022;Dr. Livingstone, I presume?&#x0022;)
</td></tr></table>
<!--l. 373--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ &#x0022;DR. LIVINGSTONE, I PRESUME?&#x0022;</td></tr></table>
<!--l. 374--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-downcase &#x0022;Dr. Livingstone, I presume?&#x0022;)</td></tr></table>
<!--l. 375--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ &#x0022;dr. livingstone, i presume?&#x0022;</td></tr></table>
<!--l. 376--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-upcase &#x0022;Dr. Livingstone, I presume?&#x0022; :start 6 :end 10)</td></tr></table>
<!--l. 377--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ &#x0022;Dr. LiVINGstone, I presume?&#x0022;</td></tr></table>
<!--l. 379--><p class="indent" >
</div>
</div>
<!--l. 381--><p class="indent" >   <a 
href="#x125-569007r614">string-capitalize</a> produces a copy of <i>string</i> such that, for every word in the
copy, the ﬁrst character of the word, if case-modiﬁable, is uppercase and any other
case-modiﬁable characters in the word are lowercase. For the purposes of
<a 
href="#x125-569007r614">string-capitalize</a>, a word is deﬁned to be a consecutive subsequence consisting
of alphanumeric characters or digits, delimited at each end either by a
non-alphanumeric character or by an end of the string. For example: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-capitalize &#x0022; hello &#x0022;)  ⇒ &#x0022; Hello &#x0022;
</td></tr></table>
<!--l. 392--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-capitalize</td></tr></table>
<!--l. 393--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    </td><td  
class="tabbing">&#x0022;occlUDeD cASEmenTs FOreSTAll iNADVertent DEFenestraTION&#x0022;)</td></tr></table>
<!--l. 394--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> ⇒ </td><td  
class="tabbing">&#x0022;Occluded Casements Forestall Inadvertent Defenestration&#x0022;</td></tr></table>
<!--l. 395--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-capitalize &#x2019;kludgy-hash-search)  ⇒ &#x0022;Kludgy-Hash-Search&#x0022;</td></tr></table>
<!--l. 396--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-capitalize &#x0022;DON&#x2019;T!&#x0022;)  ⇒ &#x0022;Don&#x2019;T!&#x0022;     ;<i>not</i> &#x0022;Don&#x2019;t!&#x0022;</td></tr></table>
<!--l. 397--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(string-capitalize &#x0022;pipe 13a, foo16c&#x0022;)  ⇒ &#x0022;Pipe 13a, Foo16c&#x0022;</td></tr></table>
<!--l. 399--><p class="indent" >
</div>
</div>
<div class=newer>
<!--l. 402--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx125-797001"></a>to clarify string coercion (see <a 
href="#x125-571002r618">string</a>).
</div>
<div class=incompatibility>
                                                                          

                                                                          
<!--l. 407--><p class="noindent" ><span class="paragraphHead"><a 
 id="x125-79800018.3"></a></span>
   <b>Compatibility note:</b> Some very approximate Interlisp equivalents to
<a 
href="#x125-569003r612">string-upcase</a>, <a 
href="#x125-569005r613">string-downcase</a>, and <a 
href="#x125-569007r614">string-capitalize</a> are u-case, l-case with second
argument <a 
href="clmse31.html#x42-86002r19">nil</a>, and l-case with second argument <a 
href="clmse31.html#x42-87002r20">t</a>.
<!--l. 412--><p class="noindent" ><span class="paragraphHead"><a 
 id="x125-79900018.3"></a>
<!--l. 412--><p class="indent" >   </span>
   incompatibility
</div>
</div>
<div class=defun>
<!--l. 416--><p class="noindent" ><i>[Function]</i><a 
 id="dx125-799001"></a><a 
 id="x125-799002r615"></a><b> nstring-upcase</b>  <i>string</i> &#x0026;key  <i>:start</i> <i>:end</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx125-799003"></a><a 
 id="x125-799004r616"></a><b> nstring-downcase</b>  <i>string</i> &#x0026;key  <i>:start</i> <i>:end</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx125-799005"></a><a 
 id="x125-799006r617"></a><b> nstring-capitalize</b>  <i>string</i> &#x0026;key  <i>:start</i> <i>:end</i>
<!--l. 420--><p class="noindent" ><span class="paragraphHead"><a 
 id="x125-800000617"></a></span>
   These three functions are just like <a 
href="#x125-569003r612">string-upcase</a>, <a 
href="#x125-569005r613">string-downcase</a>, and
<a 
href="#x125-569007r614">string-capitalize</a> but destructively modify the argument <i>string</i> by altering
case-modiﬁable characters as necessary.
<!--l. 426--><p class="indent" >   The keyword arguments :start and :end delimit the portion of the string to be
aﬀected. The argument <i>string</i> is returned as the result.
</div>
<div class=defun>
<!--l. 431--><p class="noindent" ><i>[Function]</i><a 
 id="dx125-800001"></a><a 
 id="x125-800002r618"></a><b> string</b>  <i>x</i>
<!--l. 433--><p class="noindent" ><span class="paragraphHead"><a 
 id="x125-801000618"></a></span>
   Most of the string functions eﬀectively apply <a 
href="#x125-571002r618">string</a> to such of their
arguments as are supposed to be strings. If <i>x</i> is a string, it is returned. If
<i>x</i> is a symbol, its print name is returned. <div class=obsolete> If <i>x</i> is a string character (a
character of type string-char), then a string containing that one character is
returned.
</div> <div class=newer> X3J13 voted in March 1989 <a 
 id="dx125-801001"></a>to eliminate the type string-char and to
redeﬁne the type <a 
href="#x125-571002r618">string</a> to be the union of one or more specialized vector
types, the types of whose elements are subtypes of the type <a 
href="clmse79.html#x97-412002r384">character</a>.
Presumably converting a character to a string always works according to this
vote.
</div> In any other situation, an error is signaled.
                                                                          

                                                                          
<!--l. 454--><p class="indent" >   To convert a sequence of characters to a string, use <a 
href="clmse25.html#x34-58002r7">coerce</a>. (Note that (coerce
x &#x2019;string) will not succeed if x is a symbol. Conversely, <a 
href="#x125-571002r618">string</a> will not convert a
list or other sequence to be a string.)
<!--l. 459--><p class="indent" >   To get the string representation of a number or any other Lisp object, use
prin1-to-string, <a 
href="clmse117.html#x144-684008r718">princ-to-string</a>, or <a 
href="clmse117.html#x144-694003r730">format</a>.
<div class=newer>
<!--l. 464--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx125-801002"></a>to specify that the following functions perform
coercion on their <i>string</i> arguments identical to that performed by the function
<a 
href="#x125-571002r618">string</a>.
<div class="flushleft" 
>
<!--l. 469--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" >string=   </td><td align="left" >string-equal         </td><td align="left" >string-trim       </td>
</tr><tr><td align="left" >string&#x003C;   </td><td align="left" >string-lessp          </td><td align="left" >string-left-trim  </td>
</tr><tr><td align="left" >string&#x003E;   </td><td align="left" >string-greaterp     </td><td align="left" >string-right-trim</td>
</tr><tr><td align="left" >string&#x003C;= </td><td align="left" >string-not-greaterp</td><td align="left" >string-upcase    </td>
</tr><tr><td align="left" >string&#x003E;= </td><td align="left" >string-not-lessp     </td><td align="left" >string-downcase </td>
</tr><tr><td align="left" >string/=  </td><td align="left" >string-not-equal    </td><td align="left" >string-capitalize </td></tr></table>
</div></div>
<!--l. 480--><p class="noindent" >Note that <a 
href="#x125-570003r615">nstring-upcase</a>, <a 
href="#x125-570005r616">nstring-downcase</a>, and <a 
href="#x125-570007r617">nstring-capitalize</a> are absent
from this list; because they modify destructively, the argument must be a
string.
<!--l. 484--><p class="indent" >   As part of the same vote X3J13 speciﬁed that <a 
href="#x125-571002r618">string</a> may perform
additional implementation-dependent coercions but the returned value must be
of type <a 
href="#x125-571002r618">string</a>. Only when no coercion is deﬁned, whether standard or
implementation-dependent, is <a 
href="#x125-571002r618">string</a> required to signal an error, in which case the
error condition must be of type <a 
href="clmse156.html#x190-1061002r1034">type-error</a>.
</div>
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
   <!--l. 6--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch19.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse101.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse101.html#tailclmse101.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse102.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch18.html#clmse102.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 6--><p class="indent" >   <a 
 id="tailclmse102.html"></a>  
</body></html> 
