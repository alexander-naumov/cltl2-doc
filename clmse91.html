<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Указатели заполнения</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-12 23:02:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 1564--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse92.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse90.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse90.html#tailclmse90.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse91.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#clmse91.html" >Наверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">17.5   </span> <a 
href="clm.html#QQ2-113-226" id="x113-21700017.5">Указатели
заполнения</a></h3>
<!--l. 1567--><p class="noindent" >Common Lisp предоставляет несколько функций для управления <i>указателями
заполнения</i>. Они позволяют последовательно заполнять содержимое вектора.
А если точнее, они позволяют эффективно менять длину вектора. Например,
строка с указателем заполнения имеет большинство характеристик строки с
переменной длиной из PL/I.
<!--l. 1573--><p class="indent" >   Указатель заполнения является неотрицательным целым числом не
большим чем общее количество элементов в векторе (полученное от
<tt><a 
href="clmse89.html#x111-215006r510">array-dimension</a></tt>). Указатель заполнения указывает на «активные» или
«заполненные» элементы вектора. Указатель заполнение отображает
«активную длину» вектора. Все элементы вектора, индекс которых
меньше чем указатель заполнения, являются активными. Остальные
элементы являются неактивными. Почти все функции, которые оперируют
содержимым вектора, будут оперировать только активными элементами.
Исключением является <tt><a 
href="clmse88.html#x110-214002r506">aref</a></tt>, которая может получать доступ ко всем
элементам массива, активным и неактивным. Следует отметить, что
элементы вектора из неактивной части тем не менее являются частью
вектора.
<!--l. 1586--><p class="indent" >   Указатели заполнения могут иметь только вектора (одномерные
массивы). Многомерные массивы не могут иметь указатели заполнения.
(Следует отметить, однако, что можно создать многомерный массив
<i>соединённый</i> с вектором, у которого есть указатель заполнения.)
<div class=defun>
<!--l. 1592--><p class="noindent" ><i>[Функция]</i><a 
 id="dx113-217001"></a><a 
 id="x113-217002r530"></a><b> array-has-ﬁll-pointer-p</b>  <i>array</i>
<!--l. 1594--><p class="noindent" >Аргумент должен быть массивом. <tt><a 
href="#x113-217002r530">array-has-fill-pointer-p</a></tt> возвращает <tt><a 
href="clmse30.html#x41-73004r19">t</a></tt>,
если массив умеет указатель заполнения, иначе возвращает <tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt>. Следует
отметить, что <tt><a 
href="#x113-217002r530">array-has-fill-pointer-p</a></tt> всегда возвращает <tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt>, если массив
<i>array</i> не одномерный.
</div>
<div class=defun>
<!--l. 1601--><p class="noindent" ><i>[Функция]</i><a 
 id="dx113-217003"></a><a 
 id="x113-217004r531"></a><b> ﬁll-pointer</b>  <i>vector</i>
<!--l. 1603--><p class="noindent" >Данная функция возвращает указатель заполнения вектора <i>vector</i>. Если
                                                                          

                                                                          
вектор <i>vector</i> не имеет указателя заполнения, генерируется ошибка.
<!--l. 1607--><p class="indent" >   Для изменения указателя заполнения вектора может использоваться
функция <tt><a 
href="clmse35.html#x47-89002r64">setf</a></tt> в связке с <tt><a 
href="#x113-217004r531">fill-pointer</a></tt>. Указатель заполнения вектора
должен быть всегда целым числом между нулём и размером вектора
(включительно).
</div>
<div class=defun>
<!--l. 1612--><p class="noindent" ><i>[Функция]</i><a 
 id="dx113-217005"></a><a 
 id="x113-217006r532"></a><b> vector-push</b>  <i>new-element</i> <i>vector</i>
<!--l. 1614--><p class="noindent" >Аргумент <i>vector</i> должен быть одномерным массивом, имеющим указатель
заполнения, и <i>new-element</i> может быть любым объектом. <tt><a 
href="#x113-217006r532">vector-push</a></tt>
пытается сохранить <i>new-element</i> в элемент вектора, на который ссылается
указатель заполнения, и увеличить этот указатель на 1. Если указатель
заполнения не определяет элемент вектора (например, когда он становится
слишком большим), то <tt><a 
href="#x113-217006r532">vector-push</a></tt> возвращает <tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt>. В противном случае,
если вставка нового элемента произошла, <tt><a 
href="#x113-217006r532">vector-push</a></tt> возвращает
<i>предыдущее</i> значение указателя. Таким образом, <tt><a 
href="#x113-217006r532">vector-push</a></tt> является
индексом вставленного элемента.
<!--l. 1625--><p class="indent" >   Можно сравнить <tt><a 
href="#x113-217006r532">vector-push</a></tt>, которая является функцией, с <tt><a 
href="clmse80.html#x100-201054r451">push</a></tt>,
который являет макросом, который принимает <i>место</i> подходящее для
<tt><a 
href="clmse35.html#x47-89002r64">setf</a></tt>. Вектор с указателем заполнения содержит такое <i>место</i> в слоте
<tt><a 
href="#x113-217004r531">fill-pointer</a></tt>. FIXME
</div>
<div class=defun>
<!--l. 1632--><p class="noindent" ><i>[Функция]</i><a 
 id="dx113-217007"></a><a 
 id="x113-217008r533"></a><b> vector-push-extend</b>  <i>new-element</i> <i>vector</i> &#x0026;optional  <i>extension</i>
<!--l. 1634--><p class="noindent" ><tt><a 
href="#x113-217008r533">vector-push-extend</a></tt> похожа на <tt><a 
href="#x113-217006r532">vector-push</a></tt> за исключением того, что если
указатель заполнения стал слишком большим, длина вектора увеличивается
(с помощью <tt><a 
href="clmse92.html#x114-218002r535">adjust-array</a></tt>), и новый элемент помещается в вектор. Однако,
если вектор не расширяемый, тогда <tt><a 
href="#x113-217008r533">vector-push-extend</a></tt> сигнализирует
ошибку.
<!--l. 1641--><p class="indent" >   Необязательный аргумент <i>extension</i>, который должен быть положительным
целым, является минимальным количеством элементов, добавляемых в
вектор, если последний должен быть расширен. По-умолчанию содержит
значение зависимое от реализации.
</div>
<div class=defun>
<!--l. 1647--><p class="noindent" ><i>[Функция]</i><a 
 id="dx113-217009"></a><a 
 id="x113-217010r534"></a><b> vector-pop</b>  <i>vector</i>
<!--l. 1649--><p class="noindent" >Аргумент <i>vector</i> должен быть одномерным массивом, который имеет
указатель заполнения. Если указатель заполнения является нулём,
                                                                          

                                                                          
<tt><a 
href="#x113-217010r534">vector-pop</a></tt> сигнализирует ошибку. В противном случае, указатель
заполнения уменьшается на 1, и в качестве значения функции возвращается
обозначенный указателем элемент вектора.
</div>
                                                                          

                                                                          
<!--l. 1657--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse92.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse90.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse90.html#tailclmse90.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse91.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#clmse91.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse91.html"></a>  </div> </div> 
</body></html> 
