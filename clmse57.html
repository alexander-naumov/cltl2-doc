<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Экспортирование и импортирование символов</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-17 21:46:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 2285--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse58.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse56.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse56.html#tailclmse56.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse57.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch11.html#clmse57.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">11.4   </span> <a 
 id="x73-16500011.4"></a>Экспортирование и импортирование символов</h3>
<!--l. 2288--><p class="noindent" >Символы из одного пакета могут стать доступными в другом пакете двумя
способами.
<!--l. 2290--><p class="indent" >   Первый способ, каждый отдельный символ может быть добавлен в пакет
использованием функции <a 
href="clmse60.html#x76-169030r158">import</a>. Форма (import &#x2019;editor:buﬀer) принимает
внешний символ с именем buﬀer в пакете editor (этот символ распознаётся
Lisp считывателем) и добавляет его в текущий пакет в качестве внутреннего
символа. Символ становится доступным в текущем пакете. Импортированный
символ автоматически не экспортируется из текущего пакета, но если он уже
существовал в пакете и был внешним, то это свойство не меняется. После
вызова <a 
href="clmse60.html#x76-169030r158">import</a> в импортирующем пакете появляется возможность
ссылаться на buﬀer без указания полного имени. Свойства buﬀer в
пакете editor не меняются, editor продолжает оставаться домашним
пакетом для этого символа. Будучи импортированным, символ будет
присутствовать в пакете и может быть удалён только с помощью вызова
<a 
href="clmse60.html#x76-169024r155">unintern</a>.
<!--l. 2303--><p class="indent" >   Если символ уже присутствует в импортирующем пакете, <a 
href="clmse60.html#x76-169030r158">import</a>
ничего не делает. Если другой символ с таким же именем buﬀer уже
доступен в импортирующем пакете (напрямую или унаследован), тогда
сигнализируется ошибка с возможностью исправления ситуации, как
написано в разделе <a 
href="clmse58.html#x74-16600011.5">11.5<!--tex4ht:ref: NAME-CONFLICTS-SECTION --></a>, потому <a 
href="clmse60.html#x76-169030r158">import</a> не допускает сокрытия одного
символа другим.
<!--l. 2310--><p class="indent" >   Символ называется скрытым другим символом в некотором пакете. Это
когда первый символ был бы доступен через наследование, если бы не
присутствие второго символа. Для импортирования символа без ошибки
скрытия, используйте функцию <a 
href="clmse60.html#x76-169032r159">shadowing-import</a>. Она вставляет символ в
указанный пакет, как внутренний символ, вне зависимости от того,
происходит ли скрытие другого символа с тем же именем. Если другой
символ с тем же именем присутствовал в пакете, тогда этот символ сначала
удаляется из пакета <a 
href="clmse60.html#x76-169024r155">unintern</a>. Новый символ добавляется в список
затеняющих символов FIXME. <a 
href="clmse60.html#x76-169032r159">shadowing-import</a> должна использоваться
                                                                          

                                                                          
аккуратно. Она изменяем состояние системы пакетов так, что правила
согласованности могут перестать работать.
<!--l. 2323--><p class="indent" >   Второй способ предоставляется функцией <a 
href="clmse60.html#x76-169036r161">use-package</a>. Эта функция
делает так, что пакет наследует все внешние символы некоторого другого
пакета. Эти символы становятся доступными, как <i>внутренние</i> символы,
используемого пакета. То есть, на них можно ссылаться без указания пакета
внутри текущего пакета, но они не становятся доступными в других пакетах,
использующих данный. Следует отметить, что <a 
href="clmse60.html#x76-169036r161">use-package</a>, в отличие от
<a 
href="clmse60.html#x76-169030r158">import</a>, не делает новые символы <i>родственными</i> в текущем пакете, а делает
их только <i>доступными</i> с помощью наследования отображения символов.
<a 
href="clmse60.html#x76-169036r161">use-package</a> проверяет конфликты имен между импортируемыми и уже
доступными символами в импортирующем пакете. Это подробнее описано в
разделе <a 
href="clmse58.html#x74-16600011.5">11.5<!--tex4ht:ref: NAME-CONFLICTS-SECTION --></a>.
<!--l. 2335--><p class="indent" >   Обычно пользователь, по-умолчанию работая в пакете user, будет
загружать ряд пакетов в Lisp систему для предоставления расширенного
рабочего окружения, и затем вызывать <a 
href="clmse60.html#x76-169036r161">use-package</a> для каждого из этих
пакетов для простого доступа к их внешним символами. <a 
href="clmse60.html#x76-169038r162">unuse-package</a>
производит обратные действия относительно <a 
href="clmse60.html#x76-169036r161">use-package</a>. Внешние
символы используемые пакетом перестают наследоваться. Однако, любые
импортированные символы, остаются доступными.
<!--l. 2343--><p class="indent" >   Не существует способа наследовать <i>внутренние</i> символы другого пакета.
Для ссылки на внутренний символ, пользователь должен поменять
домашний пакет для данного символа на текущий, использовать полное
имя (вместе с пакетом) или импортировать этот символ в текущий
пакет.
<div class=newer>
<!--l. 2349--><p class="indent" >   Различие между внешними и внутренними символами прежде всего
означает скрытие имен, так чтобы одна программа не могла использовать
пространство имен другой программы.
</div>
<!--l. 2354--><p class="indent" >   Когда <a 
href="clmse60.html#x76-169020r153">intern</a> или некоторые другие функций хотят найти символ в
заданном пакете, они сначала ищут символ среди внешних и внутренних
символов текущего пакета, затем они в неопределённом порядке ищут среди
внешних символов используемых пакетов. Порядок не имеет значение. В
соответствии с правилами разрешения конфликтов имен (смотрите ниже),
если конфликтующие символы существуют в двух и более пакетах,
унаследованных пакетом <i>X</i>, символ с этим именем должен также быть в <i>X</i>,
как затеняющий символ. Конечно, реализации могут выбрать другой, более
                                                                          

                                                                          
эффективный способ для реализации такого поиска, не изменяя поведение
ранее описанного интерфейса.
<!--l. 2364--><p class="indent" >   Функция <a 
href="clmse60.html#x76-169026r156">export</a> принимает символ, который доступен в некотором
указанном пакете (напрямую или унаследован из другого пакета) и делает
его внешним символом этого пакета. Если символ уже доступен как внешний,
<a 
href="clmse60.html#x76-169026r156">export</a> ничего не делает. Если символ представлен, как внутренний
<i>родственный</i> символ, его статус просто меняется на внешний. Если он
доступен, как внутренний символ, полученный с помощью <a 
href="clmse60.html#x76-169036r161">use-package</a>,
символ сначала импортируется в пакет, а затем делается внешним. (После
этого символ становиться импортированным в пакет и остаётся в нем, вне
зависимости от того будет ли использована <a 
href="clmse60.html#x76-169038r162">unuse-package</a> или нет). Если
символ вообще недоступен в указанном пакете, то сигнализируется ошибка с
возможностью решить проблему, а, именно, какой символ должен быть
импортирован.
<!--l. 2376--><p class="indent" >   Функция <a 
href="clmse60.html#x76-169028r157">unexport</a> предоставляет как способ откатить ошибочное
экспортирование символа. Она работает только для символов напрямую
представленных в текущем пакете, меняя их свойство на «внутреннее». Если
<a 
href="clmse60.html#x76-169028r157">unexport</a> получает символ, который в текущем пакете уже является
внутренним, она ничего не делает. Если получает вообще недоступный
символ, то сигнализирует ошибку.
                                                                          

                                                                          
   <!--l. 2383--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse58.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse56.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse56.html#tailclmse56.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse57.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch11.html#clmse57.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 2383--><p class="indent" >   <a 
 id="tailclmse57.html"></a>  
</body></html> 
