<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Opening and Closing Files</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-11 23:15:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 1914--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse114.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse112.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse112.html#tailclmse112.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse113.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch23.html#clmse113.html" >Вверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">23.2   </span> <a 
href="clm.html#QQ2-141-317" id="x141-27600023.2">Opening and Closing
Files</a></h3>
<!--l. 1916--><p class="noindent" >When a ﬁle is <i>opened</i>, a stream object is constructed to serve as the ﬁle system&#x2019;s
ambassador to the Lisp environment; operations on the stream are reﬂected by
operations on the ﬁle in the ﬁle system. The act of <i>closing</i> the ﬁle (actually, the
stream) ends the association; the transaction with the ﬁle system is terminated,
and input/output may no longer be performed on the stream. The stream
function <tt><a 
href="clmse107.html#x133-244013r601">close</a></tt> may be used to close a ﬁle; the functions described below may be
used to open them. The basic operation is <tt><a 
href="#x141-276002r697">open</a></tt>, but <tt><a 
href="#x141-276011r698">with-open-file</a></tt> is usually
more convenient for most applications.
<div class=defun>
<!--l. 1927--><p class="noindent" ><i>[Function]</i><a 
 id="dx141-276001"></a><a 
 id="x141-276002r697"></a><b> open</b>  <i>ﬁlename</i> &#x0026;key  <i>:direction</i> <i>:element-type</i> <i>:if-exists</i> <i>:if-does-not-exist</i>
<i>:external-format</i>
<!--l. 1929--><p class="noindent" ><div class=newer> X3J13 voted in June 1989 <a 
 id="dx141-276003"></a>to add to the function <tt><a 
href="#x141-276002r697">open</a></tt> a new keyword argument
<tt>:external-format</tt>. This argument did not appear in the preceding argument
description in the ﬁrst edition.
</div>
<!--l. 1937--><p class="indent" >   This returns a stream that is connected to the ﬁle speciﬁed by <i>ﬁlename</i>. The
<i>ﬁlename</i> is the name of the ﬁle to be opened; it may be a string, a pathname, or a
stream. (If the <i>ﬁlename</i> is a stream, then it is not closed ﬁrst or otherwise
aﬀected; it is used merely to provide a ﬁle name for the opening of a new
stream.)
<div class=new>
<!--l. 1944--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx141-276004"></a>to specify that the result of <tt><a 
href="#x141-276002r697">open</a></tt>, if it is a
stream, is always a stream of type <tt>file-stream</tt>.
</div>
<div class=new>
<!--l. 1951--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx141-276005"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse112.html#x140-27500023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<div class=new>
<!--l. 1958--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx141-276006"></a>to specify that <tt><a 
href="#x141-276002r697">open</a></tt> is unaﬀected by whether the
ﬁrst argument, if a stream, is open or closed. If the ﬁrst argument is a stream,
                                                                          

                                                                          
<tt><a 
href="#x141-276002r697">open</a></tt> behaves as if the function <tt><a 
href="clmse112.html#x140-275005r678">pathname</a></tt> were applied to the stream and the
resulting pathname used instead.
</div>
<div class=newer>
<!--l. 1967--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx141-276007"></a>to clarify that <tt><a 
href="#x141-276002r697">open</a></tt> accepts only non-wild
pathnames; an error is signaled if <tt><a 
href="clmse112.html#x140-268003r669">wild-pathname-p</a></tt> would be true of
<i>ﬁlename</i>.
</div>
<div class=newer>
<!--l. 1973--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx141-276008"></a>to require <tt><a 
href="#x141-276002r697">open</a></tt> to accept logical pathnames (see
section <a 
href="clmse112.html#x140-26900023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>).
</div>
<!--l. 1977--><p class="indent" >   The keyword arguments specify what kind of stream to produce and how to
handle errors: <div class=flushdesc>
      <ul><li><b>
<tt>:direction</tt> </b></li>This argument speciﬁes whether the stream should handle input,
      output, or both.
           <div class="quotation">
<div class=flushdesc>
           <!--l. 1985--><p class="noindent" >
    <ul><li><b>
<tt>:input</tt> </b></li>The result will be an input stream. This is the default.
    <li><b>
<tt>:output</tt> </b></li>The result will be an output stream.
    <li><b>
<tt>:io</tt> </b></li>The result will be a bidirectional stream.
    <li><b>
<tt>:probe</tt> </b></li>The  result  will  be  a  no-directional  stream  (in  eﬀect,
    the  stream  is  created  and  then  closed).  This  is  useful  for
    determining whether a ﬁle exists without actually setting up
    a complete stream.</ul>
</div>
           </div>
                                                                          

                                                                          
      <li><b>
<tt>:element-type</tt> </b></li>This argument speciﬁes the type of the unit of transaction for the
      stream. Anything that can be recognized as being a ﬁnite subtype of
      <tt><a 
href="clmse73.html#x91-192002r341">character</a></tt> or <tt>integer</tt> is acceptable. In particular, the following types are
      recognized:
      <!--l. 2007--><p class="noindent" >
           <div class="quotation">
<div class=flushdesc>
           <!--l. 2009--><p class="noindent" >
    <ul><li><b>
<tt><a 
href="clmse73.html#x91-192002r341">character</a></tt> </b></li>The unit of transaction is any character, not just a
    string-character. The functions <tt><a 
href="clmse109.html#x136-255015r639">read-char</a></tt> and <tt><a 
href="clmse110.html#x137-258024r656">write-char</a></tt>
    (depending on the value of the <tt>:direction</tt> argument) may
    be used on the stream. This is the default.
    <li><b>
<tt>base-char</tt> </b></li>The  unit  of  transaction  is  a  base  character.  The
    functions  <tt><a 
href="clmse109.html#x136-255015r639">read-char</a></tt> and  <tt><a 
href="clmse110.html#x137-258024r656">write-char</a></tt> (depending  on  the
    value  of  the  <tt>:direction</tt> argument)  may  be  used  on  the
    stream.</ul>
</div>
           </div>
      <!--l. 2021--><p class="noindent" >
           <div class="quotation">
<div class=flushdesc>
           <!--l. 2023--><p class="noindent" >
    <ul><li><b>
<tt>(unsigned-byte <i>n</i>)</tt> </b></li>The unit of transaction is an unsigned byte
    (a non-negative integer) of size <i>n</i>. The functions <tt><a 
href="clmse109.html#x136-256002r647">read-byte</a></tt>
    and/or <tt><a 
href="clmse110.html#x137-260002r665">write-byte</a></tt> may be used on the stream.
    <li><b>
<tt>unsigned-byte</tt> </b></li>The unit of transaction is an unsigned byte (a
    non-negative integer); the size of the byte is determined by
                                                                          

                                                                          
    the ﬁle system. The functions <tt><a 
href="clmse109.html#x136-256002r647">read-byte</a></tt> and/or <tt><a 
href="clmse110.html#x137-260002r665">write-byte</a></tt>
    may be used on the stream.
    <li><b>
<tt>(signed-byte <i>n</i>)</tt> </b></li>The unit of transaction is a signed byte of size
    <i>n</i>. The functions <tt><a 
href="clmse109.html#x136-256002r647">read-byte</a></tt> and/or <tt><a 
href="clmse110.html#x137-260002r665">write-byte</a></tt> may be used
    on the stream.
    <li><b>
<tt>signed-byte</tt> </b></li>The unit of transaction is a signed byte; the size
    of the byte is determined by the ﬁle system. The functions
    <tt><a 
href="clmse109.html#x136-256002r647">read-byte</a></tt> and/or <tt><a 
href="clmse110.html#x137-260002r665">write-byte</a></tt> may be used on the stream.
    <li><b>
<tt><a 
href="clmse90.html#x112-216002r517">bit</a></tt> </b></li>The unit of transaction is a bit (values <tt>0</tt> and <tt>1</tt>). The functions
    <tt><a 
href="clmse109.html#x136-256002r647">read-byte</a></tt> and/or <tt><a 
href="clmse110.html#x137-260002r665">write-byte</a></tt> may be used on the stream.
    <li><b>
<tt>(mod <i>n</i>)</tt> </b></li>The unit of transaction is a non-negative integer less
    than <i>n</i>. The functions <tt><a 
href="clmse109.html#x136-256002r647">read-byte</a></tt> and/or <tt><a 
href="clmse110.html#x137-260002r665">write-byte</a></tt> may be
    used on the stream.
    <li><b>
<tt>:default</tt> </b></li>The unit of transaction is to be determined by the ﬁle
    system, based on the ﬁle it ﬁnds. The type can be determined
    by using the function <tt><a 
href="clmse107.html#x133-244011r600">stream-element-type</a></tt>.</ul>
</div>
           </div>
      <li><b>
<tt>:if-exists</tt> </b></li>This argument speciﬁes the action to be taken if the <tt>:direction</tt> is
      <tt>:output</tt> or <tt>:io</tt> and a ﬁle of the speciﬁed name already exists. If the
      direction is <tt>:input</tt> or <tt>:probe</tt>, this argument is ignored.
           <div class="quotation">
<div class=flushdesc>
           <!--l. 2068--><p class="noindent" >
    <ul><li><b>
<tt>:error</tt> </b></li>Signals  an  error.  This  is  the  default  when  the  version
    component of the <i>ﬁlename</i> is not <tt>:newest</tt>.
                                                                          

                                                                          
    <li><b>
<tt>:new-version</tt> </b></li>Creates a new ﬁle with the same ﬁle name but
    with a larger version number. This is the default when the
    version component of the <i>ﬁlename</i> is <tt>:newest</tt>.
    <li><b>
<tt>:rename</tt> </b></li>Renames the existing ﬁle to some other name and then
    creates a new ﬁle with the speciﬁed name.
    <li><b>
<tt>:rename-and-delete</tt> </b></li>Renames  the  existing  ﬁle  to  some  other
    name and then deletes it (but does not expunge it, on those
    systems  that  distinguish  deletion  from  expunging).  Then
    create a new ﬁle with the speciﬁed name.
    <li><b>
<tt>:overwrite</tt> </b></li>Uses  the  existing  ﬁle.  Output  operations  on  the
    stream will destructively modify the ﬁle. If the <tt>:direction</tt> is
    <tt>:io</tt>, the ﬁle is opened in a bidirectional mode that allows both
    reading and writing. The ﬁle pointer is initially positioned at
    the beginning of the ﬁle; however, the ﬁle is not truncated
    back to length zero when it is opened. This mode is most
    useful when the <tt><a 
href="clmse114.html#x142-278026r704">file-position</a></tt> function can be used on the
    stream.
    <li><b>
<tt>:append</tt> </b></li>Uses the existing ﬁle. Output operations on the stream
    will destructively modify the ﬁle. The ﬁle pointer is initially
    positioned at the end of the ﬁle. If the <tt>:direction</tt> is <tt>:io</tt>, the
    ﬁle is opened in a bidirectional mode that allows both reading
    and writing.
    <li><b>
<tt>:supersede</tt> </b></li>Supersedes   the   existing   ﬁle.   If   possible,   the
    implementation  should  arrange  not  to  destroy  the  old  ﬁle
    until the new stream is closed, against the possibility that
    the stream will be closed in “abort” mode (see <tt><a 
href="clmse107.html#x133-244013r601">close</a></tt>). This
    diﬀers from <tt>:new-version</tt> in that <tt>:supersede</tt> creates a new
    ﬁle with the same name as the old one, rather than a ﬁle name
    with a higher version number.
    <li><b>
<tt><tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt></tt> </b></li>Does not create a ﬁle or even a stream, but instead simply
                                                                          

                                                                          
    returns <tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt> to indicate failure.</ul>
</div>
           </div>
      <!--l. 2119--><p class="noindent" >If the <tt>:direction</tt> is <tt>:output</tt> or <tt>:io</tt> and the value of <tt>:if-exists</tt> is
      <tt>:new-version</tt>, then the version of the (newly created) ﬁle that is
      opened will be a version greater than that of any other ﬁle in the ﬁle
      system whose other pathname components are the same as those of
      <i>ﬁlename</i>.
      <!--l. 2125--><p class="noindent" >If the <tt>:direction</tt> is <tt>:input</tt> or <tt>:probe</tt> or the value of <tt>:if-exists</tt> is not
      <tt>:new-version</tt>, <i>and</i> the version component of the <i>ﬁlename</i> is <tt>:newest</tt>,
      then the ﬁle opened is that ﬁle already existing in the ﬁle system
      that has a version greater than that of any other ﬁle in the ﬁle
      system whose other pathname components are the same as those of
      <i>ﬁlename</i>.
<div class=new>
      <!--l. 2133--><p class="noindent" >Some ﬁle systems permit yet other actions to be taken when a ﬁle already
      exists; therefore, some implementations provide implementation-speciﬁc
      <tt>:if-exist</tt> options.
      </div></ul>
</div>
<div class=implementation>
<!--l. 2140--><p class="noindent" ><b>Заметка для реализации:</b> The various ﬁle systems in existence today have widely
diﬀering capabilities. A given implementation may not be able to support all of these
options in exactly the manner stated. An implementation is required to recognize all of
these option keywords and to try to do something “reasonable” in the context of the host
operating system. Implementors are encouraged to approximate the semantics speciﬁed
here as closely as possible.
<!--l. 2149--><p class="indent" >   As an example, suppose that a ﬁle system does not support distinct ﬁle versions and
does not distinguish the notions of deletion and expunging (in some ﬁle systems ﬁle
deletion is reversible until an expunge operation is performed). Then <tt>:new-version</tt>
might be treated the same as <tt>:rename</tt> or <tt>:supersede</tt>, and <tt>:rename-and-delete</tt> might
be treated the same as <tt>:supersede</tt>.
<!--l. 2156--><p class="indent" >   If it is utterly impossible for an implementation to handle some option in a manner
close to what is speciﬁed here, it may simply signal an error. The opening of ﬁles is an
area where complete portability is too much to hope for; the intent here is simply to
make things as portable as possible by providing speciﬁc names for a range of commonly
supportable options.
                                                                          

                                                                          
</div>
<div class=flushdesc>
<!--l. 2165--><p class="indent" >
      <ul><li><b>
<tt>:if-does-not-exist</tt> </b></li>This argument speciﬁes the action to be taken if a ﬁle of
      the speciﬁed name does not already exist.
           <div class="quotation">
<div class=flushdesc>
           <!--l. 2170--><p class="noindent" >
    <ul><li><b>
<tt>:error</tt> </b></li>Signals an error. This is the default if the <tt>:direction</tt>
    is <tt>:input</tt>, or if the <tt>:if-exists</tt> argument is <tt>:overwrite</tt> or
    <tt>:append</tt>.
    <li><b>
<tt>:create</tt> </b></li>Creates an empty ﬁle with the speciﬁed name and then
    proceeds  as  if  it  had  already  existed  (but  do  not  perform
    any processing directed by the <tt>:if-exists</tt> argument). This
    is  the  default  if  the  <tt>:direction</tt> is  <tt>:output</tt> or  <tt>:io</tt>,  and
    the  <tt>:if-exists</tt> argument  is  anything  but  <tt>:overwrite</tt> or
    <tt>:append</tt>.
    <li><b>
<tt><tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt></tt> </b></li>Does not create a ﬁle or even a stream, but instead simply
    returns  <tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt> to  indicate  failure.  This  is  the  default  if  the
    <tt>:direction</tt> is <tt>:probe</tt>.</ul>
</div>
           </div>
      </ul>
</div>
<div class=newer>
<!--l. 2191--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx141-276009"></a>to add to the function <tt><a 
href="#x141-276002r697">open</a></tt> a new keyword
argument <tt>:external-format</tt>. <div class=flushdesc>
      <ul><li><b>
<tt>:external-format</tt> </b></li>This argument speciﬁes an implementation-recognized
                                                                          

                                                                          
      scheme  for  representing  characters  in  ﬁles.  The  default  value  is
      <tt>:default</tt> and is implementation-deﬁned but must support the base
      characters. An error is signaled if the implementation does recognize
      the speciﬁed format.
      <!--l. 2200--><p class="noindent" >This  argument  may  be  speciﬁed  if  the  <tt>:direction</tt> argument  is
      <tt>:input</tt>, <tt>:output</tt>, or <tt>:io</tt>. It is an error to write a character to the
      resulting stream that cannot be represented by the speciﬁed ﬁle format.
      (However,  the  <tt>#\Newline</tt> character  cannot  produce  such  an  error;
      implementations must provide appropriate line division behavior for all
      character streams.)
      <!--l. 2207--><p class="noindent" >See <tt>stream-external-format</tt>.</ul>
</div>
</div>
<!--l. 2211--><p class="indent" >   When the caller is ﬁnished with the stream, it should close the ﬁle by using
the <tt><a 
href="clmse107.html#x133-244013r601">close</a></tt> function. The <tt><a 
href="#x141-276011r698">with-open-file</a></tt> form does this automatically, and so is
preferred for most purposes. <tt><a 
href="#x141-276002r697">open</a></tt> should be used only when the control structure
of the program necessitates opening and closing of a ﬁle in some way more
complex than provided by <tt><a 
href="#x141-276011r698">with-open-file</a></tt>. It is suggested that any program that
uses <tt><a 
href="#x141-276002r697">open</a></tt> directly should use the special form <tt><a 
href="clmse43.html#x55-139004r115">unwind-protect</a></tt> to close the ﬁle if
an abnormal exit occurs.
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> with-open-ﬁle </b><a 
 id="dx141-276010"></a><a 
 id="x141-276011r698"></a> (stream ﬁlename  {options}* )
</td></tr></table>
<!--l. 2223--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  { form}* </td></tr></table>
<!--l. 2224--><p class="indent" >
</div>
<!--l. 2224--><p class="noindent" ><span class="paragraphHead"><a 
href="#x141-27700023.2" id="x141-27700023.2"></a></span>
   <tt><a 
href="#x141-276011r698">with-open-file</a></tt> evaluates the <i>forms</i> of the body (an implicit <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt>) with the
variable <i>stream</i> bound to a stream that reads or writes the ﬁle named by the value
                                                                          

                                                                          
of <i>ﬁlename</i>. The <i>options</i> are evaluated and are used as keyword arguments to the
function <tt><a 
href="#x141-276002r697">open</a></tt>.
<!--l. 2232--><p class="indent" >   When control leaves the body, either normally or abnormally (such as by use
of <tt><a 
href="clmse43.html#x55-140002r116">throw</a></tt>), the ﬁle is automatically closed. If a new output ﬁle is being written,
and control leaves abnormally, the ﬁle is aborted and the ﬁle system is left, so far
as possible, as if the ﬁle had never been opened. Because <tt><a 
href="#x141-276011r698">with-open-file</a></tt> always
closes the ﬁle, even when an error exit is taken, it is preferred over <tt><a 
href="#x141-276002r697">open</a></tt> for most
applications.
<i>
<!--l. 2240--><p class="indent" >   ﬁlename</i> is the name of the ﬁle to be opened; it may be a string, a pathname,
or a stream.
<div class=new>
<!--l. 2244--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx141-277001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse112.html#x140-27500023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<div class=newer>
<!--l. 2251--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx141-277002"></a>to clarify that <tt><a 
href="#x141-276011r698">with-open-file</a></tt> accepts only
non-wild pathnames; an error is signaled if <tt><a 
href="clmse112.html#x140-268003r669">wild-pathname-p</a></tt> would be true of the
<i>ﬁlename</i> argument.
</div>
<div class=newer>
<!--l. 2258--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx141-277003"></a>to require <tt><a 
href="#x141-276011r698">with-open-file</a></tt> to accept logical
pathnames (see section <a 
href="clmse112.html#x140-26900023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>).
</div>
<!--l. 2263--><p class="indent" >   For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-open-ﬁle (iﬁle name
</td></tr></table>
<!--l. 2265--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 :direction :input)</td></tr></table>
<!--l. 2266--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (with-open-ﬁle (oﬁle (merge-pathname-defaults iﬁle</td></tr></table>
<!--l. 2267--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                  nil</td></tr></table>
<!--l. 2268--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                  &#x0022;out&#x0022;)</td></tr></table>
<!--l. 2269--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         :direction :output</td></tr></table>
<!--l. 2270--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         :if-exists :supersede)</td></tr></table>
<!--l. 2271--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (transduce-ﬁle iﬁle oﬁle)))</td></tr></table>
<!--l. 2273--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<div class=newer>
<!--l. 2276--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx141-277004"></a>to specify that the variable <i>stream</i> is not always
bound to a stream; rather it is bound to whatever would be returned by a call to
<tt><a 
href="#x141-276002r697">open</a></tt>. For example, if the options include <tt>:if-does-not-exist nil</tt>, <i>stream</i> will
be bound to <tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt> if the ﬁle does not exist. In this case the value of <i>stream</i> should
be tested within the body of the <tt><a 
href="#x141-276011r698">with-open-file</a></tt> form before it is used as a
stream. For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-open-ﬁle (iﬁle name
</td></tr></table>
<!--l. 2285--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 :direction :input</td></tr></table>
<!--l. 2286--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 :if-does-not-exist nil)</td></tr></table>
<!--l. 2287--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Process the ﬁle only if it actually exists.</td></tr></table>
<!--l. 2288--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (when (streamp name)</td></tr></table>
<!--l. 2289--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (compile-cobol-program iﬁle)))</td></tr></table>
<!--l. 2291--><p class="indent" >
</div>
</div>
</div>
</div>
<div class=implementation>
<!--l. 2296--><p class="noindent" ><b>Заметка для реализации:</b> While <tt><a 
href="#x141-276011r698">with-open-file</a></tt> tries to automatically close the
stream on exit from the construct, for robustness it is helpful if the garbage collector can
detect discarded streams and automatically close them.
</div>
                                                                          

                                                                          
<!--l. 2304--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse114.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse112.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse112.html#tailclmse112.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse113.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch23.html#clmse113.html" >Вверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse113.html"></a>  </div> </div> 
</body></html> 
