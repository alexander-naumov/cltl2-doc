<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Array Creation</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-17 21:46:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
                                                                          

                                                                          
   <!--l. 41--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse90.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#tailclmch17.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse89.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#clmse89.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">17.1   </span> <a 
 id="x111-21500017.1"></a>Array Creation</h3>
<!--l. 43--><p class="noindent" >Do not be daunted by the many options of the function <a 
href="#x111-215002r520">make-array</a>. All that is
required to construct an array is a list of the dimensions; most of the options are
for relatively esoteric applications.
<div class=defun>
<!--l. 48--><p class="noindent" ><i>[Function]</i><a 
 id="dx111-215001"></a><a 
 id="x111-215002r520"></a><b> make-array</b>  <i>dimensions</i> &#x0026;key  <i>:element-type</i> <i>:initial-element</i>
<i>:initial-contents</i> <i>:adjustable</i> <i>:ﬁll-pointer</i> <i>:displaced-to</i> <i>:displaced-index-oﬀset</i>
<!--l. 50--><p class="noindent" >This is the primitive function for making arrays. The dimensions argument should
be a list of non-negative integers that are to be the dimensions of the array; the
length of the list will be the dimensionality of the array. Each dimension must be
smaller than <a 
href="#x111-215009r522">array-dimension-limit</a>, and the product of all the dimensions
must be smaller than <a 
href="#x111-215012r523">array-total-size-limit</a>. Note that if dimensions is <a 
href="clmse31.html#x42-74002r18">nil</a>,
then a zero-dimensional array is created. For convenience when making a
one-dimensional array, the single dimension may be provided as an integer rather
than as a list of one integer.
<!--l. 62--><p class="indent" >   An implementation of Common Lisp may impose a limit on the rank
of an array, but this limit may not be smaller than 7. Therefore, any
Common Lisp program may assume the use of arrays of rank 7 or less. The
implementation-dependent limit on array rank is reﬂected in <a 
href="#x111-215007r521">array-rank-limit</a>.
<!--l. 68--><p class="indent" >   The keyword arguments for <a 
href="#x111-215002r520">make-array</a> are as follows:
<div class=flushdesc>
<!--l. 71--><p class="indent" >
      <ul><li><b>
:element-type </b></li>This argument should be the name of the type of the elements
      of the array; an array is constructed of the most specialized type that
      can nevertheless accommodate elements of the given type. The type <a 
href="clmse31.html#x42-74004r19">t</a>
      speciﬁes a general array, one whose elements may be any Lisp object;
      this is the default type.
<div class=new>
      <!--l. 81--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx111-215003"></a>to change <a 
href="clmse32.html#x43-76002r20">typep</a> and <a 
href="clmse32.html#x43-76004r21">subtypep</a> so that the
      specialized array type speciﬁer means the same thing for discrimination
      purposes as for declaration purposes: it encompasses those arrays that can
      result by specifying element-type as the element type to the function
      <a 
href="#x111-215002r520">make-array</a>. Therefore we may say that if type is the :element-type
      argument, then the result will be an array of type (array type); put another
      way, for any type A, <div class=lisp><div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(typep (make-array ... :element-type &#x2019;A ...)
</td></tr></table>
      <!--l. 93--><p class="noindent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">       &#x2019;(array A)))</td></tr></table>
      <!--l. 95--><p class="noindent" >
</div>
</div>
      <!--l. 96--><p class="noindent" >is always true. See <a 
href="clmse27.html#x36-55004r9">upgraded-array-element-type</a>.
      </div>
      <li><b>
:initial-element </b></li>This argument may be used to initialize each element of the array.
      The value must be of the type speciﬁed by the :element-type argument. If
      the :initial-element option is omitted, the initial values of the array elements
      are undeﬁned (unless the :initial-contents or :displaced-to option is used).
      The :initial-element option may not be used with the :initial-contents or
      :displaced-to option.
      <li><b>
:initial-contents </b></li>This argument may be used to initialize the contents
      of the array. The value is a nested structure of sequences. If the
      array is zero-dimensional, then the value speciﬁes the single element.
      Otherwise, the value must be a sequence whose length is equal to the ﬁrst
      dimension; each element must be a nested structure for an array whose
      dimensions are the remaining dimensions, and so on. For example:
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(make-array &#x2019;(4 2 3)
</td></tr></table>
      <!--l. 119--><p class="noindent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">            :initial-contents</td></tr></table>
      <!--l. 120--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">            &#x2019;(((a b c) (1 2 3))</td></tr></table>
      <!--l. 121--><p class="noindent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">              ((d e f) (3 1 2))</td></tr></table>
      <!--l. 122--><p class="noindent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">              ((g h i) (2 3 1))</td></tr></table>
                                                                          

                                                                          
      <!--l. 123--><p class="noindent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">              ((j k l) (0 0 0))))</td></tr></table>
      <!--l. 125--><p class="noindent" >
</div>
</div>
      <!--l. 126--><p class="noindent" >The numbers of levels in the structure must equal the rank of the array.
      Each leaf of the nested structure must be of the type speciﬁed by the :type
      option. If the :initial-contents option is omitted, the initial values of the
      array elements are undeﬁned (unless the :initial-element or :displaced-to
      option is used). The :initial-contents option may not be used with the
      :initial-element or :displaced-to option.
      <li><b>
:adjustable </b></li>This argument, if speciﬁed and not <a 
href="clmse31.html#x42-74002r18">nil</a>, indicates that it must be
      possible to alter the array&#x2019;s size dynamically after it is created. This
      argument defaults to <a 
href="clmse31.html#x42-74002r18">nil</a>.
<div class=newer>
      <!--l. 141--><p class="noindent" >X3J13 voted in June 1989 <a 
 id="dx111-215004"></a>to clarify that if this argument is non-<a 
href="clmse31.html#x42-74002r18">nil</a> then the
      predicate <a 
href="clmse91.html#x113-217019r535">adjustable-array-p</a> will necessarily be true when applied to the
      resulting array; but if this argument is <a 
href="clmse31.html#x42-74002r18">nil</a> (or omitted) then the resulting
      array may or may not be adjustable, depending on the implementation, and
      therefore <a 
href="clmse91.html#x113-217019r535">adjustable-array-p</a> may be correspondingly true or false of the
      resulting array. Common Lisp provides no portable way to create a
      non-adjustable array, that is, an array for which <a 
href="clmse91.html#x113-217019r535">adjustable-array-p</a> is
      guaranteed to be false.
      </div>
      <li><b>
:ﬁll-pointer </b></li>This argument speciﬁes that the array should have a ﬁll pointer. If
      this option is speciﬁed and not <a 
href="clmse31.html#x42-74002r18">nil</a>, the array must be one-dimensional. The
      value is used to initialize the ﬁll pointer for the array. If the value <a 
href="clmse31.html#x42-74004r19">t</a> is
      speciﬁed, the length of the array is used; otherwise the value must be an
      integer between 0 (inclusive) and the length of the array (inclusive). This
      argument defaults to <a 
href="clmse31.html#x42-74002r18">nil</a>.
      <li><b>
:displaced-to </b></li>This argument, if speciﬁed and not <a 
href="clmse31.html#x42-74002r18">nil</a>, speciﬁes that the array will
      be a displaced array. The argument must then be an array; <a 
href="#x111-215002r520">make-array</a> will
                                                                          

                                                                          
      create an indirect or shared array that shares its contents with the speciﬁed
      array. In this case the :displaced-index-oﬀset option may be useful. It is an
      error if the array given as the :displaced-to argument does not have the
      same :element-type as the array being created. The :displaced-to option may
      not be used with the :initial-element or :initial-contents option. This
      argument defaults to <a 
href="clmse31.html#x42-74002r18">nil</a>.
      <li><b>
:displaced-index-oﬀset </b></li>This argument may be used only in conjunction with the
      displaced-to option. It must be a non-negative integer (it defaults
      to zero); it is made to be the index-oﬀset of the created shared
      array.
      <!--l. 184--><p class="noindent" >When an array A is given as the :displaced-to argument to <a 
href="#x111-215002r520">make-array</a> when
      creating array B, then array B is said to be displaced to array A. Now the
      total number of elements in an array, called the total size of the array, is
      calculated as the product of all the dimensions (see <a 
href="clmse91.html#x113-217010r531">array-total-size</a>). It is
      required that the total size of A be no smaller than the sum of the total
      size of B plus the oﬀset n speciﬁed by the :displaced-index-oﬀset
      argument. The eﬀect of displacing is that array B does not have
      any elements of its own but instead maps accesses to itself into
      accesses to array A. The mapping treats both arrays as if they were
      one-dimensional by taking the elements in row-major order, and then maps
      an access to element k of array B to an access to element k+n of array
      A.</ul>
</div>
<!--l. 201--><p class="indent" >   If <a 
href="#x111-215002r520">make-array</a> is called with each of the :adjustable, :ﬁll-pointer, and
:displaced-to arguments either unspeciﬁed or <a 
href="clmse31.html#x42-74002r18">nil</a>, then the resulting array is
guaranteed to be a simple array (see section <a 
href="clmse7.html#x14-290002.5">2.5<!--tex4ht:ref: ARRAY-TYPE-SECTION --></a>).
<div class=newer>
<!--l. 208--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx111-215005"></a>to clarify that if one or more of the :adjustable,
:ﬁll-pointer, and :displaced-to arguments is true, then whether the resulting array
is simple is unspeciﬁed.
</div>
<!--l. 215--><p class="indent" >   Here are some examples of the use of <a 
href="#x111-215002r520">make-array</a>: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Create a one-dimensional array of ﬁve elements.
</td></tr></table>
                                                                          

                                                                          
<!--l. 217--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(make-array 5)</td></tr></table>
<!--l. 218--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 219--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Create a two-dimensional array, 3 by 4, with four-bit elements.</td></tr></table>
<!--l. 220--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(make-array &#x2019;(3 4) :element-type &#x2019;(mod 16))</td></tr></table>
<!--l. 221--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 222--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Create an array of single-ﬂoats.</td></tr></table>
<!--l. 223--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(make-array 5 :element-type &#x2019;single-ﬂoat))</td></tr></table>
<!--l. 224--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 225--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Making a shared array.</td></tr></table>
<!--l. 226--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq a (make-array &#x2019;(4 3)))</td></tr></table>
<!--l. 227--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq b (make-array 8 :displaced-to a</td></tr></table>
<!--l. 228--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      :displaced-index-oﬀset 2))</td></tr></table>
<!--l. 229--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Now it is the case that:</td></tr></table>
<!--l. 230--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (aref b 0) <span class="math"> ≡</span> (aref a 0 2)</td></tr></table>
<!--l. 231--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (aref b 1) <span class="math"> ≡</span> (aref a 1 0)</td></tr></table>
<!--l. 232--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (aref b 2) <span class="math"> ≡</span> (aref a 1 1)</td></tr></table>
<!--l. 233--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (aref b 3) <span class="math"> ≡</span> (aref a 1 2)</td></tr></table>
<!--l. 234--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (aref b 4) <span class="math"> ≡</span> (aref a 2 0)</td></tr></table>
<!--l. 235--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (aref b 5) <span class="math"> ≡</span> (aref a 2 1)</td></tr></table>
<!--l. 236--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (aref b 6) <span class="math"> ≡</span> (aref a 2 2)</td></tr></table>
<!--l. 237--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (aref b 7) <span class="math"> ≡</span> (aref a 3 0)</td></tr></table>
<!--l. 239--><p class="indent" >
</div>
</div>
<!--l. 240--><p class="noindent" >The last example depends on the fact that arrays are, in eﬀect, stored in row-major
order for purposes of sharing. Put another way, the indices for the elements of an
array are ordered lexicographically.
<div class=incompatibility>
<!--l. 246--><p class="noindent" ><b>Compatibility note:</b> Both Lisp Machine Lisp, as described in reference <span class="cite">[<a 
href="clmli5.html#XBLUE-LISPM">55</a>]</span>, and
Fortran <span class="cite">[<a 
href="clmli5.html#XDRAFT-FORTRAN-77">15</a>, <a 
href="clmli5.html#XANSI-FORTRAN-77">3</a>]</span> store arrays in column-major order.
</div>
</div>
<div class=defun>
<!--l. 254--><p class="noindent" ><i>[Constant]</i><a 
 id="dx111-215006"></a><a 
 id="x111-215007r521"></a><b> array-rank-limit</b>
<!--l. 256--><p class="noindent" >The value of <a 
href="#x111-215007r521">array-rank-limit</a> is a positive integer that is the upper exclusive
bound on the rank of an array. This bound depends on the implementation but
will not be smaller than 8; therefore every Common Lisp implementation
                                                                          

                                                                          
supports arrays whose rank is between 0 and 7 (inclusive). (Implementors are
encouraged to make this limit as large as practicable without sacriﬁcing
performance.)
</div>
<div class=defun>
<!--l. 266--><p class="noindent" ><i>[Constant]</i><a 
 id="dx111-215008"></a><a 
 id="x111-215009r522"></a><b> array-dimension-limit</b>
<!--l. 268--><p class="noindent" >The value of <a 
href="#x111-215009r522">array-dimension-limit</a> is a positive integer that is the upper exclusive
bound on each individual dimension of an array. This bound depends on the
implementation but will not be smaller than 1024. (Implementors are
encouraged to make this limit as large as practicable without sacriﬁcing
performance.)
<div class=new>
<!--l. 277--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx111-215010"></a>to specify that the value of array-dimension-limit
must be of type ﬁxnum. This in turn implies that all valid array indices will be
ﬁxnums.
</div>
</div>
<div class=defun>
<!--l. 286--><p class="noindent" ><i>[Constant]</i><a 
 id="dx111-215011"></a><a 
 id="x111-215012r523"></a><b> array-total-size-limit</b>
<!--l. 288--><p class="noindent" >The value of <a 
href="#x111-215012r523">array-total-size-limit</a> is a positive integer that is the upper exclusive
bound on the total number of elements in an array. This bound depends on the
implementation but will not be smaller than 1024. (Implementors are
encouraged to make this limit as large as practicable without sacriﬁcing
performance.)
<!--l. 296--><p class="indent" >   The actual limit on array size imposed by the implementation may
vary according to the :element-type of the array; in this case the value of
<a 
href="#x111-215012r523">array-total-size-limit</a> will be the smallest of these individual limits.
</div>
<div class=defun>
<!--l. 302--><p class="noindent" ><i>[Function]</i><a 
 id="dx111-215013"></a><a 
 id="x111-215014r524"></a><b> vector</b>  &#x0026;rest  <i>objects</i>
<!--l. 304--><p class="noindent" >The function <a 
href="#x111-215014r524">vector</a> is a convenient means for creating a simple general
vector with speciﬁed initial contents. It is analogous to the function <a 
href="clmse82.html#x102-203038r456">list</a>.
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(vector <span class="math">a<sub>1</sub></span> <span class="math">a<sub>2</sub></span> ... <span class="math">a<sub>n</sub></span>)
</td></tr></table>
<!--l. 309--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ≡</span> (make-array (list <span class="math">n</span>) :element-type t</td></tr></table>
                                                                          

                                                                          
<!--l. 310--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             :initial-contents (list <span class="math">a<sub>1</sub></span> <span class="math">a<sub>2</sub></span> ... <span class="math">a<sub>n</sub></span>))</td></tr></table>
<!--l. 312--><p class="indent" >
</div>
</div>
</div>
                                                                          

                                                                          
   <!--l. 315--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse90.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#tailclmch17.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse89.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#clmse89.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 315--><p class="indent" >   <a 
 id="tailclmse89.html"></a>  
</body></html> 
