<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Приведение типов и доступ к компонентам чисел</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-16 00:55:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 4584--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse69.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse67.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse67.html#tailclmse67.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse68.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch12.html#clmse68.html" >Наверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">12.6   </span> <a 
href="clm.html#QQ2-85-1047" id="x85-103900012.6">Приведение типов
и доступ к компонентам чисел</a></h3>
<!--l. 4586--><p class="noindent" >Тогда как большинство арифметических функций будут оперировать любым
типом чисел, выполняя при необходимости приведения, следующие функции
позволяют явно преобразовывать типы данных.
<div class="defun">
<!--l. 4590--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx85-1039001"></a><a 
 id="x85-1039002r231"></a><b> ﬂoat</b>  <i>number</i> &#x0026;optional  <i>other</i>
</div>
<!--l. 4592--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-104000012.6" id="x85-104000012.6"></a></span>
   Преобразует любое некомплексное число в число с плавающей точкой.
При отсутствии необязательного параметра, если <i>number</i> уже является
числом с плавающей точкой, то оно и будет возвращено, иначе число будет
преобразовано в <tt>single-float</tt>. Если аргумент <i>other</i> указан, тогда он должен
быть числом с плавающей точкой, и <i>number</i> будет конвертирован в такой же
формат как у <i>other</i>.
<!--l. 4601--><p class="indent" >   Смотрите также <tt><a 
href="clmse25.html#x34-201002r7">coerce</a></tt>.
</div>
<div class="defun">
<!--l. 4604--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx85-1040001"></a><a 
 id="x85-1040002r232"></a><b> rational</b>  <i>number</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1040003"></a><a 
 id="x85-1040004r233"></a><b> rationalize</b>  <i>number</i>
</div>
<!--l. 4607--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-104100012.6" id="x85-104100012.6"></a></span>
   Каждая из этих функций преобразует любое некомплексное число в
рациональное. Если аргумент уже является рациональным, он возвращается
как есть. Две функции различаются в том, как они обрабатывают числа с
плавающей точкой.
<tt>
<!--l. 4612--><p class="indent" >   <a 
href="#x85-1040002r232">rational</a></tt> предполагает, что число с плавающей точкой совершенно точно,
и возвращает рациональное число математически эквивалентное значению
числа с плавающей точкой.
<tt>
                                                                          

                                                                          
<!--l. 4616--><p class="indent" >   <a 
href="#x85-1040004r233">rationalize</a></tt> предполагает, что число с плавающей точкой приближенное,
и может возвращать любое рациональное число, для которого исходное число
является наилучшим приближением. Функция пытается сохранить числитель
и знаменатель наименьшими насколько это возможно.
<!--l. 4621--><p class="indent" >   Следующие тождества всегда справедливы <div class="lisp"><div class="tabbing">
(ﬂoat (rational <i>x</i>) <i>x</i>) <span class="math"> ≡</span> <i>x</i>
   <br>
<!--l. 4624--><p class="noindent" ></div>
<!--l. 4624--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-104200012.6" id="x85-104200012.6"></a></span>
<!--l. 4624--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-104300012.6" id="x85-104300012.6"></a></span>
</div>
<!--l. 4625--><p class="indent" >   и <div class="lisp"><div class="tabbing">
(ﬂoat (rationalize <i>x</i>) <i>x</i>) <span class="math"> ≡</span> <i>x</i>
   <br>
<!--l. 4628--><p class="noindent" ></div>
<!--l. 4628--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-104400012.6" id="x85-104400012.6"></a></span>
<!--l. 4628--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-104500012.6" id="x85-104500012.6"></a></span>
</div>
<!--l. 4629--><p class="indent" >   То есть, преобразование числа с плавающей точкой любым из методов
туда и обратно даёт исходное число. Различие в том, что <tt><a 
href="#x85-1040002r232">rational</a></tt> обычно
имеет более простую недорогую реализацию, тогда как <tt><a 
href="#x85-1040004r233">rationalize</a></tt>
представляет более «красивое» число.
</div>
<div class="defun">
                                                                          

                                                                          
<!--l. 4635--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx85-1045001"></a><a 
 id="x85-1045002r234"></a><b> numerator</b>  <i>rational</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1045003"></a><a 
 id="x85-1045004r235"></a><b> denominator</b>  <i>rational</i>
</div>
<!--l. 4638--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-104600012.6" id="x85-104600012.6"></a></span>
   Эти функции принимают рациональное число (целое или дробное) и
возвращают в качестве целого числа числитель или знаменатель дроби,
приведённое к каноническому виду. Числитель целого числа и является
этим числом. Знаменатель целого числа <tt>1</tt>. Следует отметить, что
<div class="lisp"><div class="tabbing">
(gcd (numerator <i>x</i>) (denominator <i>x</i>)) <span class="math"> ⇒</span> 1
   <br>
<!--l. 4645--><p class="noindent" ></div>
<!--l. 4645--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-104700012.6" id="x85-104700012.6"></a></span>
<!--l. 4645--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-104800012.6" id="x85-104800012.6"></a></span>
</div>
<!--l. 4646--><p class="indent" >   Знаменатель будет всегда строго положительным числом. Числитель
может быть любым целым числом. Например: <div class="lisp"><div class="tabbing">
(numerator (/ 8 -6)) <span class="math"> ⇒</span> -4
   <br>                                                         (denominator (/ 8 -6)) <span class="math"> ⇒</span> 3<br>
<!--l. 4652--><p class="noindent" ></div>
<!--l. 4652--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-104900012.6" id="x85-104900012.6"></a></span>
                                                                          

                                                                          
<!--l. 4652--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-105000012.6" id="x85-105000012.6"></a></span>
</div>
</div>
<!--l. 4655--><p class="indent" >   В Common Lisp&#x2019;е нет функции <tt>fix</tt>, потому что есть несколько интересных
способов преобразовать нецелое число к целому. Эти способы представлены
функциями ниже, которые выполняются не только преобразование типа, но
также некоторые нетривиальные вычисления.
<div class="defun">
<!--l. 4660--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx85-1050001"></a><a 
 id="x85-1050002r236"></a><b> ﬂoor</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1050003"></a><a 
 id="x85-1050004r237"></a><b> ceiling</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1050005"></a><a 
 id="x85-1050006r238"></a><b> truncate</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1050007"></a><a 
 id="x85-1050008r239"></a><b> round</b>  <i>number</i> &#x0026;optional  <i>divisor</i>
</div>
<!--l. 4665--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-105100012.6" id="x85-105100012.6"></a></span>
   При вызове с одним аргументом, каждая из этих функций преобразует
аргумент <i>number</i> (который не может быть комплексным числом) в целое
число. Если аргумент уже является целым числом, то он немедленно
возвращается в качестве результата. Если аргумент дробь или число с
плавающей точкой, для конвертации функции используют различные
алгоритмы.
<tt>
<!--l. 4673--><p class="indent" >   <a 
href="#x85-1050002r236">floor</a></tt> преобразовывает аргумент путём отсечения к отрицательной
бесконечности, то есть, результатом является наибольшее целое число,
которое не больше чем аргумент.
<tt>
<!--l. 4677--><p class="indent" >   <a 
href="#x85-1050004r237">ceiling</a></tt> преобразовывает аргумент путём отсечения к положительной
бесконечности, то есть, результатом является наименьшее целое число,
которое не меньше чем аргумент.
<tt>
<!--l. 4681--><p class="indent" >   <a 
href="#x85-1050004r237">ceiling</a></tt> преобразовывает аргумент путём отсечения к нулю, то есть,
результатом является целое число с таким же знаком, которое имеет
наибольшую целую величину, но не большую чем аргумент.
<!--l. 4685--><p class="indent" >   Следующая таблица содержит то, что возвращают четыре функции для
разных аргументов.
<div class="flushleft" 
>
                                                                          

                                                                          
<!--l. 4688--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%" class="tabular"><tr><td align="left" >Аргумент</td><td align="left" >ﬂoor</td><td align="left" >ceiling</td><td align="left" >truncate</td><td align="left" >round</td>
</tr><tr><td align="left" >     2.6    </td><td align="left" >  2 </td><td align="left" >    3   </td><td align="left" >     2    </td><td align="left" >   3  </td></tr><tr><td align="left" >  2.5 </td> <td align="left" >  2 </td> <td align="left" >  3 </td> <td align="left" >  2 </td> <td align="left" >  2</td>
</tr><tr><td align="left" >     2.4    </td><td align="left" >  2 </td><td align="left" >    3   </td><td align="left" >     2    </td><td align="left" >   2  </td></tr><tr><td align="left" >  0.7 </td> <td align="left" >  0 </td> <td align="left" >  1 </td> <td align="left" >  0 </td> <td align="left" >  1</td>
</tr><tr><td align="left" >     0.3    </td><td align="left" >  0 </td><td align="left" >    1   </td><td align="left" >     0    </td><td align="left" >   0  </td></tr><tr><td align="left" > -0.3 </td> <td align="left" > -1 </td> <td align="left" >  0 </td> <td align="left" >  0 </td> <td align="left" >  0</td>
</tr><tr><td align="left" >    -0.7    </td><td align="left" >  -1  </td><td align="left" >    0   </td><td align="left" >     0    </td><td align="left" >   -1   </td></tr><tr><td align="left" > -2.4 </td> <td align="left" > -3 </td> <td align="left" > -2 </td> <td align="left" > -2 </td> <td align="left" > -2</td>
</tr><tr><td align="left" >    -2.5    </td><td align="left" >  -3  </td><td align="left" >   -2   </td><td align="left" >    -2    </td><td align="left" >   -2   </td></tr><tr><td align="left" > -2.6 </td> <td align="left" > -3 </td> <td align="left" > -2 </td> <td align="left" > -2 </td> <td align="left" > -3</td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr><td align="left" > </td></tr></table>
</div></div>
<!--l. 4707--><p class="indent" >   Если указан второй аргумент <i>divisor</i>, тогда аргумент <i>number</i> будет
разделен на <i>divisor</i>, а затем уже будут проведены вышеописанные действия.
Например, <tt>(floor 5 2)</tt> <span class="math"> ≡</span> <tt>(values (floor (/ 5 2)))</tt>, но первый
вариант потенциально эффективнее. <i>divisor</i> может любым числом, кроме
комплексного. <i>divisor</i> не может равняться нулю. Случай вызова функции с
одним аргументом эквивалентен вызову с двумя аргументами, последний из
которых равен <tt>1</tt>.
<!--l. 4716--><p class="indent" >   Каждая из функций возвращает <i>два</i> значения. Второе значение является
остатком и может быть получено с помощью <tt><a 
href="clmse43.html#x55-727002r117">multiple-value-bind</a></tt> или
другими подобными конструкциями. Если любая из этих функций получает
два аргумента <i>x</i> и <i>y</i> и возвращает <i>q</i> и <i>r</i>, тогда <span class="math"><i>q</i> ⋅<i>y</i> + <i>r</i> = <i>x</i></span>. Первое
значение результата <i>q</i> всегда целочисленное. Остаток <i>r</i> целочисленный,
если оба аргумента были целочисленными, и рациональное, если оба
аргумента были рациональными, и с плавающей точкой, если один из
аргументов был с плавающей точкой. Если при вызове был указан
один аргумент, то тип данных остатка всегда такой же как и этот
аргумент.
<!--l. 4729--><p class="indent" >   Когда указывается только один аргумент, сумма двух значений
результата точно равняется переданному в параметре значению.
</div>
<div class="defun">
<!--l. 4733--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx85-1051001"></a><a 
 id="x85-1051002r240"></a><b> mod</b>  <i>number</i> <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1051003"></a><a 
 id="x85-1051004r241"></a><b> rem</b>  <i>number</i> <i>divisor</i>
</div>
<!--l. 4736--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-105200012.6" id="x85-105200012.6"></a></span>
<tt>
   <a 
href="#x85-1051002r240">mod</a></tt> выполняет операцию <tt><a 
href="#x85-1050002r236">floor</a></tt> для двух аргументов и возвращает <i>второй</i>
результат <tt><a 
href="#x85-1050002r236">floor</a></tt>. Таким же образом, <tt><a 
href="#x85-1051004r241">rem</a></tt> выполняет операцию <tt><a 
href="#x85-1050006r238">truncate</a></tt> для
двух аргументов и возвращает <i>второй</i> результат <tt><a 
href="#x85-1050006r238">truncate</a></tt>.
                                                                          

                                                                          
<!--l. 4742--><p class="indent" >   Таким образом <tt><a 
href="#x85-1051002r240">mod</a></tt> и <tt><a 
href="#x85-1051004r241">rem</a></tt> являются обычными функциями вычисления
остатка от деления двух чисел. Аргументы могут быть также числами с
плавающей точкой. <div class="lisp"><div class="tabbing">
(mod 13 4) <span class="math"> ⇒</span> 1                           (rem 13 4) <span class="math"> ⇒</span> 1
   <br>                     (mod -13 4) <span class="math"> ⇒</span> 3                          (rem -13 4) <span class="math"> ⇒</span> -1<br>
(mod 13 -4) <span class="math"> ⇒</span> -3                         (rem 13 -4) <span class="math"> ⇒</span> 1<br>
(mod -13 -4) <span class="math"> ⇒</span> -1                        (rem -13 -4) <span class="math"> ⇒</span> -1<br>
(mod 13.4 1) <span class="math"> ⇒</span> 0.4                       (rem 13.4 1) <span class="math"> ⇒</span> 0.4<br>
(mod -13.4 1) <span class="math"> ⇒</span> 0.6                      (rem -13.4 1) <span class="math"> ⇒</span> -0.4<br>
<!--l. 4753--><p class="noindent" ></div>
<!--l. 4753--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-105300012.6" id="x85-105300012.6"></a></span>
<!--l. 4753--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-105400012.6" id="x85-105400012.6"></a></span>
</div>
</div>
<div class="defun">
<!--l. 4756--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx85-1054001"></a><a 
 id="x85-1054002r242"></a><b> ﬄoor</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1054003"></a><a 
 id="x85-1054004r243"></a><b> fceiling</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1054005"></a><a 
 id="x85-1054006r244"></a><b> ftruncate</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1054007"></a><a 
 id="x85-1054008r245"></a><b> fround</b>  <i>number</i> &#x0026;optional  <i>divisor</i>
</div>
<!--l. 4761--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-105500012.6" id="x85-105500012.6"></a></span>
   Эти функции похожи на <tt><a 
href="#x85-1050002r236">floor</a></tt>, <tt><a 
href="#x85-1050004r237">ceiling</a></tt>, <tt><a 
href="#x85-1050006r238">truncate</a></tt> и <tt><a 
href="#x85-1050008r239">round</a></tt> за исключением
того, что результат (первый из двух) всегда целое число, а не число
с плавающей точкой. Это примерно, как если бы <tt><a 
href="#x85-1054002r242">ffloor</a></tt> передала
аргументы в <tt><a 
href="#x85-1050002r236">floor</a></tt>, а затем применила к первому результату <tt><a 
href="#x85-1039002r231">float</a></tt> и
вернула полученную пару значений. Однако, на практике <tt><a 
href="#x85-1054002r242">ffloor</a></tt> может
быть реализована более эффективно. Такое же описание подходит к
остальным трём функциям. Если первый аргумент является числом с
плавающей точкой, и второй аргумент не точнее типа первого, тогда первый
результат будет такого же типа как первый аргумент. Например:
<div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(ﬄoor -4.7) <span class="math"> ⇒</span> -5.0 and 0.3
   <br>                                                   (ﬄoor 3.5d0) <span class="math"> ⇒</span> 3.0d0 and 0.5d0<br>
<!--l. 4775--><p class="noindent" ></div>
<!--l. 4775--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-105600012.6" id="x85-105600012.6"></a></span>
<!--l. 4775--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-105700012.6" id="x85-105700012.6"></a></span>
</div>
</div>
<div class="defun">
<!--l. 4778--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx85-1057001"></a><a 
 id="x85-1057002r246"></a><b> decode-ﬂoat</b>  <i>ﬂoat</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1057003"></a><a 
 id="x85-1057004r247"></a><b> scale-ﬂoat</b>  <i>ﬂoat</i> <i>integer</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1057005"></a><a 
 id="x85-1057006r248"></a><b> ﬂoat-radix</b>  <i>ﬂoat</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1057007"></a><a 
 id="x85-1057008r249"></a><b> ﬂoat-sign</b>  <i>ﬂoat1</i> &#x0026;optional  <i>ﬂoat2</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1057009"></a><a 
 id="x85-1057010r250"></a><b> ﬂoat-digits</b>  <i>ﬂoat</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1057011"></a><a 
 id="x85-1057012r251"></a><b> ﬂoat-precision</b>  <i>ﬂoat</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1057013"></a><a 
 id="x85-1057014r252"></a><b> integer-decode-ﬂoat</b>  <i>ﬂoat</i>
</div>
<!--l. 4786--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-105800012.6" id="x85-105800012.6"></a></span>
   Функция <tt><a 
href="#x85-1057002r246">decode-float</a></tt> принимает числа с плавающей точкой и
возвращает три значения.
<!--l. 4790--><p class="indent" >   Первое значение является мантиссой и числом того же типа, что
и аргумент. Второе значение является целочисленной экспонентой.
Третье значение отображает знак аргумента (-1.0 или 1.0) и является и
числом того же типа, что и аргумент . Пусть <i>b</i> есть система счисления
для отображения чисел с плавающей точкой, тогда <tt><a 
href="#x85-1057002r246">decode-float</a></tt>
делит аргумент на <i>b</i> в некоторой степени, чтобы привести значение
в промежуток включая 1/<i>b</i> и не включая 1 и возвращает частное
в качестве первого значения FIXME. Однако, если аргумент равен
нулю результат равен абсолютному значению аргумента (то есть, если
существует отрицательный ноль, то для него возвращается положительный
ноль).
                                                                          

                                                                          
<!--l. 4801--><p class="indent" >   Второе значение <tt><a 
href="#x85-1057002r246">decode-float</a></tt> является целочисленным экспонентой <i>e</i>,
которая равняется степени, в которую было возведено <i>b</i>. Если аргумент
равен нулю, то может быть возвращено любое целое число, при условии, что
тожество, описанное ниже для <tt>scale-format</tt>, имеет место быть.
<!--l. 4806--><p class="indent" >   Третье значение <tt><a 
href="#x85-1057002r246">decode-float</a></tt> является числом с плавающей точкой в
том же формате, что и аргумент, абсолютное значение которого равно 1, и
знак совпадает со знаком аргумента.
<!--l. 4810--><p class="indent" >   Функция <tt><a 
href="#x85-1057004r247">scale-float</a></tt> принимает число с плавающей точкой <i>f </i> (не
обязательно между 1/<i>b</i> и 1) и целое число <i>k</i>, и возвращает <tt>(* <i>f</i> (expt
(float <i>b</i> <i>f</i>) <i>k</i>))</tt>. (Использование <tt><a 
href="#x85-1057004r247">scale-float</a></tt> может быть более
эффективным, чем использование возведения в степень или умножения и
позволяет избежать переполнений).
<!--l. 4816--><p class="indent" >   Следует отметить, что <div class="lisp"><div class="tabbing">
(multiple-value-bind (signif expon sign)
   <br>                       (decode-ﬂoat <i>f </i>)<br>    (scale-ﬂoat signif expon))<br>
<span class="math"> ≡</span> (abs <i>f </i>)<br>
<!--l. 4822--><p class="noindent" ></div>
<!--l. 4822--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-105900012.6" id="x85-105900012.6"></a></span>
<!--l. 4822--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-106000012.6" id="x85-106000012.6"></a></span>
</div>
<!--l. 4823--><p class="indent" >   и <div class="lisp"><div class="tabbing">
(multiple-value-bind (signif expon sign)
   <br>                                                              (decode-ﬂoat <i>f </i>)<br>
  (* (scale-ﬂoat signif expon) sign))<br>                                  <span class="math"> ≡</span> <i>f </i><br>
<!--l. 4829--><p class="noindent" ></div>
<!--l. 4829--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-106100012.6" id="x85-106100012.6"></a></span>
                                                                          

                                                                          
<!--l. 4829--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-106200012.6" id="x85-106200012.6"></a></span>
</div>
<!--l. 4831--><p class="indent" >   Функция <tt><a 
href="#x85-1057006r248">float-radix</a></tt> возвращает (в качестве целого числа) основание <i>b</i>
для числа с плавающей точкой.
<!--l. 4834--><p class="indent" >   Функция <tt><a 
href="#x85-1057008r249">float-sign</a></tt> возвращает такое число с плавающей точкой <i>z</i>,
что <i>z</i> и <i>ﬂoat1</i> имеют одинаковый знак, и <i>z</i> и <i>ﬂoat2</i> имеют равное
абсолютное значение. Аргумент <i>ﬂoat2</i> по-умолчанию имеет значение <tt>(float
1 <i>float1</i>)</tt>. Таким образом <tt>(float-sign x)</tt> всегда возвращает <tt>1.0</tt>
или <tt>-1.0</tt> в таком же формате и с тем же знаком, что и <i>x</i>. (Следует
отметить, что если реализация содержит различные представления для
отрицательного и положительного нулей, тогда <tt>(float-sign -0.0)</tt>
<span class="math"> ⇒</span> <tt>-1.0</tt>.)
<!--l. 4843--><p class="indent" >   Функция <tt><a 
href="#x85-1057010r250">float-digits</a></tt> возвращает целочисленное количество цифр
используемых в представлении аргумента. Функция <tt><a 
href="#x85-1057012r251">float-precision</a></tt>
возвращает целочисленное количество цифр в мантиссе аргумента.
Если аргумент равен нулю, то результатом также будет ноль. Для
нормализованных чисел с плавающей точкой, результаты <tt><a 
href="#x85-1057010r250">float-digits</a></tt> и
<tt><a 
href="#x85-1057012r251">float-precision</a></tt> будут такими же. Но в случае с денормализованными
числами или нулём точность будет меньше чем количество цифр в
представлении.
<!--l. 4851--><p class="indent" >   Функция <tt><a 
href="#x85-1057014r252">integer-decode-float</a></tt> похожа на <tt><a 
href="#x85-1057002r246">decode-float</a></tt>, но в качестве
первого значение возвращает масштабированную целочисленную мантиссу.
Для аргумента <i>f </i>, это число будет строго меньше чем <div class="lisp"><div class="tabbing">
<tt>(expt <i>b</i> (float-precision <i>f</i>))</tt>
   <br>
<!--l. 4856--><p class="noindent" ></div>
<!--l. 4856--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-106300012.6" id="x85-106300012.6"></a></span>
<!--l. 4856--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-106400012.6" id="x85-106400012.6"></a></span>
</div>
<!--l. 4857--><p class="indent" >   на не менее чем <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
<tt>(expt <i>b</i> (- (float-precision <i>f</i>) 1))</tt>
   <br>
<!--l. 4860--><p class="noindent" ></div>
<!--l. 4860--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-106500012.6" id="x85-106500012.6"></a></span>
<!--l. 4860--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-106600012.6" id="x85-106600012.6"></a></span>
</div>
<!--l. 4861--><p class="indent" >   за исключением того, что если <i>f </i> равно нулю, тогда целочисленное
значение также будет равно нулю.
<!--l. 4864--><p class="indent" >   Второе значение имеет такую же связь с первым значением, как и для
<tt><a 
href="#x85-1057002r246">decode-float</a></tt>: <div class="lisp"><div class="tabbing">
(multiple-value-bind (signif expon sign)
   <br>                                                    (integer-decode-ﬂoat <i>f </i>)<br>
  (scale-ﬂoat (ﬂoat signif <i>f </i>) expon))<br>                            <span class="math"> ≡</span> (abs <i>f </i>)<br>
<!--l. 4871--><p class="noindent" ></div>
<!--l. 4871--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-106700012.6" id="x85-106700012.6"></a></span>
<!--l. 4871--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-106800012.6" id="x85-106800012.6"></a></span>
</div>
<!--l. 4873--><p class="indent" >   Третье значение <tt><a 
href="#x85-1057014r252">integer-decode-float</a></tt> будет <tt>1</tt> или <tt>-1</tt>.
<div class="rationale">
<!--l. 4876--><p class="noindent" ><b>Обоснование:</b> Эти функции позволяют писать машиннонезависиммые или как
минимум машиннопараметризированные приложения с вычислениями чисел с
плавающими точками с необходимой эффективностью.
</div>
</div>
<div class="defun">
<!--l. 4884--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx85-1068001"></a><a 
 id="x85-1068002r253"></a><b> complex</b>  <i>realpart</i> &#x0026;optional  <i>imagpart</i>
</div>
                                                                          

                                                                          
<!--l. 4886--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-106900012.6" id="x85-106900012.6"></a></span>
   Аргументы должны быть некомплексными числами. Результатом
является число, которое имеет действительную часть <i>realpart</i> и мнимую
<i>imagpart</i>, возможно конвертированные к одному типу. Если <i>imagpart</i> не
указаны, тогда используется <tt>(coerce 0 (type-of <i>realpart</i>))</tt>. Необходимо
отметить, что если обе части комплексного число рациональны, и мнимая
часть равна нуля, то результатом будет только действительная часть <i>realpart</i>
так как в силу вступят правила канонизации. Таким образом результат
<tt><a 
href="#x85-1068002r253">complex</a></tt> не всегда является комплексным числом. Он может быть просто
рациональным числом (<tt><a 
href="#x85-1040002r232">rational</a></tt>).
</div>
<div class="defun">
<!--l. 4899--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx85-1069001"></a><a 
 id="x85-1069002r254"></a><b> realpart</b>  <i>number</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx85-1069003"></a><a 
 id="x85-1069004r255"></a><b> imagpart</b>  <i>number</i>
</div>
<!--l. 4902--><p class="noindent" ><span class="paragraphHead"><a 
href="#x85-107000012.6" id="x85-107000012.6"></a></span>
   Эти функции возвращают действительную и мнимую части комплексного
числа. Если <i>number</i> не является комплексным числом, тогда <tt><a 
href="#x85-1069002r254">realpart</a></tt>
возвращает это число, а <tt><a 
href="#x85-1069004r255">imagpart</a></tt> возвращает <tt>(* 0 <i>number</i>)</tt>, другими
словами, <tt>0</tt> того типа, каким был аргумент.
</div>
                                                                          

                                                                          
<!--l. 4909--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse69.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse67.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse67.html#tailclmse67.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse68.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch12.html#clmse68.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse68.html"></a>  </div> </div> 
</body></html> 
