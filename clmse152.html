<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Introduction</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-20 19:35:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 42--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse153.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmap1.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmap1.html#tailclmap1.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse152.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmap1.html#clmse152.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">A.1   </span> <a 
href="clm.html#QQ2-187-513" id="x187-474000A.1">Introduction</a></h3>
<!--l. 44--><p class="noindent" >Series combine aspects of sequences, streams, and loops. Like sequences, series
represent totally ordered multi-sets. In addition, the series functions have the
same ﬂavor as the sequence functions—namely, they operate on whole series,
rather than extracting elements to be processed by other functions. For instance,
the series expression below computes the sum of the positive elements in a list.
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(collect-sum (choose-if #&#x2019;plusp (scan &#x2019;(1 -2 3 -4)))) <span class="math"> ⇒</span> 4
</td></tr></table>
<!--l. 52--><p class="indent" >
</div>
</div>
<!--l. 54--><p class="indent" >   Like streams, series can represent unbounded sets of elements and are
supported by lazy evaluation: each element of a series is not computed until it is
needed. For instance, the series expression below returns a list of the ﬁrst ﬁve even
natural numbers and their sum. The call on <a 
href="clmse153.html#x188-476002r1015">scan-range</a> returns a series of all
the even natural numbers. However, since no elements beyond the ﬁrst
ﬁve are ever used, no elements beyond the ﬁrst ﬁve are ever computed.
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(let ((x (subseries (scan-range :from 0 :by 2) 0 5)))
</td></tr></table>
<!--l. 62--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (values (collect x) (collect-sum x)))</td></tr></table>
<!--l. 63--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <span class="math"> ⇒</span> (0 2 4 6 8) and 20</td></tr></table>
<!--l. 65--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
<!--l. 67--><p class="indent" >   Like sequences and unlike streams, a series is not altered when its
elements are accessed. For instance, both users of x above receive the same
elements.
<!--l. 71--><p class="indent" >   A totally ordered multi-set of elements can be represented in a loop by the
successive values of a variable. This is extremely eﬃcient, because it avoids the
need to store the elements as a group in any kind of data structure. In most
situations, series expressions achieve this same high level of eﬃciency, because
they are automatically transformed into loops before being evaluated or compiled.
For instance, the ﬁrst expression above is transformed into a loop like the
following. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(let ((sum 0))
</td></tr></table>
<!--l. 79--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (dolist (i &#x2019;(1 -2 3 -4) sum)</td></tr></table>
<!--l. 80--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (when (plusp i) (setq sum (+ sum i))))) <span class="math"> ⇒</span> 4</td></tr></table>
<!--l. 82--><p class="indent" >
</div>
</div>
<!--l. 84--><p class="indent" >   A wide variety of algorithms can be expressed clearly and succinctly with
series expressions. In particular, at least 90 percent of the loops programmers
typically write can be replaced by series expressions that are much easier to
understand and modify, and just as eﬃcient. From this perspective, the key
feature of series is that they are supported by a rich set of functions. These
functions more or less correspond to the union of the operations provided by
the sequence functions, the <a 
href="clmse42.html#x54-118002r90">loop</a> clauses, and the vector operations of
APL.
<!--l. 93--><p class="indent" >   Some series expressions cannot be transformed into loops. This is unfortunate,
because while transformable series expressions are much more eﬃcient than
equivalent expressions involving sequences or streams, non-transformable series
expressions are much less eﬃcient. Whenever a problem comes up that blocks the
transformation of a series expression, a warning message is issued. On the basis of
information in the message, it is usually easy to provide an eﬃcient ﬁx for the
problem (see section <a 
href="clmse154.html#x189-484000A.3">A.3<!--tex4ht:ref: SERIES-E-SECTION --></a>).
<!--l. 102--><p class="indent" >   Fortunately, most series expressions can be transformed into loops. In
particular, pure expressions (ones that do not store series in variables) can always
be transformed. As a result, the best approach for programmers to take is
simply to write series expressions without worrying about transformability.
                                                                          

                                                                          
When problems come up, they can be ignored (since they cannot lead
to the computation of incorrect results) or dealt with on an individual
basis.
<div class=implementation>
<!--l. 111--><p class="noindent" ><b>Implementation note:</b> The series functions and the theory underlying them are
described in greater detail in <span class="cite">[<a 
href="clmli5.html#XWATERS-SERIES-DESIGN">52</a>, <a 
href="clmli5.html#XWATERS-SERIES-IMPLEMENTATION">53</a>]</span>. These reports also discuss the algorithms required
to transform series expressions into loops and explain how to obtain a portable
implementation.
</div>
                                                                          

                                                                          
   <!--l. 120--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse153.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmap1.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmap1.html#tailclmap1.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse152.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmap1.html#clmse152.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 120--><p class="indent" >   <a 
 id="tailclmse152.html"></a>  
</body></html> 
