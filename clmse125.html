<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Specialized Error-Signaling Forms and Macros</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-02-20 00:42:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 402--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse126.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse124.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse124.html#tailclmse124.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse125.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch24.html#clmse125.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">24.2   </span> <a 
 id="x154-22100024.2"></a>Specialized Error-Signaling Forms and Macros</h3>
<!--l. 405--><p class="noindent" >These facilities are designed to make it convenient for the user to insert error
checks into code.
<div class=defmac>
<!--l. 409--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> check-type </b> <a 
 id="dx154-221001"></a><a 
 id="x154-221002r790"></a>   place typespec  [ <i>string</i>]
</td></tr></table>
<!--l. 410--><p class="indent" >
</div>
   <div class=obsolete><i>check-type</i> signals an error if the contents of place are not of the desired type.
Upon continuing from this error, the user will be asked for a new value; <i>check-type</i>
will store the new value in place and start over, checking the type of the new value
and signaling another error if it is still not of the desired type. Subforms of place
may be evaluated multiple times because of the implicit loop generated.
<i>check-type</i> returns <i>nil</i>.
   The place must be a generalized variable reference acceptable to <i>setf </i>.
The typespec must be a type speciﬁer; it is not evaluated. The string
should be an English description of the type, starting with an indeﬁnite
article (“a” or “an”); it is evaluated. If string is not supplied, it is computed
automatically from typespec. (The optional string argument is allowed because
some applications of <i>check-type</i> may require a more speciﬁc description
of what is wanted than can be generated automatically from the type
speciﬁer.)
   The error message will mention <i>place</i>, its contents, and the desired
type.
</div>
<div class=newer>
   The precise format and content of the error message is implementation-dependent.
The example shown below is representative of current practice.
                                                                          

                                                                          
</div>
<div class=implementation>
   <b>Implementation note:</b> An implementation may choose to generate a somewhat
diﬀerently worded error message if it recognizes that place is of a particular form, such as
one of the arguments to the function that called <i>check-type</i>.
</div>
<div class=new>
   X3J13 voted in June 1988 ⟨<b>?</b>⟩ to adopt a proposal for a Common Lisp
Condition System. This proposal modiﬁes the deﬁnition of <i>check-type</i> to specify
its interaction with the condition system. See section <a 
href="clmse155.html#x189-33600029.4.2">29.4.2<!--tex4ht:ref: CONDITION-ASSERTIONS --></a>.
</div>
<div class=newer>
   X3J13 voted in March 1988 ⟨<b>?</b>⟩ to clarify order of evaluation (see
section <a 
href="clmse36.html#x48-800007.2">7.2<!--tex4ht:ref: SETF-SECTION --></a>).
</div>
   Examples: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq aardvarks &#x2019;(sam harry fred))
</td></tr></table>
<!--l. 466--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(check-type aardvarks (vector integer))</td></tr></table>
<!--l. 467--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Error: The value of AARDVARKS, (SAM HARRY FRED),</td></tr></table>
<!--l. 468--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       is not a vector of integers.</td></tr></table>
<!--l. 469--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 470--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq naards &#x2019;foo)</td></tr></table>
<!--l. 471--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(check-type naards (integer 0 *) &#x0022;a positive integer&#x0022;)</td></tr></table>
<!--l. 472--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Error: The value of NAARDS, FOO, is not a positive integer.</td></tr></table>
<!--l. 474--><p class="indent" >
</div>
</div>
<div class=incompatibility>
<!--l. 477--><p class="noindent" ><b>Compatibility note:</b> In Lisp Machine Lisp the equivalent facility is called
<i>check-arg-type</i>.
</div>
</div>
<div class=defmac>
<!--l. 486--><p class="noindent" ><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> assert </b> <a 
 id="dx154-221003"></a><a 
 id="x154-221004r791"></a>   test-form  [ <i>({<i>place</i>}∗ ) [ <i>string {<i>arg</i>}∗ </i>] </i>]
</td></tr></table>
<!--l. 487--><p class="indent" >
</div>
   <div class=obsolete><i>assert</i> signals an error if the value of test-form is <i>nil</i>. Continuing from this
error will allow the user to alter the values of some variables, and <i>assert</i> will then
start over, evaluating test-form again. <i>assert</i> returns <i>nil</i>.
   test-form is any form. Each place (there may be any number of them, or none)
must be a generalized-variable reference acceptable to <i>setf </i>. These should
be variables on which test-form depends, whose values may sensibly be
changed by the user in attempting to correct the error. Subforms of each
place are only evaluated if an error is signaled, and may be re-evaluated
if the error is re-signaled (after continuing without actually ﬁxing the
problem).
   The string is an error message string, and the args are additional arguments;
they are evaluated only if an error is signaled, and re-evaluated if the error is
signaled again. The function <i>format</i> is applied in the usual way to string and args
to produce the actual error message. If string is omitted (and therefore also the
args), a default error message is used.
</div>
<div class=implementation>
   <b>Implementation note:</b> The debugger need not include the test-form in the error
message, and the places should not be included in the message, but they should be made
available for the user&#x2019;s perusal. If the user gives the “continue” command, he should be
presented with the opportunity to alter the values of any or all of the references.
The details of this depend on the implementation&#x2019;s style of user interface, of
course.
</div>
<div class=new>
   X3J13 voted in June 1988 ⟨<b>?</b>⟩ to adopt a proposal for a Common Lisp
Condition System. This proposal modiﬁes the deﬁnition of <i>assert</i> to specify its
interaction with the condition system. See section <a 
href="clmse155.html#x189-33600029.4.2">29.4.2<!--tex4ht:ref: CONDITION-ASSERTIONS --></a>.
</div>
<div class=newer>
   X3J13 voted in March 1988 ⟨<b>?</b>⟩ to clarify order of evaluation (see
section <a 
href="clmse36.html#x48-800007.2">7.2<!--tex4ht:ref: SETF-SECTION --></a>).
</div>
                                                                          

                                                                          
<div class=newer>
   X3J13 voted in June 1989 ⟨<b>?</b>⟩ to extend the speciﬁcation of <i>assert</i> to
allow a place whose <i>setf </i> method has more than one store variable (see
<i>deﬁne-setf-method</i>).
</div>
   Examples: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assert (valve-closed-p v1))
</td></tr></table>
<!--l. 547--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 548--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assert (valve-closed-p v1) ()</td></tr></table>
<!--l. 549--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x0022;Live steam is escaping!&#x0022;)</td></tr></table>
<!--l. 550--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 551--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assert (valve-closed-p v1)</td></tr></table>
<!--l. 552--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((valve-manual-control v1))</td></tr></table>
<!--l. 553--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x0022;Live steam is escaping!&#x0022;)</td></tr></table>
<!--l. 554--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 555--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; Note here that the user is invited to change BASE,</td></tr></table>
<!--l. 556--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; but not the bounds MINBASE and MAXBASE.</td></tr></table>
<!--l. 557--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">
</td></tr></table>
<!--l. 558--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assert (&#x003C;= minbase base maxbase)</td></tr></table>
<!--l. 559--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (base)</td></tr></table>
<!--l. 560--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x0022;Base <tt>~</tt>D is not in the range <tt>~</tt>D, <tt>~</tt>D&#x0022;</td></tr></table>
<!--l. 561--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        base minbase maxbase)</td></tr></table>
<!--l. 562--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 563--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; Note here that it is probably not desirable to include the</td></tr></table>
<!--l. 564--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; entire contents of the two matrices in the error message.</td></tr></table>
<!--l. 565--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; It is reasonable to assume that the debugger will give</td></tr></table>
<!--l. 566--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; the user access to the values of the places A and B.</td></tr></table>
<!--l. 567--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 568--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assert (= (array-dimension a 1)</td></tr></table>
<!--l. 569--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (array-dimension b 0))</td></tr></table>
<!--l. 570--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (a b)</td></tr></table>
<!--l. 571--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x0022;Cannot multiply a <tt>~</tt>D-by-<tt>~</tt>D matrix <tt>~</tt></td></tr></table>
<!--l. 572--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         and a <tt>~</tt>D-by-<tt>~</tt>D matrix.&#x0022;</td></tr></table>
<!--l. 573--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (array-dimension a 0)</td></tr></table>
                                                                          

                                                                          
<!--l. 574--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (array-dimension a 1)</td></tr></table>
<!--l. 575--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (array-dimension b 0)</td></tr></table>
<!--l. 576--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (array-dimension b 1))</td></tr></table>
<!--l. 578--><p class="indent" >
</div>
</div>
</div>
                                                                          

                                                                          
   <!--l. 581--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse126.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse124.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse124.html#tailclmse124.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse125.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch24.html#clmse125.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 581--><p class="indent" >   <a 
 id="tailclmse125.html"></a>  
</body></html> 
