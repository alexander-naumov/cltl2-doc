<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>16 Hash Tables</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-02-22 01:55:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 6--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse92.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse91.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse91.html#tailclmse91.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmch16.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clm.html#clmch16.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter 16</span><br /><a 
 id="x112-15400016"></a>Hash Tables</h2>
<!--l. 9--><p class="noindent" >A hash table is a Lisp object that can eﬃciently map a given Lisp object to
another Lisp object. Each hash table has a set of entries, each of which associates
a particular key with a particular value. The basic functions that deal with hash
tables can create entries, delete entries, and ﬁnd the value that is associated with
a given key. Finding the value is very fast, even if there are many entries, because
hashing is used; this is an important advantage of hash tables over property
lists.
<!--l. 18--><p class="indent" >   A given hash table can associate only one value with a given key; if you try to
add a second value, it will replace the ﬁrst. Also, adding a value to a hash table is
a destructive operation; the hash table is modiﬁed. By contrast, association lists
can be augmented non-destructively.
<!--l. 24--><p class="indent" >   Hash tables come in three kinds, the diﬀerence being whether the keys are
compared with <a 
href="clmse33.html#x44-74002r46">eq</a>, <a 
href="clmse33.html#x44-74004r47">eql</a>, or <a 
href="clmse33.html#x44-74006r48">equal</a>. In other words, there are hash tables that hash
on Lisp objects (using <a 
href="clmse33.html#x44-74002r46">eq</a> or <a 
href="clmse33.html#x44-74004r47">eql</a>) and there are hash tables that hash on tree
structure (using <a 
href="clmse33.html#x44-74006r48">equal</a>).
<!--l. 30--><p class="indent" >   Hash tables are created with the function <a 
href="clmse92.html#x113-155002r543">make-hash-table</a>, which
takes various options, including which kind of hash table to make (the
default being the <a 
href="clmse33.html#x44-74004r47">eql</a> kind). To look up a key and ﬁnd the associated
value, use <a 
href="clmse92.html#x113-155006r545">gethash</a>. New entries are added to hash tables using <a 
href="clmse36.html#x48-80002r66">setf</a> with
<a 
href="clmse92.html#x113-155006r545">gethash</a>. To remove an entry, use <a 
href="clmse92.html#x113-155008r546">remhash</a>. Here is a simple example. <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq a (make-hash-table))
</td></tr></table>
<!--l. 39--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setf (gethash &#x2019;color a) &#x2019;brown)</td></tr></table>
<!--l. 40--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setf (gethash &#x2019;name a) &#x2019;fred)</td></tr></table>
<!--l. 41--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(gethash &#x2019;color a)  ⇒ brown</td></tr></table>
<!--l. 42--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(gethash &#x2019;name a)  ⇒ fred</td></tr></table>
<!--l. 43--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(gethash &#x2019;pointy a)  ⇒ <a 
href="clmse31.html#x42-70002r19">nil</a></td></tr></table>
<!--l. 45--><p class="indent" >
</div>
</div>
<!--l. 47--><p class="indent" >   In this example, the symbols color and name are being used as keys, and the
symbols brown and fred are being used as the associated values. The hash table
                                                                          

                                                                          
has two items in it, one of which associates from color to brown, and the other of
which associates from name to fred.
<!--l. 53--><p class="indent" >   Keys do not have to be symbols; they can be any Lisp object. Similarly, values
can be any Lisp object.
<div class=obsolete>
<!--l. 57--><p class="indent" >   When a hash table is ﬁrst created, it has a size, which is the maximum number
of entries it can hold. Usually the actual capacity of the table is somewhat less,
since the hashing is not perfectly collision-free. With the maximum possible bad
luck, the capacity could be very much less, but this rarely happens. If so
many entries are added that the capacity is exceeded, the hash table will
automatically grow, and the entries will be rehashed (new hash values
will be recomputed, and everything will be rearranged so that the fast
hash lookup still works). This is transparent to the caller; it all happens
automatically.
</div>
<div class=newer>
<!--l. 70--><p class="indent" >   There is a discrepancy between the preceding description of the size of a hash
table and the description of the <i>:size</i> argument in the speciﬁcation below of
<a 
href="clmse92.html#x113-155002r543">make-hash-table</a>.
<!--l. 75--><p class="indent" >   X3J13 voted in June 1989 ⟨<b>?</b>⟩ to regard the latter description as deﬁnitive: the
<i>:size</i> argument is approximately the number of entries that can be inserted
without having to enlarge the hash table. This deﬁnition is certainly more
convenient for the user.
</div>
<div class=incompatibility>
<!--l. 83--><p class="noindent" ><b>Compatibility note:</b> This hash table facility is compatible with Lisp Machine Lisp. It
is similar to the hasharray facility of Interlisp, and some of the function names are the
same. However, it is not compatible with Interlisp. The exact details and the order of
arguments are designed to be consistent with the rest of MacLisp rather than with
Interlisp. For instance, the order of arguments to <a 
href="clmse92.html#x113-155010r547">maphash</a> is diﬀerent, there is no
“system hash table,” and there is not the Interlisp restriction that keys and values may
not be <a 
href="clmse31.html#x42-70002r19">nil</a>.
</div>
   <div class="sectionTOCS">
    <span class="sectionToc" >16.1 <a 
href="clmse92.html#x113-15500016.1">Hash Table Functions</a></span>
<br />    <span class="sectionToc" >16.2 <a 
href="clmse93.html#x114-15600016.2">Primitive Hash Function</a></span>
                                                                          

                                                                          
   </div>

                                                                          

                                                                          
   <!--l. 6--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse92.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse91.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse91.html#tailclmse91.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch16.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clm.html#clmch16.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 6--><p class="indent" >   <a 
 id="tailclmch16.html"></a>  
</body></html> 
