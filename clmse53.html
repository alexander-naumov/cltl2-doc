<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Type Declaration for Forms</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-02-20 00:42:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 1237--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch10.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse52.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse52.html#tailclmse52.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse53.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#clmse53.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">9.3   </span> <a 
 id="x67-1060009.3"></a>Type Declaration for Forms</h3>
<!--l. 1239--><p class="noindent" >Frequently it is useful to declare that the value produced by the evaluation of
some form will be of a particular type. Using <i>declare</i> one can declare the type of
the value held by a bound variable, but there is no easy way to declare the type of
the value of an unnamed form. For this purpose the <i>the</i> special form is deﬁned;
<i>(the type form)</i> means that the value of form is declared to be of type
type.
<div class=defspec>
<!--l. 1248--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> the </b> <a 
 id="dx67-106001"></a><a 
 id="x67-106002r157"></a>   value-type form
</td></tr></table>
<!--l. 1249--><p class="indent" >
</div>
   The form is evaluated; whatever it produces is returned by the <i>the</i> form. In
addition, it is an error if what is produced by the form does not conform to
the data type speciﬁed by value-type (which is not evaluated). (A given
implementation may or may not actually check for this error. Implementations are
encouraged to make an explicit error check when running interpretively.)
In eﬀect, this declares that the user undertakes to guarantee that the
values of the form will always be of the speciﬁed type. For example: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(the string (copy-seq x))     ;The result will be a string
</td></tr></table>
<!--l. 1260--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(the integer (+ x 3))         ;The result of <i>+</i> will be an integer</td></tr></table>
<!--l. 1261--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(+ (the integer x) 3)         ;The value of <i>x</i> will be an integer</td></tr></table>
<!--l. 1262--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(the (complex rational) (* z 3))</td></tr></table>
<!--l. 1263--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(the (unsigned-byte 8) (logand x mask))</td></tr></table>
<!--l. 1265--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 1266--><p class="noindent" >The <i>values</i> type speciﬁer may be used to indicate the types of multiple values: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(the (values integer integer) (ﬂoor x y))
</td></tr></table>
<!--l. 1269--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(the (values string t)</td></tr></table>
<!--l. 1270--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (gethash the-key the-string-table))</td></tr></table>
<!--l. 1272--><p class="indent" >
</div>
</div>
<div class=newer>
<!--l. 1275--><p class="indent" >   X3J13 voted in June 1989 ⟨<b>?</b>⟩ to clarify that value-type may be any valid type
speciﬁer whatsoever. The point is that a type speciﬁer need not be one suitable
for discrimination but only for declaration.
<!--l. 1280--><p class="indent" >   In the case that the form produces exactly one value and value-type is not a
<i>values</i> type speciﬁer, one may describe a <i>the</i> form as being entirely equivalent to <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(let ((#1=#:temp form)) (declare (type value-type #1#)) #1#)
</td></tr></table>
<!--l. 1285--><p class="indent" >
</div>
</div>
<!--l. 1286--><p class="noindent" >A more elaborate expression could be written to describe the case where value-type is
a <i>values</i> type speciﬁer.
</div>
<div class=incompatibility>
<!--l. 1291--><p class="noindent" ><b>Compatibility note:</b> This construct is borrowed from the Interlisp DECL package;
Interlisp, however, allows an implicit <i>progn</i> after the type speciﬁer rather than just a
single form. The MacLisp <i>ﬁxnum-identity</i> and <i>ﬂonum-identity</i> constructs can be
expressed as <i>(the ﬁxnum x)</i> and <i>(the single-ﬂoat x)</i>.
</div>
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
   <!--l. 7--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch10.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse52.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse52.html#tailclmse52.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse53.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#clmse53.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 7--><p class="indent" >   <a 
 id="tailclmse53.html"></a>  
</body></html> 
