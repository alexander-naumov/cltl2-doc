<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Приведение типов и доступ к компонентам чисел</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-12 20:56:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 4584--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse66.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse64.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse64.html#tailclmse64.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse65.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch12.html#clmse65.html" >Наверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">12.6   </span> <a 
href="clm.html#QQ2-82-191" id="x82-18300012.6">Приведение типов
и доступ к компонентам чисел</a></h3>
<!--l. 4586--><p class="noindent" >Тогда как большинство арифметических функций будут оперировать любым
типом чисел, выполняя при необходимости приведения, следующие функции
позволяют явно преобразовывать типы данных.
<div class=defun>
<!--l. 4590--><p class="noindent" ><i>[Функция]</i><a 
 id="dx82-183001"></a><a 
 id="x82-183002r214"></a><b> ﬂoat</b>  <i>number</i> &#x0026;optional  <i>other</i>
<!--l. 4592--><p class="noindent" >Преобразует любое некомплексное число в число с плавающей точкой. При
отсутствии необязательного параметра, если <i>number</i> уже является числом с
плавающей точкой, то оно и будет возвращено, иначе число будет
преобразовано в <tt>single-float</tt>. Если аргумент <i>other</i> указан, тогда он должен
быть числом с плавающей точкой, и <i>number</i> будет конвертирован в такой же
формат как у <i>other</i>.
<!--l. 4601--><p class="indent" >   Смотрите также <tt><a 
href="clmse24.html#x33-52002r7">coerce</a></tt>.
</div>
<div class=defun>
<!--l. 4604--><p class="noindent" ><i>[Функция]</i><a 
 id="dx82-183003"></a><a 
 id="x82-183004r215"></a><b> rational</b>  <i>number</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183005"></a><a 
 id="x82-183006r216"></a><b> rationalize</b>  <i>number</i>
<!--l. 4607--><p class="noindent" >Каждая из этих функций преобразует любое некомплексное число в
рациональное. Если аргумент уже является рациональным, он возвращается
как есть. Две функции различаются в том, как они обрабатывают числа с
плавающей точкой.
<tt>
<!--l. 4612--><p class="indent" >   <a 
href="#x82-183004r215">rational</a></tt> предполагает, что число с плавающей точкой совершенно точно,
и возвращает рациональное число математически эквивалентное значению
числа с плавающей точкой.
<tt>
<!--l. 4616--><p class="indent" >   <a 
href="#x82-183006r216">rationalize</a></tt> предполагает, что число с плавающей точкой приближенное,
и может возвращать любое рациональное число, для которого исходное число
является наилучшим приближением. Функция пытается сохранить числитель
и знаменатель наименьшими насколько это возможно.
<!--l. 4621--><p class="indent" >   Следующие тождества всегда справедливы <div class=lisp><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ﬂoat (rational <i>x</i>) <i>x</i>) <span class="math"> ≡</span> <i>x</i>
</td></tr></table>
<!--l. 4624--><p class="indent" >
</div>
</div>
<!--l. 4625--><p class="noindent" >и <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ﬂoat (rationalize <i>x</i>) <i>x</i>) <span class="math"> ≡</span> <i>x</i>
</td></tr></table>
<!--l. 4628--><p class="indent" >
</div>
</div>
<!--l. 4629--><p class="noindent" >То есть, преобразование числа с плавающей точкой любым из методов туда и
обратно даёт исходное число. Различие в том, что <tt><a 
href="#x82-183004r215">rational</a></tt> обычно имеет
более простую недорогую реализацию, тогда как <tt><a 
href="#x82-183006r216">rationalize</a></tt> представляет
более «красивое» число.
</div>
<div class=defun>
<!--l. 4635--><p class="noindent" ><i>[Функция]</i><a 
 id="dx82-183007"></a><a 
 id="x82-183008r217"></a><b> numerator</b>  <i>rational</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183009"></a><a 
 id="x82-183010r218"></a><b> denominator</b>  <i>rational</i>
<!--l. 4638--><p class="noindent" >Эти функции принимают рациональное число (целое или дробное) и
возвращают в качестве целого числа числитель или знаменатель дроби,
приведённое к каноническому виду. Числитель целого числа и является
этим числом. Знаменатель целого числа <tt>1</tt>. Следует отметить, что
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(gcd (numerator <i>x</i>) (denominator <i>x</i>)) <span class="math"> ⇒</span> 1
</td></tr></table>
<!--l. 4645--><p class="indent" >
</div>
</div>
<!--l. 4646--><p class="noindent" >Знаменатель будет всегда строго положительным числом. Числитель может
быть любым целым числом. Например: <div class=lisp><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(numerator (/ 8 -6)) <span class="math"> ⇒</span> -4
</td></tr></table>
<!--l. 4650--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(denominator (/ 8 -6)) <span class="math"> ⇒</span> 3</td></tr></table>
<!--l. 4652--><p class="indent" >
</div>
</div>
</div>
<!--l. 4655--><p class="indent" >   В Common Lisp&#x2019;е нет функции <tt>fix</tt>, потому что есть несколько интересных
способов преобразовать нецелое число к целому. Эти способы представлены
функциями ниже, которые выполняются не только преобразование типа, но
также некоторые нетривиальные вычисления.
<div class=defun>
<!--l. 4660--><p class="noindent" ><i>[Функция]</i><a 
 id="dx82-183011"></a><a 
 id="x82-183012r219"></a><b> ﬂoor</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183013"></a><a 
 id="x82-183014r220"></a><b> ceiling</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183015"></a><a 
 id="x82-183016r221"></a><b> truncate</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183017"></a><a 
 id="x82-183018r222"></a><b> round</b>  <i>number</i> &#x0026;optional  <i>divisor</i>
<!--l. 4665--><p class="noindent" >При вызове с одним аргументом, каждая из этих функций преобразует
аргумент <i>number</i> (который не может быть комплексным числом) в целое
число. Если аргумент уже является целым числом, то он немедленно
возвращается в качестве результата. Если аргумент дробь или число с
плавающей точкой, для конвертации функции используют различные
алгоритмы.
<tt>
<!--l. 4673--><p class="indent" >   <a 
href="#x82-183012r219">floor</a></tt> преобразовывает аргумент путём отсечения к отрицательной
бесконечности, то есть, результатом является наибольшее целое число,
которое не больше чем аргумент.
<tt>
<!--l. 4677--><p class="indent" >   <a 
href="#x82-183014r220">ceiling</a></tt> преобразовывает аргумент путём отсечения к положительной
бесконечности, то есть, результатом является наименьшее целое число,
которое не меньше чем аргумент.
<tt>
<!--l. 4681--><p class="indent" >   <a 
href="#x82-183014r220">ceiling</a></tt> преобразовывает аргумент путём отсечения к нулю, то есть,
результатом является целое число с таким же знаком, которое имеет
наибольшую целую величину, но не большую чем аргумент.
<!--l. 4685--><p class="indent" >   Следующая таблица содержит то, что возвращают четыре функции для
разных аргументов.
                                                                          

                                                                          
<div class="flushleft" 
>
<!--l. 4688--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" >Аргумент</td><td align="left" >ﬂoor</td><td align="left" >ceiling</td><td align="left" >truncate</td><td align="left" >round</td>
</tr><tr><td align="left" >     2.6    </td><td align="left" >  2 </td><td align="left" >    3   </td><td align="left" >     2    </td><td align="left" >   3  </td></tr><tr><td align="left" >  2.5 </td> <td align="left" >  2 </td> <td align="left" >  3 </td> <td align="left" >  2 </td> <td align="left" >  2</td>
</tr><tr><td align="left" >     2.4    </td><td align="left" >  2 </td><td align="left" >    3   </td><td align="left" >     2    </td><td align="left" >   2  </td></tr><tr><td align="left" >  0.7 </td> <td align="left" >  0 </td> <td align="left" >  1 </td> <td align="left" >  0 </td> <td align="left" >  1</td>
</tr><tr><td align="left" >     0.3    </td><td align="left" >  0 </td><td align="left" >    1   </td><td align="left" >     0    </td><td align="left" >   0  </td></tr><tr><td align="left" > -0.3 </td> <td align="left" > -1 </td> <td align="left" >  0 </td> <td align="left" >  0 </td> <td align="left" >  0</td>
</tr><tr><td align="left" >    -0.7    </td><td align="left" >  -1  </td><td align="left" >    0   </td><td align="left" >     0    </td><td align="left" >   -1   </td></tr><tr><td align="left" > -2.4 </td> <td align="left" > -3 </td> <td align="left" > -2 </td> <td align="left" > -2 </td> <td align="left" > -2</td>
</tr><tr><td align="left" >    -2.5    </td><td align="left" >  -3  </td><td align="left" >   -2   </td><td align="left" >    -2    </td><td align="left" >   -2   </td></tr><tr><td align="left" > -2.6 </td> <td align="left" > -3 </td> <td align="left" > -2 </td> <td align="left" > -2 </td> <td align="left" > -3</td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr><td align="left" > </td></tr></table>
</div></div>
<!--l. 4707--><p class="indent" >   Если указан второй аргумент <i>divisor</i>, тогда аргумент <i>number</i> будет
разделен на <i>divisor</i>, а затем уже будут проведены вышеописанные действия.
Например, <tt>(floor 5 2)</tt> <span class="math"> ≡</span> <tt>(values (floor (/ 5 2)))</tt>, но первый
вариант потенциально эффективнее. <i>divisor</i> может любым числом, кроме
комплексного. <i>divisor</i> не может равняться нулю. Случай вызова функции с
одним аргументом эквивалентен вызову с двумя аргументами, последний из
которых равен <tt>1</tt>.
<!--l. 4716--><p class="indent" >   Каждая из функций возвращает <i>два</i> значения. Второе значение является
остатком и может быть получено с помощью <tt><a 
href="clmse42.html#x54-133002r111">multiple-value-bind</a></tt> или
другими подобными конструкциями. Если любая из этих функций получает
два аргумента <i>x</i> и <i>y</i> и возвращает <i>q</i> и <i>r</i>, тогда <span class="math"><i>q</i> ⋅<i>y</i> + <i>r</i> = <i>x</i></span>. Первое
значение результата <i>q</i> всегда целочисленное. Остаток <i>r</i> целочисленный,
если оба аргумента были целочисленными, и рациональное, если оба
аргумента были рациональными, и с плавающей точкой, если один из
аргументов был с плавающей точкой. Если при вызове был указан
один аргумент, то тип данных остатка всегда такой же как и этот
аргумент.
<!--l. 4729--><p class="indent" >   Когда указывается только один аргумент, сумма двух значений
результата точно равняется переданному в параметре значению.
</div>
<div class=defun>
<!--l. 4733--><p class="noindent" ><i>[Функция]</i><a 
 id="dx82-183019"></a><a 
 id="x82-183020r223"></a><b> mod</b>  <i>number</i> <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183021"></a><a 
 id="x82-183022r224"></a><b> rem</b>  <i>number</i> <i>divisor</i>
<!--l. 4736--><p class="noindent" ><tt><a 
href="#x82-183020r223">mod</a></tt> выполняет операцию <tt><a 
href="#x82-183012r219">floor</a></tt> для двух аргументов и возвращает <i>второй</i>
результат <tt><a 
href="#x82-183012r219">floor</a></tt>. Таким же образом, <tt><a 
href="#x82-183022r224">rem</a></tt> выполняет операцию <tt><a 
href="#x82-183016r221">truncate</a></tt> для
двух аргументов и возвращает <i>второй</i> результат <tt><a 
href="#x82-183016r221">truncate</a></tt>.
<!--l. 4742--><p class="indent" >   Таким образом <tt><a 
href="#x82-183020r223">mod</a></tt> и <tt><a 
href="#x82-183022r224">rem</a></tt> являются обычными функциями вычисления
                                                                          

                                                                          
остатка от деления двух чисел. Аргументы могут быть также числами с
плавающей точкой. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:292;" 
class="tabbing">(mod 13 4) <span class="math"> ⇒</span> 1                           </td><td  
class="tabbing">(rem 13 4) <span class="math"> ⇒</span> 1
</td></tr></table>
<!--l. 4747--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:292;" 
class="tabbing">(mod -13 4) <span class="math"> ⇒</span> 3                          </td><td  
class="tabbing">(rem -13 4) <span class="math"> ⇒</span> -1</td></tr></table>
<!--l. 4748--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:292;" 
class="tabbing">(mod 13 -4) <span class="math"> ⇒</span> -3                         </td><td  
class="tabbing">(rem 13 -4) <span class="math"> ⇒</span> 1</td></tr></table>
<!--l. 4749--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:292;" 
class="tabbing">(mod -13 -4) <span class="math"> ⇒</span> -1                        </td><td  
class="tabbing">(rem -13 -4) <span class="math"> ⇒</span> -1</td></tr></table>
<!--l. 4750--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:292;" 
class="tabbing">(mod 13.4 1) <span class="math"> ⇒</span> 0.4                       </td><td  
class="tabbing">(rem 13.4 1) <span class="math"> ⇒</span> 0.4</td></tr></table>
<!--l. 4751--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:292;" 
class="tabbing">(mod -13.4 1) <span class="math"> ⇒</span> 0.6                      </td><td  
class="tabbing">(rem -13.4 1) <span class="math"> ⇒</span> -0.4</td></tr></table>
<!--l. 4753--><p class="indent" >
</div>
</div>
</div>
<div class=defun>
<!--l. 4756--><p class="noindent" ><i>[Функция]</i><a 
 id="dx82-183023"></a><a 
 id="x82-183024r225"></a><b> ﬄoor</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183025"></a><a 
 id="x82-183026r226"></a><b> fceiling</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183027"></a><a 
 id="x82-183028r227"></a><b> ftruncate</b>  <i>number</i> &#x0026;optional  <i>divisor</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183029"></a><a 
 id="x82-183030r228"></a><b> fround</b>  <i>number</i> &#x0026;optional  <i>divisor</i>
<!--l. 4761--><p class="noindent" >Эти функции похожи на <tt><a 
href="#x82-183012r219">floor</a></tt>, <tt><a 
href="#x82-183014r220">ceiling</a></tt>, <tt><a 
href="#x82-183016r221">truncate</a></tt> и <tt><a 
href="#x82-183018r222">round</a></tt> за исключением
того, что результат (первый из двух) всегда целое число, а не число
с плавающей точкой. Это примерно, как если бы <tt><a 
href="#x82-183024r225">ffloor</a></tt> передала
аргументы в <tt><a 
href="#x82-183012r219">floor</a></tt>, а затем применила к первому результату <tt><a 
href="#x82-183002r214">float</a></tt> и
вернула полученную пару значений. Однако, на практике <tt><a 
href="#x82-183024r225">ffloor</a></tt> может
быть реализована более эффективно. Такое же описание подходит к
остальным трём функциям. Если первый аргумент является числом с
плавающей точкой, и второй аргумент не точнее типа первого, тогда первый
результат будет такого же типа как первый аргумент. Например:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ﬄoor -4.7) <span class="math"> ⇒</span> -5.0 and 0.3
</td></tr></table>
<!--l. 4773--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ﬄoor 3.5d0) <span class="math"> ⇒</span> 3.0d0 and 0.5d0</td></tr></table>
<!--l. 4775--><p class="indent" >
</div>
                                                                          

                                                                          
</div>
</div>
<div class=defun>
<!--l. 4778--><p class="noindent" ><i>[Функция]</i><a 
 id="dx82-183031"></a><a 
 id="x82-183032r229"></a><b> decode-ﬂoat</b>  <i>ﬂoat</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183033"></a><a 
 id="x82-183034r230"></a><b> scale-ﬂoat</b>  <i>ﬂoat</i> <i>integer</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183035"></a><a 
 id="x82-183036r231"></a><b> ﬂoat-radix</b>  <i>ﬂoat</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183037"></a><a 
 id="x82-183038r232"></a><b> ﬂoat-sign</b>  <i>ﬂoat1</i> &#x0026;optional  <i>ﬂoat2</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183039"></a><a 
 id="x82-183040r233"></a><b> ﬂoat-digits</b>  <i>ﬂoat</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183041"></a><a 
 id="x82-183042r234"></a><b> ﬂoat-precision</b>  <i>ﬂoat</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183043"></a><a 
 id="x82-183044r235"></a><b> integer-decode-ﬂoat</b>  <i>ﬂoat</i>
<!--l. 4786--><p class="noindent" >Функция <tt><a 
href="#x82-183032r229">decode-float</a></tt> принимает числа с плавающей точкой и возвращает
три значения.
<!--l. 4790--><p class="indent" >   Первое значение является мантиссой и числом того же типа, что
и аргумент. Второе значение является целочисленной экспонентой.
Третье значение отображает знак аргумента (-1.0 или 1.0) и является и
числом того же типа, что и аргумент . Пусть <i>b</i> есть система счисления
для отображения чисел с плавающей точкой, тогда <tt><a 
href="#x82-183032r229">decode-float</a></tt>
делит аргумент на <i>b</i> в некоторой степени, чтобы привести значение
в промежуток включая 1/<i>b</i> и не включая 1 и возвращает частное
в качестве первого значения FIXME. Однако, если аргумент равен
нулю результат равен абсолютному значению аргумента (то есть, если
существует отрицательный ноль, то для него возвращается положительный
ноль).
<!--l. 4801--><p class="indent" >   Второе значение <tt><a 
href="#x82-183032r229">decode-float</a></tt> является целочисленным экспонентой <i>e</i>,
которая равняется степени, в которую было возведено <i>b</i>. Если аргумент
равен нулю, то может быть возвращено любое целое число, при условии, что
тожество, описанное ниже для <tt>scale-format</tt>, имеет место быть.
<!--l. 4806--><p class="indent" >   Третье значение <tt><a 
href="#x82-183032r229">decode-float</a></tt> является числом с плавающей точкой в
том же формате, что и аргумент, абсолютное значение которого равно 1, и
знак совпадает со знаком аргумента.
<!--l. 4810--><p class="indent" >   Функция <tt><a 
href="#x82-183034r230">scale-float</a></tt> принимает число с плавающей точкой <i>f </i> (не
обязательно между 1/<i>b</i> и 1) и целое число <i>k</i>, и возвращает <tt>(* <i>f</i> (expt
(float <i>b</i> <i>f</i>) <i>k</i>))</tt>. (Использование <tt><a 
href="#x82-183034r230">scale-float</a></tt> может быть более
эффективным, чем использование возведения в степень или умножения и
позволяет избежать переполнений).
<!--l. 4816--><p class="indent" >   Следует отметить, что <div class=lisp><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (signif expon sign)
</td></tr></table>
<!--l. 4818--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (decode-ﬂoat <i>f </i>)</td></tr></table>
<!--l. 4819--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (scale-ﬂoat signif expon))</td></tr></table>
<!--l. 4820--><p class="indent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><span class="math"> ≡</span> (abs <i>f </i>)</td></tr></table>
<!--l. 4822--><p class="indent" >
</div>
</div>
<!--l. 4823--><p class="noindent" >и <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (signif expon sign)
</td></tr></table>
<!--l. 4825--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (decode-ﬂoat <i>f </i>)</td></tr></table>
<!--l. 4826--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (* (scale-ﬂoat signif expon) sign))</td></tr></table>
<!--l. 4827--><p class="indent" >                                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><span class="math"> ≡</span> <i>f </i></td></tr></table>
<!--l. 4829--><p class="indent" >
</div>
</div>
<!--l. 4831--><p class="indent" >   Функция <tt><a 
href="#x82-183036r231">float-radix</a></tt> возвращает (в качестве целого числа) основание <i>b</i>
для числа с плавающей точкой.
<!--l. 4834--><p class="indent" >   Функция <tt><a 
href="#x82-183038r232">float-sign</a></tt> возвращает такое число с плавающей точкой <i>z</i>,
что <i>z</i> и <i>ﬂoat1</i> имеют одинаковый знак, и <i>z</i> и <i>ﬂoat2</i> имеют равное
абсолютное значение. Аргумент <i>ﬂoat2</i> по-умолчанию имеет значение <tt>(float
1 <i>float1</i>)</tt>. Таким образом <tt>(float-sign x)</tt> всегда возвращает <tt>1.0</tt>
или <tt>-1.0</tt> в таком же формате и с тем же знаком, что и <i>x</i>. (Следует
отметить, что если реализация содержит различные представления для
отрицательного и положительного нулей, тогда <tt>(float-sign -0.0)</tt>
<span class="math"> ⇒</span> <tt>-1.0</tt>.)
<!--l. 4843--><p class="indent" >   Функция <tt><a 
href="#x82-183040r233">float-digits</a></tt> возвращает целочисленное количество цифр
используемых в представлении аргумента. Функция <tt><a 
href="#x82-183042r234">float-precision</a></tt>
возвращает целочисленное количество цифр в мантиссе аргумента.
Если аргумент равен нулю, то результатом также будет ноль. Для
нормализованных чисел с плавающей точкой, результаты <tt><a 
href="#x82-183040r233">float-digits</a></tt> и
<tt><a 
href="#x82-183042r234">float-precision</a></tt> будут такими же. Но в случае с денормализованными
числами или нулём точность будет меньше чем количество цифр в
представлении.
                                                                          

                                                                          
<!--l. 4851--><p class="indent" >   Функция <tt><a 
href="#x82-183044r235">integer-decode-float</a></tt> похожа на <tt><a 
href="#x82-183032r229">decode-float</a></tt>, но в качестве
первого значение возвращает масштабированную целочисленную мантиссу.
Для аргумента <i>f </i>, это число будет строго меньше чем <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><tt>(expt <i>b</i> (float-precision <i>f</i>))</tt>
</td></tr></table>
<!--l. 4856--><p class="indent" >
</div>
</div>
<!--l. 4857--><p class="noindent" >на не менее чем <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><tt>(expt <i>b</i> (- (float-precision <i>f</i>) 1))</tt>
</td></tr></table>
<!--l. 4860--><p class="indent" >
</div>
</div>
<!--l. 4861--><p class="noindent" >за исключением того, что если <i>f </i> равно нулю, тогда целочисленное значение
также будет равно нулю.
<!--l. 4864--><p class="indent" >   Второе значение имеет такую же связь с первым значением, как и для
<tt><a 
href="#x82-183032r229">decode-float</a></tt>: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (signif expon sign)
</td></tr></table>
<!--l. 4867--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (integer-decode-ﬂoat <i>f </i>)</td></tr></table>
<!--l. 4868--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (scale-ﬂoat (ﬂoat signif <i>f </i>) expon))</td></tr></table>
<!--l. 4869--><p class="indent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><span class="math"> ≡</span> (abs <i>f </i>)</td></tr></table>
<!--l. 4871--><p class="indent" >
</div>
</div>
<!--l. 4873--><p class="indent" >   Третье значение <tt><a 
href="#x82-183044r235">integer-decode-float</a></tt> будет <tt>1</tt> или <tt>-1</tt>.
<div class=rationale>
<!--l. 4876--><p class="noindent" ><b>Обоснование:</b> Эти функции позволяют писать машиннонезависиммые или как
минимум машиннопараметризированные приложения с вычислениями чисел с
плавающими точками с необходимой эффективностью.
                                                                          

                                                                          
</div>
</div>
<div class=defun>
<!--l. 4884--><p class="noindent" ><i>[Функция]</i><a 
 id="dx82-183045"></a><a 
 id="x82-183046r236"></a><b> complex</b>  <i>realpart</i> &#x0026;optional  <i>imagpart</i>
<!--l. 4886--><p class="noindent" >Аргументы должны быть некомплексными числами. Результатом является
число, которое имеет действительную часть <i>realpart</i> и мнимую <i>imagpart</i>,
возможно конвертированные к одному типу. Если <i>imagpart</i> не указаны, тогда
используется <tt>(coerce 0 (type-of <i>realpart</i>))</tt>. Необходимо отметить, что
если обе части комплексного число рациональны, и мнимая часть равна нуля,
то результатом будет только действительная часть <i>realpart</i> так как в силу
вступят правила канонизации. Таким образом результат <tt><a 
href="#x82-183046r236">complex</a></tt> не всегда
является комплексным числом. Он может быть просто рациональным числом
(<tt><a 
href="#x82-183004r215">rational</a></tt>).
</div>
<div class=defun>
<!--l. 4899--><p class="noindent" ><i>[Функция]</i><a 
 id="dx82-183047"></a><a 
 id="x82-183048r237"></a><b> realpart</b>  <i>number</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx82-183049"></a><a 
 id="x82-183050r238"></a><b> imagpart</b>  <i>number</i>
<!--l. 4902--><p class="noindent" >Эти функции возвращают действительную и мнимую части комплексного
числа. Если <i>number</i> не является комплексным числом, тогда <tt><a 
href="#x82-183048r237">realpart</a></tt>
возвращает это число, а <tt><a 
href="#x82-183050r238">imagpart</a></tt> возвращает <tt>(* 0 <i>number</i>)</tt>, другими
словами, <tt>0</tt> того типа, каким был аргумент.
</div>
                                                                          

                                                                          
<!--l. 4909--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse66.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse64.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse64.html#tailclmse64.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse65.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch12.html#clmse65.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse65.html"></a>  </div> </div> 
</body></html> 
