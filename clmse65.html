<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Irrational and Transcendental Functions</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-19 00:40:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 821--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse66.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse64.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse64.html#tailclmse64.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse65.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch12.html#clmse65.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">12.5   </span> <a 
 id="x82-18000012.5"></a>Irrational and Transcendental Functions</h3>
<!--l. 824--><p class="noindent" >Common Lisp provides no data type that can accurately represent irrational
numerical values. The functions in this section are described as if the results were
mathematically accurate, but actually they all produce ﬂoating-point
approximations to the true mathematical result in the general case. In some places
mathematical identities are set forth that are intended to elucidate the meanings
of the functions; however, two mathematically identical expressions may be
computationally diﬀerent because of errors inherent in the ﬂoating-point
approximation process.
<!--l. 835--><p class="indent" >   When the arguments to a function in this section are all rational and the true
mathematical result is also (mathematically) rational, then unless otherwise
noted an implementation is free to return either an accurate result of
type <a 
href="clmse66.html#x83-184004r215">rational</a> or a single-precision ﬂoating-point approximation. If the
arguments are all rational but the result cannot be expressed as a rational
number, then a single-precision ﬂoating-point approximation is always
returned.
<div class=newer>
<!--l. 845--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx82-180001"></a>to clarify that the provisions of the previous
paragraph apply to complex numbers. If the arguments to a function are all of
type (or rational (complex rational)) and the true mathematical result is
(mathematically) a complex number with rational real and imaginary parts,
then unless otherwise noted an implementation is free to return either an
accurate result of type (or rational (complex rational)) or a single-precision
ﬂoating-point approximation of type single-ﬂoat (permissible only if the imaginary
part of the true mathematical result is zero) or (complex single-ﬂoat). If
the arguments are all of type (or rational (complex rational)) but the
result cannot be expressed as a rational or complex rational number,
then the returned value will be of type single-ﬂoat (permissible only if
the imaginary part of the true mathematical result is zero) or (complex
single-ﬂoat).
</div>
                                                                          

                                                                          
<!--l. 864--><p class="indent" >   The rules of ﬂoating-point contagion and complex contagion are eﬀectively
obeyed by all the functions in this section except <a 
href="#x82-181004r193">expt</a>, which treats some
cases of rational exponents specially. When, possibly after contagious
conversion, all of the arguments are of the same ﬂoating-point or complex
ﬂoating-point type, then the result will be of that same type unless otherwise
noted.
<div class=implementation>
<!--l. 872--><p class="noindent" ><b>Implementation note:</b> There is a “ﬂoating-point cookbook” by Cody and Waite
<span class="cite">[<a 
href="clmli5.html#XCODY-AND-WAITE">14</a>]</span> that may be a useful aid in implementing the functions deﬁned in this
section.
</div>
<!--l. 879--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">12.5.1   </span> <a 
 id="x82-18100012.5.1"></a>Exponential and Logarithmic Functions</h4>
<!--l. 881--><p class="noindent" >Along with the usual one-argument and two-argument exponential and logarithm
functions, <a 
href="#x82-181011r195">sqrt</a> is considered to be an exponential function, because it raises a
number to the power 1/2.
<div class=defun>
<!--l. 885--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-181001"></a><a 
 id="x82-181002r192"></a><b> exp</b>  <i>number</i>
<!--l. 887--><p class="noindent" >Returns <i>e</i> raised to the power <i>number</i>, where <i>e</i> is the base of the natural
logarithms.
</div>
<div class=defun>
<!--l. 892--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-181003"></a><a 
 id="x82-181004r193"></a><b> expt</b>  <i>base-number</i> <i>power-number</i>
<!--l. 894--><p class="noindent" >Returns <i>base-number</i> raised to the power <i>power-number</i>. If the <i>base-number</i> is of
type <a 
href="clmse66.html#x83-184004r215">rational</a> and the <i>power-number</i> is an integer, the calculation will be exact
and the result will be of type <a 
href="clmse66.html#x83-184004r215">rational</a>; otherwise a ﬂoating-point approximation
may result.
<div class=newer>
<!--l. 902--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx82-181005"></a>to clarify that provisions similar to those of the
previous paragraph apply to complex numbers. If the <i>base-number</i> is of type
(complex rational) and the <i>power-number</i> is an integer, the calculation will also
be exact and the result will be of type (or rational (complex rational));
otherwise a ﬂoating-point or complex ﬂoating-point approximation may
result.
</div>
                                                                          

                                                                          
<!--l. 913--><p class="indent" >   When <i>power-number</i> is 0 (a zero of type integer), then the result is always the
value 1 in the type of <i>base-number</i>, even if the <i>base-number</i> is zero (of any type).
That is: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(expt <i>x</i> 0) <span class="math"> ≡</span> (coerce 1 (type-of <i>x</i>))
</td></tr></table>
<!--l. 918--><p class="indent" >
</div>
</div>
<!--l. 919--><p class="noindent" >If the <i>power-number</i> is a zero of any other data type, then the result is also the value
1, in the type of the arguments after the application of the contagion rules, with
one exception: it is an error if <i>base-number</i> is zero when the <i>power-number</i> is a
zero not of type integer.
<!--l. 925--><p class="indent" >   Implementations of <a 
href="#x82-181004r193">expt</a> are permitted to use diﬀerent algorithms for the
cases of a rational <i>power-number</i> and a ﬂoating-point <i>power-number</i>; the
motivation is that in many cases greater accuracy can be achieved for the
case of a rational <i>power-number</i>. For example, (expt pi 16) and (expt pi
16.0) may yield slightly diﬀerent results if the ﬁrst case is computed by
repeated squaring and the second by the use of logarithms. Similarly, an
implementation might choose to compute (expt x 3/2) as if it had been
written (sqrt (expt x 3)), perhaps producing a more accurate result than
would (expt x 1.5). It is left to the implementor to determine the best
strategies.
<div class=new>
<!--l. 938--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx82-181006"></a>to clarify that the preceding remark is
in error, because (sqrt (expt x 3)) does not produce the same value as
(expt x 3/2) in most cases, and to specify that the speciﬁcation of the
principal value of <a 
href="#x82-181004r193">expt</a> as given in section <a 
href="#x82-18300012.5.3">12.5.3<!--tex4ht:ref: BRANCH-CUTS-SECTION --></a> should be regarded as
deﬁnitive.
<!--l. 946--><p class="indent" >   As an example of the diﬃculty, let <span class="math">x = cis 2π 
 3   = −1
2 + <img 
src="clm1x.png" alt="√3"  class="sqrt" > 
 2  i</span>. Then <span class="math"><img 
src="clm2x.png" alt="√ --3
  x"  class="sqrt" > = <img 
src="clm3x.png" alt="√ --
  1"  class="sqrt" > = 1</span>,
but <span class="math">x<sup>3∕2</sup> = e<sup>(3∕2) log x</sup> = e<sup>(3∕2)(2π∕3)i</sup> = e<sup>πi</sup> = −1</span>. Another example is <span class="math">x = −1</span>; then
<span class="math"><img 
src="clm4x.png" alt="√ ---
  x3"  class="sqrt" > = <img 
src="clm5x.png" alt="√ ---
  − 1"  class="sqrt" > = i</span>, but <span class="math">x<sup>3∕2</sup> = e<sup>(3∕2) log x</sup> = e<sup>(3∕2)πi</sup> = −i</span>.
</div>
<!--l. 955--><p class="indent" >   The result of <a 
href="#x82-181004r193">expt</a> can be a complex number, even when neither argument is
complex, if <i>base-number</i> is negative and <i>power-number</i> is not an integer. The
result is always the principal complex value. Note that (expt -8 1/3) is not
permitted to return -2; while -2 is indeed one of the cube roots of -8, it is not the
                                                                          

                                                                          
principal cube root, which is a complex number approximately equal to #C(1.0
1.73205).
<div class=new>
<i>
<!--l. 964--><p class="indent" >   Notice of correction.</i> The ﬁrst edition gave the incorrect value #C(0.5 1.73205)
for the principal cube root of -8. The correct value is #C(1.0 1.73205), that is,
<span class="math">1 + <img 
src="clm6x.png" alt="√ --
  3"  class="sqrt" >i</span>. I simply don&#x2019;t know what I was thinking of!
</div>
</div>
<div class=defun>
<!--l. 972--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-181007"></a><a 
 id="x82-181008r194"></a><b> log</b>  <i>number</i> &#x0026;optional  <i>base</i>
<!--l. 974--><p class="noindent" >Returns the logarithm of <i>number</i> in the base <i>base</i>, which defaults to <i>e</i>, the base of
the natural logarithms. For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(log 8.0 2) <span class="math"> ⇒</span> 3.0
</td></tr></table>
<!--l. 979--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(log 100.0 10) <span class="math"> ⇒</span> 2.0</td></tr></table>
<!--l. 981--><p class="indent" >
</div>
</div>
<!--l. 982--><p class="noindent" >The result of (log 8 2) may be either 3 or 3.0, depending on the implementation.
<!--l. 985--><p class="indent" >   Note that <a 
href="#x82-181008r194">log</a> may return a complex result when given a non-complex
argument if the argument is negative. For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(log -1.0) <span class="math"> ≡</span> (complex 0.0 (ﬂoat pi 0.0))
</td></tr></table>
<!--l. 989--><p class="indent" >
</div>
</div>
<div class=new>
<!--l. 992--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx82-181009"></a>to specify certain ﬂoating-point behavior when
minus zero is supported. As a part of that vote it approved a mathematical
deﬁnition of complex logarithm in terms of real logarithm, absolute value, arc
tangent of two real arguments, and the phase function as <div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Logarithm                 </td><td  
class="tabbing"><span class="math"> log <img 
src="clm7x.png" alt="|z|"  class="left" align="middle"> + <i>i</i> phase <i>z</i></span>
</td></tr></table>
<!--l. 1001--><p class="indent" >
</div>
<!--l. 1002--><p class="noindent" >This speciﬁes the branch cuts precisely whether minus zero is supported or not; see
<a 
href="#x82-182004r198">phase</a> and <a 
href="#x82-182021r206">atan</a>.
</div>
</div>
<div class=defun>
<!--l. 1007--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-181010"></a><a 
 id="x82-181011r195"></a><b> sqrt</b>  <i>number</i>
<!--l. 1009--><p class="noindent" >Returns the principal square root of <i>number</i>. If the <i>number</i> is not complex
but is negative, then the result will be a complex number. For example:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(sqrt 9.0) <span class="math"> ⇒</span> 3.0
</td></tr></table>
<!--l. 1015--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(sqrt -9.0) <span class="math"> ⇒</span> #c(0.0 3.0)</td></tr></table>
<!--l. 1017--><p class="indent" >
</div>
</div>
<!--l. 1018--><p class="noindent" >The result of (sqrt 9) may be either 3 or 3.0, depending on the implementation. The
result of (sqrt -9) may be either #c(0 3) or #c(0.0 3.0).
<div class=new>
<!--l. 1023--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx82-181012"></a>to specify certain ﬂoating-point behavior when
minus zero is supported. As a part of that vote it approved a mathematical
deﬁnition of complex square root in terms of complex logarithm and exponential
functions as <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Square root               </td><td  
class="tabbing"><span class="math"><i>e</i><sup>(log z)∕2</sup></span>
</td></tr></table>
<!--l. 1031--><p class="indent" >
</div>
                                                                          

                                                                          
<!--l. 1032--><p class="noindent" >This speciﬁes the branch cuts precisely whether minus zero is supported or not; see
<a 
href="#x82-182004r198">phase</a> and <a 
href="#x82-182021r206">atan</a>.
</div>
</div>
<div class=defun>
<!--l. 1037--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-181013"></a><a 
 id="x82-181014r196"></a><b> isqrt</b>  <i>integer</i>
<!--l. 1039--><p class="noindent" >Integer square root: the argument must be a non-negative integer, and the result
is the greatest integer less than or equal to the exact positive square root of the
argument. For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(isqrt 9) <span class="math"> ⇒</span> 3
</td></tr></table>
<!--l. 1045--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(isqrt 12) <span class="math"> ⇒</span> 3</td></tr></table>
<!--l. 1046--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(isqrt 300) <span class="math"> ⇒</span> 17</td></tr></table>
<!--l. 1047--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(isqrt 325) <span class="math"> ⇒</span> 18</td></tr></table>
<!--l. 1049--><p class="indent" >
</div>
</div>
</div>
<!--l. 1052--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">12.5.2   </span> <a 
 id="x82-18200012.5.2"></a>Trigonometric and Related Functions</h4>
<!--l. 1054--><p class="noindent" >Some of the functions in this section, such as <a 
href="#x82-182002r197">abs</a> and <a 
href="#x82-182007r199">signum</a>, are apparently
unrelated to trigonometric functions when considered as functions of real numbers
only. The way in which they are extended to operate on complex numbers makes
the trigonometric connection clear.
<div class=defun>
<!--l. 1060--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-182001"></a><a 
 id="x82-182002r197"></a><b> abs</b>  <i>number</i>
<!--l. 1062--><p class="noindent" >Returns the absolute value of the argument. For a non-complex number <i>x</i>,
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(abs <i>x</i>) <span class="math"> ≡</span> (if (minusp <i>x</i>) (- <i>x</i>) <i>x</i>)
</td></tr></table>
<!--l. 1066--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 1067--><p class="noindent" >and the result is always of the same type as the argument.
<!--l. 1069--><p class="indent" >   For a complex number <i>z</i>, the absolute value may be computed as
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(sqrt (+ (expt (realpart <i>z</i>) 2) (expt (imagpart <i>z</i>) 2)))
</td></tr></table>
<!--l. 1072--><p class="indent" >
</div>
</div>
<div class=implementation>
<!--l. 1075--><p class="noindent" ><b>Implementation note:</b> The careful implementor will not use this formula directly for
all complex numbers but will instead handle very large or very small components
specially to avoid intermediate overﬂow or underﬂow.
</div>
<!--l. 1083--><p class="indent" >   For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(abs #c(3.0 -4.0)) <span class="math"> ⇒</span> 5.0
</td></tr></table>
<!--l. 1086--><p class="indent" >
</div>
</div>
<!--l. 1087--><p class="noindent" >The result of (abs #c(3 4)) may be either 5 or 5.0, depending on the implementation.
</div>
<div class=defun>
<!--l. 1091--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-182003"></a><a 
 id="x82-182004r198"></a><b> phase</b>  <i>number</i>
<!--l. 1093--><p class="noindent" >The phase of a number is the angle part of its polar representation as a complex
number. That is, <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(phase <i>z</i>) <span class="math"> ≡</span> (atan (imagpart <i>z</i>) (realpart <i>z</i>))
</td></tr></table>
<!--l. 1098--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<div class=obsolete>
<!--l. 1100--><p class="noindent" >The result is in radians, in the range <span class="math"> −π</span> (exclusive) to <span class="math">π</span> (inclusive). The phase of a
positive non-complex number is zero; that of a negative non-complex number is <span class="math">π</span>.
The phase of zero is arbitrarily deﬁned to be zero.
</div>
<div class=new>
<!--l. 1107--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx82-182005"></a>to specify certain ﬂoating-point behavior when
minus zero is supported; <a 
href="#x82-182004r198">phase</a> is still deﬁned in terms of <a 
href="#x82-182021r206">atan</a> as above, but
thanks to a change in <a 
href="#x82-182021r206">atan</a> the range of <a 
href="#x82-182004r198">phase</a> becomes <span class="math"> − π</span> <i>inclusive</i> to <span class="math">π</span>
inclusive. The value <span class="math"> − π</span> results from an argument whose real part is
                                                                          

                                                                          
negative and whose imaginary part is minus zero. The <a 
href="#x82-182004r198">phase</a> function
therefore has a branch cut along the negative real axis. The phase of
<span class="math"> + 0 + 0<i>i</i></span> is <span class="math"> + 0</span>, of <span class="math"> + 0 − 0<i>i</i></span> is <span class="math"> − 0</span>, of <span class="math"> − 0 + 0<i>i</i></span> is <span class="math"> + π</span>, and of <span class="math"> − 0 − 0<i>i</i></span> is
<span class="math"> − π</span>.
</div>
<!--l. 1120--><p class="indent" >   If the argument is a complex ﬂoating-point number, the result is a
ﬂoating-point number of the same type as the components of the argument. If the
argument is a ﬂoating-point number, the result is a ﬂoating-point number of the
same type. If the argument is a rational number or complex rational number, the
result is a single-format ﬂoating-point number.
</div>
<div class=defun>
<!--l. 1129--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-182006"></a><a 
 id="x82-182007r199"></a><b> signum</b>  <i>number</i>
<!--l. 1131--><p class="noindent" >By deﬁnition, <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(signum <i>x</i>) <span class="math"> ≡</span> (if (zerop <i>x</i>) <i>x</i> (/ <i>x</i> (abs <i>x</i>)))
</td></tr></table>
<!--l. 1135--><p class="indent" >
</div>
</div>
<!--l. 1136--><p class="noindent" >For a rational number, <a 
href="#x82-182007r199">signum</a> will return one of -1, 0, or 1 according to whether the
number is negative, zero, or positive. For a ﬂoating-point number, the result will
be a ﬂoating-point number of the same format whose value is <span class="math"> − 1</span>, <span class="math">0</span>, or <span class="math">1</span>. For a
complex number <i>z</i>, (signum <i>z</i>) is a complex number of the same phase but with
unit magnitude, unless <i>z</i> is a complex zero, in which case the result is <i>z</i>. For
example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(signum 0) <span class="math"> ⇒</span> 0
</td></tr></table>
<!--l. 1145--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(signum -3.7L5) <span class="math"> ⇒</span> -1.0L0</td></tr></table>
<!--l. 1146--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(signum 4/5) <span class="math"> ⇒</span> 1</td></tr></table>
<!--l. 1147--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(signum #C(7.5 10.0)) <span class="math"> ⇒</span> #C(0.6 0.8)</td></tr></table>
<!--l. 1148--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(signum #C(0.0 -14.7)) <span class="math"> ⇒</span> #C(0.0 -1.0)</td></tr></table>
<!--l. 1150--><p class="indent" >
</div>
                                                                          

                                                                          
</div>
<!--l. 1151--><p class="noindent" >For non-complex rational numbers, <a 
href="#x82-182007r199">signum</a> is a rational function, but it may be
irrational for complex arguments.
</div>
<div class=defun>
<!--l. 1155--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-182008"></a><a 
 id="x82-182009r200"></a><b> sin</b>  <i>radians</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx82-182010"></a><a 
 id="x82-182011r201"></a><b> cos</b>  <i>radians</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx82-182012"></a><a 
 id="x82-182013r202"></a><b> tan</b>  <i>radians</i>
<!--l. 1159--><p class="noindent" ><a 
href="#x82-182009r200">sin</a> returns the sine of the argument, <a 
href="#x82-182011r201">cos</a> the cosine, and <a 
href="#x82-182013r202">tan</a> the tangent. The
argument is in radians. The argument may be complex.
</div>
<div class=defun>
<!--l. 1165--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-182014"></a><a 
 id="x82-182015r203"></a><b> cis</b>  <i>radians</i>
<!--l. 1167--><p class="noindent" >This computes <span class="math"><i>e</i><sup>i⋅radians</sup></span>. The name <a 
href="#x82-182015r203">cis</a> means “cos + <i>i</i> sin,” because
<span class="math"><i>e</i><sup>i𝜃</sup> = cos 𝜃 + <i>i</i> sin 𝜃</span>. The argument is in radians and may be any non-complex
number. The result is a complex number whose real part is the cosine of the
argument and whose imaginary part is the sine. Put another way, the result is a
complex number whose phase is the equal to the argument (mod <span class="math">2π</span>) and whose
magnitude is unity.
<div class=implementation>
<!--l. 1179--><p class="noindent" ><b>Implementation note:</b> Often it is cheaper to calculate the sine and cosine of a single
angle together than to perform two disjoint calculations.
</div>
</div>
<div class=defun>
<!--l. 1186--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-182016"></a><a 
 id="x82-182017r204"></a><b> asin</b>  <i>number</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx82-182018"></a><a 
 id="x82-182019r205"></a><b> acos</b>  <i>number</i>
<!--l. 1189--><p class="noindent" ><a 
href="#x82-182017r204">asin</a> returns the arc sine of the argument, and <a 
href="#x82-182019r205">acos</a> the arc cosine. The result is in
radians. The argument may be complex.
<!--l. 1193--><p class="indent" >   The arc sine and arc cosine functions may be deﬁned mathematically for an
argument <i>z</i> as follows: <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Arc sine                    </td><td  
class="tabbing"><span class="math"> −<i>i</i> log <img 
src="clm8x.png" alt="(    √ ------)
 iz +   1 − z2"  class="left" align="middle"></span>
</td></tr></table>
<!--l. 1197--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Arc cosine                 </td><td  
class="tabbing"><span class="math"> −<i>i</i> log <img 
src="clm9x.png" alt="(    √ ------)
 z + i 1 − z2"  class="left" align="middle"></span>
</td></tr></table>
<!--l. 1199--><p class="indent" >
                                                                          

                                                                          
</div>
<!--l. 1200--><p class="noindent" >Note that the result of <a 
href="#x82-182017r204">asin</a> or <a 
href="#x82-182019r205">acos</a> may be complex even if the argument is not
complex; this occurs when the absolute value of the argument is greater than
1.
<div class=newer>
<!--l. 1205--><p class="indent" >   Kahan <span class="cite">[<a 
href="clmli5.html#XKAHAN-COMPLEX-FNS">25</a>]</span> suggests for <a 
href="#x82-182019r205">acos</a> the deﬁning formula <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Arc cosine                 </td><td  
class="tabbing"><span class="math">2 log <img 
src="clm10x.png" alt="( ∘ ----  ∘ ----)
    1+z+  i  1−-z
     2        2"  class="left" align="middle">
        i            </span>
</td></tr></table>
<!--l. 1210--><p class="indent" >
</div>
<!--l. 1211--><p class="noindent" >or even the much simpler <span class="math">(π∕2) − arcsin <i>z</i></span>. Both equations are mathematically
equivalent to the formula shown above.
</div>
<div class=implementation>
<!--l. 1216--><p class="noindent" ><b>Implementation note:</b> These formulae are mathematically correct, assuming
completely accurate computation. They may be terrible methods for ﬂoating-point
computation. Implementors should consult a good text on numerical analysis. The
formulae given above are not necessarily the simplest ones for real-valued computations,
either; they are chosen to deﬁne the branch cuts in desirable ways for the complex
case.
</div>
</div>
<div class=defun>
<!--l. 1227--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-182020"></a><a 
 id="x82-182021r206"></a><b> atan</b>  <i>y</i> &#x0026;optional  <i>x</i>
<!--l. 1229--><p class="noindent" >An arc tangent is calculated and the result is returned in radians.
<!--l. 1232--><p class="indent" >   With two arguments <i>y</i> and <i>x</i>, neither argument may be complex. The result is
the arc tangent of the quantity <i>y/x</i>. The signs of <i>y</i> and <i>x</i> are used to derive
quadrant information; moreover, <i>x</i> may be zero provided <i>y</i> is not zero. The value
of <a 
href="#x82-182021r206">atan</a> is always between <span class="math"> − π</span> (exclusive) and <span class="math">π</span> (inclusive). The following table
details various special cases.
<div class="flushleft" 
>
<!--l. 1240--><p class="noindent" >
                                                                          

                                                                          
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" colspan="2">  <div class="multicolumn"  style="white-space:nowrap; text-align:center;">Condition</div>  </td><td align="left" >Cartesian Locus        </td><td align="left" >    Range of Result    </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = 0</span> </td><td align="left" ><span class="math"><i>x</i> &#x003E; 0</span></td><td align="left" >Positive <i>x</i>-axis          </td><td align="left" >             <span class="math">0</span>             </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003E; 0</span> </td><td align="left" ><span class="math"><i>x</i> &#x003E; 0</span></td><td align="left" >Quadrant I               </td><td align="left" >   <span class="math">0 &#x003C; result &#x003C; π∕2</span>   </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003E; 0</span> </td><td align="left" ><span class="math"><i>x</i> = 0</span></td><td align="left" >Positive <i>y</i>-axis          </td><td align="left" >            <span class="math">π∕2</span>            </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003E; 0</span> </td><td align="left" ><span class="math"><i>x</i> &#x003C; 0</span></td><td align="left" >Quadrant II              </td><td align="left" >   <span class="math">π∕2 &#x003C; result &#x003C; π</span>   </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = 0</span> </td><td align="left" ><span class="math"><i>x</i> &#x003C; 0</span></td><td align="left" >Negative <i>x</i>-axis         </td><td align="left" >             <span class="math">π</span>           </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003C; 0</span> </td><td align="left" ><span class="math"><i>x</i> &#x003C; 0</span></td><td align="left" >Quadrant III             </td><td align="left" ><span class="math"> − π &#x003C; result &#x003C; −π∕2</span></td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003C; 0</span> </td><td align="left" ><span class="math"><i>x</i> = 0</span></td><td align="left" >Negative <i>y</i>-axis         </td><td align="left" >          <span class="math"> − π∕2</span>          </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003C; 0</span> </td><td align="left" ><span class="math"><i>x</i> &#x003E; 0</span></td><td align="left" >Quadrant IV             </td><td align="left" > <span class="math"> − π∕2 &#x003C; result &#x003C; 0</span> </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = 0</span> </td><td align="left" ><span class="math"><i>x</i> = 0</span></td><td align="left" >Origin                     </td><td align="left" >           error           </td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr><td align="left" >  </td></tr></table>
</div></div>
<div class=new>
<!--l. 1258--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx82-182022"></a>to specify certain ﬂoating-point behavior when minus
zero is supported. When there is a minus zero, the preceding table must be
modiﬁed slightly:
<div class="flushleft" 
>
<!--l. 1263--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" colspan="2">    <div class="multicolumn"  style="white-space:nowrap; text-align:center;">Condition</div>    </td><td align="left" >Cartesian Locus              </td><td align="left" >    Range of Result    </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = +0</span> </td><td align="left" ><span class="math"><i>x</i> &#x003E; 0</span>  </td><td align="left" >Just above positive <i>x</i>-axis </td><td align="left" >           <span class="math"> + 0</span>           </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003E; 0</span>   </td><td align="left" ><span class="math"><i>x</i> &#x003E; 0</span>  </td><td align="left" >Quadrant I                    </td><td align="left" > <span class="math"> + 0 &#x003C; result &#x003C; π∕2</span> </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003E; 0</span>   </td><td align="left" ><span class="math"><i>x</i> = ±0</span></td><td align="left" >Positive <i>y</i>-axis                </td><td align="left" >            <span class="math">π∕2</span>            </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003E; 0</span>   </td><td align="left" ><span class="math"><i>x</i> &#x003C; 0</span>  </td><td align="left" >Quadrant II                   </td><td align="left" >   <span class="math">π∕2 &#x003C; result &#x003C; π</span>   </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = +0</span> </td><td align="left" ><span class="math"><i>x</i> &#x003C; 0</span>  </td><td align="left" >Just below negative <i>x</i>-axis</td><td align="left" >             <span class="math">π</span>           </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = −0</span> </td><td align="left" ><span class="math"><i>x</i> &#x003C; 0</span>  </td><td align="left" >Just above negative <i>x</i>-axis</td><td align="left" >             <span class="math">π</span>           </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003C; 0</span>   </td><td align="left" ><span class="math"><i>x</i> &#x003C; 0</span>  </td><td align="left" >Quadrant III                  </td><td align="left" ><span class="math"> − π &#x003C; result &#x003C; −π∕2</span></td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003C; 0</span>   </td><td align="left" ><span class="math"><i>x</i> = ±0</span></td><td align="left" >Negative <i>y</i>-axis              </td><td align="left" >          <span class="math"> − π∕2</span>          </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> &#x003C; 0</span>   </td><td align="left" ><span class="math"><i>x</i> &#x003E; 0</span>  </td><td align="left" >Quadrant IV                  </td><td align="left" ><span class="math"> − π∕2 &#x003C; result &#x003C; −0</span></td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = −0</span> </td><td align="left" ><span class="math"><i>x</i> &#x003E; 0</span>  </td><td align="left" >Just below positive <i>x</i>-axis </td><td align="left" >           <span class="math"> − 0</span>           </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = +0</span> </td><td align="left" ><span class="math"><i>x</i> = +0</span></td><td align="left" >Near origin                    </td><td align="left" >           <span class="math"> + 0</span>           </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = −0</span> </td><td align="left" ><span class="math"><i>x</i> = +0</span></td><td align="left" >Near origin                    </td><td align="left" >           <span class="math"> − 0</span>           </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = +0</span> </td><td align="left" ><span class="math"><i>x</i> = −0</span></td><td align="left" >Near origin                    </td><td align="left" >             <span class="math">π</span>           </td>
</tr><tr><td align="left" ><span class="math"><i>y</i> = −0</span> </td><td align="left" ><span class="math"><i>x</i> = −0</span></td><td align="left" >Near origin                    </td><td align="left" >           <span class="math"> − π</span>          </td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr><td align="left" >  </td></tr></table>
</div></div>
<!--l. 1286--><p class="indent" >   Note that the case <span class="math"><i>y</i> = 0,<i>x</i> = 0</span> is an error in the absence of minus zero,
but the four cases <span class="math"><i>y</i> = ±0,<i>x</i> = ±0</span> are deﬁned in the presence of minus
zero.
</div>
<div class=obsolete>
<!--l. 1291--><p class="indent" >   With only one argument <i>y</i>, the argument may be complex. The result is
the arc tangent of <i>y</i>, which may be deﬁned by the following formula:
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Arc tangent               </td><td  
class="tabbing"><span class="math"> −<i>i</i> log <img 
src="clm11x.png" alt="(       ∘ --------2-)
 (1 + iy)  1∕(1 + y )"  class="left" align="middle"></span>
</td></tr></table>
<!--l. 1297--><p class="indent" >
</div>
</div>
<!--l. 1300--><p class="indent" >
                                                                          

                                                                          
<div class=implementation>
<!--l. 1303--><p class="noindent" ><b>Implementation note:</b> This formula is mathematically correct, assuming completely
accurate computation. It may be a terrible method for ﬂoating-point computation.
Implementors should consult a good text on numerical analysis. The formula
given above is not necessarily the simplest one for real-valued computations,
either; it is chosen to deﬁne the branch cuts in desirable ways for the complex
case.
</div>
<div class=new>
<!--l. 1314--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx82-182023"></a>to replace the preceding formula with the
formula <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Arc tangent               </td><td  
class="tabbing"><span class="math">log(1 + <i>i</i><i>y</i>) − log(1 −<i>i</i><i>y</i>)
              2<i>i</i>              </span>
</td></tr></table>
<!--l. 1320--><p class="indent" >
</div>
<!--l. 1321--><p class="noindent" >This change alters the direction of continuity for the branch cuts, which
alters the result returned by <a 
href="#x82-182021r206">atan</a> only for arguments on the imaginary
axis that are of magnitude greater than 1. See section <a 
href="#x82-18300012.5.3">12.5.3<!--tex4ht:ref: BRANCH-CUTS-SECTION --></a> for further
details.
</div>
<!--l. 1328--><p class="indent" >   For a non-complex argument <i>y</i>, the result is non-complex and lies between
<span class="math"> − π∕2</span> and <span class="math">π∕2</span> (both exclusive).
<div class=incompatibility>
<!--l. 1332--><p class="noindent" ><b>Compatibility note:</b> MacLisp has a function called <a 
href="#x82-182021r206">atan</a> whose range is from 0 to <span class="math">2π</span>.
Almost every other programming language (ANSI Fortran, IBM PL/1, Interlisp) has a
two-argument arc tangent function with range <span class="math"> −π</span> to <span class="math">π</span>. Lisp Machine Lisp provides two
two-argument arc tangent functions, <a 
href="#x82-182021r206">atan</a> (compatible with MacLisp) and atan2
(compatible with all others).
<!--l. 1341--><p class="indent" >   Common Lisp makes two-argument <a 
href="#x82-182021r206">atan</a> the standard one with range <span class="math"> − π</span>
to <span class="math">π</span>. Observe that this makes the one-argument and two-argument versions
of <a 
href="#x82-182021r206">atan</a> compatible in the sense that the branch cuts do not fall in diﬀerent
places. The Interlisp one-argument function arctan has a range from 0 to <span class="math">π</span>,
while nearly every other programming language provides the range <span class="math"> − π∕2</span>
to <span class="math">π∕2</span> for one-argument arc tangent! Nevertheless, since Interlisp uses the
standard two-argument version of arc tangent, its branch cuts are inconsistent
anyway.
</div>
                                                                          

                                                                          
</div>
<div class=defun>
<!--l. 1355--><p class="noindent" ><i>[Constant]</i><a 
 id="dx82-182024"></a><a 
 id="x82-182025r207"></a><b> pi</b>
<!--l. 1357--><p class="noindent" >This global variable has as its value the best possible approximation to <span class="math">π</span> in <i>long</i>
ﬂoating-point format. For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun sind (x)     ;The argument is in degrees
</td></tr></table>
<!--l. 1362--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (sin (* x (/ (ﬂoat pi x) 180))))</td></tr></table>
<!--l. 1364--><p class="indent" >
</div>
</div>
<!--l. 1365--><p class="noindent" >An approximation to <span class="math">π</span> in some other precision can be obtained by writing (ﬂoat pi
<i>x</i>), where <i>x</i> is a ﬂoating-point number of the desired precision, or by
writing (coerce pi <i>type</i>), where <i>type</i> is the name of the desired type, such as
short-ﬂoat.
</div>
                                                                          

                                                                          
<div class=defun>
<!--l. 1374--><p class="noindent" ><i>[Function]</i><a 
 id="dx82-182026"></a><a 
 id="x82-182027r208"></a><b> sinh</b>  <i>number</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx82-182028"></a><a 
 id="x82-182029r209"></a><b> cosh</b>  <i>number</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx82-182030"></a><a 
 id="x82-182031r210"></a><b> tanh</b>  <i>number</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx82-182032"></a><a 
 id="x82-182033r211"></a><b> asinh</b>  <i>number</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx82-182034"></a><a 
 id="x82-182035r212"></a><b> acosh</b>  <i>number</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx82-182036"></a><a 
 id="x82-182037r213"></a><b> atanh</b>  <i>number</i>
<!--l. 1381--><p class="noindent" ><div class=obsolete>These functions compute the hyperbolic sine, cosine, tangent, arc sine, arc cosine,
and arc tangent functions, which are mathematically deﬁned for an argument <i>z</i> as
follows:
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Hyperbolic sine          </td><td  
class="tabbing"><span class="math">(<i>e</i><sup>z</sup> −<i>e</i><sup>−z</sup>)∕2</span>
</td></tr></table>
<!--l. 1389--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Hyperbolic cosine       </td><td  
class="tabbing"><span class="math">(<i>e</i><sup>z</sup> + <i>e</i><sup>−z</sup>)∕2</span></td></tr></table>
<!--l. 1390--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Hyperbolic tangent     </td><td  
class="tabbing"><span class="math">(<i>e</i><sup>z</sup> −<i>e</i><sup>−z</sup>)∕(<i>e</i><sup>z</sup> + <i>e</i><sup>−z</sup>)</span></td></tr></table>
<!--l. 1391--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Hyperbolic arc sine     </td><td  
class="tabbing"><span class="math"> log <img 
src="clm12x.png" alt="(    √ -----2)
 z +   1 + z"  class="left" align="middle"></span>
</td></tr></table>
<!--l. 1392--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Hyperbolic arc cosine  </td><td  
class="tabbing"><span class="math"> log <img 
src="clm13x.png" alt="(          ∘ ---------------)
 z + (z + 1 ) (z − 1)∕(z + 1)"  class="left" align="middle"></span>
</td></tr></table>
<!--l. 1393--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:178;" 
class="tabbing">Hyperbolic arc tangent</td><td style="width:226;" 
class="tabbing"><span class="math"> log <img 
src="clm14x.png" alt="(       ∘ --------)
 (1 + z)  1 − 1∕z2"  class="left" align="middle"></span></td><td  
class="tabbing-right">                 WRONG!
</td></tr></table>
<!--l. 1395--><p class="indent" >
</div>
</div>
<div class=newer>
<!--l. 1399--><p class="indent" >   WARNING! <i>The formula shown above for hyperbolic arc tangent is
incorrect.</i> It is not a matter of incorrect branch cuts; it simply does not
compute anything like a hyperbolic arc tangent. This unfortunate error in the
ﬁrst edition was the result of mistranscribing a (correct) APL formula
from Penﬁeld&#x2019;s paper <span class="cite">[<a 
href="clmli5.html#XAPL-BRANCH-CUTS">36</a>]</span>. The formula should have been transcribed as
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:180;" 
class="tabbing">Hyperbolic arc tangent</td><td  
class="tabbing"><span class="math"> log <img 
src="clm15x.png" alt="(       ∘ ---------)
 (1 + z)  1∕(1 − z2)"  class="left" align="middle"></span>
</td></tr></table>
<!--l. 1407--><p class="indent" >
                                                                          

                                                                          
</div>
<!--l. 1408--><p class="noindent" >A proposal was submitted to X3J13 in September 1989 to replace the formulae for
<a 
href="#x82-182035r212">acosh</a> and <a 
href="#x82-182037r213">atanh</a>. See section <a 
href="#x82-18300012.5.3">12.5.3<!--tex4ht:ref: BRANCH-CUTS-SECTION --></a> for further discussion.
</div>
<!--l. 1413--><p class="indent" >   Note that the result of <a 
href="#x82-182035r212">acosh</a> may be complex even if the argument is not
complex; this occurs when the argument is less than 1. Also, the result of <a 
href="#x82-182037r213">atanh</a>
may be complex even if the argument is not complex; this occurs when the
absolute value of the argument is greater than 1.
<div class=implementation>
<!--l. 1421--><p class="noindent" ><b>Implementation note:</b> These formulae are mathematically correct, assuming
completely accurate computation. They may be terrible methods for ﬂoating-point
computation. Implementors should consult a good text on numerical analysis. The
formulae given above are not necessarily the simplest ones for real-valued computations,
either; they are chosen to deﬁne the branch cuts in desirable ways for the complex
case.
</div>
</div>
   <h4 class="subsectionHead"><span class="titlemark">12.5.3   </span> <a 
 id="x82-18300012.5.3"></a>Branch Cuts, Principal Values, and Boundary Conditions in the
Complex Plane</h4>
<!--l. 1437--><p class="noindent" >Many of the irrational and transcendental functions are multiply deﬁned in the
complex domain; for example, there are in general an inﬁnite number of complex
values for the logarithm function. In each such case, a principal value must
be chosen for the function to return. In general, such values cannot be
chosen so as to make the range continuous; lines in the domain called
<i>branch cuts</i> must be deﬁned, which in turn deﬁne the discontinuities in the
range.
<!--l. 1446--><p class="indent" >   Common Lisp deﬁnes the branch cuts, principal values, and boundary
conditions for the complex functions following a proposal for complex functions in
APL <span class="cite">[<a 
href="clmli5.html#XAPL-BRANCH-CUTS">36</a>]</span>. The contents of this section are borrowed largely from that
proposal.
<div class=incompatibility>
<!--l. 1452--><p class="noindent" ><b>Compatibility note:</b> The branch cuts deﬁned here diﬀer in a few very minor respects
from those advanced by W. Kahan, who considers not only the “usual” deﬁnitions but
also the special modiﬁcations necessary for IEEE proposed ﬂoating-point arithmetic,
which has inﬁnities and minus zero as explicit computational objects. For example, he
proposes that <span class="math"><img 
src="clm16x.png" alt="√ -------
  − 4+ 0i"  class="sqrt" > = 2<i>i</i></span>, but <span class="math"><img 
src="clm17x.png" alt="√ -------
  − 4− 0i"  class="sqrt" > = −2<i>i</i></span>.
                                                                          

                                                                          
<!--l. 1460--><p class="indent" >   It may be that the diﬀerences between the APL proposal and Kahan&#x2019;s proposal will
be ironed out. If so, Common Lisp may be changed as necessary to be compatible with
these other groups. Any changes from the speciﬁcation below are likely to be quite
minor, probably concerning primarily questions of which side of a branch cut is
continuous with the cut itself.
</div>
<div class=new>
<!--l. 1470--><p class="indent" >   Indeed, X3J13 voted in January 1989 <a 
 id="dx82-183001"></a>to alter the direction of continuity for
the branch cuts of <a 
href="#x82-182021r206">atan</a>, and also <a 
 id="dx82-183002"></a>to address the treatment of branch cuts in
implementations that have a distinct ﬂoating-point minus zero.
<!--l. 1478--><p class="indent" >   The treatment of minus zero centers in two-argument <a 
href="#x82-182021r206">atan</a>. If there is no
minus zero, then the branch cut runs just below the negative real axis as before,
and the range of two-argument <a 
href="#x82-182021r206">atan</a> is <span class="math">(−π,π]</span>. If there is a minus zero, however,
then the branch cut runs precisely on the negative real axis, skittering between
pairs of numbers of the form <span class="math"> −<i>x</i> ± 0<i>i</i></span>, and the range of two-argument <a 
href="#x82-182021r206">atan</a> is
<span class="math">[−π,π]</span>.
<!--l. 1485--><p class="indent" >   The treatment of minus zero by all other irrational and transcendental
functions is then speciﬁed by deﬁning those functions in terms of two-argument
<a 
href="#x82-182021r206">atan</a>. First, <a 
href="#x82-182004r198">phase</a> is deﬁned in terms of two-argument <a 
href="#x82-182021r206">atan</a>, and complex <a 
href="#x82-182002r197">abs</a> in
terms of real <a 
href="#x82-181011r195">sqrt</a>; then complex <a 
href="#x82-181008r194">log</a> is deﬁned in terms of <a 
href="#x82-182004r198">phase</a>, <a 
href="#x82-182002r197">abs</a>, and real <a 
href="#x82-181008r194">log</a>;
then complex <a 
href="#x82-181011r195">sqrt</a> in terms of complex <a 
href="#x82-181008r194">log</a>; and ﬁnally all others are deﬁned in
terms of these.
<!--l. 1493--><p class="indent" >   Kahan <span class="cite">[<a 
href="clmli5.html#XKAHAN-COMPLEX-FNS">25</a>]</span> treats these matters in some detail and also suggests speciﬁc
algorithms for implementing irrational and transcendental functions in IEEE
standard ﬂoating-point arithmetic <span class="cite">[<a 
href="clmli5.html#XIEEE-PROPOSED-FLOATING-POINT-STANDARD">23</a>]</span>.
<!--l. 1497--><p class="indent" >   Remarks in the ﬁrst edition about the direction of the continuity of branch
cuts continue to hold in the absence of minus zero and may be ignored if minus
zero is supported; since all branch cuts happen to run along the principal axes,
they run <i>between</i> plus zero and minus zero, and so each sort of zero is associated
with the obvious quadrant.
</div>
<div class=flushdesc>
<!--l. 1505--><p class="indent" >
      <ul><li><b>
 <a 
href="#x82-181011r195">sqrt</a> </b></li>The  branch  cut  for  square  root  lies  along  the  negative  real  axis,
      continuous with quadrant II. The range consists of the right half-plane,
      including the non-negative imaginary axis and excluding the negative
                                                                          

                                                                          
      imaginary axis.
<div class=new>
      <!--l. 1512--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx82-183003"></a>to specify certain ﬂoating-point behavior when
      minus zero is supported. As a part of that vote it approved a mathematical
      deﬁnition of complex square root: <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"><img 
src="clm18x.png" alt="√ -
  z"  class="sqrt" > = <i>e</i><sup>(log z)∕2
           </sup></span>
</td></tr></table>
      <!--l. 1518--><p class="noindent" >
</div>
      <!--l. 1519--><p class="noindent" >This deﬁnes the branch cuts precisely, whether minus zero is supported or
      not.
      </div>
      <li><b>
<a 
href="#x82-182004r198">phase</a> </b></li>The branch cut for the phase function lies along the negative real axis,
      continuous with quadrant II. The range consists of that portion of the real
      axis between <span class="math"> − π</span> (exclusive) and <span class="math">π</span> (inclusive).
<div class=new>
      <!--l. 1528--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx82-183004"></a>to specify certain ﬂoating-point behavior when
      minus zero is supported. As a part of that vote it approved a mathematical
      deﬁnition of phase: <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> phase <i>z</i> = arctan(ℑ<i>z</i>,ℜ<i>z</i>)</span>
</td></tr></table>
      <!--l. 1534--><p class="noindent" >
</div>
      <!--l. 1535--><p class="noindent" >where <span class="math">ℑ<i>z</i></span> is the imaginary part of <span class="math"><i>z</i></span> and <span class="math">ℜ<i>z</i></span> the real part of <span class="math"><i>z</i></span>. This
      deﬁnes the branch cuts precisely, whether minus zero is supported or
      not.
      </div>
                                                                          

                                                                          
      <li><b>
  <a 
href="#x82-181008r194">log</a> </b></li>The branch cut for the logarithm function of one argument (natural
      logarithm) lies along the negative real axis, continuous with quadrant II.
      The domain excludes the origin. For a complex number <span class="math"><i>z</i></span>, <span class="math"> log <i>z</i></span> is deﬁned to
      be <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> log <i>z</i> = <img 
src="clm19x.png" alt="(log |z|)"  class="left" align="middle"> + <i>i</i>(phase <i>z</i>)</span>
</td></tr></table>
      <!--l. 1546--><p class="noindent" >
</div>
      <!--l. 1547--><p class="noindent" >Therefore the range of the one-argument logarithm function is that strip of
      the complex plane containing numbers with imaginary parts between <span class="math"> − π</span>
      (exclusive) and <span class="math">π</span> (inclusive).
<div class=new>
      <!--l. 1552--><p class="noindent" >The X3J13 vote on minus zero <a 
 id="dx82-183005"></a>would alter that exclusive bound of <span class="math"> − π</span> to
      be inclusive if minus zero is supported.
      </div>
      <!--l. 1557--><p class="noindent" >The two-argument logarithm function is deﬁned as <span class="math"> log <sub>b</sub><i>z</i> = (log <i>z</i>)∕(log <i>b</i>)</span>.
      This deﬁnes the principal values precisely. The range of the two-argument
      logarithm function is the entire complex plane. It is an error if <span class="math"><i>z</i></span> is
      zero. If <span class="math"><i>z</i></span> is non-zero and <span class="math"><i>b</i></span> is zero, the logarithm is taken to be
      zero.
      <li><b>
 <a 
href="#x82-181002r192">exp</a> </b></li>The simple exponential function has no branch cut.
      <li><b>
<a 
href="#x82-181004r193">expt</a> </b></li>The two-argument exponential function is deﬁned as <span class="math"><i>b</i><sup>x</sup> = <i>e</i><sup>x log b</sup></span>. This
      deﬁnes the principal values precisely. The range of the two-argument
      exponential function is the entire complex plane. Regarded as a
      function of <span class="math"><i>x</i></span>, with <span class="math"><i>b</i></span> ﬁxed, there is no branch cut. Regarded as a
      function of <i>b</i>, with <span class="math"><i>x</i></span> ﬁxed, there is in general a branch cut along the
      negative real axis, continuous with quadrant II. The domain excludes
      the origin. By deﬁnition, <span class="math">0<sup>0</sup> = 1</span>. If <span class="math"><i>b</i> = 0</span> and the real part of <span class="math"><i>x</i></span>
      is strictly positive, then <span class="math"><i>b</i><sup>x</sup> = 0</span>. For all other values of <span class="math"><i>x</i></span>, <span class="math">0<sup>x</sup></span> is an
      error.
                                                                          

                                                                          
      <li><b>
 <a 
href="#x82-182017r204">asin</a> </b></li>The following deﬁnition for arc sine determines the range and branch cuts:
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arcsin <i>z</i> = −<i>i</i> log <img 
src="clm20x.png" alt="(    √ -----2)
 iz +  1 − z"  class="left" align="middle"></span>
</td></tr></table>
      <!--l. 1585--><p class="noindent" >
</div>
<div class=newer>
      <!--l. 1587--><p class="noindent" >This is equivalent to the formula <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arcsin <i>z</i> = arcsinh <i>i</i><i>z</i> 
     <i>i</i>     </span>
</td></tr></table>
      <!--l. 1591--><p class="noindent" >
</div>
      <!--l. 1592--><p class="noindent" >recommended by Kahan <span class="cite">[<a 
href="clmli5.html#XKAHAN-COMPLEX-FNS">25</a>]</span>.
      </div>
      <!--l. 1595--><p class="noindent" >The branch cut for the arc sine function is in two pieces: one along the
      negative real axis to the left of <span class="math"> − 1</span> (inclusive), continuous with quadrant II,
      and one along the positive real axis to the right of 1 (inclusive),
      continuous with quadrant IV. The range is that strip of the complex
      plane containing numbers whose real part is between <span class="math"> − π∕2</span> and
      <span class="math">π∕2</span>. A number with real part equal to <span class="math"> − π∕2</span> is in the range if
      and only if its imaginary part is non-negative; a number with real
      part equal to <span class="math">π∕2</span> is in the range if and only if its imaginary part is
      non-positive.
      <li><b>
<a 
href="#x82-182019r205">acos</a> </b></li>The following deﬁnition for arc cosine determines the range and branch cuts:
      <div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arccos <i>z</i> = −<i>i</i> log <img 
src="clm21x.png" alt="(     √------)
 z + i 1 − z2"  class="left" align="middle"></span>
</td></tr></table>
      <!--l. 1610--><p class="noindent" >
</div>
      <!--l. 1611--><p class="noindent" >or, which is equivalent, <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arccos <i>z</i> = π 
2  − arcsin <i>z</i></span></td></tr></table>
      <!--l. 1614--><p class="noindent" >
</div>
      <!--l. 1615--><p class="noindent" >The branch cut for the arc cosine function is in two pieces: one along the
      negative real axis to the left of <span class="math"> − 1</span> (inclusive), continuous with quadrant II,
      and one along the positive real axis to the right of 1 (inclusive), continuous
      with quadrant IV. This is the same branch cut as for arc sine. The range is
      that strip of the complex plane containing numbers whose real part is
      between zero and <span class="math">π</span>. A number with real part equal to zero is in the range if
      and only if its imaginary part is non-negative; a number with real
      part equal to <span class="math">π</span> is in the range if and only if its imaginary part is
      non-positive.
      <li><b>
<a 
href="#x82-182021r206">atan</a> </b></li>The following deﬁnition for (one-argument) arc tangent determines the range and branch
      cuts: <div class=obsolete> <div class=tabbing>
         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arctan <i>z</i> = −<i>i</i> log <img 
src="clm22x.png" alt="(       ∘ ----------)
 (1 + iz)  1∕(1 + z2)"  class="left" align="middle"></span> </td></tr></table>
<!--l. 1633--><p class="noindent" >
</div>
      <!--l. 1636--><p class="noindent" >Beware of simplifying this formula; “obvious” simpliﬁcations are likely to
      alter the branch cuts or the values on the branch cuts incorrectly.
                                                                          

                                                                          
      <!--l. 1639--><p class="noindent" >The branch cut for the arc tangent function is in two pieces: one along
      the positive imaginary axis above <i>i</i> (exclusive), continuous with
      quadrant II, and one along the negative imaginary axis below <span class="math"> −<i>i</i></span>
      (exclusive), continuous with quadrant IV. The points <i>i</i> and <span class="math"> −<i>i</i></span> are
      excluded from the domain. The range is that strip of the complex plane
      containing numbers whose real part is between <span class="math"> − π∕2</span> and <span class="math">π∕2</span>. A
      number with real part equal to <span class="math"> − π∕2</span> is in the range if and only if its
      imaginary part is strictly positive; a number with real part equal
      to <span class="math">π∕2</span> is in the range if and only if its imaginary part is strictly
      negative. Thus the range of the arc tangent function is identical
      to that of the arc sine function with the points <span class="math"> − π∕2</span> and <span class="math">π∕2</span>
      excluded.
      </div>
<div class=new>
      <!--l. 1654--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx82-183006"></a>to replace the formula shown above with the
      formula <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arctan <i>z</i> = log(1 + <i>i</i><i>z</i>) − log(1 −<i>i</i><i>z</i>) 
              2<i>i</i>              </span>
</td></tr></table>
      <!--l. 1659--><p class="noindent" >
</div>
      <!--l. 1660--><p class="noindent" >This is equivalent to the formula <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arctan <i>z</i> = arctanh <i>i</i><i>z</i> 
     <i>i</i>      </span>
</td></tr></table>
      <!--l. 1663--><p class="noindent" >
</div>
      <!--l. 1664--><p class="noindent" >recommended by Kahan <span class="cite">[<a 
href="clmli5.html#XKAHAN-COMPLEX-FNS">25</a>]</span>. It causes the upper branch cut to be
      continuous with quadrant I rather than quadrant II, and the lower branch
      cut to be continuous with quadrant III rather than quadrant IV; otherwise
      it agrees with the formula of the ﬁrst edition. Therefore this change alters
      the result returned by <a 
href="#x82-182021r206">atan</a> only for arguments on the positive imaginary
                                                                          

                                                                          
      axis that are of magnitude greater than 1. The full description for this new
      formula is as follows.
      <!--l. 1672--><p class="noindent" >The branch cut for the arc tangent function is in two pieces: one along the
      positive imaginary axis above <i>i</i> (exclusive), continuous with quadrant I, and
      one along the negative imaginary axis below <span class="math"> −<i>i</i></span> (exclusive), continuous
      with quadrant III. The points <i>i</i> and <span class="math"> −<i>i</i></span> are excluded from the domain. The
      range is that strip of the complex plane containing numbers whose real
      part is between <span class="math"> − π∕2</span> and <span class="math">π∕2</span>. A number with real part equal to
      <span class="math"> − π∕2</span> is in the range if and only if its imaginary part is strictly
      negative; a number with real part equal to <span class="math">π∕2</span> is in the range if
      and only if its imaginary part is strictly positive. Thus the range
      of the arc tangent function is <i>not</i> identical to that of the arc sine
      function.
      </div>
      <li><b>
<a 
href="#x82-182033r211">asinh</a> </b></li>The following deﬁnition for the inverse hyperbolic sine determines the range
      and branch cuts: <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arcsinh <i>z</i> = log <img 
src="clm23x.png" alt="(    √ ------)
 z +   1 + z2"  class="left" align="middle"></span>
</td></tr></table>
      <!--l. 1690--><p class="noindent" >
</div>
      <!--l. 1691--><p class="noindent" >The branch cut for the inverse hyperbolic sine function is in two pieces: one
      along the positive imaginary axis above <i>i</i> (inclusive), continuous with
      quadrant I, and one along the negative imaginary axis below <span class="math"> −<i>i</i></span> (inclusive),
      continuous with quadrant III. The range is that strip of the complex
      plane containing numbers whose imaginary part is between <span class="math"> − π∕2</span>
      and <span class="math">π∕2</span>. A number with imaginary part equal to <span class="math"> − π∕2</span> is in the
      range if and only if its real part is non-positive; a number with
      imaginary part equal to <span class="math">π∕2</span> is in the range if and only if its real part is
      non-negative.
      <li><b>
<a 
href="#x82-182035r212">acosh</a> </b></li>The following deﬁnition for the inverse hyperbolic cosine determines the
      range and branch cuts: <div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arccosh <i>z</i> = log <img 
src="clm24x.png" alt="              ---------------
(           ∘               )
  z + (z + 1) (z − 1)∕(z + 1)"  class="left" align="middle"></span>
</td></tr></table>
      <!--l. 1706--><p class="noindent" >
</div>
<div class=newer>
      <!--l. 1709--><p class="noindent" >Kahan <span class="cite">[<a 
href="clmli5.html#XKAHAN-COMPLEX-FNS">25</a>]</span> suggests the formula <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arccosh <i>z</i> = 2 log <img 
src="clm25x.png" alt="(∘ ---------  ∘ ---------)
   (z + 1 )∕2 +  (z − 1)∕2"  class="left" align="middle"></span>
</td></tr></table>
      <!--l. 1712--><p class="noindent" >
</div>
      <!--l. 1713--><p class="noindent" >pointing out that it yields the same principal value but eliminates a
      gratuitous removable singularity at <span class="math"><i>z</i> = −1</span>. A proposal was submitted to
      X3J13 in September 1989 to replace the formula <a 
href="#x82-182035r212">acosh</a> with that
      recommended by Kahan. There is a good possibility that it will be
      adopted.
      </div>
      <!--l. 1720--><p class="noindent" >The branch cut for the inverse hyperbolic cosine function lies along the real
      axis to the left of 1 (inclusive), extending indeﬁnitely along the negative real
      axis, continuous with quadrant II and (between 0 and 1) with quadrant I.
      The range is that half-strip of the complex plane containing numbers whose
      real part is non-negative and whose imaginary part is between <span class="math"> − π</span>
      (exclusive) and <span class="math">π</span> (inclusive). A number with real part zero is in
      the range if its imaginary part is between zero (inclusive) and <span class="math">π</span>
      (inclusive).
      <li><b>
<a 
href="#x82-182037r213">atanh</a> </b></li>The following deﬁnition for the inverse hyperbolic tangent determines the range and
                                                                          

                                                                          
      branch cuts: <div class=obsolete> <div class=tabbing>
         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:271;" 
class="tabbing"></td><td style="width:269;" 
class="tabbing"><span class="math"> arctanh <i>z</i> = log <img 
src="clm26x.png" alt="(       ∘ --------)
 (1 + z)  1 − 1∕z2"  class="left" align="middle"></span></td><td  
class="tabbing-right">                 WRONG! </td></tr></table>
<!--l. 1737--><p class="noindent" >
</div></div>
<div class=newer>
      <!--l. 1742--><p class="noindent" >WARNING! <i>The formula shown above for hyperbolic arc tangent is
      incorrect.</i> It is not a matter of incorrect branch cuts; it simply does not
      compute anything like a hyperbolic arc tangent. This unfortunate error in
      the ﬁrst edition was the result of mistranscribing a (correct) APL formula
      from Penﬁeld&#x2019;s paper <span class="cite">[<a 
href="clmli5.html#XAPL-BRANCH-CUTS">36</a>]</span>. The formula should have been transcribed as
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arctanh <i>z</i> = log <img 
src="clm27x.png" alt="(      ∘ ----------)
 (1 + z)  1∕(1 − z2)"  class="left" align="middle"></span>
</td></tr></table>
      <!--l. 1749--><p class="noindent" >
</div>
</div>
<div class=obsolete>
      <!--l. 1753--><p class="noindent" >Beware of simplifying this formula; “obvious” simpliﬁcations are likely to
      alter the branch cuts or the values on the branch cuts incorrectly.
      <!--l. 1757--><p class="noindent" >The branch cut for the inverse hyperbolic tangent function is in two pieces:
      one along the negative real axis to the left of <span class="math"> − 1</span> (inclusive), continuous
      with quadrant III, and one along the positive real axis to the right of 1
      (inclusive), continuous with quadrant I. The points <span class="math"> − 1</span> and 1 are excluded
      from the domain. The range is that strip of the complex plane containing
      numbers whose imaginary part is between <span class="math"> − π∕2</span> and <span class="math">π∕2</span>. A number with
      imaginary part equal to <span class="math"> − π∕2</span> is in the range if and only if its real part is
      strictly negative; a number with imaginary part equal to <span class="math">π∕2</span> is in the range
      if and only if its real part is strictly positive. Thus the range of
                                                                          

                                                                          
      the inverse hyperbolic tangent function is identical to that of the
      inverse hyperbolic sine function with the points <span class="math"> − π<i>i</i>∕2</span> and <span class="math">π<i>i</i>∕2</span>
      excluded.
      </div>
<div class=newer>
      <!--l. 1775--><p class="noindent" >A proposal was submitted to X3J13 in September 1989 to replace the
      formula <a 
href="#x82-182037r213">atanh</a> with that recommended by Kahan <span class="cite">[<a 
href="clmli5.html#XKAHAN-COMPLEX-FNS">25</a>]</span>: <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"><span class="math"> arctanh <i>z</i> = <img 
src="clm28x.png" alt="(log(1 + z) − log (1 − z))"  class="left" align="middle"> 
               2                </span>
</td></tr></table>
      <!--l. 1779--><p class="noindent" >
</div>
      <!--l. 1780--><p class="noindent" >There is a good possibility that it will be adopted. If it is, the complete
      description of the branch cuts of <a 
href="#x82-182037r213">atanh</a> will then be as follows.
      <!--l. 1783--><p class="noindent" >The branch cut for the inverse hyperbolic tangent function is in two pieces:
      one along the negative real axis to the left of <span class="math"> − 1</span> (inclusive), continuous
      with quadrant II, and one along the positive real axis to the right of 1
      (inclusive), continuous with quadrant IV. The points <span class="math"> − 1</span> and 1 are
      excluded from the domain. The range is that strip of the complex
      plane containing numbers whose imaginary part is between <span class="math"> − π∕2</span>
      and <span class="math">π∕2</span>. A number with imaginary part equal to <span class="math"> − π∕2</span> is in the
      range if and only if its real part is strictly positive; a number with
      imaginary part equal to <span class="math">π∕2</span> is in the range if and only if its real
      part is strictly negative. Thus the range of the inverse hyperbolic
      tangent function is <i>not</i> the same as that of the inverse hyperbolic sine
      function.
      </div></ul>
</div>
<!--l. 1800--><p class="indent" >   With these deﬁnitions, the following useful identities are obeyed throughout
the applicable portion of the complex domain, even on the branch cuts:
<div class="flushleft" 
>
                                                                          

                                                                          
<!--l. 1805--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" ><span class="math"> sin <i>i</i><i>z</i> = <i>i</i> sinh <i>z</i></span>  </td><td align="left" ><span class="math"> sinh <i>i</i><i>z</i> = <i>i</i> sin <i>z</i></span>       </td><td align="left" ><span class="math"> arctan <i>i</i><i>z</i> = <i>i</i> arctanh <i>z</i></span></td></tr><tr><td align="left" ><span class="math"> cos <i> i </i> <i> z </i> = cosh <i> z </i> </span>  </td> <td align="left" ><span class="math"> cosh <i> i </i> <i> z </i> = cos <i> z </i> </span> </td> <td align="left" ><span class="math"> arcsinh <i> i </i> <i> z </i> = <i> i </i> arcsin <i> z </i> </span></td>
</tr><tr><td align="left" ><span class="math"> tan <i>i</i><i>z</i> = <i>i</i> tanh <i>z</i></span> </td><td align="left" ><span class="math"> arcsin <i>i</i><i>z</i> = <i>i</i> arcsinh <i>z</i></span></td><td align="left" ><span class="math"> arctanh <i>i</i><i>z</i> = <i>i</i> arctan <i>z</i></span></td></tr></table>
</div></div>
<div class=new>
<!--l. 1814--><p class="indent" >   I thought it would be useful to provide some graphs illustrating the behavior
of the irrational and transcendental functions in the complex plane. It also
provides an opportunity to show oﬀ the Common Lisp code that was used to
generate them.
<!--l. 1819--><p class="indent" >   Imagine the complex plane to be decorated as follows. The real and imaginary
axes are painted with thick lines. Parallels from the axes on both sides at
distances of 1, 2, and 3 are painted with thin lines; these parallels are doubly
inﬁnite lines, as are the axes. Four annuli (rings) are painted in gradated shades of
gray. Ring 1, the inner ring, consists of points whose radial distances
from the origin lie in the range <span class="math">[1∕4, 1∕2]</span>; ring 2 is in the radial range
<span class="math">[3∕4, 1]</span>; ring 3, in the range <span class="math">[π∕2, 2]</span>; and ring 4, in the range <span class="math">[3,π]</span>. Ring <i>j</i> is
divided into <span class="math">2<sup>j+1</sup></span> equal sectors, with each sector painted a diﬀerent shade of
gray, darkening as one proceeds counterclockwise from the positive real
axis.
<!--l. 1832--><p class="indent" >   We can illustrate the behavior of a numerical function <span class="math"><i>f</i></span> by considering how it
maps the complex plane to itself. More speciﬁcally, consider each point <span class="math"><i>z</i></span> of the
decorated plane. We decorate a new plane by coloring the point <span class="math"><i>f</i>(<i>z</i>)</span> with the same
color that point <span class="math"><i>z</i></span> had in the original decorated plane. In other words, the newly
decorated plane illustrates how the <span class="math"><i>f</i></span> maps the axes, other horizontal and vertical
lines, and annuli.
<!--l. 1839--><p class="indent" >   In each ﬁgure we will show only a fragment of the complex plane, with the real
axis horizontal in the usual manner (<span class="math"> −∞</span> to the left, <span class="math"> + ∞</span> to the right) and the
imaginary axis vertical (<span class="math"> −∞<i>i</i></span> below, <span class="math"> + ∞<i>i</i></span> above). Each fragment shows a region
containing points whose real and imaginary parts are in the range <span class="math">[−4.1, 4.1]</span>. The
axes of the new plane are shown as very thin lines, with large tick marks
at integer coordinates and somewhat smaller tick marks at multiples of
<span class="math">π∕2</span>.
<!--l. 1847--><p class="indent" >   Figure <a 
href="#x82-1830071">12.1<!--tex4ht:ref: IDENTITY-PLOT --></a> shows the result of plotting the <a 
href="clmse126.html#x156-309002r798">identity</a> function (quite literally);
the graph exhibits the decoration of the original plane.
<!--l. 1850--><p class="indent" >   Figures <a 
href="#x82-1830082">12.2<!--tex4ht:ref: SECOND-PLOT --></a> through <a 
href="#x82-18302620">12.20<!--tex4ht:ref: LAST-PLOT --></a> show the graphs for the functions <a 
href="#x82-181011r195">sqrt</a>, <a 
href="#x82-181002r192">exp</a>, <a 
href="#x82-181008r194">log</a>,
<a 
href="#x82-182009r200">sin</a>, <a 
href="#x82-182017r204">asin</a>, <a 
href="#x82-182011r201">cos</a>, <a 
href="#x82-182019r205">acos</a>, <a 
href="#x82-182013r202">tan</a>, <a 
href="#x82-182021r206">atan</a>, <a 
href="#x82-182027r208">sinh</a>, <a 
href="#x82-182033r211">asinh</a>, <a 
href="#x82-182029r209">cosh</a>, <a 
href="#x82-182035r212">acosh</a>, <a 
href="#x82-182031r210">tanh</a>, and <a 
href="#x82-182037r213">atanh</a>, and as a
bonus, the graphs for the functions <span class="math"><img 
src="clm29x.png" alt="√ ------
  1 − z2"  class="sqrt" ></span>, <span class="math"><img 
src="clm30x.png" alt="√ ------
  1 + z2"  class="sqrt" ></span>, <span class="math">(<i>z</i> − 1)∕(<i>z</i> + 1)</span>, and
<span class="math">(1 + <i>z</i>)∕(1 −<i>z</i>)</span>. All of these are related to the trigonometric functions in various
                                                                          

                                                                          
ways. For example, if <span class="math"><i>f</i>(<i>z</i>) = (<i>z</i> − 1)∕(<i>z</i> + 1)</span>, then <span class="math"> tanh <i>z</i> = <i>f</i>(<i>e</i><sup>2z</sup>)</span>, and if
<span class="math"><i>g</i>(<i>z</i>) = <img 
src="clm31x.png" alt="√ -----2
  1 − z"  class="sqrt" ></span>, then <span class="math"> cos <i>z</i> = <i>g</i>(sin <i>z</i>)</span>. It is instructive to examine the graph for
<span class="math"><img 
src="clm32x.png" alt="√ -----2
  1 − z"  class="sqrt" ></span> and try to visualize how it transforms the graph for <a 
href="#x82-182009r200">sin</a> into the graph
for <a 
href="#x82-182011r201">cos</a>.
<!--l. 1860--><p class="indent" >   Each ﬁgure is accompanied by a commentary on what maps to what and other
interesting features. None of this material is terribly new; much of it may be found
in any good textbook on complex analysis. I believe that the particular form
in which the graphs are presented is novel, as well as the fact that the
graphs have been generated as PostScript <span class="cite">[<a 
href="clmli5.html#XADOBE-POSTSCRIPT">1</a>]</span> code by Common Lisp code.
This PostScript code was then fed directly to the typesetting equipment
that set the pages for this book. Samples of this PostScript code follow
the ﬁgures themselves, after which the code for the entire program is
presented.
<!--l. 1871--><p class="indent" >   In the commentaries that accompany the ﬁgures I sometimes speak of mapping
the points <span class="math"> ±∞</span> or <span class="math"> ±∞i</span>. When I say that function <span class="math">f</span> maps <span class="math"> + ∞</span> to a certain
point <span class="math">z</span>, I mean that <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><span class="math">z = lim <sub>x→+∞</sub>f(x + 0 i)</span>
</td></tr></table>
<!--l. 1876--><p class="indent" >
</div>
<!--l. 1877--><p class="noindent" >Similarly, when I say that <span class="math">f</span> maps <span class="math"> −∞i</span> to <span class="math">z</span>, I mean that <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><span class="math">z = lim <sub>y→−∞</sub>f(0 + yi)</span>
</td></tr></table>
<!--l. 1881--><p class="indent" >
</div>
<!--l. 1882--><p class="noindent" >In other words, I am considering a limit as one travels out along one of the
main axes. I also speak in a similar manner of mapping <i>to</i> one of these
inﬁnities.
</div>
                                                                          

                                                                          
   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-1830071"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.1: </span><span  
class="content">Initial Decoration of the Complex Plane (Identity Function)</span></div><!--tex4ht:label?: x82-1830071 -->
<!--l. 1907--><p class="noindent" ><img 
src="identity-plot.png" alt="PIC"  
><br 
class="newline" />This ﬁgure was produced in exactly the same manner as succeeding ﬁgures, simply
by plotting the function <a 
href="clmse126.html#x156-309002r798">identity</a> instead of a numerical function. Thus the ﬁrst of
these ﬁgures was produced by the last function of the ﬁrst edition. I knew it would
come in handy someday!
                                                                          

                                                                          
   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 1919--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-1830082"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.2: </span><span  
class="content">Illustration of the Range of the Square Root Function</span></div><!--tex4ht:label?: x82-1830082 -->
<!--l. 1923--><p class="noindent" ><img 
src="sqrt-plot.png" alt="PIC"  
><br 
class="newline" />The <a 
href="#x82-181011r195">sqrt</a> function maps the complex plane into the right half of the plane by slitting
it along the negative real axis and then sweeping it around as if half-closing a
folding fan. The fan also shrinks, as if it were made of cotton and had gotten wetter
at the periphery than at the center. The positive real axis is mapped onto itself.
The negative real axis is mapped onto the positive imaginary axis (but if minus
zero is supported, then <span class="math"> −<i>x</i> + 0<i>i</i></span> is mapped onto the positive imaginary axis and
<span class="math">−<i>x</i>−0<i>i</i></span> onto the negative imaginary axis, assuming <span class="math"><i>x</i> &#x003E; 0</span>). The positive imaginary
axis is mapped onto the northeast diagonal, and the negative imaginary axis onto
the southeast diagonal. More generally, lines are mapped to rectangular hyperbolas
(or fragments thereof) centered on the origin; lines through the origin are mapped
to degenerate hyperbolas (perpendicular lines through the origin).
                                                                          

                                                                          
<!--l. 1940--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 1944--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-1830093"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.3: </span><span  
class="content">Illustration of the Range of the Exponential Function</span></div><!--tex4ht:label?: x82-1830093 -->
<!--l. 1947--><p class="noindent" ><img 
src="exp-plot.png" alt="PIC"  
><br 
class="newline" />The <a 
href="#x82-181002r192">exp</a> function maps horizontal lines to radii and maps vertical lines to circles
centered at the origin. The origin is mapped to 1. (It is instructive to compare
this graph with those of other functions that map the origin to 1, for example
<span class="math">(1 + <i>z</i>)∕(1 −<i>z</i>)</span>, <span class="math"> cos<i>z</i></span>, and <span class="math"><img 
src="clm33x.png" alt="√ ----2-
  1− z"  class="sqrt" ></span>.) The entire real axis is mapped to the positive
real axis, with <span class="math"> −∞</span> mapping to the origin and <span class="math"> + ∞</span> to itself. The imaginary axis
is mapped to the unit circle with inﬁnite multiplicity (period <span class="math">2π</span>); therefore the
mapping of the imaginary inﬁnities <span class="math">±∞<i>i</i></span> is indeterminate. It follows that the entire
left half-plane is mapped to the interior of the unit circle, and the right half-plane is
mapped to the exterior of the unit circle. A line at any angle other than horizontal
or vertical is mapped to a logarithmic spiral (but this is not illustrated here).
                                                                          

                                                                          
<!--l. 1963--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 1967--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-1830104"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.4: </span><span  
class="content">Illustration of the Range of the Natural Logarithm Function</span></div><!--tex4ht:label?: x82-1830104 -->
<!--l. 1970--><p class="noindent" ><img 
src="log-plot.png" alt="PIC"  
><br 
class="newline" />The  <a 
href="#x82-181008r194">log</a>  function,  which  is  the  inverse  of  <a 
href="#x82-181002r192">exp</a>,  naturally  maps  radial  lines  to
horizontal lines and circles centered at the origin to vertical lines. The interior of
the unit circle is thus mapped to the entire left half-plane, and the exterior of the
unit circle is mapped to the right half-plane. The positive real axis is mapped to
the entire real axis, and the negative real axis to a horizontal line of height <span class="math">π</span>.
The positive and negative imaginary axes are mapped to horizontal lines of height
<span class="math"> ± π∕2</span>. The origin is mapped to <span class="math"> −∞</span>.
                                                                          

                                                                          
<!--l. 1982--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 1986--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-1830115"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.5: </span><span  
class="content">Illustration of the Range of the Function <span class="math">(<i>z</i> − 1)∕(<i>z</i> + 1)</span></span></div><!--tex4ht:label?: x82-1830115 -->
<!--l. 1989--><p class="noindent" ><img 
src="minus-over-plus-plot.png" alt="PIC"  
><br 
class="newline" />A line is a degenerate circle with inﬁnite radius; when I say “circles” here I also
mean lines. Then <span class="math">(<i>z</i> − 1)∕(<i>z</i> + 1)</span> maps circles into circles. All circles through <span class="math"> − 1</span>
become lines; all lines become circles through <span class="math">1</span>. The real axis is mapped onto itself:
1 to the origin, the origin to <span class="math"> − 1</span>, <span class="math"> − 1</span> to inﬁnity, and inﬁnity to 1. The imaginary
axis becomes the unit circle; <i>i</i> is mapped to itself, as is <span class="math"> −<i>i</i></span>. Thus the entire right
half-plane is mapped to the interior of the unit circle, the unit circle interior to
the left half-plane, the left half-plane to the unit circle exterior, and the unit circle
exterior to the right half-plane. Imagine the complex plane to be a vast sea. The
Colossus of Rhodes straddles the origin, its left foot on <i>i</i> and its right foot on <span class="math">−<i>i</i></span>. It
bends down and brieﬂy paddles water between its legs so furiously that the water
directly beneath is pushed out into the entire area behind it; much that was behind
swirls forward to either side; and all that was before is sucked in to lie between its
feet.
                                                                          

                                                                          
<!--l. 2009--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2013--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-1830126"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.6: </span><span  
class="content">Illustration of the Range of the Function <span class="math">(1 + <i>z</i>)∕(1 −<i>z</i>)</span></span></div><!--tex4ht:label?: x82-1830126 -->
<!--l. 2016--><p class="noindent" ><img 
src="plus-over-minus-plot.png" alt="PIC"  
><br 
class="newline" />The function <span class="math"><i>h</i>(<i>z</i>) = (1 + <i>z</i>)∕(1 −<i>z</i>)</span> is the inverse of <span class="math"><i>f</i>(<i>z</i>) = (<i>z</i> − 1)∕(<i>z</i> + 1)</span>; that
is, <span class="math"><i>h</i>(<i>f</i>(<i>z</i>)) = <i>f</i>(<i>h</i>(<i>z</i>)) = <i>z</i></span>. At ﬁrst glance, the graph of <span class="math"><i>h</i></span> appears to be that of <span class="math"><i>f</i></span>
ﬂipped left-to-right, or perhaps reﬂected in the origin, but careful consideration
of the shaded annuli reveals that this is not so; something more subtle is going
on. Note that <span class="math"><i>f</i>(<i>f</i>(<i>z</i>))  =  <i>h</i>(<i>h</i>(<i>z</i>))  =  <i>g</i>(<i>z</i>)  =  −1∕<i>z</i></span>. The functions <span class="math"><i>f</i></span>, <span class="math"><i>g</i></span>, <span class="math"><i>h</i></span>, and the
identity function thus form a group under composition, isomorphic to the group of
the cyclic permutations of the points <span class="math"> − 1</span>, <span class="math">0</span>, <span class="math">1</span>, and <span class="math">∞</span>, as indeed these functions
accomplish the four possible cyclic permutations on those points. This function
group is a subset of the group of bilinear transformations <span class="math">(<i>a</i><i>z</i> + <i>b</i>)∕(<i>c</i><i>z</i> + <i>d</i>)</span>, all of
which are conformal (angle-preserving) and map circles onto circles. Now, doesn&#x2019;t
that tangle of circles through <span class="math"> − 1</span> look like something the cat got into?
                                                                          

                                                                          
<!--l. 2036--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2040--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-1830137"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.7: </span><span  
class="content">Illustration of the Range of the Sine Function</span></div><!--tex4ht:label?: x82-1830137 -->
<!--l. 2043--><p class="noindent" ><img 
src="sin-plot.png" alt="PIC"  
><br 
class="newline" />We are used to seeing <a 
href="#x82-182009r200">sin</a> looking like a wiggly ocean wave, graphed vertically as
a function of the real axis only. Here is a diﬀerent view. The entire real axis is
mapped to the segment <span class="math">[−1,1]</span> of the real axis with inﬁnite multiplicity (period <span class="math">2π</span>).
The imaginary axis is mapped to itself as if by <a 
href="#x82-182027r208">sinh</a> considered as a real function.
The origin is mapped to itself. Horizontal lines are mapped to ellipses with foci at
<span class="math">±1</span> (note that two horizontal lines equidistant from the real axis will map onto the
same ellipse). Vertical lines are mapped to hyperbolas with the same foci. There
is a curious accident: the ellipse for horizontal lines at distance <span class="math"> ± 1</span> from the real
axis appears to intercept the real axis at <span class="math"> ± π∕2 ≈±1.57…</span> but this is not so; the
intercepts are actually at <span class="math"> ± (<i>e</i> + 1∕<i>e</i>)∕2 ≈±1.54…</span>.
                                                                          

                                                                          
<!--l. 2058--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2062--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-1830148"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.8: </span><span  
class="content">Illustration of the Range of the Arc Sine Function</span></div><!--tex4ht:label?: x82-1830148 -->
<!--l. 2065--><p class="noindent" ><img 
src="asin-plot.png" alt="PIC"  
><br 
class="newline" />Just as <a 
href="#x82-182009r200">sin</a> grabs horizontal lines and bends them into elliptical loops around the
origin, so its inverse <a 
href="#x82-182017r204">asin</a> takes annuli and yanks them more or less horizontally
straight. Because sine is not injective, its inverse as a function cannot be surjective.
This is just a highfalutin way of saying that the range of the <a 
href="#x82-182017r204">asin</a> function doesn&#x2019;t
cover the entire plane but only a strip <span class="math">π</span> wide; arc sine as a one-to-many relation
would cover the plane with an inﬁnite number of copies of this strip side by side,
looking for all the world like the tail of a peacock with an inﬁnite number of
feathers. The imaginary axis is mapped to itself as if by <a 
href="#x82-182033r211">asinh</a> considered as a real
function. The real axis is mapped to a bent path, turning corners at <span class="math"> ± π∕2</span> (the
points to which <span class="math"> ± 1</span> are mapped); <span class="math"> + ∞</span> is mapped to <span class="math">π∕2 −∞<i>i</i></span>, and <span class="math"> −∞</span> to
<span class="math"> − π∕2 + ∞<i>i</i></span>.
                                                                          

                                                                          
<!--l. 2080--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2084--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-1830159"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.9: </span><span  
class="content">Illustration of the Range of the Cosine Function</span></div><!--tex4ht:label?: x82-1830159 -->
<!--l. 2087--><p class="noindent" ><img 
src="cos-plot.png" alt="PIC"  
><br 
class="newline" />We are used to seeing <a 
href="#x82-182011r201">cos</a> looking exactly like <a 
href="#x82-182009r200">sin</a>, a wiggly ocean wave, only
displaced. Indeed the complex mapping of <a 
href="#x82-182011r201">cos</a> is also similar to that of <a 
href="#x82-182009r200">sin</a>, with
horizontal and vertical lines mapping to the same ellipses and hyperbolas with foci
at <span class="math">±1</span>, although mapping to them in a diﬀerent manner, to be sure. The entire real
axis is again mapped to the segment <span class="math">[−1,1]</span> of the real axis, but each half of the
imaginary axis is mapped to the real axis to the right of 1 (as if by <a 
href="#x82-182029r209">cosh</a> considered
as a real function). Therefore <span class="math"> ±∞<i>i</i></span> both map to <span class="math"> + ∞</span>. The origin is mapped to 1.
Whereas <a 
href="#x82-182009r200">sin</a> is an odd function, <a 
href="#x82-182011r201">cos</a> is an even function; as a result <i>two</i> points in
each annulus, one the negative of the other, are mapped to the same shaded point
in this graph; the shading shown here is taken from points in the original upper
half-plane.
                                                                          

                                                                          
<!--l. 2103--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2107--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18301610"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.10: </span><span  
class="content">Illustration of the Range of the Arc Cosine Function</span></div><!--tex4ht:label?: x82-18301610 -->
<!--l. 2110--><p class="noindent" ><img 
src="acos-plot.png" alt="PIC"  
><br 
class="newline" />The graph of <a 
href="#x82-182019r205">acos</a> is very much like that of <a 
href="#x82-182017r204">asin</a>. One might think that our nervous
peacock has shuﬄed half a step to the right, but the shading on the annuli shows
that we have instead caught the bird exactly in mid-ﬂight while doing a cartwheel.
This is easily understood if we recall that <span class="math"> arccos<i>z</i> = (π∕2) − arcsin<i>z</i></span>; negating
<span class="math"> arcsin<i>z</i></span> rotates it upside down, and adding the result to <span class="math">π∕2</span> translates it <span class="math">π∕2</span> to
the right. The imaginary axis is mapped upside down to the vertical line at <span class="math">π∕2</span>.
The point <span class="math"> + 1</span> is mapped to the origin, and <span class="math"> − 1</span> to <span class="math">π</span>. The image of the real axis
is again cranky; <span class="math"> + ∞</span> is mapped to <span class="math"> + ∞<i>i</i></span>, and <span class="math"> −∞</span> to <span class="math">π −∞<i>i</i></span>.
                                                                          

                                                                          
<!--l. 2125--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2129--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18301711"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.11: </span><span  
class="content">Illustration of the Range of the Tangent Function</span></div><!--tex4ht:label?: x82-18301711 -->
<!--l. 2132--><p class="noindent" ><img 
src="tan-plot.png" alt="PIC"  
><br 
class="newline" />The usual graph of <a 
href="#x82-182013r202">tan</a> as a real function looks like an inﬁnite chorus line of disco
dancers, left hands pointed skyward and right hands to the ﬂoor. The <a 
href="#x82-182013r202">tan</a> function
is the quotient of <a 
href="#x82-182009r200">sin</a> and <a 
href="#x82-182011r201">cos</a> but it doesn&#x2019;t much look like either except for having
period <span class="math">2π</span>. This goes for the complex plane as well, although the swoopy loops
produced from the annulus between <span class="math">π∕2</span> and <span class="math">2</span> look vaguely like those from the
graph of <a 
href="#x82-182009r200">sin</a> inside out. The real axis is mapped onto itself with inﬁnite multiplicity
(period <span class="math">2π</span>). The imaginary axis is mapped backwards onto <span class="math">[−<i>i</i>,<i>i</i>]</span>: <span class="math">+∞<i>i</i></span> is mapped
to <span class="math">−<i>i</i></span> and <span class="math">−∞<i>i</i></span> to <span class="math">+<i>i</i></span>. Horizontal lines below or above the real axis become circles
surrounding <span class="math"> + <i>i</i></span> or <span class="math"> −<i>i</i></span>, respectively. Vertical lines become circular arcs from <span class="math"> + <i>i</i></span>
to <span class="math"> −<i>i</i></span>; two vertical lines separated by <span class="math">(2<i>k</i> + 1)π</span> for integer <span class="math"><i>k</i></span> together become a
complete circle. It seems that two arcs shown hit the real axis at <span class="math"> ± π∕2 = ±1.57…</span>
but that is a coincidence; they really hit the axis at <span class="math"> ± tan1 = 1.55…</span>.
                                                                          

                                                                          
<!--l. 2152--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2156--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18301812"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.12: </span><span  
class="content">Illustration of the Range of the Arc Tangent Function</span></div><!--tex4ht:label?: x82-18301812 -->
<!--l. 2159--><p class="noindent" ><img 
src="xatan-plot.png" alt="PIC"  
><br 
class="newline" />All I can say is that this peacock is a horse of another color. At ﬁrst glance, the
axes seem to map in the same way as for <a 
href="#x82-182017r204">asin</a> and <a 
href="#x82-182019r205">acos</a>, but look again: this time
it&#x2019;s the imaginary axis doing weird things. All inﬁnities map multiply to the points
<span class="math">(2<i>k</i> + 1)π∕2</span>; within the strip of principal values we may say that the real axis is
mapped to the interval <span class="math">[−π∕2,+π∕2]</span> and therefore <span class="math"> −∞</span> is mapped to <span class="math"> − π∕2</span> and
<span class="math"> + ∞</span> to <span class="math"> + π∕2</span>. The point <span class="math"> + <i>i</i></span> is mapped to <span class="math"> + ∞<i>i</i></span>, and <span class="math"> −<i>i</i></span> to <span class="math"> −∞<i>i</i></span>, and so the
imaginary axis is mapped into three pieces: the segment <span class="math">[−∞<i>i</i>,−<i>i</i>]</span> is mapped to
<span class="math">[π∕2,π∕2 −∞<i>i</i>]</span>; the segment <span class="math">[−<i>i</i>,<i>i</i>]</span> is mapped to the imaginary axis <span class="math">[−∞<i>i</i>,+∞<i>i</i>]</span>;
and the segment <span class="math">[+<i>i</i>,+∞<i>i</i>]</span> is mapped to <span class="math">[−π∕2 + ∞<i>i</i>,−π∕2]</span>.
                                                                          

                                                                          
<!--l. 2174--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2178--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18301913"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.13: </span><span  
class="content">Illustration of the Range of the Hyperbolic Sine Function</span></div><!--tex4ht:label?: x82-18301913 -->
<!--l. 2181--><p class="noindent" ><img 
src="sinh-plot.png" alt="PIC"  
><br 
class="newline" />It would seem that the graph of <a 
href="#x82-182027r208">sinh</a> is merely that of <a 
href="#x82-182009r200">sin</a> rotated 90 degrees. If
that were so, then we would have <span class="math"> sinh<i>z</i> = <i>i</i>sin<i>z</i></span>. Careful inspection of the shading,
however, reveals that this is not quite the case; in both graphs the lightest and
darkest shades, which initially are adjacent to the positive real axis, remain adjacent
to the positive real axis in both cases. To derive the graph of <a 
href="#x82-182027r208">sinh</a> from <a 
href="#x82-182009r200">sin</a> we
must therefore ﬁrst rotate the complex plane by <span class="math">−90</span> degrees, then apply <a 
href="#x82-182009r200">sin</a>, then
rotate the result by 90 degrees. In other words, <span class="math"> sinh<i>z</i> = <i>i</i>sin(−<i>i</i>)<i>z</i></span>; consistently
replacing <span class="math"><i>z</i></span> with <span class="math"><i>i</i><i>z</i></span> in this formula yields the familiar identity <span class="math"> sinh<i>i</i><i>z</i> = <i>i</i>sin<i>z</i></span>.
                                                                          

                                                                          
<!--l. 2194--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2198--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18302014"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.14: </span><span  
class="content">Illustration of the Range of the Hyperbolic Arc Sine Function</span></div><!--tex4ht:label?: x82-18302014 -->
<!--l. 2201--><p class="noindent" ><img 
src="asinh-plot.png" alt="PIC"  
><br 
class="newline" />The peacock sleeps. Because <span class="math"> arcsinh <i>i</i><i>z</i> = <i>i</i>arcsin<i>z</i></span>, the graph of <a 
href="#x82-182033r211">asinh</a> is related to
that of <a 
href="#x82-182017r204">asin</a> by pre- and post-rotations of the complex plane in the same way as
for <a 
href="#x82-182027r208">sinh</a> and <a 
href="#x82-182009r200">sin</a>.
                                                                          

                                                                          
<!--l. 2208--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2212--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18302115"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.15: </span><span  
class="content">Illustration of the Range of the Hyperbolic Cosine Function</span></div><!--tex4ht:label?: x82-18302115 -->
<!--l. 2215--><p class="noindent" ><img 
src="cosh-plot.png" alt="PIC"  
><br 
class="newline" />The graph of <a 
href="#x82-182029r209">cosh</a> does <i>not</i> look like that of <a 
href="#x82-182011r201">cos</a> rotated 90 degrees; instead it looks
like that of <a 
href="#x82-182011r201">cos</a> unrotated. That is because <span class="math"> cosh<i>i</i><i>z</i></span> is not equal to <span class="math"><i>i</i>cos<i>z</i></span>; rather,
<span class="math"> cosh<i>i</i><i>z</i> = cos<i>z</i></span>. Interpreted, that means that the shading is pre-rotated but there
is no post-rotation.
                                                                          

                                                                          
<!--l. 2224--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2228--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18302216"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.16:  </span><span  
class="content">Illustration  of  the  Range  of  the  Hyperbolic  Arc  Cosine
Function</span></div><!--tex4ht:label?: x82-18302216 -->
<!--l. 2231--><p class="noindent" ><img 
src="acosh-plot.png" alt="PIC"  
><br 
class="newline" />Hmm—I&#x2019;d rather not say what happened to this peacock. This feather looks a bit
mangled. Actually it is all right—the principal value for <a 
href="#x82-182035r212">acosh</a> is so chosen that
its graph does not look simply like a rotated version of the graph of <a 
href="#x82-182019r205">acos</a>, but if
all values were shown, the two graphs would ﬁll the plane in repeating patterns
related by a rotation.
                                                                          

                                                                          
<!--l. 2241--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2245--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18302317"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.17: </span><span  
class="content">Illustration of the Range of the Hyperbolic Tangent Function</span></div><!--tex4ht:label?: x82-18302317 -->
<!--l. 2248--><p class="noindent" ><img 
src="tanh-plot.png" alt="PIC"  
><br 
class="newline" />The diagram for <a 
href="#x82-182031r210">tanh</a> is simply that of <a 
href="#x82-182013r202">tan</a> turned on its ear: <span class="math"><i>i</i>tan<i>z</i> = tanh<i>i</i><i>z</i></span>. The
imaginary axis is mapped onto itself with inﬁnite multiplicity (period <span class="math">2π</span>), and the
real axis is mapped onto the segment <span class="math">[−1,+1]</span>: <span class="math"> + ∞</span> is mapped to <span class="math"> + 1</span>, and <span class="math"> −∞</span>
to <span class="math"> − 1</span>. Vertical lines to the left or right of the real axis are mapped to circles
surrounding <span class="math"> − 1</span> or <span class="math">1</span>, respectively. Horizontal lines are mapped to circular arcs
anchored at <span class="math">−1</span> and <span class="math">+1</span>; two horizontal lines separated by a distance <span class="math">(2<i>k</i>+1)π</span> for
integer <span class="math"><i>k</i></span> are together mapped into a complete circle. How do we know these really
are circles? Well, <span class="math"> tanh<i>z</i> = ((exp2<i>z</i>)−1)∕((exp2<i>z</i>)+1)</span>, which is the composition of
the bilinear transform <span class="math">(<i>z</i>−1)∕(<i>z</i>+1)</span>, the exponential <span class="math"> exp<i>z</i></span>, and the magniﬁcation
<span class="math">2<i>z</i></span>.  Magniﬁcation  maps  lines  to  lines  of  the  same  slope;  the  exponential  maps
horizontal lines to circles and vertical lines to radial lines; and a bilinear transform
maps generalized circles (including lines) to generalized circles. Q.E.D.
                                                                          

                                                                          
<!--l. 2268--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2272--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18302418"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.18:  </span><span  
class="content">Illustration  of  the  Range  of  the  Hyperbolic  Arc  Tangent
Function</span></div><!--tex4ht:label?: x82-18302418 -->
<!--l. 2276--><p class="noindent" ><img 
src="really-good-atanh-plot.png" alt="PIC"  
><br 
class="newline" />A sleeping peacock of another color: <span class="math"> arctanh <i>i</i><i>z</i> = <i>i</i>arctan<i>z</i></span>.
                                                                          

                                                                          
<!--l. 2280--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2284--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18302519"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.19: </span><span  
class="content">Illustration of the Range of the Function <span class="math"><img 
src="clm34x.png" alt="√ ------
  1 − z2"  class="sqrt" ></span></span></div><!--tex4ht:label?: x82-18302519 -->
<!--l. 2287--><p class="noindent" ><img 
src="sqrt-one-minus-sq-plot.png" alt="PIC"  
><br 
class="newline" />Here is a curious graph indeed for so simple a function! The origin is mapped to
1. The real axis segment <span class="math">[0,1]</span> is mapped backwards (and non-linearly) into itself;
the segment <span class="math">[1,+∞]</span> is mapped non-linearly onto the positive imaginary axis. The
negative real axis is mapped to the same points as the positive real axis. Both
halves of the imaginary axis are mapped into <span class="math">[1,+∞]</span> on the real axis. Horizontal
lines become vaguely vertical, and vertical lines become vaguely horizontal. Circles
centered at the origin are transformed into Cassinian (half-)ovals; the unit circle
is mapped to a (half-)lemniscate of Bernoulli. The outermost annulus appears to
have its <i>inner</i> edge at <span class="math">π</span> on the real axis and its <i>outer</i> edge at 3 on the imaginary
axis, but this is another accident; the intercept on the real axis, for example, is not
really at <span class="math">π ≈ 3.14…</span> but at <span class="math"><img 
src="clm35x.png" alt="∘ ---------
  1 − (3i)2"  class="sqrt" > = <img 
src="clm36x.png" alt="√ ---
  10"  class="sqrt" > ≈ 3.16…</span>.
                                                                          

                                                                          
<!--l. 2305--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<!--l. 2309--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x82-18302620"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure 12.20: </span><span  
class="content">Illustration of the Range of the Function <span class="math"><img 
src="clm37x.png" alt="√ ------
  1 + z2"  class="sqrt" ></span></span></div><!--tex4ht:label?: x82-18302620 -->
<!--l. 2313--><p class="noindent" ><img 
src="sqrt-one-plus-sq-plot.png" alt="PIC"  
><br 
class="newline" />The graph of <span class="math"><i>q</i>(<i>z</i>)  =  <img 
src="clm38x.png" alt="√1-+-z2-"  class="sqrt" ></span>  looks like that of <span class="math"><i>p</i>(<i>z</i>)  =  <img 
src="clm39x.png" alt="√1--−-z2-"  class="sqrt" ></span>  except for the
shading. You might not expect <span class="math"><i>p</i></span> and <span class="math"><i>q</i></span> to be related in the same way that <a 
href="#x82-182011r201">cos</a> and
<a 
href="#x82-182029r209">cosh</a> are, but after a little reﬂection (or perhaps I should say, after turning it around
in one&#x2019;s mind) one can see that <span class="math"><i>q</i>(<i>i</i><i>z</i>) = <i>p</i>(<i>z</i>)</span>. This formula is indeed of exactly the
same form as <span class="math"> cosh<i>i</i><i>z</i> = cos<i>z</i></span>. The function <span class="math"><img 
src="clm40x.png" alt="√ ------
  1 + z2"  class="sqrt" ></span> maps both halves of the real
axis into <span class="math">[1,+∞]</span> on the real axis. The segments <span class="math">[0,<i>i</i>]</span> and <span class="math">[0,−<i>i</i>]</span> of the imaginary
axis are each mapped backwards onto segment <span class="math">[0,1]</span> of the real axis; <span class="math">[<i>i</i>,+∞<i>i</i>]</span> and
<span class="math">[−<i>,</i> −∞<i>i</i>]</span> are each mapped onto the positive imaginary axis (but if minus zero is
supported then opposite sides of the imaginary axis map to opposite halves of the
imaginary axis—for example, <span class="math">q(+0 + 2<i>i</i>) = <img 
src="clm41x.png" alt="√--
 5"  class="sqrt" ><i>i</i></span> but <span class="math">q(−0 + 2<i>i</i>) = −<img 
src="clm42x.png" alt="√--
 5"  class="sqrt" ><i>i</i></span>).
                                                                          

                                                                          
<!--l. 2330--><p class="indent" >   </div><hr class="endfigure">
                                                                          

                                                                          
<div class=new>
<!--l. 2335--><p class="indent" >   Here is a sample of the PostScript code that generated ﬁgure <a 
href="#x82-1830071">12.1<!--tex4ht:ref: IDENTITY-PLOT --></a>, showing
the initial scaling, translation, and clipping parameters; the code for one sector of
the innermost annulus; and the code for the negative imaginary axis. Comment
lines indicate how path or boundary segments were generated separately and then
spliced (in order to allow for the places that a singularity might lurk, in which
case the generating code can “inch up” to the problematical argument
value).
<!--l. 2345--><p class="indent" >   The size of the entire PostScript ﬁle for the <a 
href="clmse126.html#x156-309002r798">identity</a> function was about 68
kilobytes (2757 lines, including comments). The smallest ﬁles were the plots for
<a 
href="#x82-182021r206">atan</a> and <a 
href="#x82-182037r213">atanh</a>, about 65 kilobytes apiece; the largest were the plots for <a 
href="#x82-182009r200">sin</a>, <a 
href="#x82-182011r201">cos</a>,
<a 
href="#x82-182027r208">sinh</a>, and <a 
href="#x82-182029r209">cosh</a>, about 138 kilobytes apiece.
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">
</td></tr></table>
<!--l. 2354--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">% PostScript ﬁle for plot of function IDENTITY</td></tr></table>
<!--l. 2355--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">% Plot is to ﬁt in a region 4.666666666666667 inches square</td></tr></table>
<!--l. 2356--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">%  showing axes extending 4.1 units from the origin.</td></tr></table>
<!--l. 2357--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2358--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">40.97560975609756 40.97560975609756 scale</td></tr></table>
<!--l. 2359--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">4.1 4.1 translate</td></tr></table>
<!--l. 2360--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">newpath</td></tr></table>
<!--l. 2361--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  -4.1 -4.1 moveto</td></tr></table>
<!--l. 2362--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  4.1 -4.1 lineto</td></tr></table>
<!--l. 2363--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  4.1 4.1 lineto</td></tr></table>
<!--l. 2364--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  -4.1 4.1 lineto</td></tr></table>
<!--l. 2365--><p class="indent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  closepath</td></tr></table>
<!--l. 2366--><p class="indent" >                                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">clip</td></tr></table>
<!--l. 2367--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">% Moby grid for function IDENTITY</td></tr></table>
<!--l. 2368--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">% Annulus 0.25 0.5 4 0.97 0.45</td></tr></table>
<!--l. 2369--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">% Sector from 4.7124 to 6.2832 (quadrant 3)</td></tr></table>
<!--l. 2370--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">newpath</td></tr></table>
<!--l. 2371--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -0.25 moveto</td></tr></table>
<!--l. 2372--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -0.375 lineto</td></tr></table>
<!--l. 2373--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  %middle radial</td></tr></table>
<!--l. 2374--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -0.375 lineto</td></tr></table>
<!--l. 2375--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -0.5 lineto</td></tr></table>
                                                                          

                                                                          
<!--l. 2376--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  %end radial</td></tr></table>
<!--l. 2377--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -0.5 lineto</td></tr></table>
<!--l. 2378--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.092 -0.4915 lineto</td></tr></table>
<!--l. 2379--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.1843 -0.4648 lineto</td></tr></table>
<!--l. 2380--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.273 -0.4189 lineto</td></tr></table>
<!--l. 2381--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.3536 -0.3536 lineto</td></tr></table>
<!--l. 2382--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  %middle circumferential</td></tr></table>
<!--l. 2383--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.3536 -0.3536 lineto</td></tr></table>
<!--l. 2384--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.413 -0.2818 lineto</td></tr></table>
<!--l. 2385--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.4594 -0.1974 lineto</td></tr></table>
<!--l. 2386--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.4894 -0.1024 lineto</td></tr></table>
<!--l. 2387--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.5 0.0 lineto</td></tr></table>
<!--l. 2388--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  %end circumferential</td></tr></table>
<!--l. 2389--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.5 0.0 lineto</td></tr></table>
<!--l. 2390--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.375 0.0 lineto</td></tr></table>
<!--l. 2391--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  %middle radial</td></tr></table>
<!--l. 2392--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.375 0.0 lineto</td></tr></table>
<!--l. 2393--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.25 0.0 lineto</td></tr></table>
<!--l. 2394--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  %end radial</td></tr></table>
<!--l. 2395--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.25 0.0 lineto</td></tr></table>
<!--l. 2396--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.2297 -0.0987 lineto</td></tr></table>
<!--l. 2397--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.1768 -0.1768 lineto</td></tr></table>
<!--l. 2398--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  %middle circumferential</td></tr></table>
<!--l. 2399--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.1768 -0.1768 lineto</td></tr></table>
<!--l. 2400--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0922 -0.2324 lineto</td></tr></table>
<!--l. 2401--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -0.25 lineto</td></tr></table>
<!--l. 2402--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  %end circumferential</td></tr></table>
<!--l. 2403--><p class="indent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  closepath</td></tr></table>
<!--l. 2404--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">currentgray   0.45 setgray   ﬁll   setgray</td></tr></table>
<!--l. 2406--><p class="indent" >
</div>
</div>
<!--l. 2407--><p class="noindent" >[2598 lines omitted] <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">% Vertical line from (0.0, -0.5) to (0.0, 0.0)
</td></tr></table>
<!--l. 2409--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">newpath</td></tr></table>
<!--l. 2410--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -0.5 moveto</td></tr></table>
<!--l. 2411--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 0.0 lineto</td></tr></table>
<!--l. 2412--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0.05 setlinewidth   1 setlinecap  stroke</td></tr></table>
                                                                          

                                                                          
<!--l. 2413--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">% Vertical line from (0.0, -0.5) to (0.0, -1.0)</td></tr></table>
<!--l. 2414--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">newpath</td></tr></table>
<!--l. 2415--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -0.5 moveto</td></tr></table>
<!--l. 2416--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -1.0 lineto</td></tr></table>
<!--l. 2417--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0.05 setlinewidth   1 setlinecap  stroke</td></tr></table>
<!--l. 2418--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">% Vertical line from (0.0, -2.0) to (0.0, -1.0)</td></tr></table>
<!--l. 2419--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">newpath</td></tr></table>
<!--l. 2420--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -2.0 moveto</td></tr></table>
<!--l. 2421--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -1.0 lineto</td></tr></table>
<!--l. 2422--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0.05 setlinewidth   1 setlinecap  stroke</td></tr></table>
<!--l. 2423--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">% Vertical line from (0.0, -2.0) to (0.0, -1.1579208923731617E77)</td></tr></table>
<!--l. 2424--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">newpath</td></tr></table>
<!--l. 2425--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -2.0 moveto</td></tr></table>
<!--l. 2426--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -6.3553 lineto</td></tr></table>
<!--l. 2427--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -6.378103166302659 lineto</td></tr></table>
<!--l. 2428--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -6.378103166302659 lineto</td></tr></table>
<!--l. 2429--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  0.0 -6.378103166302659 lineto</td></tr></table>
<!--l. 2430--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0.05 setlinewidth 1 setlinecap stroke</td></tr></table>
<!--l. 2432--><p class="indent" >
</div>
</div>
<!--l. 2433--><p class="noindent" >[84 lines omitted] <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">% End of PostScript ﬁle for plot of function IDENTITY
</td></tr></table>
<!--l. 2436--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
<!--l. 2442--><p class="indent" >   Here is the program that generated the PostScript code for the graphs shown
in ﬁgures <a 
href="#x82-1830071">12.1<!--tex4ht:ref: IDENTITY-PLOT --></a> through <a 
href="#x82-18302620">12.20<!--tex4ht:ref: LAST-PLOT --></a>. It contains a mixture of fairly general mechanisms
and <i>ad hoc</i> kludges for plotting functions of a single complex argument while
gracefully handling extremely large and small values, branch cuts, singularities,
and periodic behavior. The aim was to provide a simple user interface that
would not require the caller to provide special advice for each function
to be plotted. The ﬁle for ﬁgure <a 
href="#x82-1830071">12.1<!--tex4ht:ref: IDENTITY-PLOT --></a>, for example, was generated by
the call (picture &#x2019;identity), which resulted in the writing of a ﬁle named
identity-plot.ps.
<!--l. 2455--><p class="indent" >   The program assumes that any periodic behavior will have a period that is a
multiple of <span class="math">2π</span>; that branch cuts will fall along the real or imaginary axis; and that
singularities or very large or small values will occur only at the origin, at <span class="math"> ± 1</span> or
<span class="math"> ±<i>i</i></span>, or on the boundaries of the annuli (particularly those with radius <span class="math">π∕2</span> or <span class="math">π</span>).
The central function is parametric-path, which accepts four arguments: two real
numbers that are the endpoints of an interval of real numbers, a function that
maps this interval into a path in the complex plane, and the function to be
plotted; the task of parametric-path is to generate PostScript code (a series of
lineto operations) that will plot an approximation to the image of the
parametric path as transformed by the function to be plotted. Each of
the functions hline, vline, -hline, -vline, radial, and circumferential takes
appropriate parameters and returns a function suitable for use as the third
argument to parametric-path. There is some code that defends against
errors (by using <a 
href="clmse150.html#x184-457002r958">ignore-errors</a>) and against certain peculiarities of IEEE
ﬂoating-point arithmetic (the code that checks for not-a-number (NaN)
results).
<!--l. 2475--><p class="indent" >   The program is oﬀered here without further comment or apology.
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">
</td></tr></table>
<!--l. 2482--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter units-to-show 4.1)</td></tr></table>
<!--l. 2483--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter text-width-in-picas 28.0)</td></tr></table>
<!--l. 2484--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter device-pixels-per-inch 300)</td></tr></table>
<!--l. 2485--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter pixels-per-unit</td></tr></table>
<!--l. 2486--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (* (/ (/ text-width-in-picas 6)</td></tr></table>
<!--l. 2487--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (* units-to-show 2))</td></tr></table>
<!--l. 2488--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     device-pixels-per-inch))</td></tr></table>
<!--l. 2489--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
                                                                          

                                                                          
<!--l. 2490--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter big (sqrt (sqrt most-positive-single-ﬂoat)))</td></tr></table>
<!--l. 2491--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter tiny (sqrt (sqrt least-positive-single-ﬂoat)))</td></tr></table>
<!--l. 2492--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2493--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter path-really-losing 1000.0)</td></tr></table>
<!--l. 2494--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter path-outer-limit (* units-to-show (sqrt 2) 1.1))</td></tr></table>
<!--l. 2495--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter path-minimal-delta (/ 10 pixels-per-unit))</td></tr></table>
<!--l. 2496--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter path-outer-delta (* path-outer-limit 0.3))</td></tr></table>
<!--l. 2497--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter path-relative-closeness 0.00001)</td></tr></table>
<!--l. 2498--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter back-oﬀ-delta 0.0005)</td></tr></table>
<!--l. 2500--><p class="indent" >
</div>
</div>
<!--l. 2501--><p class="noindent" >
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun comment-line (stream &#x0026;rest stuﬀ)
</td></tr></table>
<!--l. 2503--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (format stream &#x0022;~%% &#x0022;)</td></tr></table>
<!--l. 2504--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (apply #&#x2019;format stream stuﬀ)</td></tr></table>
<!--l. 2505--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (format t &#x0022;~%% &#x0022;)</td></tr></table>
<!--l. 2506--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (apply #&#x2019;format t stuﬀ))</td></tr></table>
<!--l. 2507--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2508--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun parametric-path (from to paramfn plotfn)</td></tr></table>
<!--l. 2509--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (assert (and (plusp from) (plusp to)))</td></tr></table>
<!--l. 2510--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (ﬂet ((domainval (x) (funcall paramfn x))</td></tr></table>
<!--l. 2511--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (rangeval (x) (funcall plotfn (funcall paramfn x)))</td></tr></table>
<!--l. 2512--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (losing (x) (or (null x)</td></tr></table>
<!--l. 2513--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         (/= (realpart x) (realpart x))  ;NaN?</td></tr></table>
<!--l. 2514--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         (/= (imagpart x) (imagpart x))  ;NaN?</td></tr></table>
<!--l. 2515--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         (&#x003E; (abs (realpart x)) path-really-losing)</td></tr></table>
<!--l. 2516--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         (&#x003E; (abs (imagpart x)) path-really-losing))))</td></tr></table>
<!--l. 2517--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (when (&#x003E; to 1000.0)</td></tr></table>
<!--l. 2518--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (let ((f0 (rangeval from))</td></tr></table>
<!--l. 2519--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (f1 (rangeval (+ from 1)))</td></tr></table>
<!--l. 2520--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (f2 (rangeval (+ from (* 2 pi))))</td></tr></table>
<!--l. 2521--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (f3 (rangeval (+ from 1 (* 2 pi))))</td></tr></table>
<!--l. 2522--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (f4 (rangeval (+ from (* 4 pi)))))</td></tr></table>
<!--l. 2523--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (ﬂet ((close (x y)</td></tr></table>
<!--l. 2524--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 (or (&#x003C; (careful-abs (- x y)) path-minimal-delta)</td></tr></table>
<!--l. 2525--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (&#x003C; (careful-abs (- x y))</td></tr></table>
<!--l. 2526--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        (* (+ (careful-abs x) (careful-abs y))</td></tr></table>
<!--l. 2527--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                           path-relative-closeness)))))</td></tr></table>
<!--l. 2528--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (when (and (close f0 f2)</td></tr></table>
<!--l. 2529--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (close f2 f4)</td></tr></table>
<!--l. 2530--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (close f1 f3)</td></tr></table>
<!--l. 2531--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (or (and (close f0 f1)</td></tr></table>
<!--l. 2532--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (close f2 f3))</td></tr></table>
<!--l. 2533--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         (and (not (close f0 f1))</td></tr></table>
<!--l. 2534--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (not (close f2 f3)))))</td></tr></table>
<!--l. 2535--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (format t &#x0022;~&#x0026;Periodicity detected.&#x0022;)</td></tr></table>
<!--l. 2536--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (setq to (+ from (* (signum (- to from)) 2 pi)))))))</td></tr></table>
<!--l. 2537--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (let ((fromrange (ignore-errors (rangeval from)))</td></tr></table>
                                                                          

                                                                          
<!--l. 2538--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (torange (ignore-errors (rangeval to))))</td></tr></table>
<!--l. 2539--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (if (losing fromrange)</td></tr></table>
<!--l. 2540--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (if (losing torange)</td></tr></table>
<!--l. 2541--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x2019;()</td></tr></table>
<!--l. 2542--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (parametric-path (back-oﬀ from to) to paramfn plotfn))</td></tr></table>
<!--l. 2543--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (if (losing torange)</td></tr></table>
<!--l. 2544--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (parametric-path from (back-oﬀ to from) paramfn plotfn)</td></tr></table>
<!--l. 2545--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (expand-path (reﬁne-path (list from to) #&#x2019;rangeval)</td></tr></table>
<!--l. 2546--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                           #&#x2019;rangeval))))))</td></tr></table>
<!--l. 2548--><p class="indent" >
</div>
</div>
<!--l. 2549--><p class="noindent" >
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun back-oﬀ (point other)
</td></tr></table>
<!--l. 2551--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (if (or (&#x003E; point 10.0) (&#x003C; point 0.1))</td></tr></table>
<!--l. 2552--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (let ((sp (sqrt point)))</td></tr></table>
<!--l. 2553--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (if (or (&#x003E; point sp other) (&#x003C; point sp other))</td></tr></table>
<!--l. 2554--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            sp</td></tr></table>
<!--l. 2555--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (* sp (sqrt other))))</td></tr></table>
<!--l. 2556--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (+ point (* (signum (- other point)) back-oﬀ-delta))))</td></tr></table>
<!--l. 2557--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2558--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun careful-abs (z)</td></tr></table>
<!--l. 2559--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (cond ((or (&#x003E; (realpart z) big)</td></tr></table>
<!--l. 2560--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (&#x003C; (realpart z) (- big))</td></tr></table>
<!--l. 2561--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (&#x003E; (imagpart z) big)</td></tr></table>
<!--l. 2562--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (&#x003C; (imagpart z) (- big)))</td></tr></table>
<!--l. 2563--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         big)</td></tr></table>
<!--l. 2564--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((complexp z) (abs z))</td></tr></table>
<!--l. 2565--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((minusp z) (- z))</td></tr></table>
<!--l. 2566--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (t z)))</td></tr></table>
<!--l. 2567--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2568--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter max-reﬁnements 5000)
</td></tr></table>
<!--l. 2570--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2571--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun reﬁne-path (original-path rangevalfn)</td></tr></table>
<!--l. 2572--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (ﬂet ((rangeval (x) (funcall rangevalfn x)))</td></tr></table>
<!--l. 2573--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (let ((path original-path))</td></tr></table>
<!--l. 2574--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (do ((j 0 (+ j 1)))</td></tr></table>
<!--l. 2575--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          ((null (rest path)))</td></tr></table>
<!--l. 2576--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (when (zerop (mod (+ j 1) max-reﬁnements))</td></tr></table>
<!--l. 2577--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (break &#x0022;Runaway path&#x0022;))</td></tr></table>
<!--l. 2578--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (let* ((from (ﬁrst path))</td></tr></table>
                                                                          

                                                                          
<!--l. 2579--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (to (second path))</td></tr></table>
<!--l. 2580--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (fromrange (rangeval from))</td></tr></table>
<!--l. 2581--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (torange (rangeval to))</td></tr></table>
<!--l. 2582--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (dist (careful-abs (- torange fromrange)))</td></tr></table>
<!--l. 2583--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (mid (* (sqrt from) (sqrt to)))</td></tr></table>
<!--l. 2584--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (midrange (rangeval mid)))</td></tr></table>
<!--l. 2585--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (cond ((or (and (far-out fromrange) (far-out torange))</td></tr></table>
<!--l. 2586--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     (and (&#x003C; dist path-minimal-delta)</td></tr></table>
<!--l. 2587--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          (&#x003C; (abs (- midrange fromrange))</td></tr></table>
<!--l. 2588--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                             path-minimal-delta)</td></tr></table>
<!--l. 2589--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          ;; Next test is intentionally asymmetric to</td></tr></table>
<!--l. 2590--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          ;;  avoid problems with periodic functions.</td></tr></table>
<!--l. 2591--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          (&#x003C; (abs (- (rangeval (/ (+ to (* from 1.5))</td></tr></table>
<!--l. 2592--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                  2.5))</td></tr></table>
<!--l. 2593--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                     fromrange))</td></tr></table>
<!--l. 2594--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                             path-minimal-delta)))</td></tr></table>
<!--l. 2595--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 (pop path))</td></tr></table>
<!--l. 2596--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                ((= mid from) (pop path))</td></tr></table>
<!--l. 2597--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                ((= mid to) (pop path))</td></tr></table>
<!--l. 2598--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                (t (setf (rest path) (cons mid (rest path)))))))))</td></tr></table>
<!--l. 2599--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  original-path)</td></tr></table>
<!--l. 2600--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2601--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun expand-path (path rangevalfn)</td></tr></table>
<!--l. 2602--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (ﬂet ((rangeval (x) (funcall rangevalfn x)))</td></tr></table>
<!--l. 2603--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (let ((ﬁnal-path (list (rangeval (ﬁrst path)))))</td></tr></table>
<!--l. 2604--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (do ((p (rest path) (cdr p)))</td></tr></table>
<!--l. 2605--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          ((null p)</td></tr></table>
<!--l. 2606--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (unless (rest ﬁnal-path)</td></tr></table>
<!--l. 2607--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (break &#x0022;Singleton path&#x0022;))</td></tr></table>
<!--l. 2608--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (reverse ﬁnal-path))</td></tr></table>
<!--l. 2609--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (let ((v (rangeval (car p))))</td></tr></table>
<!--l. 2610--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (cond ((and (rest ﬁnal-path)</td></tr></table>
<!--l. 2611--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (not (far-out v))</td></tr></table>
<!--l. 2612--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (not (far-out (ﬁrst ﬁnal-path)))</td></tr></table>
<!--l. 2613--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (between v (ﬁrst ﬁnal-path)</td></tr></table>
<!--l. 2614--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 (second ﬁnal-path)))</td></tr></table>
<!--l. 2615--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 (setf (ﬁrst ﬁnal-path) v))</td></tr></table>
<!--l. 2616--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                ((null (rest p))   ;Mustn&#x2019;t omit last point</td></tr></table>
<!--l. 2617--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 (push v ﬁnal-path))</td></tr></table>
<!--l. 2618--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                ((&#x003C; (abs (- v (ﬁrst ﬁnal-path))) path-minimal-delta))</td></tr></table>
                                                                          

                                                                          
<!--l. 2619--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                ((far-out v)</td></tr></table>
<!--l. 2620--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 (unless (and (far-out (ﬁrst ﬁnal-path))</td></tr></table>
<!--l. 2621--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (&#x003C; (abs (- v (ﬁrst ﬁnal-path)))</td></tr></table>
<!--l. 2622--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 path-outer-delta))</td></tr></table>
<!--l. 2623--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   (push (* 1.01 path-outer-limit (signum v))</td></tr></table>
<!--l. 2624--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         ﬁnal-path)))</td></tr></table>
<!--l. 2625--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                (t (push v ﬁnal-path))))))))</td></tr></table>
<!--l. 2626--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2627--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun far-out (x)</td></tr></table>
<!--l. 2628--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (&#x003E; (careful-abs x) path-outer-limit))</td></tr></table>
<!--l. 2629--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2630--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter between-tolerance 0.000001)</td></tr></table>
<!--l. 2631--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2632--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun between (p q r)</td></tr></table>
<!--l. 2633--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((px (realpart p)) (py (imagpart p))</td></tr></table>
<!--l. 2634--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (qx (realpart q)) (qy (imagpart q))</td></tr></table>
<!--l. 2635--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (rx (realpart r)) (ry (imagpart r)))</td></tr></table>
<!--l. 2636--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (and (or (&#x003C;= px qx rx) (&#x003E;= px qx rx))</td></tr></table>
<!--l. 2637--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (or (&#x003C;= py qy ry) (&#x003E;= py qy ry))</td></tr></table>
<!--l. 2638--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (&#x003C; (abs (- (* (- qx px) (- ry qy))</td></tr></table>
<!--l. 2639--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    (* (- rx qx) (- qy py))))</td></tr></table>
<!--l. 2640--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            between-tolerance))))</td></tr></table>
<!--l. 2642--><p class="indent" >
</div>
</div>
<!--l. 2643--><p class="noindent" >
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun circle (radius)
</td></tr></table>
<!--l. 2645--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  #&#x2019;(lambda (angle) (* radius (cis angle))))</td></tr></table>
<!--l. 2646--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2647--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun hline (imag)</td></tr></table>
<!--l. 2648--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  #&#x2019;(lambda (real) (complex real imag)))</td></tr></table>
<!--l. 2649--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2650--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun vline (real)</td></tr></table>
<!--l. 2651--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  #&#x2019;(lambda (imag) (complex real imag)))</td></tr></table>
<!--l. 2652--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2653--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun -hline (imag)</td></tr></table>
<!--l. 2654--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  #&#x2019;(lambda (real) (complex (- real) imag)))</td></tr></table>
<!--l. 2655--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2656--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun -vline (real)</td></tr></table>
<!--l. 2657--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  #&#x2019;(lambda (imag) (complex real (- imag))))</td></tr></table>
<!--l. 2658--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2659--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun radial (phi quadrant)</td></tr></table>
<!--l. 2660--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  #&#x2019;(lambda (rho) (repair-quadrant (* rho (cis phi)) quadrant)))</td></tr></table>
<!--l. 2661--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2662--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun circumferential (rho quadrant)</td></tr></table>
<!--l. 2663--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  #&#x2019;(lambda (phi) (repair-quadrant (* rho (cis phi)) quadrant)))</td></tr></table>
<!--l. 2664--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2665--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Quadrant is 0, 1, 2, or 3, meaning I, II, III, or IV.</td></tr></table>
<!--l. 2666--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2667--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun repair-quadrant (z quadrant)</td></tr></table>
<!--l. 2668--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (complex (* (+ (abs (realpart z)) tiny)</td></tr></table>
<!--l. 2669--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (case quadrant (0 1.0) (1 -1.0) (2 -1.0) (3 1.0)))</td></tr></table>
<!--l. 2670--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (* (+ (abs (imagpart z)) tiny)</td></tr></table>
<!--l. 2671--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (case quadrant (0 1.0) (1 1.0) (2 -1.0) (3 -1.0)))))</td></tr></table>
<!--l. 2672--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2673--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun clamp-real (x)</td></tr></table>
<!--l. 2674--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (if (far-out x)</td></tr></table>
<!--l. 2675--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (* (signum x) path-outer-limit)</td></tr></table>
<!--l. 2676--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (round-real x)))</td></tr></table>
<!--l. 2677--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2678--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun round-real (x)</td></tr></table>
<!--l. 2679--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (/ (round (* x 10000.0)) 10000.0))</td></tr></table>
                                                                          

                                                                          
<!--l. 2680--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2681--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun round-point (z)</td></tr></table>
<!--l. 2682--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (complex (round-real (realpart z)) (round-real (imagpart z))))</td></tr></table>
<!--l. 2683--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2684--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter hiringshade 0.97)</td></tr></table>
<!--l. 2685--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter loringshade 0.45)</td></tr></table>
<!--l. 2686--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2687--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter ticklength 0.12)</td></tr></table>
<!--l. 2688--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defparameter smallticklength 0.09)</td></tr></table>
<!--l. 2690--><p class="indent" >
</div>
</div>
<!--l. 2691--><p class="noindent" >
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; This determines the pattern of lines and annuli to be drawn.
</td></tr></table>
<!--l. 2693--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun moby-grid (&#x0026;optional (fn &#x2019;sqrt) (stream t))</td></tr></table>
<!--l. 2694--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (comment-line stream &#x0022;Moby grid for function ~S&#x0022; fn)</td></tr></table>
<!--l. 2695--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (shaded-annulus 0.25 0.5 4 hiringshade loringshade fn stream)</td></tr></table>
<!--l. 2696--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (shaded-annulus 0.75 1.0 8 hiringshade loringshade fn stream)</td></tr></table>
<!--l. 2697--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (shaded-annulus (/ pi 2) 2.0 16 hiringshade loringshade fn stream)</td></tr></table>
<!--l. 2698--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (shaded-annulus 3 pi 32 hiringshade loringshade fn stream)</td></tr></table>
<!--l. 2699--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (moby-lines :horizontal 1.0 fn stream)</td></tr></table>
<!--l. 2700--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (moby-lines :horizontal -1.0 fn stream)</td></tr></table>
<!--l. 2701--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (moby-lines :vertical 1.0 fn stream)</td></tr></table>
<!--l. 2702--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (moby-lines :vertical -1.0 fn stream)</td></tr></table>
<!--l. 2703--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((tickline 0.015)</td></tr></table>
<!--l. 2704--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (axisline 0.008))</td></tr></table>
<!--l. 2705--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (ﬂet ((tick (n) (straight-line (complex n ticklength)</td></tr></table>
<!--l. 2706--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                    (complex n (- ticklength))</td></tr></table>
<!--l. 2707--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                    tickline</td></tr></table>
<!--l. 2708--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                    stream))</td></tr></table>
<!--l. 2709--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (smalltick (n) (straight-line (complex n smallticklength)</td></tr></table>
<!--l. 2710--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         (complex n (- smallticklength))</td></tr></table>
<!--l. 2711--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         tickline</td></tr></table>
<!--l. 2712--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         stream)))</td></tr></table>
<!--l. 2713--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (comment-line stream &#x0022;Real axis&#x0022;)</td></tr></table>
<!--l. 2714--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (straight-line #c(-5 0) #c(5 0) axisline stream)</td></tr></table>
<!--l. 2715--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (dotimes (j (ﬂoor units-to-show))</td></tr></table>
<!--l. 2716--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (let ((q (+ j 1))) (tick q) (tick (- q))))</td></tr></table>
<!--l. 2717--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (dotimes (j (ﬂoor units-to-show (/ pi 2)))</td></tr></table>
<!--l. 2718--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (let ((q (* (/ pi 2) (+ j 1))))</td></tr></table>
<!--l. 2719--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (smalltick q)</td></tr></table>
<!--l. 2720--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (smalltick (- q)))))</td></tr></table>
<!--l. 2721--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (ﬂet ((tick (n) (straight-line (complex ticklength n)</td></tr></table>
<!--l. 2722--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                    (complex (- ticklength) n)</td></tr></table>
<!--l. 2723--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                    tickline</td></tr></table>
<!--l. 2724--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                    stream))</td></tr></table>
<!--l. 2725--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (smalltick (n) (straight-line (complex smallticklength n)</td></tr></table>
                                                                          

                                                                          
<!--l. 2726--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         (complex (- smallticklength) n)</td></tr></table>
<!--l. 2727--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         tickline</td></tr></table>
<!--l. 2728--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         stream)))</td></tr></table>
<!--l. 2729--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (comment-line stream &#x0022;Imaginary axis&#x0022;)</td></tr></table>
<!--l. 2730--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (straight-line #c(0 -5) #c(0 5) axisline stream)</td></tr></table>
<!--l. 2731--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (dotimes (j (ﬂoor units-to-show))</td></tr></table>
<!--l. 2732--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (let ((q (+ j 1))) (tick q) (tick (- q))))</td></tr></table>
<!--l. 2733--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (dotimes (j (ﬂoor units-to-show (/ pi 2)))</td></tr></table>
<!--l. 2734--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (let ((q (* (/ pi 2) (+ j 1))))</td></tr></table>
<!--l. 2735--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (smalltick q)</td></tr></table>
<!--l. 2736--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (smalltick (- q)))))))</td></tr></table>
<!--l. 2738--><p class="indent" >
</div>
</div>
<!--l. 2739--><p class="noindent" >
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun straight-line (from to wid stream)
</td></tr></table>
<!--l. 2741--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (format stream</td></tr></table>
<!--l. 2742--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          &#x0022;~%newpath  ~S ~S moveto  ~S ~S lineto  ~S ~</td></tr></table>
<!--l. 2743--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           setlinewidth  1  setlinecap  stroke&#x0022;</td></tr></table>
<!--l. 2744--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (realpart from)</td></tr></table>
<!--l. 2745--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (imagpart from)</td></tr></table>
<!--l. 2746--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (realpart to)</td></tr></table>
<!--l. 2747--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (imagpart to)</td></tr></table>
<!--l. 2748--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          wid))</td></tr></table>
<!--l. 2749--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2750--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; This function draws the lines for the pattern.
</td></tr></table>
<!--l. 2752--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun moby-lines (orientation signum plotfn stream)</td></tr></table>
<!--l. 2753--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((paramfn (ecase orientation</td></tr></table>
<!--l. 2754--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   (:horizontal (if (&#x003C; signum 0) #&#x2019;-hline #&#x2019;hline))</td></tr></table>
<!--l. 2755--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   (:vertical (if (&#x003C; signum 0) #&#x2019;-vline #&#x2019;vline)))))</td></tr></table>
<!--l. 2756--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (ﬂet ((foo (from to other wid)</td></tr></table>
<!--l. 2757--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (ecase orientation</td></tr></table>
<!--l. 2758--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (:horizontal</td></tr></table>
<!--l. 2759--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                (comment-line stream</td></tr></table>
<!--l. 2760--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              &#x0022;Horizontal line from (~S, ~S) to (~S, ~S)&#x0022;</td></tr></table>
<!--l. 2761--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (round-real (* signum from))</td></tr></table>
<!--l. 2762--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (round-real other)</td></tr></table>
<!--l. 2763--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (round-real (* signum to))</td></tr></table>
<!--l. 2764--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (round-real other)))</td></tr></table>
<!--l. 2765--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (:vertical</td></tr></table>
<!--l. 2766--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                (comment-line stream</td></tr></table>
<!--l. 2767--><p class="indent" >    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              &#x0022;Vertical line from (~S, ~S) to (~S, ~S)&#x0022;</td></tr></table>
                                                                          

                                                                          
<!--l. 2768--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (round-real other)</td></tr></table>
<!--l. 2769--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (round-real (* signum from))</td></tr></table>
<!--l. 2770--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (round-real other)</td></tr></table>
<!--l. 2771--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (round-real (* signum to)))))</td></tr></table>
<!--l. 2772--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (postscript-path</td></tr></table>
<!--l. 2773--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               stream</td></tr></table>
<!--l. 2774--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (parametric-path from</td></tr></table>
<!--l. 2775--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                to</td></tr></table>
<!--l. 2776--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                (funcall paramfn other)</td></tr></table>
<!--l. 2777--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                plotfn))</td></tr></table>
<!--l. 2778--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (postscript-penstroke stream wid)))</td></tr></table>
<!--l. 2779--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (let* ((thick 0.05)</td></tr></table>
<!--l. 2780--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (thin 0.02))</td></tr></table>
<!--l. 2781--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ;; Main axis</td></tr></table>
<!--l. 2782--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo 0.5 tiny 0.0 thick)</td></tr></table>
<!--l. 2783--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo 0.5 1.0 0.0 thick)</td></tr></table>
<!--l. 2784--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo 2.0 1.0 0.0 thick)</td></tr></table>
<!--l. 2785--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo 2.0 big 0.0 thick)</td></tr></table>
<!--l. 2786--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ;; Parallels at 1 and -1</td></tr></table>
<!--l. 2787--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo 2.0 tiny 1.0 thin)</td></tr></table>
<!--l. 2788--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo 2.0 big 1.0 thin)</td></tr></table>
<!--l. 2789--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo 2.0 tiny -1.0 thin)</td></tr></table>
<!--l. 2790--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo 2.0 big -1.0 thin)</td></tr></table>
<!--l. 2791--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ;; Parallels at 2, 3, -2, -3</td></tr></table>
<!--l. 2792--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo tiny big 2.0 thin)</td></tr></table>
<!--l. 2793--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo tiny big -2.0 thin)</td></tr></table>
<!--l. 2794--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo tiny big 3.0 thin)</td></tr></table>
<!--l. 2795--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (foo tiny big -3.0 thin)))))</td></tr></table>
<!--l. 2796--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2797--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun splice (p q)</td></tr></table>
<!--l. 2798--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((v (car (last p)))</td></tr></table>
<!--l. 2799--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (w (ﬁrst q)))</td></tr></table>
<!--l. 2800--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (and (far-out v)</td></tr></table>
<!--l. 2801--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (far-out w)</td></tr></table>
<!--l. 2802--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (&#x003E;= (abs (- v w)) path-outer-delta)</td></tr></table>
<!--l. 2803--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         ;; Two far-apart far-out points.  Try to walk around</td></tr></table>
<!--l. 2804--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         ;;  outside the perimeter, in the shorter direction.</td></tr></table>
<!--l. 2805--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (let* ((pdiﬀ (phase (/ v w)))</td></tr></table>
<!--l. 2806--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                (npoints (ﬂoor (abs pdiﬀ) (asin .2)))</td></tr></table>
<!--l. 2807--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                (delta (/ pdiﬀ (+ npoints 1)))</td></tr></table>
                                                                          

                                                                          
<!--l. 2808--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                (incr (cis delta)))</td></tr></table>
<!--l. 2809--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (do ((j 0 (+ j 1))</td></tr></table>
<!--l. 2810--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                (p (list w &#x0022;end splice&#x0022;) (cons (* (car p) incr) p)))</td></tr></table>
<!--l. 2811--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               ((= j npoints) (cons &#x0022;start splice&#x0022; p)))))))</td></tr></table>
<!--l. 2812--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2813--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; This function draws the annuli for the pattern.
</td></tr></table>
<!--l. 2815--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun shaded-annulus (inner outer sectors ﬁrstshade lastshade fn stream)</td></tr></table>
<!--l. 2816--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (assert (zerop (mod sectors 4)))</td></tr></table>
<!--l. 2817--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (comment-line stream &#x0022;Annulus ~S ~S ~S ~S ~S&#x0022;</td></tr></table>
<!--l. 2818--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                (round-real inner) (round-real outer)</td></tr></table>
<!--l. 2819--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                sectors ﬁrstshade lastshade)</td></tr></table>
<!--l. 2820--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (dotimes (jj sectors)</td></tr></table>
<!--l. 2821--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (let ((j (- sectors jj 1)))</td></tr></table>
<!--l. 2822--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (let* ((lophase (+ tiny (* 2 pi (/ j sectors))))</td></tr></table>
<!--l. 2823--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (hiphase (* 2 pi (/ (+ j 1) sectors)))</td></tr></table>
<!--l. 2824--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (midphase (/ (+ lophase hiphase) 2.0))</td></tr></table>
<!--l. 2825--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (midradius (/ (+ inner outer) 2.0))</td></tr></table>
<!--l. 2826--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (quadrant (ﬂoor (* j 4) sectors)))</td></tr></table>
<!--l. 2827--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (comment-line stream &#x0022;Sector from ~S to ~S (quadrant ~S)&#x0022;</td></tr></table>
<!--l. 2828--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (round-real lophase)</td></tr></table>
<!--l. 2829--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (round-real hiphase)</td></tr></table>
<!--l. 2830--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      quadrant)</td></tr></table>
<!--l. 2831--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (let ((p0 (reverse (parametric-path midradius</td></tr></table>
<!--l. 2832--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            inner</td></tr></table>
<!--l. 2833--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            (radial lophase quadrant)</td></tr></table>
<!--l. 2834--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            fn)))</td></tr></table>
<!--l. 2835--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (p1 (parametric-path midradius</td></tr></table>
<!--l. 2836--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   outer</td></tr></table>
<!--l. 2837--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   (radial lophase quadrant)</td></tr></table>
<!--l. 2838--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   fn))</td></tr></table>
<!--l. 2839--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (p2 (reverse (parametric-path midphase</td></tr></table>
<!--l. 2840--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            lophase</td></tr></table>
                                                                          

                                                                          
<!--l. 2841--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            (circumferential outer</td></tr></table>
<!--l. 2842--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                             quadrant)</td></tr></table>
<!--l. 2843--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            fn)))</td></tr></table>
<!--l. 2844--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (p3 (parametric-path midphase</td></tr></table>
<!--l. 2845--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   hiphase</td></tr></table>
<!--l. 2846--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   (circumferential outer quadrant)</td></tr></table>
<!--l. 2847--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   fn))</td></tr></table>
<!--l. 2848--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (p4 (reverse (parametric-path midradius</td></tr></table>
<!--l. 2849--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            outer</td></tr></table>
<!--l. 2850--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            (radial hiphase quadrant)</td></tr></table>
<!--l. 2851--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            fn)))</td></tr></table>
<!--l. 2852--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (p5 (parametric-path midradius</td></tr></table>
<!--l. 2853--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   inner</td></tr></table>
<!--l. 2854--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   (radial hiphase quadrant)</td></tr></table>
<!--l. 2855--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   fn))</td></tr></table>
<!--l. 2856--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (p6 (reverse (parametric-path midphase</td></tr></table>
<!--l. 2857--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            hiphase</td></tr></table>
<!--l. 2858--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            (circumferential inner</td></tr></table>
<!--l. 2859--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                             quadrant)</td></tr></table>
<!--l. 2860--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            fn)))</td></tr></table>
<!--l. 2861--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (p7 (parametric-path midphase</td></tr></table>
<!--l. 2862--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   lophase</td></tr></table>
<!--l. 2863--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   (circumferential inner quadrant)</td></tr></table>
<!--l. 2864--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                   fn)))</td></tr></table>
<!--l. 2865--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (postscript-closed-path stream</td></tr></table>
<!--l. 2866--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (append</td></tr></table>
<!--l. 2867--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              p0 (splice p0 p1) &#x2019;(&#x0022;middle radial&#x0022;)</td></tr></table>
<!--l. 2868--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              p1 (splice p1 p2) &#x2019;(&#x0022;end radial&#x0022;)</td></tr></table>
<!--l. 2869--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              p2 (splice p2 p3) &#x2019;(&#x0022;middle circumferential&#x0022;)</td></tr></table>
<!--l. 2870--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              p3 (splice p3 p4) &#x2019;(&#x0022;end circumferential&#x0022;)</td></tr></table>
<!--l. 2871--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              p4 (splice p4 p5) &#x2019;(&#x0022;middle radial&#x0022;)</td></tr></table>
<!--l. 2872--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              p5 (splice p5 p6) &#x2019;(&#x0022;end radial&#x0022;)</td></tr></table>
<!--l. 2873--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              p6 (splice p6 p7) &#x2019;(&#x0022;middle circumferential&#x0022;)</td></tr></table>
<!--l. 2874--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              p7 (splice p7 p0) &#x2019;(&#x0022;end circumferential&#x0022;)</td></tr></table>
<!--l. 2875--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              )))</td></tr></table>
<!--l. 2877--><p class="indent" >
</div>
</div>
<!--l. 2878--><p class="noindent" >
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (postscript-shade stream
</td></tr></table>
<!--l. 2880--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          (/ (+ (* ﬁrstshade (- (- sectors 1) j))</td></tr></table>
<!--l. 2881--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                (* lastshade j))</td></tr></table>
<!--l. 2882--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                             (- sectors 1)))))))</td></tr></table>
<!--l. 2883--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2884--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun postscript-penstroke (stream wid)</td></tr></table>
<!--l. 2885--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (format stream &#x0022;~%~S setlinewidth   1 setlinecap  stroke&#x0022;</td></tr></table>
<!--l. 2886--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          wid))</td></tr></table>
<!--l. 2887--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2888--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun postscript-shade (stream shade)</td></tr></table>
<!--l. 2889--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (format stream &#x0022;~%currentgray   ~S setgray   ﬁll   setgray&#x0022;</td></tr></table>
<!--l. 2890--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          shade))</td></tr></table>
<!--l. 2891--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2892--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun postscript-closed-path (stream path)</td></tr></table>
<!--l. 2893--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (unless (every #&#x2019;far-out (remove-if-not #&#x2019;numberp path))</td></tr></table>
<!--l. 2894--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (postscript-raw-path stream path)</td></tr></table>
<!--l. 2895--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;~%  closepath&#x0022;)))</td></tr></table>
<!--l. 2896--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2897--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun postscript-path (stream path)</td></tr></table>
<!--l. 2898--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (unless (every #&#x2019;far-out (remove-if-not #&#x2019;numberp path))</td></tr></table>
<!--l. 2899--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (postscript-raw-path stream path)))</td></tr></table>
<!--l. 2900--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2901--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Print a path as a series of PostScript &#x0022;lineto&#x0022; commands.</td></tr></table>
<!--l. 2902--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun postscript-raw-path (stream path)</td></tr></table>
<!--l. 2903--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (format stream &#x0022;~%newpath&#x0022;)</td></tr></table>
<!--l. 2904--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((fmt &#x0022;~%  ~S ~S moveto&#x0022;))</td></tr></table>
<!--l. 2905--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (dolist (pt path)</td></tr></table>
<!--l. 2906--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (cond ((stringp pt)</td></tr></table>
<!--l. 2907--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (format stream &#x0022;~%  %~A&#x0022; pt))</td></tr></table>
<!--l. 2908--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (t (format stream</td></tr></table>
<!--l. 2909--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       fmt</td></tr></table>
<!--l. 2910--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (clamp-real (realpart pt))</td></tr></table>
<!--l. 2911--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (clamp-real (imagpart pt)))</td></tr></table>
<!--l. 2912--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (setq fmt &#x0022;~%  ~S ~S lineto&#x0022;))))))</td></tr></table>
<!--l. 2913--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2914--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Deﬁnitions of functions to be plotted that are not</td></tr></table>
                                                                          

                                                                          
<!--l. 2915--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; standard Common Lisp functions.</td></tr></table>
<!--l. 2916--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2917--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun one-plus-over-one-minus (x) (/ (+ 1 x) (- 1 x)))</td></tr></table>
<!--l. 2918--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2919--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun one-minus-over-one-plus (x) (/ (- 1 x) (+ 1 x)))</td></tr></table>
<!--l. 2920--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2921--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun sqrt-square-minus-one (x) (sqrt (- 1 (* x x))))</td></tr></table>
<!--l. 2922--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2923--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun sqrt-one-plus-square (x) (sqrt (+ 1 (* x x))))</td></tr></table>
<!--l. 2925--><p class="indent" >
</div>
</div>
<!--l. 2926--><p class="noindent" >
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Because X3J13 voted for a new deﬁnition of the atan function,
</td></tr></table>
<!--l. 2928--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; the following deﬁnition was used in place of the atan function</td></tr></table>
<!--l. 2929--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; provided by the Common Lisp implementation I was using.</td></tr></table>
<!--l. 2930--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2931--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun good-atan (x)</td></tr></table>
<!--l. 2932--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (/ (- (log (+ 1 (* x #c(0 1))))</td></tr></table>
<!--l. 2933--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (log (- 1 (* x #c(0 1)))))</td></tr></table>
<!--l. 2934--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     #c(0 2)))</td></tr></table>
<!--l. 2935--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2936--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Because the ﬁrst edition had an erroneous deﬁnition of atanh,</td></tr></table>
<!--l. 2937--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; the following deﬁnition was used in place of the atanh function</td></tr></table>
<!--l. 2938--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; provided by the Common Lisp implementation I was using.</td></tr></table>
<!--l. 2939--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2940--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun really-good-atanh (x)</td></tr></table>
<!--l. 2941--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (/ (- (log (+ 1 x))</td></tr></table>
<!--l. 2942--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (log (- 1 x)))</td></tr></table>
<!--l. 2943--><p class="indent" >                                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     2))</td></tr></table>
<!--l. 2944--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2945--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; This is the main procedure that is intended to be called by a user.
</td></tr></table>
<!--l. 2947--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun picture (&#x0026;optional (fn #&#x2019;sqrt))</td></tr></table>
<!--l. 2948--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (with-open-ﬁle (stream (concatenate &#x2019;string</td></tr></table>
<!--l. 2949--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                       (string-downcase (string fn))</td></tr></table>
<!--l. 2950--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                       &#x0022;-plot.ps&#x0022;)</td></tr></table>
<!--l. 2951--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          :direction :output)</td></tr></table>
<!--l. 2952--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;% PostScript ﬁle for plot of function ~S~%&#x0022; fn)</td></tr></table>
<!--l. 2953--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;% Plot is to ﬁt in a region ~S inches square~%&#x0022;</td></tr></table>
<!--l. 2954--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (/ text-width-in-picas 6.0))</td></tr></table>
<!--l. 2955--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream</td></tr></table>
                                                                          

                                                                          
<!--l. 2956--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            &#x0022;%  showing axes extending ~S units from the origin.~%&#x0022;</td></tr></table>
<!--l. 2957--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            units-to-show)</td></tr></table>
<!--l. 2958--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (let ((scaling (/ (* text-width-in-picas 12) (* units-to-show 2))))</td></tr></table>
<!--l. 2959--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (format stream &#x0022;~%~S ~:*~S scale&#x0022; scaling))</td></tr></table>
<!--l. 2960--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;~%~S ~:*~S translate&#x0022; units-to-show)</td></tr></table>
<!--l. 2961--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;~%newpath&#x0022;)</td></tr></table>
<!--l. 2962--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;~%  ~S ~S moveto&#x0022; (- units-to-show) (- units-to-show))</td></tr></table>
<!--l. 2963--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;~%  ~S ~S lineto&#x0022; units-to-show (- units-to-show))</td></tr></table>
<!--l. 2964--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;~%  ~S ~S lineto&#x0022; units-to-show units-to-show)</td></tr></table>
<!--l. 2965--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;~%  ~S ~S lineto&#x0022; (- units-to-show) units-to-show)</td></tr></table>
<!--l. 2966--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;~%  closepath&#x0022;)</td></tr></table>
<!--l. 2967--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream &#x0022;~%clip&#x0022;)</td></tr></table>
<!--l. 2968--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (moby-grid fn stream)</td></tr></table>
<!--l. 2969--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (format stream</td></tr></table>
<!--l. 2970--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            &#x0022;~%% End of PostScript ﬁle for plot of function ~S&#x0022;</td></tr></table>
<!--l. 2971--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            fn)</td></tr></table>
<!--l. 2972--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (terpri stream)))</td></tr></table>
<!--l. 2974--><p class="indent" >
</div>
</div>
</div>
                                                                          

                                                                          
   <!--l. 2978--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse66.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse64.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse64.html#tailclmse64.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse65.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch12.html#clmse65.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 2978--><p class="indent" >   <a 
 id="tailclmse65.html"></a>  
</body></html> 
