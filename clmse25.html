<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Функция преобразования</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-14 15:35:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 1702--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse26.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse24.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse24.html#tailclmse24.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse25.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch4.html#clmse25.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">4.8   </span> <a 
 id="x34-530004.8"></a>Функция преобразования</h3>
<!--l. 1704--><p class="noindent" >Следующие функции могут быть использованы для преобразования объекта
в эквивалентный объект другого типа.
<div class=defun>
<!--l. 1707--><p class="noindent" ><i>[Function]</i><a 
 id="dx34-53001"></a><a 
 id="x34-53002r7"></a><b> coerce</b>  <i>object</i> <i>result-type</i>
<!--l. 1709--><p class="noindent" ><i>result-type</i> должен быть спецификатором типа. <i>object</i> будет конвертирован в
«эквивалентный» объект заданного типа. Если преобразование не может
быть осуществлено, будет сигнализирована ошибка. В частности, (coerce
x &#x2019;nil) всегда сигнализирует ошибку. Если <i>object</i> уже принадлежит
заданному типу, это проверяется предикатом <a 
href="clmse32.html#x43-76002r20">typep</a>, тогда данный
объект будет возвращён. В целом, невозможно преобразовать любой
объект в объект любого другого типа. Допускаются только следующие
преобразования.
      <ul class="itemize1">
      <li class="itemize">Любой  тип  последовательности  может  быть  конвертирован  в
      другой  тип  последовательности.  Новый  тип  последовательности
      будет  содержать  все  объекты  из  старой  последовательности
      (если это невозможно, тогда возникнет ошибка). Если result-type
      задан  как  array,  тогда  будет  использоваться  (array  t).  Также
      может   использоваться   специализированный   тип   такой,   как
      <a 
href="clmse99.html#x122-227022r584">string</a>   или   (vector   (complex   short-ﬂoat));   конечно,   результат
      может  быть  более  общим  типом,  в  зависимости  от  реализации.
      Элементы  новой  последовательности  будут  эквивалентны  <a 
href="clmse33.html#x44-78004r45">eql</a>
      соответствующим  элементам  старой  последовательности.  Если
      последовательность уже принадлежит заданному типу, она может
      быть   просто   возвращена   без   копирования.   В   таком   случае
      (coerce <i>последовательность</i> <i>тип</i>) отличается от (concatenate <i>тип</i>
      <i>последовательность</i>),  так  как  последняя  требует  копирования
      аргумента <i>последовательность</i>.
<div class=lisp>
                                                                          

                                                                          
<div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(coerce &#x2019;(a b c) &#x2019;vector) ⇒ #(a b c)
</td></tr></table>
      <!--l. 1738--><p class="noindent" >
</div>
</div>
      </li></ul>
      <ul class="itemize1">
      <li class="itemize">Любое некомплексное число может быть приведено к short-ﬂoat,
      single-ﬂoat, double-ﬂoat или long-ﬂoat. Если тип указан с плавающей
      точкой и <i>объект</i> не является числом с плавающей точкой, тогда
      объект преобразовывается в single-ﬂoat.
<div class=lisp>
<div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(coerce 0 &#x2019;short-ﬂoat) ⇒ 0.0S0
</td></tr></table>
      <!--l. 1750--><p class="noindent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(coerce 3.5L0 &#x2019;ﬂoat) ⇒ 3.5L0</td></tr></table>
      <!--l. 1751--><p class="noindent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(coerce 7/2 &#x2019;ﬂoat) ⇒ 3.5</td></tr></table>
      <!--l. 1753--><p class="noindent" >
</div>
</div>
      </li>
      <li class="itemize">Любое число может быть приведено к комплексному. Если число
      ещё не является комплексным, тогда мнимая часть будет равна
                                                                          

                                                                          
      нулю, который будет преобразован в тип, соответствующий типу
      действительной части. (Если полученная действительная часть является
      рациональным числом, тогда результат немедленно будет преобразован
      из комплексного обратно в рациональный.)
<div class=lisp>
<div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(coerce 4.5s0 &#x2019;complex) ⇒ #C(4.5S0 0.0S0)
</td></tr></table>
      <!--l. 1763--><p class="noindent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(coerce 7/2 &#x2019;complex) ⇒ 7/2</td></tr></table>
      <!--l. 1764--><p class="noindent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(coerce #C(7/2 0) &#x2019;(complex double-ﬂoat))</td></tr></table>
      <!--l. 1765--><p class="noindent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">   ⇒ #C(3.5D0 0.0D0)</td></tr></table>
      <!--l. 1767--><p class="noindent" >
</div>
</div>
      </li>
      <li class="itemize">Любой объект может быть приведён к типу <a 
href="clmse31.html#x42-74004r19">t</a>. <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(coerce x &#x2019;t) ≡ (identity x) ≡ x
</td></tr></table>
      <!--l. 1773--><p class="noindent" >
</div>
</div>
      </li></ul>
<div class=newer>
      <ul class="itemize1">
      <li class="itemize">Символ  или  лямбда-выражение  может  быть  преобразовано  к
      функции. Символ приводится к типу <a 
href="clmse35.html#x47-85002r52">function</a>, как если бы к нему
                                                                          

                                                                          
      была применена функция <a 
href="clmse35.html#x47-86006r54">symbol-function</a>. Если символ не связан
      (<a 
href="clmse35.html#x47-86013r57">fboundp</a>  symbol  -&#x003E;  false),  или  символ  связан  с  макросом  или
      специальной формой сигнализируется ошибка. Список <i>x</i>, чей <i>car</i>
      является  символом  lambda  приводится  к  функции,  как  если  бы
      было вычислено выражение (eval ‘#&#x2019;,<i>x</i>), или (eval (list &#x2019;function <i>x</i>)).</li></ul>
</div>
<!--l. 1790--><p class="indent" >   Приведение чисел с плавающей точкой к рациональным и рациональных
целым <i>не</i> предоставляется в связи с проблемами округления. Для этого
могут использоваться функции <a 
href="clmse68.html#x85-187004r220">rational</a>, <a 
href="clmse68.html#x85-187006r221">rationalize</a>, <a 
href="clmse68.html#x85-187012r224">ﬂoor</a>, <a 
href="clmse68.html#x85-187014r225">ceiling</a>, <a 
href="clmse68.html#x85-187016r226">truncate</a> и
<a 
href="clmse68.html#x85-187018r227">round</a>. Также не предоставляется приведение строковых символов
к целым числам. В этих целях можно использовать <a 
href="clmse75.html#x93-195002r347">char-code</a> или
<a 
href="clmse76.html#x94-196012r356">char-int</a>.
</div>
                                                                          

                                                                          
   <!--l. 1798--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse26.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse24.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse24.html#tailclmse24.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse25.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch4.html#clmse25.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 1798--><p class="indent" >   <a 
 id="tailclmse25.html"></a>  
</body></html> 
