<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Type Conversions and Component Extractions on Numbers</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-20 16:10:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
<!--l. 2524--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse70.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse68.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse68.html#tailclmse68.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse69.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="number.html#clmse69.html" >Up</a><tt>&#x003E;</tt>&lt;<a href="../index.html">Main Page</a>&gt;</div><h3 class="sectionHead"><span class="titlemark">12.6   </span> <a 
href="clm.html#QQ2-86-1107" id="x86-107800012.6">Type Conversions and Component
Extractions on Numbers</a></h3>
<!--l. 2526--><p class="noindent" >While most arithmetic functions will operate on any kind of number, coercing
types if necessary, the following functions are provided to allow speciﬁc
conversions of data types to be forced when desired.
<div class="defun">
<!--l. 2530--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx86-1078001"></a><a 
 id="x86-1078002r235"></a> <b>ﬂoat</b>  <i>number</i> <b>&#x0026;optional</b>  <i>other</i>
</div>
<!--l. 2533--><p class="indent" >   This converts any non-complex number to a ﬂoating-point number. With no
second argument, if <i>number</i> is already a ﬂoating-point number, then <i>number</i> is
returned; otherwise a <tt>single-float</tt> is produced. If the argument <i>other</i> is
provided, then it must be a ﬂoating-point number, and <i>number</i> is converted to the
same format as <i>other</i>. See also <tt><a 
href="symbols.html#x187-2636227r227">coerce</a></tt>.
</div>
<div class="defun">
<!--l. 2542--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx86-1078003"></a><a 
 id="x86-1078004r236"></a> <b>rational</b>  <i>number</i><br />
<i>
[Function]</i><a 
 id="dx86-1078005"></a><a 
 id="x86-1078006r237"></a> <b>rationalize</b>  <i>number</i>
</div>
<!--l. 2546--><p class="indent" >   Each of these functions converts any non-complex number to a rational
number. If the argument is already rational, it is returned. The two functions
diﬀer in their treatment of ﬂoating-point numbers.
<tt>
<!--l. 2550--><p class="indent" >   rational</tt> assumes that the ﬂoating-point number is completely accurate and
returns a rational number mathematically equal to the precise value of the
ﬂoating-point number.
<tt>
<!--l. 2554--><p class="indent" >   <a 
href="symbols.html#x187-2636715r715">rationalize</a></tt> assumes that the ﬂoating-point number is accurate only to the
precision of the ﬂoating-point representation and may return any rational number
for which the ﬂoating-point number is the best available approximation of its
                                                                          

                                                                          
format; in doing this it attempts to keep both numerator and denominator
small.
<!--l. 2561--><p class="indent" >   It is always the case that <div class="lisp"><div class="tabbing">
(ﬂoat (rational <i>x</i>) <i>x</i>) <span class="math"> ≡</span> <i>x</i>
   <br>
<!--l. 2564--><p class="noindent" ></div>
<!--l. 2564--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-107900012.6" id="x86-107900012.6"></a></span>
<!--l. 2564--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-108000012.6" id="x86-108000012.6"></a></span>
</div>
<!--l. 2565--><p class="indent" >   and <div class="lisp"><div class="tabbing">
(ﬂoat (rationalize <i>x</i>) <i>x</i>) <span class="math"> ≡</span> <i>x</i>
   <br>
<!--l. 2568--><p class="noindent" ></div>
<!--l. 2568--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-108100012.6" id="x86-108100012.6"></a></span>
<!--l. 2568--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-108200012.6" id="x86-108200012.6"></a></span>
</div>
<!--l. 2569--><p class="indent" >   That is, rationalizing a ﬂoating-point number by either method and then
converting it back to a ﬂoating-point number of the same format produces the
original number. What distinguishes the two functions is that <tt>rational</tt> typically
has a simple, inexpensive implementation, whereas <tt><a 
href="symbols.html#x187-2636715r715">rationalize</a></tt> goes to more
trouble to produce a result that is more pleasant to view and simpler to compute
with for some purposes.
</div>
<div class="defun">
                                                                          

                                                                          
<!--l. 2578--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx86-1082001"></a><a 
 id="x86-1082002r238"></a> <b>numerator</b>  <i>rational</i><br />
<i>
[Function]</i><a 
 id="dx86-1082003"></a><a 
 id="x86-1082004r239"></a> <b>denominator</b>  <i>rational</i>
</div>
<!--l. 2582--><p class="indent" >   These functions take a rational number (an integer or ratio) and return as an
integer the numerator or denominator of the canonical reduced form of the
rational. The numerator of an integer is that integer; the denominator of an
integer is <tt>1</tt>. Note that <div class="lisp"><div class="tabbing">
(gcd (numerator <i>x</i>) (denominator <i>x</i>)) <span class="math"> ⇒</span> 1
   <br>
<!--l. 2588--><p class="noindent" ></div>
<!--l. 2588--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-108300012.6" id="x86-108300012.6"></a></span>
<!--l. 2588--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-108400012.6" id="x86-108400012.6"></a></span>
</div>
<!--l. 2589--><p class="indent" >   The denominator will always be a strictly positive integer; the numerator may
be any integer. For example: <div class="lisp"><div class="tabbing">
(numerator (/ 8 -6)) <span class="math"> ⇒</span> -4
   <br>                                                         (denominator (/ 8 -6)) <span class="math"> ⇒</span> 3<br>
<!--l. 2595--><p class="noindent" ></div>
<!--l. 2595--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-108500012.6" id="x86-108500012.6"></a></span>
<!--l. 2595--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-108600012.6" id="x86-108600012.6"></a></span>
</div>
</div>
                                                                          

                                                                          
<!--l. 2598--><p class="indent" >   There is no <tt>fix</tt> function in Common Lisp because there are several interesting
ways to convert non-integral values to integers. These are provided by the
functions below, which perform not only type conversion but also some non-trivial
calculations as well.
<div class="defun">
<!--l. 2603--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx86-1086001"></a><a 
 id="x86-1086002r240"></a> <b>ﬂoor</b>  <i>number</i> <b>&#x0026;optional</b>  <i>divisor</i><br />
<i>
[Function]</i><a 
 id="dx86-1086003"></a><a 
 id="x86-1086004r241"></a> <b>ceiling</b>  <i>number</i> <b>&#x0026;optional</b>  <i>divisor</i><br />
<i>
[Function]</i><a 
 id="dx86-1086005"></a><a 
 id="x86-1086006r242"></a> <b>truncate</b>  <i>number</i> <b>&#x0026;optional</b>  <i>divisor</i><br />
<i>
[Function]</i><a 
 id="dx86-1086007"></a><a 
 id="x86-1086008r243"></a> <b>round</b>  <i>number</i> <b>&#x0026;optional</b>  <i>divisor</i>
</div>
<!--l. 2609--><p class="indent" >   In the simple one-argument case, each of these functions converts its
argument <i>number</i> (which must not be complex) to an integer. If the argument
is already an integer, it is returned directly. If the argument is a ratio
or ﬂoating-point number, the functions use diﬀerent algorithms for the
conversion.
<tt>
<!--l. 2616--><p class="indent" >   <a 
href="symbols.html#x187-2636388r388">floor</a></tt> converts its argument by truncating toward negative inﬁnity; that is,
the result is the largest integer that is not larger than the argument.
<tt>
<!--l. 2620--><p class="indent" >   <a 
href="symbols.html#x187-2636190r190">ceiling</a></tt> converts its argument by truncating toward positive inﬁnity; that is,
the result is the smallest integer that is not smaller than the argument.
<tt>
<!--l. 2624--><p class="indent" >   <a 
href="symbols.html#x187-2636888r888">truncate</a></tt> converts its argument by truncating toward zero; that is, the result
is the integer of the same sign as the argument and which has the greatest integral
magnitude not greater than that of the argument.
<tt>
<!--l. 2629--><p class="indent" >   <a 
href="symbols.html#x187-2636757r757">round</a></tt> converts its argument by rounding to the nearest integer; if <i>number</i> is
exactly halfway between two integers (that is, of the form <span class="math">integer + 0.5</span>), then it is
rounded to the one that is even (divisible by 2).
<!--l. 2634--><p class="indent" >   The following table shows what the four functions produce when given various
arguments.
<div class="flushleft" 
>
                                                                          

                                                                          
<!--l. 2637--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%" class="tabular"><tr><td align="left" >Argument</td><td align="left" >ﬂoor</td><td align="left" >ceiling</td><td align="left" >truncate</td><td align="left" >round</td>
</tr><tr><td align="left" >     2.6    </td><td align="left" >  2 </td><td align="left" >    3   </td><td align="left" >     2    </td><td align="left" >   3  </td></tr><tr><td align="left" >  2.5 </td> <td align="left" >  2 </td> <td align="left" >  3 </td> <td align="left" >  2 </td> <td align="left" >  2</td>
</tr><tr><td align="left" >     2.4    </td><td align="left" >  2 </td><td align="left" >    3   </td><td align="left" >     2    </td><td align="left" >   2  </td></tr><tr><td align="left" >  0.7 </td> <td align="left" >  0 </td> <td align="left" >  1 </td> <td align="left" >  0 </td> <td align="left" >  1</td>
</tr><tr><td align="left" >     0.3    </td><td align="left" >  0 </td><td align="left" >    1   </td><td align="left" >     0    </td><td align="left" >   0  </td></tr><tr><td align="left" > -0.3 </td> <td align="left" > -1 </td> <td align="left" >  0 </td> <td align="left" >  0 </td> <td align="left" >  0</td>
</tr><tr><td align="left" >    -0.7    </td><td align="left" >  -1  </td><td align="left" >    0   </td><td align="left" >     0    </td><td align="left" >   -1   </td></tr><tr><td align="left" > -2.4 </td> <td align="left" > -3 </td> <td align="left" > -2 </td> <td align="left" > -2 </td> <td align="left" > -2</td>
</tr><tr><td align="left" >    -2.5    </td><td align="left" >  -3  </td><td align="left" >   -2   </td><td align="left" >    -2    </td><td align="left" >   -2   </td></tr><tr><td align="left" > -2.6 </td> <td align="left" > -3 </td> <td align="left" > -2 </td> <td align="left" > -2 </td> <td align="left" > -3</td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr><td align="left" > </td></tr></table>
</div></div>
<!--l. 2656--><p class="indent" >   If a second argument <i>divisor</i> is supplied, then the result is the appropriate
type of rounding or truncation applied to the result of dividing the <i>number</i> by the
<i>divisor</i>. For example, <tt>(floor 5 2)</tt> <span class="math"> ≡</span> <tt>(floor (/ 5 2))</tt> but is potentially more
eﬃcient. <div class="new">This statement is not entirely accurate; one should instead say that
<tt>(values (floor 5 2))</tt> <span class="math"> ≡</span> <tt>(values (floor (/ 5 2)))</tt>, because there is a
second value to consider, as discussed below. In other words, the ﬁrst values
returned by the two forms will be the same, but in general the second values will
diﬀer. Indeed, we have <div class="lisp"><div class="tabbing">
(ﬂoor 5 2) <span class="math"> ⇒</span> 2 and 1
   <br>                                                          (ﬂoor (/ 5 2)) <span class="math"> ⇒</span> 2 and 1/2<br>
<!--l. 2670--><p class="noindent" ></div>
<!--l. 2670--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-108700012.6" id="x86-108700012.6"></a></span>
<!--l. 2670--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-108800012.6" id="x86-108800012.6"></a></span>
</div>
<!--l. 2671--><p class="indent" >   for this example.
</div> The <i>divisor</i> may be any non-complex number.
<!--l. 2675--><p class="indent" >   It is generally accepted that it is an error for the <i>divisor</i> to be zero.
<!--l. 2677--><p class="indent" >   The one-argument case is exactly like the two-argument case where the second
argument is <tt>1</tt>.
<div class="newer">
<!--l. 2681--><p class="indent" >   In other words, the one-argument case returns an integer and fractional part
for the <i>number</i>: <tt>(truncate 5.3) <span class="math"> ⇒</span> 5.0 and  0.3</tt>, for example.
</div> Each of the functions actually returns <i>two</i> values, whether given one or two
                                                                          

                                                                          
arguments. The second result is the remainder and may be obtained using
<tt><a 
href="symbols.html#x187-2636595r595">multiple-value-bind</a></tt> and related constructs. If any of these functions is given
two arguments <span class="math"><i>x</i></span> and <span class="math"><i>y</i></span> and produces results <span class="math"><i>q</i></span> and <span class="math"><i>r</i></span>, then <span class="math"><i>q</i> ⋅<i>y</i> + <i>r</i> = <i>x</i></span>. The
ﬁrst result <span class="math"><i>q</i></span> is always an integer. The remainder <span class="math"><i>r</i></span> is an integer if both
arguments are integers, is rational if both arguments are rational, and is
ﬂoating-point if either argument is ﬂoating-point. One consequence is that in the
one-argument case the remainder is always a number of the same type as the
argument.
<!--l. 2698--><p class="indent" >   When only one argument is given, the two results are exact; the mathematical
sum of the two results is always equal to the mathematical value of the
argument.
</div>
<div class="defun">
<!--l. 2703--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx86-1088001"></a><a 
 id="x86-1088002r244"></a> <b>mod</b>  <i>number</i> <i>divisor</i><br />
<i>
[Function]</i><a 
 id="dx86-1088003"></a><a 
 id="x86-1088004r245"></a> <b>rem</b>  <i>number</i> <i>divisor</i>
</div>
<tt>
<!--l. 2707--><p class="indent" >   <a 
href="symbols.html#x187-2636582r582">mod</a></tt> performs the operation <tt><a 
href="symbols.html#x187-2636388r388">floor</a></tt> on its two arguments and returns the
<i>second</i> result of <tt><a 
href="symbols.html#x187-2636388r388">floor</a></tt> as its only result. Similarly, <tt><a 
href="symbols.html#x187-2636733r733">rem</a></tt> performs the operation
<tt><a 
href="symbols.html#x187-2636888r888">truncate</a></tt> on its arguments and returns the <i>second</i> result of <tt><a 
href="symbols.html#x187-2636888r888">truncate</a></tt> as its only
result.
<tt>
<!--l. 2713--><p class="indent" >   <a 
href="symbols.html#x187-2636582r582">mod</a></tt> and <tt><a 
href="symbols.html#x187-2636733r733">rem</a></tt> are therefore the usual modulus and remainder functions when
applied to two integer arguments. In general, however, the arguments may be
integers or ﬂoating-point numbers. <div class="lisp"><div class="tabbing">
(mod 13 4) <span class="math"> ⇒</span> 1                           (rem 13 4) <span class="math"> ⇒</span> 1
   <br>                     (mod -13 4) <span class="math"> ⇒</span> 3                          (rem -13 4) <span class="math"> ⇒</span> -1<br>
(mod 13 -4) <span class="math"> ⇒</span> -3                         (rem 13 -4) <span class="math"> ⇒</span> 1<br>
(mod -13 -4) <span class="math"> ⇒</span> -1                        (rem -13 -4) <span class="math"> ⇒</span> -1<br>
(mod 13.4 1) <span class="math"> ⇒</span> 0.4                       (rem 13.4 1) <span class="math"> ⇒</span> 0.4<br>
(mod -13.4 1) <span class="math"> ⇒</span> 0.6                      (rem -13.4 1) <span class="math"> ⇒</span> -0.4<br>
<!--l. 2725--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 2725--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-108900012.6" id="x86-108900012.6"></a></span>
<!--l. 2725--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-109000012.6" id="x86-109000012.6"></a></span>
</div>
</div>
<div class="defun">
<!--l. 2728--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx86-1090001"></a><a 
 id="x86-1090002r246"></a> <b>ﬄoor</b>  <i>number</i> <b>&#x0026;optional</b>  <i>divisor</i><br />
<i>
[Function]</i><a 
 id="dx86-1090003"></a><a 
 id="x86-1090004r247"></a> <b>fceiling</b>  <i>number</i> <b>&#x0026;optional</b>  <i>divisor</i><br />
<i>
[Function]</i><a 
 id="dx86-1090005"></a><a 
 id="x86-1090006r248"></a> <b>ftruncate</b>  <i>number</i> <b>&#x0026;optional</b>  <i>divisor</i><br />
<i>
[Function]</i><a 
 id="dx86-1090007"></a><a 
 id="x86-1090008r249"></a> <b>fround</b>  <i>number</i> <b>&#x0026;optional</b>  <i>divisor</i>
</div>
<!--l. 2734--><p class="indent" >   These functions are just like <tt><a 
href="symbols.html#x187-2636388r388">floor</a></tt>, <tt><a 
href="symbols.html#x187-2636190r190">ceiling</a></tt>, <tt><a 
href="symbols.html#x187-2636888r888">truncate</a></tt>, and <tt><a 
href="symbols.html#x187-2636757r757">round</a></tt>, except
that the result (the ﬁrst result of two) is always a ﬂoating-point number
rather than an integer. It is roughly as if <tt><a 
href="symbols.html#x187-2636355r355">ffloor</a></tt> gave its arguments to
<tt><a 
href="symbols.html#x187-2636388r388">floor</a></tt>, and then applied <tt><a 
href="symbols.html#x187-2636380r380">float</a></tt> to the ﬁrst result before passing them
both back. In practice, however, <tt><a 
href="symbols.html#x187-2636355r355">ffloor</a></tt> may be implemented much more
eﬃciently. Similar remarks apply to the other three functions. If the ﬁrst
argument is a ﬂoating-point number, and the second argument is not a
ﬂoating-point number of longer format, then the ﬁrst result will be a
ﬂoating-point number of the same type as the ﬁrst argument. For example:
<div class="lisp"><div class="tabbing">
(ﬄoor -4.7) <span class="math"> ⇒</span> -5.0 and 0.3
   <br>                                                   (ﬄoor 3.5d0) <span class="math"> ⇒</span> 3.0d0 and 0.5d0<br>
<!--l. 2748--><p class="noindent" ></div>
<!--l. 2748--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-109100012.6" id="x86-109100012.6"></a></span>
                                                                          

                                                                          
<!--l. 2748--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-109200012.6" id="x86-109200012.6"></a></span>
</div>
</div>
<div class="defun">
<!--l. 2751--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx86-1092001"></a><a 
 id="x86-1092002r250"></a> <b>decode-ﬂoat</b>  <i>ﬂoat</i><br />
<i>
[Function]</i><a 
 id="dx86-1092003"></a><a 
 id="x86-1092004r251"></a> <b>scale-ﬂoat</b>  <i>ﬂoat</i> <i>integer</i><br />
<i>
[Function]</i><a 
 id="dx86-1092005"></a><a 
 id="x86-1092006r252"></a> <b>ﬂoat-radix</b>  <i>ﬂoat</i><br />
<i>
[Function]</i><a 
 id="dx86-1092007"></a><a 
 id="x86-1092008r253"></a> <b>ﬂoat-sign</b>  <i>ﬂoat1</i> <b>&#x0026;optional</b>  <i>ﬂoat2</i><br />
<i>
[Function]</i><a 
 id="dx86-1092009"></a><a 
 id="x86-1092010r254"></a> <b>ﬂoat-digits</b>  <i>ﬂoat</i><br />
<i>
[Function]</i><a 
 id="dx86-1092011"></a><a 
 id="x86-1092012r255"></a> <b>ﬂoat-precision</b>  <i>ﬂoat</i><br />
<i>
[Function]</i><a 
 id="dx86-1092013"></a><a 
 id="x86-1092014r256"></a> <b>integer-decode-ﬂoat</b>  <i>ﬂoat</i>
</div>
<!--l. 2760--><p class="indent" >   The function <tt><a 
href="symbols.html#x187-2636272r272">decode-float</a></tt> takes a ﬂoating-point number and returns three
values.
<!--l. 2763--><p class="indent" >   The ﬁrst value is a new ﬂoating-point number of the same format representing
the signiﬁcand; the second value is an integer representing the exponent; and the
third value is a ﬂoating-point number of the same format indicating the sign
(<span class="math"> − 1.0</span> or <span class="math">1.0</span>). Let <i>b</i> be the radix for the ﬂoating-point representation; then
<tt><a 
href="symbols.html#x187-2636272r272">decode-float</a></tt> divides the argument by an integral power of <i>b</i> so as to bring its
value between 1/<i>b</i> (inclusive) and 1 (exclusive) and returns the quotient as the
ﬁrst value. If the argument is zero, however, the result is equal to the absolute
value of the argument (that is, if there is a negative zero, its signiﬁcand is
considered to be a positive zero).
<!--l. 2775--><p class="indent" >   The second value of <tt><a 
href="symbols.html#x187-2636272r272">decode-float</a></tt> is the integer exponent <i>e</i> to which <i>b</i> must
be raised to produce the appropriate power for the division. If the argument is
zero, any integer value may be returned, provided that the identity shown below
for <tt><a 
href="symbols.html#x187-2636766r766">scale-float</a></tt> holds.
<!--l. 2781--><p class="indent" >   The third value of <tt><a 
href="symbols.html#x187-2636272r272">decode-float</a></tt> is a ﬂoating-point number, of the same
format as the argument, whose absolute value is 1 and whose sign matches that of
the argument.
                                                                          

                                                                          
<!--l. 2785--><p class="indent" >   The function <tt><a 
href="symbols.html#x187-2636766r766">scale-float</a></tt> takes a ﬂoating-point number <i>f </i> (not necessarily
between 1/<i>b</i> and 1) and an integer <i>k</i>, and returns <tt>(* <i>f</i> (expt (float <i>b</i> <i>f</i>)
<i>k</i>))</tt>. (The use of <tt><a 
href="symbols.html#x187-2636766r766">scale-float</a></tt> may be much more eﬃcient than using
exponentiation and multiplication and avoids intermediate overﬂow and underﬂow
if the ﬁnal result is representable.)
<!--l. 2792--><p class="indent" >   Note that <div class="lisp"><div class="tabbing">
(multiple-value-bind (signif expon sign)
   <br>                       (decode-ﬂoat <i>f </i>)<br>    (scale-ﬂoat signif expon))<br>
<span class="math"> ≡</span> (abs <i>f </i>)<br>
<!--l. 2798--><p class="noindent" ></div>
<!--l. 2798--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-109300012.6" id="x86-109300012.6"></a></span>
<!--l. 2798--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-109400012.6" id="x86-109400012.6"></a></span>
</div>
<!--l. 2799--><p class="indent" >   and <div class="lisp"><div class="tabbing">
(multiple-value-bind (signif expon sign)
   <br>                                                              (decode-ﬂoat <i>f </i>)<br>
  (* (scale-ﬂoat signif expon) sign))<br>                                  <span class="math"> ≡</span> <i>f </i><br>
<!--l. 2805--><p class="noindent" ></div>
<!--l. 2805--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-109500012.6" id="x86-109500012.6"></a></span>
<!--l. 2805--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-109600012.6" id="x86-109600012.6"></a></span>
</div>
<!--l. 2807--><p class="indent" >   The function <tt><a 
href="symbols.html#x187-2636383r383">float-radix</a></tt> returns (as an integer) the radix <i>b</i> of the
ﬂoating-point argument.
                                                                          

                                                                          
<!--l. 2810--><p class="indent" >   The function <tt><a 
href="symbols.html#x187-2636384r384">float-sign</a></tt> returns a ﬂoating-point number <i>z</i> such that <i>z</i> and
<i>ﬂoat1</i> have the same sign and also such that <i>z</i> and <i>ﬂoat2</i> have the same absolute
value. The argument <i>ﬂoat2</i> defaults to the value of <tt>(float 1 <i>float1</i>)</tt>;
<tt>(float-sign x)</tt> therefore always produces a <tt>1.0</tt> or <tt>-1.0</tt> of appropriate format
according to the sign of <tt>x</tt>. (Note that if an implementation has distinct
representations for negative zero and positive zero, then <tt>(float-sign -0.0)</tt>
<span class="math"> ⇒</span> <tt>-1.0</tt>.)
<!--l. 2820--><p class="indent" >   The function <tt><a 
href="symbols.html#x187-2636381r381">float-digits</a></tt> returns, as a non-negative integer, the number of
radix-<i>b</i> digits used in the representation of its argument (including any implicit
digits, such as a “hidden bit”). The function <tt><a 
href="symbols.html#x187-2636382r382">float-precision</a></tt> returns, as a
non-negative integer, the number of signiﬁcant radix-<i>b</i> digits present in the
argument; if the argument is (a ﬂoating-point) zero, then the result is
(an integer) zero. For normalized ﬂoating-point numbers, the results of
<tt><a 
href="symbols.html#x187-2636381r381">float-digits</a></tt> and <tt><a 
href="symbols.html#x187-2636382r382">float-precision</a></tt> will be the same, but the precision will be
less than the number of representation digits for a denormalized or zero
number.
<!--l. 2834--><p class="indent" >   The function <tt><a 
href="symbols.html#x187-2636447r447">integer-decode-float</a></tt> is similar to <tt><a 
href="symbols.html#x187-2636272r272">decode-float</a></tt> but
for its ﬁrst value returns, as an <tt>integer</tt>, the signiﬁcand scaled so as to
be an integer. For an argument <i>f </i>, this integer will be strictly less than
<div class="lisp"><div class="tabbing">
<tt>(expt <i>b</i> (float-precision <i>f</i>))</tt>
   <br>
<!--l. 2840--><p class="noindent" ></div>
<!--l. 2840--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-109700012.6" id="x86-109700012.6"></a></span>
<!--l. 2840--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-109800012.6" id="x86-109800012.6"></a></span>
</div>
<!--l. 2841--><p class="indent" >   but no less than <div class="lisp"><div class="tabbing">
<tt>(expt <i>b</i> (- (float-precision <i>f</i>) 1))</tt>
   <br>
                                                                          

                                                                          
<!--l. 2844--><p class="noindent" ></div>
<!--l. 2844--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-109900012.6" id="x86-109900012.6"></a></span>
<!--l. 2844--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-110000012.6" id="x86-110000012.6"></a></span>
</div>
<!--l. 2845--><p class="indent" >   except that if <i>f </i> is zero, then the integer value will be zero.
<!--l. 2847--><p class="indent" >   The second value bears the same relationship to the ﬁrst value as for
<tt><a 
href="symbols.html#x187-2636272r272">decode-float</a></tt>: <div class="lisp"><div class="tabbing">
(multiple-value-bind (signif expon sign)
   <br>                                                    (integer-decode-ﬂoat <i>f </i>)<br>
  (scale-ﬂoat (ﬂoat signif <i>f </i>) expon))<br>                            <span class="math"> ≡</span> (abs <i>f </i>)<br>
<!--l. 2854--><p class="noindent" ></div>
<!--l. 2854--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-110100012.6" id="x86-110100012.6"></a></span>
<!--l. 2854--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-110200012.6" id="x86-110200012.6"></a></span>
</div>
<!--l. 2856--><p class="indent" >   The third value of <tt><a 
href="symbols.html#x187-2636447r447">integer-decode-float</a></tt> will be <tt>1</tt> or <tt>-1</tt>._____________<div class="rationale">
<!--l. 2859--><p class="noindent" ><b>Rationale:</b> These functions allow the writing of machine-independent, or at least
machine-parameterized, ﬂoating-point software of reasonable eﬃciency.
</div>___________________________________________________________________________________________________________
</div>
<div class="defun">
<!--l. 2867--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx86-1102001"></a><a 
 id="x86-1102002r257"></a> <b>complex</b>  <i>realpart</i> <b>&#x0026;optional</b>  <i>imagpart</i>
</div>
<!--l. 2870--><p class="indent" >    The arguments must be non-complex numbers; a number is returned that has
<i>realpart</i> as its real part and <i>imagpart</i> as its imaginary part, possibly converted
according to the rule of ﬂoating-point contagion (thus both components will be of
the same type). If <i>imagpart</i> is not speciﬁed, then <tt>(coerce 0 (type-of
                                                                          

                                                                          
<i>realpart</i>))</tt> is eﬀectively used. Note that if both the <i>realpart</i> and <i>imagpart</i> are
rational and the <i>imagpart</i> is zero, then the result is just the <i>realpart</i> because of
the rule of canonical representation for complex rationals. It follows that the
result of <tt><a 
href="symbols.html#x187-2636239r239">complex</a></tt> is not always a complex number; it may be simply a
<tt>rational</tt>.
</div>
<div class="defun">
<!--l. 2883--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx86-1102003"></a><a 
 id="x86-1102004r258"></a> <b>realpart</b>  <i>number</i><br />
<i>
[Function]</i><a 
 id="dx86-1102005"></a><a 
 id="x86-1102006r259"></a> <b>imagpart</b>  <i>number</i>
</div>
<!--l. 2887--><p class="indent" >   These return the real and imaginary parts of a complex number. If <i>number</i> is a
non-complex number, then <tt><a 
href="symbols.html#x187-2636730r730">realpart</a></tt> returns its argument <i>number</i> and <tt><a 
href="symbols.html#x187-2636437r437">imagpart</a></tt>
returns <tt>(* 0 <i>number</i>)</tt>, which has the eﬀect that the imaginary part of a rational
is <tt>0</tt> and that of a ﬂoating-point number is a ﬂoating-point zero of the same
format.
<div class="newer">
<!--l. 2895--><p class="indent" >   A clever way to multiply a complex number <i>z</i> by <i>i</i> is to write <div class="lisp"><div class="tabbing">
(complex (- (imagpart <i>z</i>)) (realpart <i>z</i>))
   <br>
<!--l. 2898--><p class="noindent" ></div>
<!--l. 2898--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-110300012.6" id="x86-110300012.6"></a></span>
<!--l. 2898--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-110400012.6" id="x86-110400012.6"></a></span>
</div>
<!--l. 2899--><p class="indent" >   instead of <tt>(* <i>z</i> #c(0 1))</tt>. This cleverness is not always gratuitous; it may be
of particular importance in the presence of minus zero. For example, if we are
using IEEE standard ﬂoating-point arithmetic and <span class="math">z = 4 + 0<i>i</i></span>, the result of the
clever expression is <span class="math"> − 0 + 4<i>i</i></span>, a true <span class="math">90<sup>∘</sup></span> rotation of <span class="math"><i>z</i></span>, whereas the result of <tt>(* <i>z</i>
#c(0 1))</tt> is likely to be <div class="tabbing">
                                                                          

                                                                          
<span class="math">(4 + 0<i>i</i>)(+0 + <i>i</i>) = ((4)(+0) − (+0)(1)) + ((4)(1) + (+0)(+0))<i>i</i></span>
   <br>                                   <span class="math"> = ((+0) − (+0)) + ((4) + (+0))<i>i</i> = +0 + 4<i>i</i></span><br>
<!--l. 2908--><p class="noindent" ></div>
<!--l. 2908--><p class="noindent" ><span class="paragraphHead"><a 
href="#x86-110500012.6" id="x86-110500012.6"></a></span>
   which could land on the wrong side of a branch cut, for example.
</div>
</div>
                                                                          

                                                                          
<!--l. 2914--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse70.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse68.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse68.html#tailclmse68.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse69.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="number.html#clmse69.html" >Up</a><tt>&#x003E;</tt></div><a 
 id="tailclmse69.html"></a>   </div> </div> 
</body></html> 
