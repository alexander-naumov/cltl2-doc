<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Changing the Dimensions of an Array</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-20 14:21:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
<!--l. 783--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="string.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse95.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse95.html#tailclmse95.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse96.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="array.html#clmse96.html" >Up</a><tt>&#x003E;</tt>&lt;<a href="../index.html">Main Page</a>&gt;</div><h3 class="sectionHead"><span class="titlemark">17.6   </span> <a 
href="clm.html#QQ2-118-1462" id="x118-143200017.6">Changing the Dimensions of an
Array</a></h3>
<!--l. 785--><p class="noindent" >This function may be used to resize or reshape an array. Its options are similar to
those of <tt><a 
href="symbols.html#x185-2637533r533">make-array</a></tt>.
<div class="defun">
<!--l. 788--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx118-1432001"></a><a 
 id="x118-1432002r559"></a> <b>adjust-array</b>  <i>array</i> <i>new-dimensions</i> <b>&#x0026;key</b>  <i>:element-type</i>
<i>:initial-element</i> <i>:initial-contents</i> <i>:ﬁll-pointer</i> <i>:displaced-to</i> <i>:displaced-index-oﬀset</i>
</div>
<tt>
<!--l. 791--><p class="indent" >   <a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> takes an array and a number of other arguments as for
<tt><a 
href="symbols.html#x185-2637533r533">make-array</a></tt>. The number of dimensions speciﬁed by <i>new-dimensions</i> must equal
the rank of <i>array</i>.
<tt>
<!--l. 795--><p class="indent" >   <a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> returns an array of the same type and rank as <i>array</i>, with the
speciﬁed <i>new-dimensions</i>. In eﬀect, the <i>array</i> argument itself is modiﬁed to
conform to the new speciﬁcations, but this may be achieved either by modifying
the <i>array</i> or by creating a new array and modifying the <i>array</i> argument to be
<i>displaced</i> to the new array.
<!--l. 802--><p class="indent" >   In the simplest case, one speciﬁes only the <i>new-dimensions</i> and possibly an
<tt>:initial-element</tt> argument. Those elements of <i>array</i> that are still in bounds
appear in the new array. The elements of the new array that are not
in the bounds of <i>array</i> are initialized to the <tt>:initial-element</tt>; if this
argument is not provided, then the initial contents of any new elements are
undeﬁned.
<!--l. 810--><p class="indent" >   If <tt>:element-type</tt> is speciﬁed, then <i>array</i> must be such that it could have been
originally created with that type; otherwise an error is signaled. Specifying
<tt>:element-type</tt> to <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> serves only to require such an error
check.
<!--l. 815--><p class="indent" >   If <tt>:initial-contents</tt> or <tt>:displaced-to</tt> is speciﬁed, then it is treated as for
<tt><a 
href="symbols.html#x185-2637533r533">make-array</a></tt>. In this case none of the original contents of <i>array</i> appears in the new
array.
                                                                          

                                                                          
<!--l. 820--><p class="indent" >   If <tt>:fill-pointer</tt> is speciﬁed, the ﬁll pointer of the <i>array</i> is reset as speciﬁed.
An error is signaled if <i>array</i> had no ﬁll pointer already.
<div class="new">
<!--l. 825--><p class="indent" >   X3J13 voted in June 1988 <a 
 id="dx118-1432003"></a>to clarify the treatment of the <tt>:fill-pointer</tt>
argument as follows.
<!--l. 830--><p class="indent" >   If the <tt>:fill-pointer</tt> argument is not supplied, then the ﬁll pointer of the
<i>array</i> is left alone. It is an error to try to adjust the <i>array</i> to a total size that is
smaller than its ﬁll pointer.
<!--l. 835--><p class="indent" >   If the <tt>:fill-pointer</tt> argument is supplied, then its value must be either an
integer, <tt><a 
href="symbols.html#x185-2637871r871">t</a></tt>, or <tt><a 
href="symbols.html#x185-2637609r609">nil</a></tt>. If it is an integer, then it is the new value for the ﬁll
pointer; it must be non-negative and no greater than the new size to
which the <i>array</i> is being adjusted. If it is <tt><a 
href="symbols.html#x185-2637871r871">t</a></tt>, then the ﬁll pointer is set
equal to the new size for the <i>array</i>. If it is <tt><a 
href="symbols.html#x185-2637609r609">nil</a></tt>, then the ﬁll pointer is
left alone; it is as if the argument had not been supplied. Again, it is an
error to try to adjust the <i>array</i> to a total size that is smaller than its ﬁll
pointer.
<!--l. 847--><p class="indent" >   An error is signaled if a non-<tt><a 
href="symbols.html#x185-2637609r609">nil</a></tt> <tt>:fill-pointer</tt> value is supplied and the
<i>array</i> to be adjusted does not already have a ﬁll pointer.
<!--l. 851--><p class="indent" >   This extended treatment of the <tt>:fill-pointer</tt> argument to <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> is
consistent with the previously existing treatment of the <tt>:fill-pointer</tt> argument
to <tt><a 
href="symbols.html#x185-2637533r533">make-array</a></tt>.
</div>
<tt>
<!--l. 856--><p class="indent" >   <a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> may, depending on the implementation and the arguments,
simply alter the given array or create and return a new one. In the latter case the
given array will be altered so as to be displaced to the new array and have the
given new dimensions.
<div class="newer">
<!--l. 862--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx118-1432004"></a>to allow <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> to be applied to any
array. If <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> is applied to an array that was originally created with
<tt>:adjustable</tt> true, the array returned is <tt><a 
href="symbols.html#x185-2637337r337">eq</a></tt> to its ﬁrst argument. It is not speciﬁed
whether <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> returns an array <tt><a 
href="symbols.html#x185-2637337r337">eq</a></tt> to its ﬁrst argument for any other
arrays. If the array returned by <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> is not <tt><a 
href="symbols.html#x185-2637337r337">eq</a></tt> to its ﬁrst argument,
the original array is unchanged and does not share storage with the new
array.
<!--l. 873--><p class="indent" >   Under this new deﬁnition, it is wise to treat <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> in the same
manner as <tt><a 
href="symbols.html#x185-2637293r293">delete</a></tt> and <tt><a 
href="symbols.html#x185-2637605r605">nconc</a></tt>: one should carefully retain the returned value, for
example by writing <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(setq my-array (adjust-array my-array ...))
   <br>
<!--l. 878--><p class="noindent" ></div>
<!--l. 878--><p class="noindent" ><span class="paragraphHead"><a 
href="#x118-143300017.6" id="x118-143300017.6"></a></span>
<!--l. 878--><p class="noindent" ><span class="paragraphHead"><a 
href="#x118-143400017.6" id="x118-143400017.6"></a></span>
</div>
<!--l. 879--><p class="indent" >   rather than relying solely on a side eﬀect.
</div>
<!--l. 882--><p class="indent" >   If <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> is applied to an <i>array</i> that is displaced to another array <i>x</i>,
then afterwards neither <i>array</i> nor the returned result is displaced to <i>x</i> unless such
displacement is explicitly re-speciﬁed in the call to <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt>.
<!--l. 887--><p class="indent" >   For example, suppose that the 4-by-4 array <tt>m</tt> looks like this: <div class="lisp"><div class="tabbing">
#2A( ( alpha     beta      gamma     delta )
   <br>                                    ( epsilon   zeta      eta       theta )<br>
     ( iota      kappa     lambda    mu    )<br>
     ( nu        xi        omicron   pi    ) )<br>
<!--l. 893--><p class="noindent" ></div>
<!--l. 893--><p class="noindent" ><span class="paragraphHead"><a 
href="#x118-143500017.6" id="x118-143500017.6"></a></span>
<!--l. 893--><p class="noindent" ><span class="paragraphHead"><a 
href="#x118-143600017.6" id="x118-143600017.6"></a></span>
</div>
<!--l. 894--><p class="indent" >   Then the result of <div class="lisp"><div class="tabbing">
(adjust-array m &#x2019;(3 5) :initial-element &#x2019;baz)
   <br>
<!--l. 897--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 897--><p class="noindent" ><span class="paragraphHead"><a 
href="#x118-143700017.6" id="x118-143700017.6"></a></span>
<!--l. 897--><p class="noindent" ><span class="paragraphHead"><a 
href="#x118-143800017.6" id="x118-143800017.6"></a></span>
</div>
<!--l. 898--><p class="indent" >   is a 3-by-5 array with contents <div class="lisp"><div class="tabbing">
#2A( ( alpha     beta      gamma     delta     baz )
   <br>                        ( epsilon   zeta      eta       theta     baz )<br>
     ( iota      kappa     lambda    mu        baz ) )<br>
<!--l. 903--><p class="noindent" ></div>
<!--l. 903--><p class="noindent" ><span class="paragraphHead"><a 
href="#x118-143900017.6" id="x118-143900017.6"></a></span>
<!--l. 903--><p class="noindent" ><span class="paragraphHead"><a 
href="#x118-144000017.6" id="x118-144000017.6"></a></span>
</div>
<!--l. 904--><p class="indent" >   Note that if array <tt>a</tt> is created displaced to array <tt>b</tt> and subsequently array <tt>b</tt> is
given to <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt>, array <tt>a</tt> will still be displaced to array <tt>b</tt>; the eﬀects of this
displacement and the rule of row-major storage order must be taken into
account.
<div class="newer">
<!--l. 910--><p class="indent" >   X3J13 voted in June 1988 <a 
 id="dx118-1440001"></a>to clarify the interaction of <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> with
array displacement.
<!--l. 913--><p class="indent" >   Suppose that an array <i>A</i> is to be adjusted. There are four cases according to
whether or not <i>A</i> was displaced before adjustment and whether or not the result
is displaced after adjustment.
      <ul class="itemize1">
      <li class="itemize">Suppose <i>A</i> is not displaced either before or after. The dimensions of <i>A</i>
      are altered, and the contents are rearranged as appropriate. Additional
      elements  of  <i>A</i>  are  taken  from  the  <tt>:initial-element</tt> argument.
      However, the use of the <tt>:initial-contents</tt> argument causes all old
      contents to be discarded.
                                                                          

                                                                          
      </li>
      <li class="itemize">Suppose <i>A</i> is not displaced before, but is displaced to array <i>C</i> after.
      None of the original contents of <i>A</i> appears in <i>A</i> afterwards; <i>A</i> now
      contains (some of) the contents of <i>C</i>, without any rearrangement of <i>C</i>.
      </li>
      <li class="itemize">Suppose <i>A</i> is displaced to array <i>B</i> before the call, and is displaced
      to  array  <i>C</i> after  the  call.  (Note  that  <i>B</i> and  <i>C</i> may  be  the  same
      array.) The contents of <i>B</i> do not appear in <i>A</i> afterwards (unless such
      contents also happen to be in <i>C</i>, as when <i>B</i> and <i>C</i> are the same, for
      example). If <tt>:displaced-index-offset</tt> is not speciﬁed in the call to
      <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt>, it defaults to zero; the old oﬀset (into <i>B</i>) is not retained.
      </li>
      <li class="itemize">Suppose  <i>A</i>  is  displaced  to  array  <i>B</i>  before  the  call,  but  is  not
      displaced  afterwards.  In  this  case  <i>A</i> gets  a  new  “data  region”  and
      (some  of)  the  contents  of  <i>B</i>  are  copied  into  it  as  appropriate  to
      maintain  the  existing  old  contents.  Additional  elements  of  <i>A</i>  are
      taken from the <tt>:initial-element</tt> argument. However, the use of the
      <tt>:initial-contents</tt> argument causes all old contents to be discarded.</li></ul>
<!--l. 953--><p class="indent" >   If array <i>X</i> is displaced to array <i>Y </i>, and array <i>Y </i> is displaced to array <i>Z</i>, and
array <i>Y </i> is altered by <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt>, array <i>X</i> must now refer to the adjusted
contents of <i>Y </i>. This means that an implementation may not collapse the chain to
make <i>X</i> refer to <i>Z</i> directly and forget that the chain of reference passes through
array <i>Y </i>. (Caching techniques are of course permitted, as long as they preserve the
semantics speciﬁed here.)
<!--l. 961--><p class="indent" >   If <i>X</i> is displaced to <i>Y </i>, it is an error to adjust <i>Y </i> in such a way that it no
longer has enough elements to satisfy <i>X</i>. This error may be signaled at the time of
the adjustment, but this is not required.
<!--l. 965--><p class="indent" >   Note that omitting the <tt>:displaced-to</tt> argument to <tt><a 
href="symbols.html#x185-2637073r73">adjust-array</a></tt> is
equivalent to specifying <tt>:displaced-to nil</tt>; in either case, the array is not
displaced after the call regardless of whether it was displaced before the
call.
</div>
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
<!--l. 6--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="string.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse95.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse95.html#tailclmse95.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse96.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="array.html#clmse96.html" >Up</a><tt>&#x003E;</tt></div><a 
 id="tailclmse96.html"></a>   </div> </div> 
</body></html> 
