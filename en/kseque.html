<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>14 Sequences</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-20 16:10:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
<!--l. 8--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse78.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse77.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse77.html#tailclmse77.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailkseque.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clm.html#kseque.html" >Up</a><tt>&#x003E;</tt>&lt;<a href="../index.html">Main Page</a>&gt;</div><h2 class="chapterHead"><span class="titlemark">Chapter 14</span><br /><a 
href="clm.html#QQ2-96-1222" id="x96-119200014">Sequences</a></h2><div class="chapterTOCS">
    <span class="sectionToc" >14.1 <a 
href="clmse78.html#x97-120700014.1">Simple Sequence Functions</a></span>
<br />    <span class="sectionToc" >14.2 <a 
href="clmse79.html#x98-121200014.2">Concatenating, Mapping, and Reducing Sequences</a></span>
<br />    <span class="sectionToc" >14.3 <a 
href="clmse80.html#x99-121700014.3">Modifying Sequences</a></span>
<br />    <span class="sectionToc" >14.4 <a 
href="clmse81.html#x100-123200014.4">Searching Sequences for Items</a></span>
<br />    <span class="sectionToc" >14.5 <a 
href="clmse82.html#x101-123900014.5">Sorting and Merging</a></span>
   </div>
<!--l. 11--><p class="indent" >   The type <tt>sequence</tt> encompasses both lists and vectors (one-dimensional
arrays). While these are diﬀerent data structures with diﬀerent structural
properties leading to diﬀerent algorithmic uses, they do have a common property:
each contains an ordered set of elements. Note that <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> is considered to be a
sequence of length zero.
<!--l. 18--><p class="indent" >   Some operations are useful on both lists and arrays because they deal with
ordered sets of elements. One may ask the number of elements, reverse the
ordering, extract a subsequence, and so on. For such purposes Common Lisp
provides a set of generic functions on sequences.
<!--l. 23--><p class="indent" >   Note that this remark, predating the design of the Common Lisp Object
System, uses the term “generic” in a generic sense, and not necessarily in the
technical sense used by CLOS (see chapter <a 
href="dtypes.html#x9-400002">2<!--tex4ht:ref: DTYPES --></a>).
<div class="flushleft" 
>
<!--l. 28--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%" class="tabular"><tr><td align="left" >elt         </td><td align="left" >reverse      </td><td align="left" >map      </td><td align="left" >remove              </td>
</tr><tr><td align="left" >length    </td><td align="left" >nreverse     </td><td align="left" >some     </td><td align="left" >remove-duplicates</td>
</tr><tr><td align="left" >subseq   </td><td align="left" >concatenate</td><td align="left" >every    </td><td align="left" >delete                </td>
</tr><tr><td align="left" >copy-seq </td><td align="left" >position     </td><td align="left" >notany  </td><td align="left" >delete-duplicates  </td>
</tr><tr><td align="left" >ﬁll         </td><td align="left" >ﬁnd           </td><td align="left" >notevery</td><td align="left" >substitute          </td>
</tr><tr><td align="left" >replace   </td><td align="left" >sort          </td><td align="left" >reduce   </td><td align="left" >nsubstitute         </td>
</tr><tr><td align="left" >count     </td><td align="left" >merge        </td><td align="left" >search   </td><td align="left" >mismatch           </td></tr></table></div></div>
<!--l. 40--><p class="noindent" >Some of these operations come in more than one version. Such versions are indicated
by adding a suﬃx (or occasionally a preﬁx) to the basic name of the operation. In
addition, many operations accept one or more optional keyword arguments that
can modify the operation in various ways.
<!--l. 46--><p class="indent" >   If the operation requires testing sequence elements according to some
criterion, then the criterion may be speciﬁed in one of two ways. The basic
operation accepts an item, and elements are tested for being <tt><a 
href="symbols.html#x187-2636338r338">eql</a></tt> to that
item. (A test other than <tt><a 
href="symbols.html#x187-2636338r338">eql</a></tt> can be speciﬁed by the <tt>:test</tt> or <tt>:test-not</tt>
keyword. It is an error to use both of these keywords in the same call.) The
                                                                          

                                                                          
variants formed by adding <tt>-if</tt> and <tt>-if-not</tt> to the basic operation name do
not take an item, but instead a one-argument predicate, and elements
are tested for satisfying or not satisfying the predicate. As an example,
<div class="lisp"><div class="tabbing">
(remove <i>item</i> <i>sequence</i>)
   <br>
<!--l. 60--><p class="noindent" ></div>
<!--l. 60--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-119300014" id="x96-119300014"></a></span>
<!--l. 60--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-119400014" id="x96-119400014"></a></span>
</div>
<!--l. 61--><p class="indent" >   returns a copy of <i>sequence</i> from which all elements <tt><a 
href="symbols.html#x187-2636338r338">eql</a></tt> to <i>item</i> have been
removed; <div class="lisp"><div class="tabbing">
(remove <i>item</i> <i>sequence</i> <tt>:test</tt> #&#x2019;equal)
   <br>
<!--l. 65--><p class="noindent" ></div>
<!--l. 65--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-119500014" id="x96-119500014"></a></span>
<!--l. 65--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-119600014" id="x96-119600014"></a></span>
</div>
<!--l. 66--><p class="indent" >   returns a copy of <i>sequence</i> from which all elements <tt><a 
href="symbols.html#x187-2636339r339">equal</a></tt> to <i>item</i> have been
removed; <div class="lisp"><div class="tabbing">
(remove-if #&#x2019;numberp <i>sequence</i>)
   <br>
<!--l. 70--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 70--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-119700014" id="x96-119700014"></a></span>
<!--l. 70--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-119800014" id="x96-119800014"></a></span>
</div>
<!--l. 71--><p class="indent" >   returns a copy of <i>sequence</i> from which all numbers have been removed.
<!--l. 73--><p class="indent" >   If an operation tests elements of a sequence in any manner, the keyword
argument <tt>:key</tt>, if not <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt>, should be a function of one argument that will extract
from an element the part to be tested in place of the whole element. For example,
the eﬀect of the MacLisp expression <tt>(assq item seq)</tt> could be obtained by
<div class="lisp"><div class="tabbing">
(ﬁnd <i>item</i> <i>sequence</i> <tt>:test</tt> #&#x2019;eq <tt>:key</tt> #&#x2019;car)
   <br>
<!--l. 81--><p class="noindent" ></div>
<!--l. 81--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-119900014" id="x96-119900014"></a></span>
<!--l. 81--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-120000014" id="x96-120000014"></a></span>
</div>
<!--l. 82--><p class="indent" >   This searches for the ﬁrst element of <i>sequence</i> whose <i>car</i> is <tt><a 
href="symbols.html#x187-2636337r337">eq</a></tt> to <i>item</i>. <div class="newer">
X3J13 voted in June 1988 <a 
 id="dx96-1200001"></a>to allow the <tt>:key</tt> function to be only of type
<tt>symbol</tt> or <tt><a 
href="symbols.html#x187-2636399r399">function</a></tt>; a lambda-expression is no longer acceptable as a
functional argument. One must use the <tt><a 
href="symbols.html#x187-2636399r399">function</a></tt> special operator or the
abbreviation <tt>#&#x2019;</tt> before a lambda-expression that appears as an explicit argument
form.
</div>
<!--l. 92--><p class="indent" >   For some operations it can be useful to specify the direction in which the
sequence is conceptually processed. In this case the basic operation normally
processes the sequence in the forward direction, and processing in the reverse
direction is indicated by a non-<tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> value for the keyword argument <tt>:from-end</tt>.
(The processing order speciﬁed by the <tt>:from-end</tt> is purely conceptual. Depending
on the object to be processed and on the implementation, the actual processing
order may be diﬀerent. For this reason a user-supplied <i>test</i> function should be free
                                                                          

                                                                          
of side eﬀects.)
<!--l. 102--><p class="indent" >   Many operations allow the speciﬁcation of a subsequence to be operated upon.
Such operations have keyword arguments called <tt>:start</tt> and <tt>:end</tt>. These
arguments should be integer indices into the sequence, with <span class="math"><i>start</i> ≤<i>end</i></span> (it is an
error if <span class="math"><i>start</i> &#x003E; <i>end</i></span>). They indicate the subsequence starting with and <i>including</i>
element <i>start</i> and up to but <i>excluding</i> element <i>end</i>. The length of the subsequence
is therefore <span class="math"><i>end</i> −<i>start</i></span>. If <i>start</i> is omitted, it defaults to zero; and if <i>end</i> is
omitted or <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt>, it defaults to the length of the sequence. Therefore if both
<i>start</i> and <i>end</i> are omitted, the entire sequence is processed by default.
For the most part, subsequence speciﬁcation is permitted purely for the
sake of eﬃciency; one could simply call <tt><a 
href="symbols.html#x187-2636849r849">subseq</a></tt> instead to extract the
subsequence before operating on it. Note, however, that operations that calculate
indices return indices into the original sequence, not into the subsequence:
<div class="lisp"><div class="tabbing">
(position #\b &#x0022;foobar&#x0022; <tt>:start</tt> 2 <tt>:end</tt> 5) <span class="math"> ⇒</span> 3
   <br>                                      (position #\b (subseq &#x0022;foobar&#x0022; 2 5)) <span class="math"> ⇒</span> 1<br>
<!--l. 123--><p class="noindent" ></div>
<!--l. 123--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-120100014" id="x96-120100014"></a></span>
<!--l. 123--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-120200014" id="x96-120200014"></a></span>
</div>
<!--l. 124--><p class="indent" >   If two sequences are involved, then the keyword arguments <tt>:start1</tt>, <tt>:end1</tt>,
<tt>:start2</tt>, and <tt>:end2</tt> are used to specify separate subsequences for each
sequence.
<div class="newer">
<!--l. 130--><p class="indent" >   X3J13 voted in June 1988 <a 
 id="dx96-1202001"></a>(and further clariﬁcation was voted in January
1989 <a 
 id="dx96-1202002"></a>) to specify that these rules apply not only to all built-in functions
that have keyword parameters named <tt>:start</tt>, <tt>:start1</tt>, <tt>:start2</tt>, <tt>:end</tt>,
<tt>:end1</tt>, or <tt>:end2</tt> but also to functions such as <tt><a 
href="symbols.html#x187-2636849r849">subseq</a></tt> that take required
or optional parameters that are documented as being named <i>start</i> or
<i>end</i>.
                                                                          

                                                                          
      <ul class="itemize1">
      <li class="itemize">A “start” argument must always be a non-negative integer and defaults
      to zero if not supplied; it is not permissible to pass <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> as a “start”
      argument.
      </li>
      <li class="itemize">An  “end”  argument  must  be  either  a  non-negative  integer  or  <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt>
      (which indicates the end of the sequence) and defaults to <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> if not
      supplied; therefore supplying <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> is equivalent to not supplying such
      an argument.
      </li>
      <li class="itemize">If the “end”  argument is an integer, it must be no greater than the
      active length of the corresponding sequence (as returned by the function
      <tt><a 
href="symbols.html#x187-2636487r487">length</a></tt>).
      </li>
      <li class="itemize">The default value for the “end”  argument is the active length of the
      corresponding sequence.
      </li>
      <li class="itemize">The “start” value (after defaulting, if necessary) must not be greater
      than the corresponding “end” value (after defaulting, if necessary).</li></ul>
<!--l. 156--><p class="noindent" >This may be summarized as follows. Let <i>x</i> be the sequence within which indices are
to be considered. Let <i>s</i> be the “start” argument for that sequence of any
standard function, whether explicitly speciﬁed or defaulted, through omission,
to zero. Let <i>e</i> be the “end” argument for that sequence of any standard
function, whether explicitly speciﬁed or defaulted, through omission or
an explicitly passed <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> value, to the active length of <i>x</i>, as returned by
<tt><a 
href="symbols.html#x187-2636487r487">length</a></tt>. Then it is an error if the test <tt>(&#x003C;= 0 <i>s</i> <i>e</i> (length <i>x</i>))</tt> is not
true.
</div>
<!--l. 168--><p class="indent" >   For some functions, notably <tt><a 
href="symbols.html#x187-2636736r736">remove</a></tt> and <tt><a 
href="symbols.html#x187-2636293r293">delete</a></tt>, the keyword argument
<tt>:count</tt> is used to specify how many occurrences of the item should be aﬀected. If
this is <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> or is not supplied, all matching items are aﬀected.
<!--l. 173--><p class="indent" >   In the following function descriptions, an element <i>x</i> of a sequence “satisﬁes the
test” if any of the following holds:
                                                                          

                                                                          
      <ul class="itemize1">
      <li class="itemize">A basic function was called, <i>testfn</i> was speciﬁed by the keyword <tt>:test</tt>,
      and <tt>(funcall <i>testfn</i> <i>item</i> (<i>keyfn</i> <i>x</i>))</tt> is true.
      </li>
      <li class="itemize">A  basic  function  was  called,  <i>testfn</i>  was  speciﬁed  by  the  keyword
      <tt>:test-not</tt>, and <tt>(funcall <i>testfn</i> <i>item</i> (<i>keyfn</i> <i>x</i>))</tt> is false.
      </li>
      <li class="itemize">An <tt>-if</tt> function was called, and <tt>(funcall <i>predicate</i> (<i>keyfn</i> <i>x</i>))</tt>
      is true.
      </li>
      <li class="itemize">An <tt>-if-not</tt> function was called, and <tt>(funcall <i>predicate</i> (<i>keyfn</i>
      <i>x</i>))</tt> is false.</li></ul>
<!--l. 194--><p class="noindent" >In each case <i>keyfn</i> is the value of the <tt>:key</tt> keyword argument (the default being the
identity function). See, for example, <tt><a 
href="symbols.html#x187-2636736r736">remove</a></tt>.
<!--l. 198--><p class="indent" >   In the following function descriptions, two elements <i>x</i> and <i>y</i> taken from
sequences “match” if either of the following holds:
      <ul class="itemize1">
      <li class="itemize"><i>testfn</i>  was  speciﬁed  by  the  keyword  <tt>:test</tt>,  and  <tt>(funcall <i>testfn</i>
      (<i>keyfn</i> <i>x</i>) (<i>keyfn</i> <i>y</i>))</tt> is true.
      </li>
      <li class="itemize"><i>testfn</i> was speciﬁed by the keyword <tt>:test-not</tt>, and <tt>(funcall <i>testfn</i>
      (<i>keyfn</i> <i>x</i>) (<i>keyfn</i> <i>y</i>))</tt> is false.</li></ul>
<!--l. 210--><p class="noindent" >See, for example, <tt><a 
href="symbols.html#x187-2636768r768">search</a></tt>.
<div class="newer">
<!--l. 213--><p class="indent" >   X3J13 voted in June 1988 <a 
 id="dx96-1202003"></a>to allow the <i>testfn</i> or <tt>predicate</tt> to be only of type
<tt>symbol</tt> or <tt><a 
href="symbols.html#x187-2636399r399">function</a></tt>; a lambda-expression is no longer acceptable as a
functional argument. One must use the <tt><a 
href="symbols.html#x187-2636399r399">function</a></tt> special operator or the
abbreviation <tt>#&#x2019;</tt> before a lambda-expression that appears as an explicit argument
form.
</div>
<!--l. 221--><p class="indent" >   You may depend on the order in which arguments are given to <i>testfn</i>; this
permits the use of non-commutative test functions in a predictable manner. The
order of the arguments to <i>testfn</i> corresponds to the order in which those
                                                                          

                                                                          
arguments (or the sequences containing those arguments) were given to the
sequence function in question. If a sequence function gives two elements from the
same sequence argument to <i>testfn</i>, they are given in the same order in which they
appear in the sequence.
<!--l. 232--><p class="indent" >   Whenever a sequence function must construct and return a new vector, it
always returns a <i>simple</i> vector (see section <a 
href="clmse7.html#x14-920002.5">2.5<!--tex4ht:ref: ARRAY-TYPE-SECTION --></a>). Similarly, any strings constructed
will be simple strings.
<div class="defun">
<!--l. 237--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx96-1202004"></a><a 
 id="x96-1202005r369"></a> <b>complement</b>  <i>fn</i>
</div>
<!--l. 240--><p class="indent" >   Returns a function whose value is the same as that of <tt><a 
href="symbols.html#x187-2636615r615">not</a></tt> applied to the result
of applying the function <i>fn</i> to the same arguments. One could deﬁne <tt><a 
href="symbols.html#x187-2636238r238">complement</a></tt>
as follows: <div class="lisp"><div class="tabbing">
(defun complement (fn)
   <br>                                                       #&#x2019;(lambda (&#x0026;rest arguments)<br>
      (not (apply fn arguments))))<br>
<!--l. 247--><p class="noindent" ></div>
<!--l. 247--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-120300014" id="x96-120300014"></a></span>
<!--l. 247--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-120400014" id="x96-120400014"></a></span>
</div>
<!--l. 249--><p class="indent" >   One intended use of <tt><a 
href="symbols.html#x187-2636238r238">complement</a></tt> is to supplant the use of <tt>:test-not</tt>
arguments and <tt>-if-not</tt> functions. <div class="lisp"><div class="tabbing">
(remove-if-not #&#x2019;virtuous senators) <span class="math"> ≡</span>
   <br>                (remove-if (complement #&#x2019;virtuous) senators)<br>
<br>                                        (remove-duplicates telephone-book<br>
                   :test-not #&#x2019;mismatch) <span class="math"> ≡</span><br>
   (remove-duplicates telephone-book<br>
                      :test (complement #&#x2019;mismatch))<br>
                                                                          

                                                                          
<!--l. 259--><p class="noindent" ></div>
<!--l. 259--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-120500014" id="x96-120500014"></a></span>
<!--l. 259--><p class="noindent" ><span class="paragraphHead"><a 
href="#x96-120600014" id="x96-120600014"></a></span>
</div>
</div>
<!--l. 262--><p class="noindent" >




                                                                          

                                                                          
   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse78.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse77.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse77.html#tailclmse77.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="kseque.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clm.html#kseque.html" >Up</a><tt>&#x003E;</tt></div><a 
 id="tailkseque.html"></a>   </div> </div> 
</body></html> 
