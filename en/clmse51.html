<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Declaration Syntax</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-20 16:10:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
<!--l. 28--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse52.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="declar.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="declar.html#taildeclar.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse51.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="declar.html#clmse51.html" >Up</a><tt>&#x003E;</tt>&lt;<a href="../index.html">Main Page</a>&gt;</div><h3 class="sectionHead"><span class="titlemark">9.1   </span> <a 
href="clm.html#QQ2-65-800" id="x65-7910009.1">Declaration Syntax</a></h3>
<!--l. 31--><p class="noindent" >The <tt><a 
href="symbols.html#x187-2636271r271">declare</a></tt> construct is used for embedding declarations within executable code.
Global declarations and declarations that are computed by a program are
established by the <tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt> construct.
<!--l. 35--><p class="indent" >   Macro <tt><a 
href="symbols.html#x187-2636269r269">declaim</a></tt>, which is guaranteed to be recognized appropriately by the
compiler, is often more convenient than <tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt> for establishing global
declarations.
<div class="defspec">
<div class="defmacheader">
<!--l. 40--><p class="indent" >   <div class="tabbing">
 <i>[Special operator]</i> <b>declare</b> <a 
 id="dx65-791001"></a><a 
 id="x65-791002r142"></a> {decl-spec}*
   <br>
                                                                          

                                                                          
<!--l. 41--><p class="noindent" ></div>
<!--l. 41--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-7920009.1" id="x65-7920009.1"></a></span>
</div>
<!--l. 42--><p class="indent" >   A <tt><a 
href="symbols.html#x187-2636271r271">declare</a></tt> form is known as a <i>declaration</i>. Declarations may occur only at the
beginning of the bodies of certain special operators; that is, a declaration may
occur only as a statement of such a special operator, and all statements preceding
it (if any) must also be <tt><a 
href="symbols.html#x187-2636271r271">declare</a></tt> forms (or possibly documentation strings, in
some cases). Declarations may occur in lambda-expressions and in the forms listed
here. <div class="lisp"><div class="tabbing">
<tt><a 
href="symbols.html#x187-2636282r282">define-setf-method</a></tt>     <tt><a 
href="symbols.html#x187-2636461r461">labels</a></tt>
   <br>   <tt><a 
href="symbols.html#x187-2636284r284">defmacro</a></tt>               <tt><a 
href="symbols.html#x187-2636488r488">let</a></tt><br>   <tt><a 
href="symbols.html#x187-2636288r288">defsetf</a></tt>                <tt><a 
href="symbols.html#x187-2636489r489">let*</a></tt><br>
<tt><a 
href="symbols.html#x187-2636290r290">deftype</a></tt>                <tt><a 
href="symbols.html#x187-2636501r501">locally</a></tt><br>  <tt><a 
href="symbols.html#x187-2636291r291">defun</a></tt>                  <tt><a 
href="symbols.html#x187-2636532r532">macrolet</a></tt><br>
<tt><a 
href="symbols.html#x187-2636310r310">do</a></tt>                     <tt><a 
href="symbols.html#x187-2636595r595">multiple-value-bind</a></tt><br>
<tt><a 
href="symbols.html#x187-2636311r311">do*</a></tt>                    <tt><a 
href="symbols.html#x187-2636696r696">prog</a></tt><br>         <tt><a 
href="symbols.html#x187-2636312r312">do-all-symbols</a></tt>         <tt><a 
href="symbols.html#x187-2636697r697">prog*</a></tt><br>
<tt><a 
href="symbols.html#x187-2636313r313">do-external-symbols</a></tt>    <tt><a 
href="symbols.html#x187-2636936r936">with-input-from-string</a></tt><br>
<tt><a 
href="symbols.html#x187-2636314r314">do-symbols</a></tt>             <tt><a 
href="symbols.html#x187-2636937r937">with-open-file</a></tt><br>
<tt><a 
href="symbols.html#x187-2636317r317">dolist</a></tt>                 <tt><a 
href="symbols.html#x187-2636938r938">with-open-stream</a></tt><br>
<tt><a 
href="symbols.html#x187-2636318r318">dotimes</a></tt>                <tt><a 
href="symbols.html#x187-2636939r939">with-output-to-string</a></tt><br>
<tt><a 
href="symbols.html#x187-2636379r379">flet</a></tt>                   <tt>with-conditions-restarts</tt><br>
<tt><a 
href="symbols.html#x187-2636692r692">print-unreadable-object</a></tt><tt><a 
href="symbols.html#x187-2636943r943">with-standard-io-syntax</a></tt><br>
<!--l. 65--><p class="noindent" ></div>
<!--l. 65--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-7930009.1" id="x65-7930009.1"></a></span>
<!--l. 65--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-7940009.1" id="x65-7940009.1"></a></span>
</div>
<div class="lisp">
<!--l. 67--><p class="indent" >   <div class="tabbing">
<tt><a 
href="symbols.html#x187-2636276r276">defgeneric</a></tt>             <tt><a 
href="symbols.html#x187-2636406r406">generic-function</a></tt>
                                                                          

                                                                          
   <br>                       <tt><a 
href="symbols.html#x187-2636280r280">define-method-combination</a></tt><tt><a 
href="symbols.html#x187-2636407r407">generic-labels</a></tt><br>
<tt><a 
href="symbols.html#x187-2636285r285">defmethod</a></tt>              <tt><a 
href="symbols.html#x187-2636932r932">with-added-methods</a></tt><br>            <tt><a 
href="symbols.html#x187-2636405r405">generic-flet</a></tt><br>
<!--l. 73--><p class="noindent" ></div>
<!--l. 73--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-7950009.1" id="x65-7950009.1"></a></span>
<!--l. 73--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-7960009.1" id="x65-7960009.1"></a></span>
</div>
<div class="lisp">
<!--l. 75--><p class="indent" >   <div class="tabbing">
<tt><a 
href="symbols.html#x187-2636864r864">symbol-macrolet</a></tt>        <tt><a 
href="symbols.html#x187-2636942r942">with-slots</a></tt>
   <br>                                              <tt><a 
href="symbols.html#x187-2636931r931">with-accessors</a></tt><br>
<!--l. 79--><p class="noindent" ></div>
<!--l. 79--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-7970009.1" id="x65-7970009.1"></a></span>
<!--l. 79--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-7980009.1" id="x65-7980009.1"></a></span>
</div>
<!--l. 81--><p class="indent" >   It is an error to attempt to evaluate a declaration. Those special operators
that permit declarations to appear perform explicit checks for their presence.
<!--l. 85--><p class="indent" >   It is permissible for a macro call to expand into a declaration and be
recognized as such, provided that the macro call appears where a declaration may
legitimately appear. (However, a macro call may not appear in place of a
<i>decl-spec</i>.)
<!--l. 90--><p class="indent" >   A declaration is recognized only as such if it appears explicitly, as a list whose
<i>car</i> is the symbol <tt><a 
href="symbols.html#x187-2636271r271">declare</a></tt>, in the body of a relevant special operator. (Note,
however, that it is still possible for a macro to expand into a call to the <tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt>
function.)
<!--l. 96--><p class="indent" >   Each <i>decl-spec</i> is a list whose <i>car</i> is a symbol specifying the kind of declaration
to be made. Declarations may be divided into two classes: those that concern the
bindings of variables, and those that do not. (The <tt>special</tt> declaration is the
                                                                          

                                                                          
sole exception: it eﬀectively falls into both classes, as explained below.)
Those that concern variable bindings apply only to the bindings made
by the form at the head of whose body they appear. For example, in
<div class="lisp"><div class="tabbing">
(defun foo (x)
   <br>                    (declare (type ﬂoat x)) ...<br>                    (let ((x &#x2019;a)) ...)<br>
  ...)<br>
<!--l. 109--><p class="noindent" ></div>
<!--l. 109--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-7990009.1" id="x65-7990009.1"></a></span>
<!--l. 109--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8000009.1" id="x65-8000009.1"></a></span>
</div>
<!--l. 110--><p class="indent" >   the <tt>type</tt> declaration applies only to the outer binding of <tt>x</tt>, and not to the
binding made in the <tt><a 
href="symbols.html#x187-2636488r488">let</a></tt>.
<!--l. 113--><p class="indent" >   Declarations that do not concern themselves with variable bindings are
pervasive, aﬀecting all code in the body of the special operator. As an example of
a pervasive declaration, <div class="lisp"><div class="tabbing">
(defun foo (x y) (declare (notinline ﬂoor)) ...)
   <br>
<!--l. 118--><p class="noindent" ></div>
<!--l. 118--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8010009.1" id="x65-8010009.1"></a></span>
<!--l. 118--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8020009.1" id="x65-8020009.1"></a></span>
</div>
<!--l. 119--><p class="indent" >   advises that everywhere within the body of <tt>foo</tt> the function <tt><a 
href="symbols.html#x187-2636388r388">floor</a></tt> should not
be open-coded but called as an out-of-line subroutine.
                                                                          

                                                                          
<!--l. 122--><p class="indent" >   Some special operators contain pieces of code that, properly speaking, are not
part of the body of the special operator. Examples of this are initialization forms
that provide values for bound variables, and the result forms of iteration
constructs. In all cases such additional code is within the scope of any
pervasive declarations appearing before the body of the special operator.
Non-pervasive declarations have no eﬀect on such code, except (of course)
in those situations where the code is deﬁned to be within the scope of
the variables aﬀected by such non-pervasive declarations. For example:
<div class="lisp"><div class="tabbing">
(defun few (x <tt>&#x0026;optional</tt> (y *print-circle*))
   <br>                                                    (declare (special *print-circle*))<br>
  ...)<br>
<!--l. 136--><p class="noindent" ></div>
<!--l. 136--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8030009.1" id="x65-8030009.1"></a></span>
<!--l. 136--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8040009.1" id="x65-8040009.1"></a></span>
</div>
<!--l. 137--><p class="indent" >   The reference to <tt><a 
href="symbols.html#x187-2636027r27">*print-circle*</a></tt> in the ﬁrst line of this example is special
because of the declaration in the second line. <div class="lisp"><div class="tabbing">
(defun nonsense (k x z)
   <br>                                     (foo z x)               ;First call to <tt>foo</tt><br>
  (let ((j (foo k x))     ;Second call to <tt>foo</tt><br>
        (x (* k k)))<br>                    (declare (inline foo) (special x z))<br>
    (foo x j z)))         ;Third call to <tt>foo</tt><br>
<!--l. 146--><p class="noindent" ></div>
<!--l. 146--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8050009.1" id="x65-8050009.1"></a></span>
                                                                          

                                                                          
<!--l. 146--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8060009.1" id="x65-8060009.1"></a></span>
</div>
<!--l. 147--><p class="indent" >   In this rather nonsensical example, the <tt>inline</tt> declaration applies to the
second and third calls to <tt>foo</tt>, but not to the ﬁrst one. The <tt>special</tt> declaration of
<tt>x</tt> causes the <tt><a 
href="symbols.html#x187-2636488r488">let</a></tt> form to make a special binding for <tt>x</tt> and causes the
reference to <tt>x</tt> in the body of the <tt><a 
href="symbols.html#x187-2636488r488">let</a></tt> to be a special reference. The reference
to <tt>x</tt> in the second call to <tt>foo</tt> is also a special reference. The reference
to <tt>x</tt> in the ﬁrst call to <tt>foo</tt> is a local reference, not a special one. The
<tt>special</tt> declaration of <tt>z</tt> causes the reference to <tt>z</tt> in the call to <tt>foo</tt> to be a
special reference; it will not refer to the parameter to <tt>nonsense</tt> named <tt>z</tt>,
because that parameter binding has not been declared to be <tt>special</tt>. (The
<tt>special</tt> declaration of <tt>z</tt> does not appear in the body of the <tt><a 
href="symbols.html#x187-2636291r291">defun</a></tt>, but
in an inner construct, and therefore does not aﬀect the binding of the
parameter.)
<div class="new">
<!--l. 166--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx65-806001"></a>to replace the rules concerning the scope of
declarations occurring at the head of a special operator or lambda-expression:
      <ul class="itemize1">
      <li class="itemize">The scope of a declaration always includes the body forms, as well as
      any “stepper” or “result” forms (which are logically part of the body),
      of the special operator or lambda-expression.
      </li>
      <li class="itemize">If the declaration applies to a name binding, then the scope of the
      declaration also includes the scope of the name binding.</li></ul>
<!--l. 178--><p class="noindent" >Note that the distinction between pervasive and non-pervasive declarations is
eliminated. An important change from the ﬁrst edition is that “initialization”
forms are speciﬁcally <i>not</i> included as part of the body under the ﬁrst rule; on the
other hand, in many cases initialization forms may fall within the scope of certain
declarations under the second rule.
</div>
<div class="new">
<!--l. 188--><p class="indent" >   X3J13 also voted in January 1989 <a 
 id="dx65-806002"></a>to change the interpretation of <tt>type</tt>
declarations (see section <a 
href="clmse52.html#x66-8370009.2">9.2<!--tex4ht:ref: DECLARATION-SPECIFIERS-SECTION --></a>).
</div>
<div class="new">
                                                                          

                                                                          
<!--l. 195--><p class="indent" >   These changes aﬀect the interpretation of some of the examples from the ﬁrst
edition. <div class="lisp"><div class="tabbing">
(defun foo (x)
   <br>                    (declare (type ﬂoat x)) ...<br>                    (let ((x &#x2019;a)) ...)<br>
  ...)<br>
<!--l. 202--><p class="noindent" ></div>
<!--l. 202--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8070009.1" id="x65-8070009.1"></a></span>
<!--l. 202--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8080009.1" id="x65-8080009.1"></a></span>
</div>
<!--l. 203--><p class="indent" >   Under the interpretation approved by X3J13, the type declaration applies to
<i>both</i> bindings of <tt>x</tt>. More accurately, the type declaration is considered to apply to
variable references rather than bindings, and the type declaration refers to every
reference in the body of <tt>foo</tt> to a variable named <tt>x</tt>, no matter to what binding it
may refer. <div class="lisp"><div class="tabbing">
(defun foo (x y) (declare (notinline ﬂoor)) ...)
   <br>
<!--l. 211--><p class="noindent" ></div>
<!--l. 211--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8090009.1" id="x65-8090009.1"></a></span>
<!--l. 211--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8100009.1" id="x65-8100009.1"></a></span>
</div>
<!--l. 212--><p class="indent" >   This example of the use of <tt>notinline</tt> stands unchanged, but the following
slight extension of it would change: <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(defun foo (x &#x0026;optional (y (ﬂoor x)))
   <br>                                                        (declare (notinline ﬂoor)) ...)<br>
<!--l. 217--><p class="noindent" ></div>
<!--l. 217--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8110009.1" id="x65-8110009.1"></a></span>
<!--l. 217--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8120009.1" id="x65-8120009.1"></a></span>
</div>
<!--l. 218--><p class="indent" >   Under ﬁrst edition rules, the <tt>notinline</tt> declaration would be considered
to apply to the call to <tt><a 
href="symbols.html#x187-2636388r388">floor</a></tt> in the initialization form for <tt>y</tt>. Under the
interpretation approved by X3J13, the <tt>notinline</tt> would <i>not</i> apply to
that particular call to <tt><a 
href="symbols.html#x187-2636388r388">floor</a></tt>. Instead the user must write something like
<div class="lisp"><div class="tabbing">
(defun foo (x &#x0026;optional (y (locally (declare (notinline ﬂoor))
   <br>                                                            (ﬂoor x))))<br>
  (declare (notinline ﬂoor)) ...)<br>
<!--l. 227--><p class="noindent" ></div>
<!--l. 227--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8130009.1" id="x65-8130009.1"></a></span>
<!--l. 227--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8140009.1" id="x65-8140009.1"></a></span>
</div>
<!--l. 228--><p class="indent" >   or perhaps <div class="lisp"><div class="tabbing">
(locally (declare (notinline ﬂoor))
   <br>                                       (defun foo (x &#x0026;optional (y (ﬂoor x))) ...))<br>
<!--l. 232--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 232--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8150009.1" id="x65-8150009.1"></a></span>
<!--l. 232--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8160009.1" id="x65-8160009.1"></a></span>
</div>
<!--l. 233--><p class="indent" >   Similarly, the <tt>special</tt> declaration in <div class="lisp"><div class="tabbing">
(defun few (x <tt>&#x0026;optional</tt> (y *print-circle*))
   <br>                                                    (declare (special *print-circle*))<br>
  ...)<br>
<!--l. 238--><p class="noindent" ></div>
<!--l. 238--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8170009.1" id="x65-8170009.1"></a></span>
<!--l. 238--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8180009.1" id="x65-8180009.1"></a></span>
</div>
<!--l. 239--><p class="indent" >   is not considered to apply to the reference in the initialization form for <tt>y</tt> in
<tt>few</tt>. As for the <tt>nonsense</tt> example, <div class="lisp"><div class="tabbing">
(defun nonsense (k x z)
   <br>                                     (foo z x)               ;First call to <tt>foo</tt><br>
  (let ((j (foo k x))     ;Second call to <tt>foo</tt><br>
        (x (* k k)))<br>                    (declare (inline foo) (special x z))<br>
    (foo x j z)))         ;Third call to <tt>foo</tt><br>
<!--l. 248--><p class="noindent" ></div>
<!--l. 248--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8190009.1" id="x65-8190009.1"></a></span>
                                                                          

                                                                          
<!--l. 248--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8200009.1" id="x65-8200009.1"></a></span>
</div>
<!--l. 249--><p class="indent" >   under the interpretation approved by X3J13, the <tt>inline</tt> declaration is no
longer considered to apply to the second call to <tt>foo</tt>, because it is in an
initialization form, which is no longer considered in the scope of the declaration.
Similarly, the reference to <tt>x</tt> in that second call to <tt>foo</tt> is no longer taken to
be a special reference, but a local reference to the second parameter of
<tt>nonsense</tt>.
</div>
</div>
<tt>
<!--l. 259--><p class="indent" >   <a 
href="symbols.html#x187-2636501r501">locally</a></tt> executes the <i>form</i>s as an implicit <tt><a 
href="symbols.html#x187-2636700r700">progn</a></tt> and returns the value(s) of
the last <i>form</i>.
<div class="defspec">
<div class="defmacheader">
<!--l. 263--><p class="indent" >   <div class="tabbing">
 <i>[Special operator]</i> <b>locally</b> <a 
 id="dx65-820001"></a><a 
 id="x65-820002r143"></a> {declaration}* {form}*
   <br>
<!--l. 264--><p class="noindent" ></div>
<!--l. 264--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8210009.1" id="x65-8210009.1"></a></span>
</div>
<!--l. 265--><p class="indent" >   This change was made to accommodate the new compilation model for
top-level forms in a ﬁle (see section <a 
href="clmse122.html#x151-198200024.2">24.2<!--tex4ht:ref: COMPILER-SECTION --></a>). When a <tt><a 
href="symbols.html#x187-2636501r501">locally</a></tt> operator appears at
top level, the forms in its body are processed as top-level forms. This means that
one may, for example, meaningfully use <tt><a 
href="symbols.html#x187-2636501r501">locally</a></tt> to wrap declarations around a
<tt><a 
href="symbols.html#x187-2636291r291">defun</a></tt> or <tt><a 
href="symbols.html#x187-2636284r284">defmacro</a></tt> form: <div class="lisp"><div class="tabbing">
(locally
   <br>               (declare (optimize (safety 3) (space 3) (debug 3) (speed 1)))<br>
  (defun foo (x &#x0026;optional (y (abs x)) (z (sqrt y)))<br>            (bar x y z)))<br>
<!--l. 275--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 275--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8220009.1" id="x65-8220009.1"></a></span>
<!--l. 275--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8230009.1" id="x65-8230009.1"></a></span>
</div>
<!--l. 276--><p class="indent" >   Without assurance that this works one must write something cumbersome
such as <div class="lisp"><div class="tabbing">
   <br>                                                  (defun foo (x &#x0026;optional (y (locally<br>
                              (declare (optimize (safety 3)<br>
                                                 (space 3)<br>
                                                 (debug 3)<br>
                                                 (speed 1)))<br>
                              (abs x)))<br>                         (z (locally<br>
                              (declare (optimize (safety 3)<br>
                                                 (space 3)<br>
                                                 (debug 3)<br>
                                                 (speed 1)))<br>
                              (sqrt y))))<br>                     (locally<br>
    (declare (optimize (safety 3) (space 3) (debug 3) (speed 1)))<br>
    (bar x y z)))<br>
<!--l. 295--><p class="noindent" ></div>
<!--l. 295--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8240009.1" id="x65-8240009.1"></a></span>
<!--l. 295--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8250009.1" id="x65-8250009.1"></a></span>
</div>
</div>
<div class="defun">
<!--l. 298--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx65-825001"></a><a 
 id="x65-825002r144"></a> <b>proclaim</b>  <i>decl-spec</i>
</div>
<!--l. 301--><p class="indent" >   The function <tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt> takes a <i>decl-spec</i> as its argument and puts it into eﬀect
                                                                          

                                                                          
globally. (Such a global declaration is called a <i>proclamation</i>.) Because
<tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt> is a function, its argument is always evaluated. This allows a
program to compute a declaration and then put it into eﬀect by calling
<tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt>.
<!--l. 308--><p class="indent" >   Any variable names mentioned are assumed to refer to the dynamic values of
the variable. For example, the proclamation <div class="lisp"><div class="tabbing">
(proclaim &#x2019;(type ﬂoat tolerance))
   <br>
<!--l. 313--><p class="noindent" ></div>
<!--l. 313--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8260009.1" id="x65-8260009.1"></a></span>
<!--l. 313--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8270009.1" id="x65-8270009.1"></a></span>
</div>
<!--l. 314--><p class="indent" >   once executed, speciﬁes that the dynamic value of <tt>tolerance</tt> should always be
a ﬂoating-point number. Similarly, any function-names mentioned are assumed to
refer to the global function deﬁnition.
<!--l. 320--><p class="indent" >   A proclamation constitutes a universal declaration, always in force unless
locally shadowed. For example, <div class="lisp"><div class="tabbing">
(proclaim &#x2019;(inline ﬂoor))
   <br>
<!--l. 324--><p class="noindent" ></div>
<!--l. 324--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8280009.1" id="x65-8280009.1"></a></span>
<!--l. 324--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8290009.1" id="x65-8290009.1"></a></span>
</div>
<!--l. 325--><p class="indent" >   advises that <tt><a 
href="symbols.html#x187-2636388r388">floor</a></tt> should normally be open-coded in-line by the compiler (but
in the situation <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(defun foo (x y) (declare (notinline ﬂoor)) ...)
   <br>
<!--l. 329--><p class="noindent" ></div>
<!--l. 329--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8300009.1" id="x65-8300009.1"></a></span>
<!--l. 329--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8310009.1" id="x65-8310009.1"></a></span>
</div>
<!--l. 330--><p class="indent" >   it will be compiled out-of-line anyway in the body of <tt>foo</tt>, because of the
shadowing local declaration to that eﬀect).
<div class="newer">
<!--l. 334--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx65-831001"></a>to clarify that such shadowing does not occur in
the case of type declarations. If there is a local type declaration for a special
variable and there is also a global proclamation for that same variable, then the
value of the variable within the scope of the local declaration must be a member
of the intersection of the two declared types. This is consistent with the treatment
of nested local type declarations on which X3J13 also voted in January 1989
<a 
 id="dx65-831002"></a>.
</div>
<!--l. 344--><p class="indent" >   As a special case (so to speak), <tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt> treats a <tt>special</tt> <i>decl-spec</i> as
applying to all bindings as well as to all references of the mentioned variables.
<div class="new"><i>Notice of correction.</i> In the ﬁrst edition, this sentence referred to a “<tt>special</tt>
<i>declaration-form</i>.” That was incorrect; <tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt> accepts only a <i>decl-spec</i>, not a
<i>declaration-form</i>.
</div>
<!--l. 354--><p class="indent" >   For example, after <div class="lisp"><div class="tabbing">
(proclaim &#x2019;(special x))
   <br>
<!--l. 357--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 357--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8320009.1" id="x65-8320009.1"></a></span>
<!--l. 357--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8330009.1" id="x65-8330009.1"></a></span>
</div>
<!--l. 358--><p class="indent" >   in a function deﬁnition such as <div class="lisp"><div class="tabbing">
(defun example (x) ...)
   <br>
<!--l. 361--><p class="noindent" ></div>
<!--l. 361--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8340009.1" id="x65-8340009.1"></a></span>
<!--l. 361--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8350009.1" id="x65-8350009.1"></a></span>
</div>
<!--l. 362--><p class="indent" >   the parameter <tt>x</tt> will be bound as a special (dynamic) variable rather than
as a lexical (static) variable. This facility should be used with caution.
The usual way to deﬁne a globally special variable is with <tt><a 
href="symbols.html#x187-2636292r292">defvar</a></tt> or
<tt><a 
href="symbols.html#x187-2636287r287">defparameter</a></tt>.
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 369--><p class="indent" >   <div class="tabbing">
 <i>[Macro]</i> <b>declaim</b> <a 
 id="dx65-835001"></a><a 
 id="x65-835002r145"></a> {decl-spec}*
   <br>
<!--l. 370--><p class="noindent" ></div>
<!--l. 370--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8360009.1" id="x65-8360009.1"></a></span>
</div>
<!--l. 371--><p class="indent" >   This macro is syntactically like <tt><a 
href="symbols.html#x187-2636271r271">declare</a></tt> and semantically like <tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt>. It is
an executable form and may be used anywhere <tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt> may be called. However,
each <i>decl-spec</i> is not evaluated.
                                                                          

                                                                          
<!--l. 376--><p class="indent" >   If a call to this macro appears at top level in a ﬁle being processed by the ﬁle
compiler, the proclamations are also made at compile time. As with other deﬁning
macros, it is unspeciﬁed whether or not the compile-time side eﬀects of a <tt><a 
href="symbols.html#x187-2636269r269">declaim</a></tt>
persist after the ﬁle has been compiled (see section <a 
href="clmse122.html#x151-198200024.2">24.2<!--tex4ht:ref: COMPILER-SECTION --></a>).
</div>
                                                                          

                                                                          
<!--l. 384--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse52.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="declar.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="declar.html#taildeclar.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse51.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="declar.html#clmse51.html" >Up</a><tt>&#x003E;</tt></div><a 
 id="tailclmse51.html"></a>  </div> </div> 
</body></html> 
