<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Environments</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-20 16:10:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
<!--l. 737--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="declar.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse49.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse49.html#tailclmse49.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse50.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="macro.html#clmse50.html" >Up</a><tt>&#x003E;</tt>&lt;<a href="../index.html">Main Page</a>&gt;</div><h3 class="sectionHead"><span class="titlemark">8.5   </span> <a 
href="clm.html#QQ2-63-797" id="x63-7880008.5">Environments</a></h3>
<!--l. 739--><p class="noindent" >X3J13 voted in June 1989 <a 
 id="dx63-788001"></a>to add some facilities for obtaining information from
environment objects of the kind received as arguments by macro expansion
functions, <tt><a 
href="symbols.html#x187-2636022r22">*macroexpand-hook*</a></tt> functions, and <tt><a 
href="symbols.html#x187-2636015r15">*evalhook*</a></tt> functions. There is a
minimal set of accessors (<tt><a 
href="symbols.html#x187-2636919r919">variable-information</a></tt>, <tt><a 
href="symbols.html#x187-2636400r400">function-information</a></tt>, and
<tt><a 
href="symbols.html#x187-2636270r270">declaration-information</a></tt>) and a constructor (<tt><a 
href="symbols.html#x187-2636114r114">augment-environment</a></tt>) for
environments.
<!--l. 747--><p class="indent" >   All of the standard declaration speciﬁers, with the exception of <tt>special</tt>, can
be deﬁned fairly easily using <tt><a 
href="symbols.html#x187-2636279r279">define-declaration</a></tt>. It also seems to be able to
handle most extended declarations.
<!--l. 751--><p class="indent" >   The function <tt><a 
href="symbols.html#x187-2636654r654">parse-macro</a></tt> is provided so that users don&#x2019;t have to write their
own code to destructure macro arguments. This function is not entirely
necessary since X3J13 voted in March 1989 <a 
 id="dx63-788002"></a>to add <tt><a 
href="symbols.html#x187-2636303r303">destructuring-bind</a></tt>
to the language. However, <tt><a 
href="symbols.html#x187-2636654r654">parse-macro</a></tt> is worth having anyway, since
any program-analyzing program is going to need to deﬁne it, and the
implementation isn&#x2019;t completely trivial even with <tt><a 
href="symbols.html#x187-2636303r303">destructuring-bind</a></tt> to build
upon.
<!--l. 761--><p class="indent" >   The function <tt><a 
href="symbols.html#x187-2636330r330">enclose</a></tt> allows expander functions to be deﬁned in a non-null
lexical environment, as required by the vote of X3J13 in March 1989 <a 
 id="dx63-788003"></a>. It also
provides a mechanism by which a program processing the body of an <tt>(eval-when
(:compile-toplevel) ...)</tt> form can execute it in the enclosing environment
(see issue <a 
 id="dx63-788004"></a>).
<!--l. 769--><p class="indent" >   In all of these functions the argument named <i>env</i> is an environment object. (It
is not required that implementations provide a distinguished representation for
such objects.) Optional <i>env</i> arguments default to <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt>, which represents the local
null lexical environment (containing only global deﬁnitions and proclamations
that are present in the run-time environment). All of these functions should signal
an error of type <tt><a 
href="symbols.html#x187-2636891r891">type-error</a></tt> if the value of an environment argument is not a
syntactic environment object.
<!--l. 778--><p class="indent" >   The accessor functions <tt><a 
href="symbols.html#x187-2636919r919">variable-information</a></tt>, <tt><a 
href="symbols.html#x187-2636400r400">function-information</a></tt>, and
<tt><a 
href="symbols.html#x187-2636270r270">declaration-information</a></tt> retrieve information about declarations that are in
eﬀect in the environment. Since implementations are permitted to ignore
declarations (except for <tt>special</tt> declarations and <tt>optimize safety</tt> declarations
                                                                          

                                                                          
if they ever compile unsafe code), these accessors are required only to return
information about declarations that were explicitly added to the environment
using <tt><a 
href="symbols.html#x187-2636114r114">augment-environment</a></tt>. They might also return information about
declarations recognized and added to the environment by the interpreter or the
compiler, but that is at the discretion of the implementor. Implementations are
also permitted to canonicalize declarations, so the information returned by the
accessors might not be identical to the information that was passed to
<tt><a 
href="symbols.html#x187-2636114r114">augment-environment</a></tt>.
<div class="defun">
<!--l. 792--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx63-788005"></a><a 
 id="x63-788006r135"></a> <b>variable-information</b>  <i>variable</i> <b>&#x0026;optional</b>  <i>env</i>
</div>
<!--l. 795--><p class="indent" >   This function returns information about the interpretation of the symbol
<i>variable</i> when it appears as a variable within the lexical environment <i>env</i>. Three
values are returned.
<!--l. 799--><p class="indent" >   The ﬁrst value indicates the type of deﬁnition or binding for <i>variable</i> in <i>env</i>:
<div class="indentdesc">
      <ul><li><b>
 <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> </b></li>There is no apparent deﬁnition or binding for <i>variable</i>.
      <li><b>
<tt>:special</tt> </b></li>The <i>variable</i> refers to a special variable, either declared or proclaimed.
      <li><b>
<tt>:lexical</tt> </b></li>The <i>variable</i> refers to a lexical variable.
      <li><b>
<tt>:symbol-macro</tt> </b></li>The <i>variable</i> refers to a <tt><a 
href="symbols.html#x187-2636864r864">symbol-macrolet</a></tt> binding.
      <li><b>
<tt>:constant</tt> </b></li>Either the <i>variable</i> refers to a named constant deﬁned by <tt><a 
href="symbols.html#x187-2636275r275">defconstant</a></tt>
      or the <i>variable</i> is a keyword symbol.</ul>
</div>
<!--l. 819--><p class="indent" >   The second value indicates whether there is a local binding of the name. If the
name is locally bound, the second value is true; otherwise, the second value is
<tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt>.
                                                                          

                                                                          
<!--l. 823--><p class="indent" >   The third value is an a-list containing information about declarations that
apply to the apparent binding of the <i>variable</i>. The keys in the a-list are symbols
that name declaration speciﬁers, and the format of the corresponding value in the
<i>cdr</i> of each pair depends on the particular declaration name involved. The
standard declaration names that might appear as keys in this a-list are:
<div class="indentdesc">
      <ul><li><b>
<tt>dynamic-extent</tt> </b></li>A  non-<tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> value  indicates  that  the  <i>variable</i>  has  been  declared
      <tt>dynamic-extent</tt>. If the value is <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt>, the pair might be omitted.
      <li><b>
<tt>ignore</tt> </b></li>A non-<tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> value indicates that the <i>variable</i> has been declared <tt>ignore</tt>.
      If the value is <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt>, the pair might be omitted.
      <li><b>
<tt>type</tt> </b></li>The value is a type speciﬁer associated with the <i>variable</i> by a <tt>type</tt>
      declaration or an abbreviated declaration such as <tt>(fixnum <i>variable</i>)</tt>.
      If no explicit association exists, either by <tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt> or <tt><a 
href="symbols.html#x187-2636271r271">declare</a></tt>, then
      the type speciﬁer is <tt><a 
href="symbols.html#x187-2636871r871">t</a></tt>. It is permissible for implementations to use a
      type speciﬁer that is equivalent to or a supertype of the one appearing
      in the original declaration. If the value is <tt><a 
href="symbols.html#x187-2636871r871">t</a></tt>, the pair might be omitted.</ul>
</div>
<!--l. 850--><p class="noindent" >If an implementation supports additional declaration speciﬁers that apply to variable
bindings, those declaration names might also appear in the a-list. However, the
corresponding key must not be a symbol that is external in any package deﬁned in
the standard or that is otherwise accessible in the <tt>common-lisp-user</tt>
package.
<!--l. 856--><p class="indent" >   The a-list might contain multiple entries for a given key. The consequences of
destructively modifying the list structure of this a-list or its elements (except for
values that appear in the a-list as a result of <tt><a 
href="symbols.html#x187-2636279r279">define-declaration</a></tt>) are
undeﬁned.
<!--l. 861--><p class="indent" >   Note that the global binding might diﬀer from the local one and can be
retrieved by calling <tt><a 
href="symbols.html#x187-2636919r919">variable-information</a></tt> with a null lexical environment.
</div>
<div class="defun">
<!--l. 866--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx63-788007"></a><a 
 id="x63-788008r136"></a> <b>function-information</b>  <i>function</i> <b>&#x0026;optional</b>  <i>env</i>
                                                                          

                                                                          
</div>
<!--l. 869--><p class="indent" >   This function returns information about the interpretation of the function-name
<i>function</i> when it appears in a functional position within lexical environment <i>env</i>.
Three values are returned.
<!--l. 873--><p class="indent" >   The ﬁrst value indicates the type of deﬁnition or binding of the function-name
which is apparent in <i>env</i>: <div class="indentdesc">
      <ul><li><b>
 <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> </b></li>There is no apparent deﬁnition for <i>function</i>.
      <li><b>
<tt>:function</tt> </b></li>The <i>function</i> refers to a function.
      <li><b>
<tt>:macro</tt> </b></li>The <i>function</i> refers to a macro.
      <li><b>
<tt>:special-form</tt> </b></li>The <i>function</i> refers to a special operator.</ul>
</div>
<!--l. 884--><p class="noindent" >Some function-names can refer to both a global macro and a global special form. In
such a case the macro takes precedence and <tt>:macro</tt> is returned as the ﬁrst
value.
<!--l. 888--><p class="indent" >   The second value speciﬁes whether the deﬁnition is local or global. If local, the
second value is true; it is <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> when the deﬁnition is global.
<!--l. 892--><p class="indent" >   The third value is an a-list containing information about declarations that
apply to the apparent binding of the function. The keys in the a-list are symbols
that name declaration speciﬁers, and the format of the corresponding values in the
<i>cdr</i> of each pair depends on the particular declaration name involved. The
standard declaration names that might appear as keys in this a-list are:
<div class="indentdesc">
      <ul><li><b>
<tt>dynamic-extent</tt> </b></li>A  non-<tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> value  indicates  that  the  function  has  been  declared
      <tt>dynamic-extent</tt>. If the value is <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt>, the pair might be omitted.
      <li><b>
<tt>inline</tt> </b></li>The  value  is  one  of  the  symbols  <tt>inline</tt>,  <tt>notinline</tt>,  or  <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt> to
      indicate whether the function-name has been declared <tt>inline</tt>, declared
      <tt>notinline</tt>, or neither, respectively. If the value is <tt><a 
href="symbols.html#x187-2636609r609">nil</a></tt>, the pair might
      be omitted.
                                                                          

                                                                          
      <li><b>
<tt>ftype</tt> </b></li>The value is the type speciﬁer associated with the function-name in
      the  environment,  or  the  symbol  <tt><a 
href="symbols.html#x187-2636399r399">function</a></tt> if  there  is  no  functional
      type declaration or proclamation associated with the function-name.
      This value might not include all the apparent <tt>ftype</tt> declarations for
      the function-name. It is permissible for implementations to use a type
      speciﬁer that is equivalent to or a supertype of the one that appeared
      in the original declaration. If the value is <tt><a 
href="symbols.html#x187-2636399r399">function</a></tt>, the pair might be
      omitted.</ul>
</div>
<!--l. 921--><p class="noindent" >If an implementation supports additional declaration speciﬁers that apply to function
bindings, those declaration names might also appear in the a-list. However, the
corresponding key must not be a symbol that is external in any package deﬁned in
the standard or that is otherwise accessible in the <tt>common-lisp-user</tt>
package.
<!--l. 927--><p class="indent" >   The a-list might contain multiple entries for a given key. In this case the
value associated with the ﬁrst entry has precedence. The consequences of
destructively modifying the list structure of this a-list or its elements (except for
values that appear in the a-list as a result of <tt><a 
href="symbols.html#x187-2636279r279">define-declaration</a></tt>) are
undeﬁned.
<!--l. 934--><p class="indent" >   Note that the global binding might diﬀer from the local one and can be
retrieved by calling <tt><a 
href="symbols.html#x187-2636400r400">function-information</a></tt> with a null lexical environment.
</div>
<div class="defun">
<!--l. 939--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx63-788009"></a><a 
 id="x63-788010r137"></a> <b>declaration-information</b>  <i>decl-name</i> <b>&#x0026;optional</b>  <i>env</i>
</div>
<!--l. 942--><p class="indent" >   This function returns information about declarations named by the symbol
<i>decl-name</i> that are in force in the environment <i>env</i>. Only declarations that do not
apply to function or variable bindings can be accessed with this function. The
format of the information that is returned depends on the <i>decl-name</i>
involved.
<!--l. 948--><p class="indent" >   It is required that this function recognize <tt>optimize</tt> and <tt>declaration</tt>
as <i>decl-name</i>s. The values returned for these two cases are as follows:
<div class="indentdesc">
      <ul><li><b>
                                                                          

                                                                          
<tt>optimize</tt> </b></li>A  single  value  is  returned,  a  list  whose  entries  are  of  the  form
      <tt>(<i>quality</i> <i>value</i>)</tt>, where <i>quality</i> is one of the standard optimization
      qualities (<tt>speed</tt>, <tt>safety</tt>, <tt>compilation-speed</tt>, <tt>space</tt>, <tt>debug</tt>) or some
      implementation-speciﬁc optimization quality, and <i>value</i> is an integer
      in  the  range  0  to  3  (inclusive).  The  returned  list  always  contains
      an  entry  for  each  of  the  standard  qualities  and  for  each  of  the
      implementation-speciﬁc  qualities.  In  the  absence  of  any  previous
      declarations, the associated values are implementation-dependent. The
      list might contain multiple entries for a quality, in which case the ﬁrst
      such entry speciﬁes the current value. The consequences of destructively
      modifying this list or its elements are undeﬁned.
      <li><b>
<tt>declaration</tt> </b></li>A single value is returned, a list of the declaration names that have been
      proclaimed as valid through the use of the <tt>declaration</tt> proclamation.
      The consequences of destructively modifying this list or its elements
      are undeﬁned.</ul>
</div>
<!--l. 976--><p class="noindent" >If an implementation is extended to recognize additional declaration speciﬁers in
<tt><a 
href="symbols.html#x187-2636271r271">declare</a></tt> or <tt><a 
href="symbols.html#x187-2636695r695">proclaim</a></tt>, it is required that either the <tt><a 
href="symbols.html#x187-2636270r270">declaration-information</a></tt>
function should recognize those declarations also or the implementation should
provide a similar accessor that is specialized for that declaration speciﬁer. If
<tt><a 
href="symbols.html#x187-2636270r270">declaration-information</a></tt> is used to return the information, the corresponding
<i>decl-name</i> must not be a symbol that is external in any package deﬁned in
the standard or that is otherwise accessible in the <tt>common-lisp-user</tt>
package.
</div>
<div class="defun">
<!--l. 986--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx63-788011"></a><a 
 id="x63-788012r138"></a> <b>augment-environment</b>  <i>env</i> <b>&#x0026;key</b>  <i>:variable</i> <i>:symbol-macro</i>
<i>:function</i> <i>:macro</i> <i>:declare</i>
</div>
<!--l. 989--><p class="indent" >   This function returns a new environment containing the information
present in <i>env</i> augmented with the information provided by the keyword
arguments. It is intended to be used by program analyzers that perform a code
walk.
<!--l. 993--><p class="indent" >   The arguments are supplied as follows. <div class="flushdesc">
                                                                          

                                                                          
      <ul><li><b>
<tt>:variable</tt> </b></li>The argument is a list of symbols that will be visible as bound
      variables  in  the  new  environment.  Whether  each  binding  is  to  be
      interpreted  as  special  or  lexical  depends  on  <tt>special</tt> declarations
      recorded in the environment or provided in the <tt>:declare</tt> argument.
      <li><b>
<tt>:symbol-macro</tt> </b></li>The argument is a list of symbol macro deﬁnitions, each of
      the form <tt>(<i>name</i> <i>definition</i>)</tt>; that is, the argument is in the same
      format as the <i>cadr</i> of a <tt><a 
href="symbols.html#x187-2636864r864">symbol-macrolet</a></tt> special operator. The new
      environment  will  have  local  symbol-macro  bindings  of  each  symbol
      to the corresponding expansion, so that <tt><a 
href="symbols.html#x187-2636530r530">macroexpand</a></tt> will be able to
      expand them properly. A type declaration in the <tt>:declare</tt> argument
      that  refers  to  a  name  in  this  list  implicitly  modiﬁes  the  deﬁnition
      associated with the name. The eﬀect is to wrap a <tt><a 
href="symbols.html#x187-2636878r878">the</a></tt> form mentioning
      the type around the deﬁnition.
      <li><b>
<tt>:function</tt> </b></li>The argument is a list of function-names that will be visible as
      local function bindings in the new environment.
      <li><b>
<tt>:macro</tt> </b></li>The argument is a list of local macro deﬁnitions, each of the form
      <tt>(<i>name</i> <i>definition</i>)</tt>.  Note  that  the  argument  is  <i>not</i>  in  the  same
      format as the <i>cadr</i> of a <tt><a 
href="symbols.html#x187-2636532r532">macrolet</a></tt> special operator. Each <i>deﬁnition</i>
      must be a function of two arguments (a form and an environment).
      The new environment will have local macro bindings of each name
      to  the  corresponding  expander  function,  which  will  be  returned  by
      <tt><a 
href="symbols.html#x187-2636529r529">macro-function</a></tt> and used by <tt><a 
href="symbols.html#x187-2636530r530">macroexpand</a></tt>.
      <li><b>
<tt>:declare</tt> </b></li>The  argument  is  a  list  of  declaration  speciﬁers.  Information
      about   these   declarations   can   be   retrieved   from   the   resulting
      environment using <tt><a 
href="symbols.html#x187-2636919r919">variable-information</a></tt>, <tt><a 
href="symbols.html#x187-2636400r400">function-information</a></tt>,
      and <tt><a 
href="symbols.html#x187-2636270r270">declaration-information</a></tt>.</ul>
</div>
<!--l. 1037--><p class="noindent" >The consequences of subsequently destructively modifying the list structure of any of
the arguments to this function are undeﬁned.
                                                                          

                                                                          
<!--l. 1041--><p class="indent" >   An error is signaled if any of the symbols naming a symbol macro in the
<tt>:symbol-macro</tt> argument is also included in the <tt>:variable</tt> argument. An error is
signaled if any symbol naming a symbol macro in the <tt>:symbol-macro</tt> argument is
also included in a <tt>special</tt> declaration speciﬁer in the <tt>:declare</tt> argument. An
error is signaled if any symbol naming a macro in the <tt>:macro</tt> argument is also
included in the <tt>:function</tt> argument. The condition type of each of these errors is
<tt><a 
href="symbols.html#x187-2636701r701">program-error</a></tt>.
<!--l. 1051--><p class="indent" >   The extent of the returned environment is the same as the extent of the
argument environment <i>env</i>. The result might share structure with <i>env</i> but <i>env</i> is
not modiﬁed.
<!--l. 1055--><p class="indent" >   While an environment argument received by an <tt><a 
href="symbols.html#x187-2636015r15">*evalhook*</a></tt> function is
permitted to be used as the environment argument to <tt><a 
href="symbols.html#x187-2636114r114">augment-environment</a></tt>, the
consequences are undeﬁned if an attempt is made to use the result of
<tt><a 
href="symbols.html#x187-2636114r114">augment-environment</a></tt> as the environment argument for <tt><a 
href="symbols.html#x187-2636345r345">evalhook</a></tt>. The
environment returned by <tt><a 
href="symbols.html#x187-2636114r114">augment-environment</a></tt> can be used only for syntactic
analysis, that is, as an argument to the functions deﬁned in this section and
functions such as <tt><a 
href="symbols.html#x187-2636530r530">macroexpand</a></tt>.
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 1066--><p class="indent" >   <div class="tabbing">
 <i>[Macro]</i> <b>deﬁne-declaration</b> <a 
 id="dx63-788013"></a><a 
 id="x63-788014r139"></a> decl-name lambda-list {form}*
   <br>
<!--l. 1067--><p class="noindent" ></div>
<!--l. 1067--><p class="noindent" ><span class="paragraphHead"><a 
href="#x63-7890008.5" id="x63-7890008.5"></a></span>
</div>
<!--l. 1068--><p class="indent" >   This macro deﬁnes a handler for the named declaration. It is the mechanism
by which <tt><a 
href="symbols.html#x187-2636114r114">augment-environment</a></tt> is extended to support additional declaration
speciﬁers. The function deﬁned by this macro will be called with two arguments, a
declaration speciﬁer whose <i>car</i> is <i>decl-name</i> and the <i>env</i> argument to
<tt><a 
href="symbols.html#x187-2636114r114">augment-environment</a></tt>. This function must return two values. The ﬁrst value
must be one of the following keywords: <div class="indentdesc">
      <ul><li><b>
<tt>:variable</tt> </b></li>The declaration applies to variable bindings.
                                                                          

                                                                          
      <li><b>
<tt>:function</tt> </b></li>The declaration applies to function bindings.
      <li><b>
<tt>:declare</tt> </b></li>The declaration does not apply to bindings.</ul>
</div>
<!--l. 1080--><p class="noindent" >If the ﬁrst value is <tt>:variable</tt> or <tt>:function</tt> then the second value must be a list, the
elements of which are lists of the form <tt>(<i>binding-name</i> <i>key</i> <i>value</i>)</tt>. If the
corresponding information function (either <tt><a 
href="symbols.html#x187-2636919r919">variable-information</a></tt> or
<tt><a 
href="symbols.html#x187-2636400r400">function-information</a></tt>) is applied to the <i>binding-name</i> and the augmented
environment, the a-list returned by the information function as its third value will
contain the <i>value</i> under the speciﬁed <i>key</i>.
<!--l. 1088--><p class="indent" >   If the ﬁrst value is <tt>:declare</tt>, the second value must be a cons of the form
<tt>(<i>key</i> . <i>value</i>)</tt>. The function <tt><a 
href="symbols.html#x187-2636270r270">declaration-information</a></tt> will return <i>value</i> when
applied to the <i>key</i> and the augmented environment.
<tt>
<!--l. 1093--><p class="indent" >   <a 
href="symbols.html#x187-2636279r279">define-declaration</a></tt> causes <i>decl-name</i> to be proclaimed to be a declaration;
it is as if its expansion included a call <tt>(proclaim &#x2019;(declaration <i>decl-name</i>))</tt>.
As is the case with standard declaration speciﬁers, the evaluator and compiler are
permitted, but not required, to add information about declaration speciﬁers
deﬁned with <tt><a 
href="symbols.html#x187-2636279r279">define-declaration</a></tt> to the macro expansion and <tt><a 
href="symbols.html#x187-2636015r15">*evalhook*</a></tt>
environments.
<!--l. 1101--><p class="indent" >   The consequences are undeﬁned if <i>decl-name</i> is a symbol that can appear as
the <i>car</i> of any standard declaration speciﬁer.
<!--l. 1104--><p class="indent" >   The consequences are also undeﬁned if the return value from a declaration
handler deﬁned with <tt><a 
href="symbols.html#x187-2636279r279">define-declaration</a></tt> includes a <i>key</i> name that is used by
the corresponding accessor to return information about any standard declaration
speciﬁer. (For example, if the ﬁrst return value from the handler is <tt>:variable</tt>, the
second return value may not use the symbols <tt>dynamic-extent</tt>, <tt>ignore</tt>, or <tt>type</tt>
as <i>key</i> names.)
<!--l. 1112--><p class="indent" >   The <tt><a 
href="symbols.html#x187-2636279r279">define-declaration</a></tt> macro does not have any special compile-time side
eﬀects (see section <a 
href="clmse122.html#x151-198200024.2">24.2<!--tex4ht:ref: COMPILER-SECTION --></a>).
</div>
<div class="defun">
<!--l. 1116--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx63-789001"></a><a 
 id="x63-789002r140"></a> <b>parse-macro</b>  <i>name</i> <i>lambda-list</i> <i>body</i> <b>&#x0026;optional</b>  <i>env</i>
                                                                          

                                                                          
</div>
<!--l. 1119--><p class="indent" >   This function is used to process a macro deﬁnition in the same way as
<tt><a 
href="symbols.html#x187-2636284r284">defmacro</a></tt> and <tt><a 
href="symbols.html#x187-2636532r532">macrolet</a></tt>. It returns a lambda-expression that accepts two
arguments, a form and an environment. The <i>name</i>, <i>lambda-list</i>, and <i>body</i>
arguments correspond to the parts of a <tt><a 
href="symbols.html#x187-2636284r284">defmacro</a></tt> or <tt><a 
href="symbols.html#x187-2636532r532">macrolet</a></tt> deﬁnition.
<!--l. 1125--><p class="indent" >   The <i>lambda-list</i> argument may include <tt>&#x0026;environment</tt> and <tt>&#x0026;whole</tt> and may
include destructuring. The <i>name</i> argument is used to enclose the <i>body</i> in an
implicit <tt><a 
href="symbols.html#x187-2636128r128">block</a></tt> and might also be used for implementation-dependent purposes
(such as including the name of the macro in error messages if the form does not
match the <i>lambda-list</i>).
</div>
<div class="defun">
<!--l. 1133--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx63-789003"></a><a 
 id="x63-789004r141"></a> <b>enclose</b>  <i>lambda-expression</i> <b>&#x0026;optional</b>  <i>env</i>
</div>
<!--l. 1136--><p class="indent" >   This function returns an object of type <tt><a 
href="symbols.html#x187-2636399r399">function</a></tt> that is equivalent to what
would be obtained by evaluating <tt>‘(function ,<i>lambda-expression</i>)</tt>
in a syntactic environment <i>env</i>. The <i>lambda-expression</i> is permitted to
reference only the parts of the environment argument <i>env</i> that are relevant
only to syntactic processing, speciﬁcally declarations and the deﬁnitions
of macros and symbol macros. The consequences are undeﬁned if the
<i>lambda-expression</i> contains any references to variable or function bindings that
are lexically visible in <i>env</i>, any <tt><a 
href="symbols.html#x187-2636423r423">go</a></tt> to a tag that is lexically visible in <i>env</i>, or
any <tt><a 
href="symbols.html#x187-2636752r752">return-from</a></tt> mentioning a block name that is lexically visible in
<i>env</i>.
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
<!--l. 8--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="declar.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse49.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse49.html#tailclmse49.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse50.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="macro.html#clmse50.html" >Up</a><tt>&#x003E;</tt></div><a 
 id="tailclmse50.html"></a>  </div> </div> 
</body></html> 
