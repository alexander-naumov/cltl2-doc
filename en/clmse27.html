<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Type Upgrading</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-20 14:21:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
<!--l. 917--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="progs.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse26.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse26.html#tailclmse26.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse27.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="dtspec.html#clmse27.html" >Up</a><tt>&#x003E;</tt>&lt;<a href="../index.html">Main Page</a>&gt;</div><h3 class="sectionHead"><span class="titlemark">4.10   </span> <a 
href="clm.html#QQ2-36-237" id="x36-2300004.10">Type Upgrading</a></h3>
<!--l. 919--><p class="noindent" >There are functions by which a program can determine, in a given Common Lisp
implementation, how that implementation will <i>upgrade</i> a type when constructing
an array specialized to contain elements of that type, or a complex number
specialized to contain parts of that type.
<div class="defun">
<!--l. 926--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx36-230001"></a><a 
 id="x36-230002r9"></a> <b>upgraded-array-element-type</b>  <i>type</i>
</div>
<!--l. 929--><p class="indent" >   A type speciﬁer is returned, indicating the element type of the most
specialized array representation capable of holding items of the speciﬁed argument
<i>type</i>. The result is necessarily a supertype of the given <i>type</i>. Furthermore, if a
type <i>A</i> is a subtype of type <i>B</i>, then <tt>(upgraded-array-element-type <i>A</i>)</tt> is a
subtype of <tt>(upgraded-array-element-type <i>B</i>)</tt>.
<!--l. 937--><p class="indent" >   The manner in which an array element type is upgraded depends only on
the element type as such and not on any other property of the array
such as size, rank, adjustability, presence or absence of a ﬁll pointer, or
displacement._____________________________________________________________<div class="rationale">
<!--l. 943--><p class="noindent" ><b>Rationale:</b> If upgrading were allowed to depend on any of these properties, all of which
can be referred to, directly or indirectly, in the language of type speciﬁers, then it would
not be possible to displace an array in a consistent and dependable manner to another
array created with the same <tt>:element-type</tt> argument but diﬀering in one of these
properties.
</div>___________________________________________________________________________________________________________
<!--l. 953--><p class="indent" >     Note that <tt><a 
href="symbols.html#x185-2637911r911">upgraded-array-element-type</a></tt> could be deﬁned as <div class="lisp"><div class="tabbing">
(defun upgraded-array-element-type (type)
     <br>                    (array-element-type (make-array 0 :element-type type)))<br>
<!--l. 957--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 957--><p class="noindent" ><span class="paragraphHead"><a 
href="#x36-2310004.10" id="x36-2310004.10"></a></span>
<!--l. 957--><p class="noindent" ><span class="paragraphHead"><a 
href="#x36-2320004.10" id="x36-2320004.10"></a></span>
</div>
<!--l. 958--><p class="indent" >   but this deﬁnition has the disadvantage of allocating an array and then
immediately discarding it. The clever implementor surely can conjure up a more
practical approach.
</div>
<div class="defun">
<!--l. 964--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx36-232001"></a><a 
 id="x36-232002r10"></a> <b>upgraded-complex-part-type</b>  <i>type</i>
</div>
<!--l. 967--><p class="indent" >   A type speciﬁer is returned, indicating the element type of the most specialized
complex number representation capable of having parts of the speciﬁed argument
<i>type</i>. The result is necessarily a supertype of the given <i>type</i>. Furthermore, if a
type <i>A</i> is a subtype of type <i>B</i>, then <tt>(upgraded-complex-part-type <i>A</i>)</tt> is a
subtype of <tt>(upgraded-complex-part-type <i>B</i>)</tt>.
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
<!--l. 7--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="progs.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse26.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse26.html#tailclmse26.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse27.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="dtspec.html#clmse27.html" >Up</a><tt>&#x003E;</tt></div><a 
 id="tailclmse27.html"></a>   </div> </div> 
</body></html> 
