<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Multiple Values Возврат и обработка нескольких значений</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-11 14:56:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 5767--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse45.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse43.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse43.html#tailclmse43.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse44.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch7.html#clmse44.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">7.10   </span> <a 
 id="x56-1430007.10"></a>Multiple Values Возврат и обработка нескольких значений</h3>
<a 
 id="dx56-143001"></a>
<!--l. 5770--><p class="noindent" >Ordinarily the result of calling a Lisp function is a single Lisp object. Sometimes,
however, it is convenient for a function to compute several objects and return
them. Common Lisp provides a mechanism for handling multiple values
directly. This mechanism is cleaner and more eﬃcient than the usual
tricks involving returning a list of results or stashing results in global
variables.
<!--l. 5778--><p class="indent" >   Обычно результатом вызова Lisp&#x2019;овой функции является один
Lisp&#x2019;овый объект. Однако, иногда для функции удобно вычислить
несколько объектов и вернуть их. Common Lisp представляет механизм
для прямой обработки нескольких значений. Механизм удобнее и
эффективнее, чем исполнение трюков со списками или глобальными
переменными.
<!--l. 5785--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.10.1   </span> <a 
 id="x56-1440007.10.1"></a>Constructs for Handling Multiple Values Конструкции для
обработки нескольких значений</h4>
<!--l. 5787--><p class="noindent" >Normally multiple values are not used. Special forms are required both to <i>produce</i>
multiple values and to <i>receive</i> them. If the caller of a function does not
request multiple values, but the called function produces multiple values,
then the ﬁrst value is given to the caller and all others are discarded;
if the called function produces zero values, then the caller gets <a 
href="clmse31.html#x42-77002r19">nil</a> as a
value.
<!--l. 5795--><p class="indent" >   The primary primitive for producing multiple values is <a 
href="#x56-144002r123">values</a>, which takes any
number of arguments and returns that many values. If the last form in the body
of a function is a <a 
href="#x56-144002r123">values</a> with three arguments, then a call to that function will
return three values. Other special forms also produce multiple values,
but they can be described in terms of <a 
href="#x56-144002r123">values</a>. Some built-in Common
                                                                          

                                                                          
Lisp functions, such as <a 
href="clmse71.html#x88-206012r256">ﬂoor</a>, return multiple values; those that do are so
documented.
<!--l. 5803--><p class="indent" >   Обычно не используется несколько значений. Для возврата и обработки
нескольких значений требуются специальные формы. Если вызывающий
функцию код не требует нескольких значений, однако вызываемая
функция их несколько, то для кода берется только первое значение.
Все оставшиеся значения игнорируются. Если вызываемая функция
возвращает ноль значений, вызывающий код в качестве значения получает
<a 
href="clmse31.html#x42-77002r19">nil</a>.
<!--l. 5811--><p class="indent" >   <a 
href="#x56-144002r123">values</a> — это главный примитив для возврата нескольких значений. Он
принимает любое количество аргументов и возвращает столько же значений.
Если последняя форма тела функции является <a 
href="#x56-144002r123">values</a> с тремя аргументами,
то вызов такой функции вернет три значения. Другие специальные формы
также возвращают несколько значения, но они могут быть описаны в
терминах <a 
href="#x56-144002r123">values</a>. Некоторые встроенные Common Lisp функции, такая как
<a 
href="clmse71.html#x88-206012r256">ﬂoor</a>, возвращают несколько значений.
<!--l. 5819--><p class="indent" >   The special forms and macros for receiving multiple values are as follows: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">multiple-value-list
</td></tr></table>
<!--l. 5821--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">multiple-value-call</td></tr></table>
<!--l. 5822--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">multiple-value-prog1</td></tr></table>
<!--l. 5823--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">multiple-value-bind</td></tr></table>
<!--l. 5824--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">multiple-value-setq</td></tr></table>
<!--l. 5826--><p class="indent" >
</div>
</div>
<!--l. 5827--><p class="noindent" >These specify a form to evaluate and an indication of where to put the values
returned by that form.
<!--l. 5830--><p class="indent" >   Специальные формы обрабатывающие несколько значений представлены
ниже: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">multiple-value-list
</td></tr></table>
<!--l. 5832--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">multiple-value-call</td></tr></table>
                                                                          

                                                                          
<!--l. 5833--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">multiple-value-prog1</td></tr></table>
<!--l. 5834--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">multiple-value-bind</td></tr></table>
<!--l. 5835--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">multiple-value-setq</td></tr></table>
<!--l. 5837--><p class="indent" >
</div>
</div>
<!--l. 5838--><p class="noindent" >Они задают форму для вычисления и указывают куда поместить значения
возвращаемые данной формой.
<div class=defun>
<!--l. 5841--><p class="noindent" ><i>[Function]</i><a 
 id="dx56-144001"></a><a 
 id="x56-144002r123"></a><b> values</b>  &#x0026;rest  <i>args</i>
<!--l. 5843--><p class="noindent" >All of the arguments are returned, in order, as values. For example: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun polar (x y)
</td></tr></table>
<!--l. 5847--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (values (sqrt (+ (* x x) (* y y))) (atan y x)))</td></tr></table>
<!--l. 5848--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5849--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (r theta) (polar 3.0 4.0)</td></tr></table>
<!--l. 5850--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (vector r theta))</td></tr></table>
<!--l. 5851--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ #(5.0 0.9272952)</td></tr></table>
<!--l. 5853--><p class="indent" >
</div>
</div>
<!--l. 5855--><p class="indent" >   Все аргументы в таком же порядке возвращаются, как значения.
Например, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun polar (x y)
</td></tr></table>
<!--l. 5858--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (values (sqrt (+ (* x x) (* y y))) (atan y x)))</td></tr></table>
<!--l. 5859--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5860--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (r theta) (polar 3.0 4.0)</td></tr></table>
<!--l. 5861--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (vector r theta))</td></tr></table>
<!--l. 5862--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ #(5.0 0.9272952)</td></tr></table>
<!--l. 5864--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 5866--><p class="indent" >   The expression (values) returns zero values. This is the standard idiom for
returning no values from a function.
<!--l. 5869--><p class="indent" >   Выражение (values) возвращает ноль значений. Это стандартная идиома
для возврата из функции нулевого количества значений.
<!--l. 5872--><p class="indent" >   Sometimes it is desirable to indicate explicitly that a function will return
exactly one value. For example, the function <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x y)
</td></tr></table>
<!--l. 5875--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (ﬂoor (+ x y) y))</td></tr></table>
<!--l. 5877--><p class="indent" >
</div>
</div>
<!--l. 5878--><p class="noindent" >will return two values because <a 
href="clmse71.html#x88-206012r256">ﬂoor</a> returns two values. It may be that the second
value makes no sense, or that for eﬃciency reasons it is desired not to compute
the second value. The <a 
href="#x56-144002r123">values</a> function is the standard idiom for indicating that
only one value is to be returned, as shown in the following example. <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x y)
</td></tr></table>
<!--l. 5885--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (values (ﬂoor (+ x y) y)))</td></tr></table>
<!--l. 5887--><p class="indent" >
</div>
</div>
<!--l. 5888--><p class="noindent" >This works because <a 
href="#x56-144002r123">values</a> returns exactly <i>one</i> value for each of its argument forms;
as for any function call, if any argument form to <a 
href="#x56-144002r123">values</a> produces more than one
value, all but the ﬁrst are discarded.
<!--l. 5893--><p class="indent" >   Иногда необходимо указать явно, что функция будет возвращать только
одно значение. Например, функция <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x y)
</td></tr></table>
                                                                          

                                                                          
<!--l. 5896--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (ﬂoor (+ x y) y))</td></tr></table>
<!--l. 5898--><p class="indent" >
</div>
</div>
<!--l. 5899--><p class="noindent" >будет возвращать два значения, потому что <a 
href="clmse71.html#x88-206012r256">ﬂoor</a> возвращает два значения.
Может быть второе значение не имеет смысла в данном контексте, или есть
причины не тратить время на вычисления второго значения. Функция
<a 
href="#x56-144002r123">values</a> является стандартной идиомой для указания того, что будет
возвращено только одно значение, как показано в следующем примере. <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x y)
</td></tr></table>
<!--l. 5905--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (values (ﬂoor (+ x y) y)))</td></tr></table>
<!--l. 5907--><p class="indent" >
</div>
</div>
<!--l. 5908--><p class="noindent" >Это работает, потому что <a 
href="#x56-144002r123">values</a> возвращает только <i>одно</i> значения для каждой
формы аргумента. Если форма аргумента возвращает несколько значений, то
используется только первое, а остальные игнорируются.
<!--l. 5912--><p class="indent" >   There is absolutely no way in Common Lisp for a caller to distinguish between
returning a single value in the ordinary manner and returning exactly one
“multiple value.” For example, the values returned by the expressions
(+ 1 2) and (values (+ 1 2)) are identical in every respect: the single value
3.
<!--l. 5918--><p class="indent" >   В Common Lisp&#x2019;е для вызывающго кода нет возможности различить, было
ли возвращено просто одно значение или было возвращено только
одно значение в с помощью <a 
href="#x56-144002r123">values</a>. Например значения, возвращенные
выражением (+ 1 2) и (values (+ 1 2)), идентичны во всех отношениях: они
оба просто равны 3.
</div>
<div class=defun>
<!--l. 5924--><p class="noindent" ><i>[Constant]</i><a 
 id="dx56-144003"></a><a 
 id="x56-144004r124"></a><b> multiple-values-limit</b>
<!--l. 5926--><p class="noindent" >The value of <a 
href="#x56-144004r124">multiple-values-limit</a> is a positive integer that is the upper
exclusive bound on the number of values that may be returned from a
function. This bound depends on the implementation but will not be smaller
                                                                          

                                                                          
than 20. (Implementors are encouraged to make this limit as large as
practicable without sacriﬁcing performance.) See <a 
href="clmse29.html#x39-67008r12">lambda-parameters-limit</a> and
<a 
href="clmse37.html#x49-101008r79">call-arguments-limit</a>.
<!--l. 5935--><p class="indent" >   Значение <a 
href="#x56-144004r124">multiple-values-limit</a> является положительным целым числом,
которое невключительно указывает наибольшее возможное количество
возвращаемых значений. Это значение зависит от реализации, но не может
быть менее 20. (Разработчики рекомендуется делать это ограничение
как можно большим без потери в производительности.) Смотрите
<a 
href="clmse29.html#x39-67008r12">lambda-parameters-limit</a> и <a 
href="clmse37.html#x49-101008r79">call-arguments-limit</a>.
</div>
<div class=defun>
<!--l. 5943--><p class="noindent" ><i>[Function]</i><a 
 id="dx56-144005"></a><a 
 id="x56-144006r125"></a><b> values-list</b>  <i>list</i>
<!--l. 5945--><p class="noindent" >All of the elements of <i>list</i> are returned as multiple values. For example: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(values-list (list a b c))  ≡ (values a b c)
</td></tr></table>
<!--l. 5950--><p class="indent" >
</div>
</div>
<!--l. 5951--><p class="noindent" >In general, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(values-list <i>list</i>)  ≡ (apply #&#x2019;values <i>list</i>)
</td></tr></table>
<!--l. 5954--><p class="indent" >
</div>
</div>
<!--l. 5955--><p class="noindent" >but <a 
href="#x56-144006r125">values-list</a> may be clearer or more eﬃcient.
<!--l. 5957--><p class="indent" >   Все элементы списка <i>list</i> будут возвращены как несколько значений.
Например: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(values-list (list a b c))  ≡ (values a b c)
</td></tr></table>
<!--l. 5961--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 5962--><p class="noindent" >Можно обозначить так, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(values-list <i>list</i>)  ≡ (apply #&#x2019;values <i>list</i>)
</td></tr></table>
<!--l. 5965--><p class="indent" >
</div>
</div>
<!--l. 5966--><p class="noindent" >но <a 
href="#x56-144006r125">values-list</a> может быть более ясным или эффективным.
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> multiple-value-list </b><a 
 id="dx56-144007"></a><a 
 id="x56-144008r126"></a> form
</td></tr></table>
<!--l. 5972--><p class="indent" >
</div>
<!--l. 5972--><p class="noindent" ><span class="paragraphHead"><a 
 id="x56-1450007.10.1"></a></span>
   <a 
href="#x56-144008r126">multiple-value-list</a> evaluates <i>form</i> and returns a list of the multiple values it
returned. For example: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-list (ﬂoor -3 4))  ⇒ (-1 1)
</td></tr></table>
<!--l. 5978--><p class="indent" >
</div>
</div>
<!--l. 5979--><p class="noindent" ><a 
href="#x56-144008r126">multiple-value-list</a> and <a 
href="#x56-144006r125">values-list</a> are therefore inverses of each other.
<!--l. 5982--><p class="indent" >   <a 
href="#x56-144008r126">multiple-value-list</a> вычисляет форму <i>form</i> и возвращает список из того
количества значений, которое было возвращено формой. Например, <div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-list (ﬂoor -3 4))  ⇒ (-1 1)
</td></tr></table>
<!--l. 5987--><p class="indent" >
</div>
</div>
<!--l. 5988--><p class="noindent" >Таким образом, <a 
href="#x56-144008r126">multiple-value-list</a> и <a 
href="#x56-144006r125">values-list</a> являются антиподами.
FIXME
</div>
<div class=defspec>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> multiple-value-call </b><a 
 id="dx56-145001"></a><a 
 id="x56-145002r127"></a> function  { form}*
</td></tr></table>
<!--l. 5995--><p class="indent" >
</div>
<!--l. 5995--><p class="noindent" ><span class="paragraphHead"><a 
 id="x56-1460007.10.1"></a></span>
   <a 
href="#x56-145002r127">multiple-value-call</a> ﬁrst evaluates <i>function</i> to obtain a function and then
evaluates all of the <i>form</i>s. All the values of the <i>form</i>s are gathered together (not
just one value from each) and are all given as arguments to the function. The
result of <a 
href="#x56-145002r127">multiple-value-call</a> is whatever is returned by the function. For example: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(+ (ﬂoor 5 3) (ﬂoor 19 4))
</td></tr></table>
<!--l. 6003--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ≡ (+ 1 4)  ⇒ 5</td></tr></table>
<!--l. 6004--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-call #&#x2019;+ (ﬂoor 5 3) (ﬂoor 19 4))</td></tr></table>
<!--l. 6005--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ≡ (+ 1 2 4 3)  ⇒ 10</td></tr></table>
<!--l. 6006--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-list <i>form</i>)  ≡ (multiple-value-call #&#x2019;list <i>form</i>)</td></tr></table>
<!--l. 6008--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 6010--><p class="indent" >   <a 
href="#x56-145002r127">multiple-value-call</a> сначала вычисляет <i>function</i> для получения функции и
затем вычисляет все формы <i>forms</i>. Все значения форм <i>forms</i> собираются
вместе (все, а не только первые) и передаются как аргументы функции.
Результат <a 
href="#x56-145002r127">multiple-value-call</a> является тем, что вернула функция. Например: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(+ (ﬂoor 5 3) (ﬂoor 19 4))
</td></tr></table>
<!--l. 6016--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ≡ (+ 1 4)  ⇒ 5</td></tr></table>
<!--l. 6017--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-call #&#x2019;+ (ﬂoor 5 3) (ﬂoor 19 4))</td></tr></table>
<!--l. 6018--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ≡ (+ 1 2 4 3)  ⇒ 10</td></tr></table>
<!--l. 6019--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-list <i>form</i>)  ≡ (multiple-value-call #&#x2019;list <i>form</i>)</td></tr></table>
<!--l. 6021--><p class="indent" >
</div>
</div>
</div>
<div class=defspec>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> multiple-value-prog1 </b><a 
 id="dx56-146001"></a><a 
 id="x56-146002r128"></a> form  { form}*
</td></tr></table>
<!--l. 6027--><p class="indent" >
</div>
<!--l. 6027--><p class="noindent" ><span class="paragraphHead"><a 
 id="x56-1470007.10.1"></a></span>
   <a 
href="#x56-146002r128">multiple-value-prog1</a> evaluates the ﬁrst <i>form</i> and saves all the values
produced by that form. It then evaluates the other <i>form</i>s from left to
right, discarding their values. The values produced by the ﬁrst <i>form</i> are
returned by <a 
href="#x56-146002r128">multiple-value-prog1</a>. See <a 
href="clmse38.html#x50-103002r81">prog1</a>, which always returns a single
value.
                                                                          

                                                                          
<!--l. 6034--><p class="indent" >   <a 
href="#x56-146002r128">multiple-value-prog1</a> вычисляет первую форму <i>form</i> и сохраняет все
значения, возвращенные данной формой. Затем она слева направо
вычисляет оставшиеся <i>формы</i>, игнорируя их значения. Значения,
возвращенные первой формой, становяться результатом всей формы
<a 
href="#x56-146002r128">multiple-value-prog1</a>. Смотрите <a 
href="clmse38.html#x50-103002r81">prog1</a>, которая всегда возвращает одно
значение.
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> multiple-value-bind </b><a 
 id="dx56-147001"></a><a 
 id="x56-147002r129"></a> ( {var}* ) values-form
</td></tr></table>
<!--l. 6043--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  { form}* </td></tr></table>
<!--l. 6044--><p class="indent" >
</div>
<!--l. 6044--><p class="noindent" ><span class="paragraphHead"><a 
 id="x56-1480007.10.1"></a></span>
   The <i>values-form</i> is evaluated, and each of the variables <i>var</i> is bound to the
respective value returned by that form. If there are more variables than values
returned, extra values of <a 
href="clmse31.html#x42-77002r19">nil</a> are given to the remaining variables. If there are more
values than variables, the excess values are simply discarded. The variables are
bound to the values over the execution of the forms, which make up an implicit
<a 
href="clmse38.html#x50-102002r80">progn</a>. For example: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (x) (ﬂoor 5 3) (list x))  ⇒ (1)
</td></tr></table>
<!--l. 6053--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (x y) (ﬂoor 5 3) (list x y))  ⇒ (1 2)</td></tr></table>
<!--l. 6054--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (x y z) (ﬂoor 5 3) (list x y z))</td></tr></table>
<!--l. 6055--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ (1 2 <a 
href="clmse31.html#x42-77002r19">nil</a>)</td></tr></table>
<!--l. 6057--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
<!--l. 6059--><p class="indent" >   Вычисляется <i>values-form</i> и каждое значение результата связывается
соотвественно с переменными указанными в первом параметре. Если
переменных больше, чем возвращаемых значений, для оставшихся
переменных используется значение <a 
href="clmse31.html#x42-77002r19">nil</a>. Если значений больше, чем
переменных, лишние значения игнорируются. Переменные связываются со
значениями только на время выполнения форм тела, которое является
неявным <a 
href="clmse38.html#x50-102002r80">progn</a>. Например: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (x) (ﬂoor 5 3) (list x))  ⇒ (1)
</td></tr></table>
<!--l. 6067--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (x y) (ﬂoor 5 3) (list x y))  ⇒ (1 2)</td></tr></table>
<!--l. 6068--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(multiple-value-bind (x y z) (ﬂoor 5 3) (list x y z))</td></tr></table>
<!--l. 6069--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ (1 2 <a 
href="clmse31.html#x42-77002r19">nil</a>)</td></tr></table>
<!--l. 6071--><p class="indent" >
</div>
</div>
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> multiple-value-setq </b><a 
 id="dx56-148001"></a><a 
 id="x56-148002r130"></a> variables form
</td></tr></table>
<!--l. 6076--><p class="indent" >
</div>
<!--l. 6076--><p class="noindent" ><span class="paragraphHead"><a 
 id="x56-1490007.10.1"></a></span>
   The <i>variables</i> must be a list of variables. The <i>form</i> is evaluated, and the
variables are <i>set</i> (not bound) to the values returned by that form. If there are
more variables than values returned, extra values of <a 
href="clmse31.html#x42-77002r19">nil</a> are assigned to the
remaining variables. If there are more values than variables, the excess values are
simply discarded.
<!--l. 6083--><p class="indent" >   Аргумент <i>variables</i> должен быть списком переменных. Вычисляется
форма <i>form</i> и переменным <i>присваиваются</i> (не связываются) значения,
                                                                          

                                                                          
возвращенные этой формой. Если переменных больше, чем значений,
осташимся переменным присваивается <a 
href="clmse31.html#x42-77002r19">nil</a>. Если значений больше, чем
переменных, лишние значения игнорируются.
<div class=incompatibility>
<!--l. 6090--><p class="noindent" ><b>Compatibility note:</b> In Lisp Machine Lisp this is called multiple-value. The added
clarity of the name <a 
href="#x56-148002r130">multiple-value-setq</a> in Common Lisp was deemed worth the
incompatibility with Lisp Machine Lisp.
</div>
<!--l. 6097--><p class="indent" >
                                                                          

                                                                          
<!--l. 6099--><p class="indent" >   <a 
href="#x56-148002r130">multiple-value-setq</a> always returns a single value, which is the ﬁrst value
returned by <i>form</i>, or <a 
href="clmse31.html#x42-77002r19">nil</a> if <i>form</i> produces zero values.
<!--l. 6102--><p class="indent" >   <a 
href="#x56-148002r130">multiple-value-setq</a> всегда возвращает одно значение, которое является
первым из возвращенных значений формы <i>form</i>, или <a 
href="clmse31.html#x42-77002r19">nil</a>, если форма <i>form</i>
вернула ноль значений.
<div class=newer>
<!--l. 6107--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx56-149001"></a>to specify that if any <i>var</i> refers not to an
ordinary variable but to a binding made by <a 
href="clmse39.html#x51-115002r96">symbol-macrolet</a>, then that
<i>var</i> is handled as if <a 
href="clmse35.html#x47-90002r61">setq</a> were used to assign the appropriate value to
it.
</div>
</div>
<div class=new>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> nth-value </b><a 
 id="dx56-149002"></a><a 
 id="x56-149003r131"></a> n form
</td></tr></table>
<!--l. 6119--><p class="indent" >
</div>
<!--l. 6119--><p class="noindent" ><span class="paragraphHead"><a 
 id="x56-1500007.10.1"></a></span>
   X3J13 voted in January 1989 <a 
 id="dx56-150001"></a>to add a new macro named <a 
href="#x56-149003r131">nth-value</a>. The
argument forms <i>n</i> and <i>form</i> are both evaluated. The value of <i>n</i> must be a
non-negative integer, and the <i>form</i> may produce any number of values. The
integer <i>n</i> is used as a zero-based index into the list of values. Value <i>n</i> of the <i>form</i>
is returned as the single value of the <a 
href="#x56-149003r131">nth-value</a> form; <a 
href="clmse31.html#x42-77002r19">nil</a> is returned if the <i>form</i>
produces no more than <i>n</i> values.
<!--l. 6132--><p class="indent" >   As an example, <a 
href="clmse71.html#x88-206020r260">mod</a> could be deﬁned as <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun mod (number divisor)
</td></tr></table>
<!--l. 6134--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (nth-value 1 (ﬂoor number divisor)))</td></tr></table>
<!--l. 6136--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 6137--><p class="noindent" >Value number 1 is the <i>second</i> value returned by <a 
href="clmse71.html#x88-206012r256">ﬂoor</a>, the ﬁrst value being value
number 0.
<!--l. 6140--><p class="indent" >   One could deﬁne <a 
href="#x56-149003r131">nth-value</a> simply as <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmacro nth-value (n form)
</td></tr></table>
<!--l. 6142--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ‘(nth ,n (multiple-value-list ,form)))</td></tr></table>
<!--l. 6144--><p class="indent" >
</div>
</div>
<!--l. 6145--><p class="noindent" >but the clever implementor will doubtless ﬁnd an implementation technique for
<a 
href="#x56-149003r131">nth-value</a> that avoids constructing an intermediate list of all the values of the
<i>form</i>.
</div>
</div>
<!--l. 6152--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.10.2   </span> <a 
 id="x56-1510007.10.2"></a>Rules Governing the Passing of Multiple Values Правила управления
возврата нескольких значений</h4>
<!--l. 6154--><p class="noindent" >It is often the case that the value of a special form or macro call is deﬁned to be
the value of one of its subforms. For example, the value of a <a 
href="clmse40.html#x52-120002r100">cond</a> is the value of
the last form in the selected clause.
<!--l. 6160--><p class="indent" >   Часто случается так, что значение специальной формы или макроса
определено как значение одного из подвыражений. Например, значение
<a 
href="clmse40.html#x52-120002r100">cond</a> является значением последнего подвыражения в исполняемой
ветке.
<!--l. 6165--><p class="indent" >   In most such cases, if the subform produces multiple values, then the original
form will also produce all of those values. This <i>passing back</i> of multiple values of
course has no eﬀect unless eventually one of the special forms for receiving
multiple values is reached.
<!--l. 6171--><p class="indent" >   В большинстве таких случаев, если подвыражение возвращает несколько
значений, тогда и оригинальная форма возвращает все эти значения.
Эта <i>передача значений</i>, конечно, не будет иметь место, если не была
                                                                          

                                                                          
выполнена специальная форма для обработки возврата нескольких
значений.
<!--l. 6176--><p class="indent" >   To be explicit, multiple values can result from a special form under precisely
these circumstances:
<!--l. 6179--><p class="indent" >   Неявно несколько значений может быть возвращены из специальных
форм в соответствие со следующими правилами:
<div class=flushdesc>
<!--l. 6183--><p class="indent" >
      <ul><li><b>
<i>Evaluation and application Вычисление и применение</i> </b></li>
           <ul class="itemize1">
           <li class="itemize"><a 
href="clmse110.html#x135-261002r620">eval</a>  returns  multiple  values  if  the  form  given  it  to  evaluate
           produces multiple values.
           </li>
           <li class="itemize"><a 
href="clmse110.html#x135-261002r620">eval</a>  возвращает  несколько  значений,  если  переданная  ему
           форму при вычислении вернула несколько значений.
           </li>
           <li class="itemize"><a 
href="clmse37.html#x49-101002r77">apply</a>, <a 
href="clmse37.html#x49-101005r78">funcall</a>, and <a 
href="#x56-145002r127">multiple-value-call</a> pass back multiple values
           from the function applied or called.
           </li>
           <li class="itemize"><a 
href="clmse37.html#x49-101002r77">apply</a>, <a 
href="clmse37.html#x49-101005r78">funcall</a> и <a 
href="#x56-145002r127">multiple-value-call</a> передают обратно несколько
           значений из применяемой или вызываемой функции.</li></ul>
      <li><b>
<i>Implicit <a 
href="clmse38.html#x50-102002r80">progn</a> contexts В контексте неявного <a 
href="clmse38.html#x50-102002r80">progn</a></i> </b></li>
           <ul class="itemize1">
           <li class="itemize">The  special  form  <a 
href="clmse38.html#x50-102002r80">progn</a>  passes  back  multiple  values  resulting
           from evaluation of the last subform. Other situations referred to
           as “implicit <a 
href="clmse38.html#x50-102002r80">progn</a>,”  where several forms are evaluated and the
           results  of  all  but  the  last  form  are  discarded,  also  pass  back
           multiple values from the last form. These situations include the
           body  of  a  lambda-expression,  in  particular  those  constructed
           by  <a 
href="clmse30.html#x40-69002r13">defun</a>,  <a 
href="clmse46.html#x59-157007r137">defmacro</a>,  and  <a 
href="clmse24.html#x33-53002r6">deftype</a>.  Also  included  are  bodies
           of  the  constructs  <a 
href="clmse30.html#x40-74003r18">eval-when</a>,  <a 
href="clmse39.html#x51-112003r89">progv</a>,  <a 
href="clmse39.html#x51-107003r84">let</a>,  <a 
href="clmse39.html#x51-109003r86">let*</a>,  <a 
href="clmse141.html#x172-364004r879">when</a>,  <a 
href="clmse141.html#x172-364006r880">unless</a>,
           <a 
href="clmse41.html#x53-124002r103">block</a>, <a 
href="#x56-147002r129">multiple-value-bind</a>, and <a 
href="clmse45.html#x57-152006r132">catch</a>, as well as clauses in such
                                                                          

                                                                          
           conditional constructs as <a 
href="clmse40.html#x52-121002r101">case</a>, <a 
href="clmse40.html#x52-122002r102">typecase</a>, <a 
href="clmse155.html#x189-477002r998">ecase</a>, <a 
href="clmse155.html#x189-475002r996">etypecase</a>, <a 
href="clmse155.html#x189-478002r999">ccase</a>,
           and <a 
href="clmse155.html#x189-476002r997">ctypecase</a>.
           </li>
           <li class="itemize">Специальная   форма   <a 
href="clmse38.html#x50-102002r80">progn</a>   передает   обратно   несколько
           значений полученных при вычислении последней подформы.
           В другие ситуациях, называемых «неявный <a 
href="clmse38.html#x50-102002r80">progn</a>», в которых
           вычисляется  несколько  форм  и  результаты  всех,  кроме
           последней формы, игнорируются, также передается обратно
           несколько  значений  от  формы.  Такие  ситуации  включают
           тело  лямбда-выражения,  в  частности  в  <a 
href="clmse30.html#x40-69002r13">defun</a>,  <a 
href="clmse46.html#x59-157007r137">defmacro</a>  и
           <a 
href="clmse24.html#x33-53002r6">deftype</a>.  Также  включаются  тела  конструкций  <a 
href="clmse30.html#x40-74003r18">eval-when</a>,
           <a 
href="clmse39.html#x51-112003r89">progv</a>, <a 
href="clmse39.html#x51-107003r84">let</a>, <a 
href="clmse39.html#x51-109003r86">let*</a>, <a 
href="clmse141.html#x172-364004r879">when</a>, <a 
href="clmse141.html#x172-364006r880">unless</a>, <a 
href="clmse41.html#x53-124002r103">block</a>, <a 
href="#x56-147002r129">multiple-value-bind</a> и <a 
href="clmse45.html#x57-152006r132">catch</a>.
           И также включаются подвыражения условных конструкций
           <a 
href="clmse40.html#x52-121002r101">case</a>, <a 
href="clmse40.html#x52-122002r102">typecase</a>, <a 
href="clmse155.html#x189-477002r998">ecase</a>, <a 
href="clmse155.html#x189-475002r996">etypecase</a>, <a 
href="clmse155.html#x189-478002r999">ccase</a> и <a 
href="clmse155.html#x189-476002r997">ctypecase</a>.</li></ul>
      </ul>
</div>
<div class=new>
<!--l. 6245--><p class="indent" >   X3J13 has voted to add many new constructs to the language that contain
implicit <a 
href="clmse38.html#x50-102002r80">progn</a> contexts. I won&#x2019;t attempt to list them all here. Of particular
interest, however, is <a 
href="clmse51.html#x65-169004r155">locally</a>, which may be regarded as simply a version of
<a 
href="clmse38.html#x50-102002r80">progn</a> that permits declarations before its body. This provides a useful
building block for constructing macros that permit declarations (but not
documentation strings) before their bodies and pass back any multiple
values produced by the last sub-form of a body. (If a body can contain a
documentation string, most likely lambda is the correct building block to
use.)
</div>
<div class=flushdesc>
<!--l. 6257--><p class="indent" >
      <ul><li><b>
<i>Conditional constructs Условные конструкции</i> </b></li>
           <ul class="itemize1">
           <li class="itemize"><a 
href="clmse141.html#x172-364002r878">if</a> passes back multiple values from whichever subform is selected
           (the <i>then</i> form or the <i>else</i> form).
                                                                          

                                                                          
           </li>
           <li class="itemize"><a 
href="clmse141.html#x172-364002r878">if</a> передает обратно несколько значений из любой выбранной
           подформы (ветки <i>then</i> или <i>else</i>).
           </li>
           <li class="itemize"><a 
href="clmse34.html#x45-82004r51">and</a> and <a 
href="clmse34.html#x45-83002r52">or</a> pass back multiple values from the last subform but
           not from subforms other than the last.
           </li>
           <li class="itemize"><a 
href="clmse34.html#x45-82004r51">and</a> и <a 
href="clmse34.html#x45-83002r52">or</a> передают обратно несколько значений из последней
           подформы, но ни из какой другой непоследней подформы.
           </li>
           <li class="itemize"><a 
href="clmse40.html#x52-120002r100">cond</a> passes back multiple values from the last subform of the
           implicit  <a 
href="clmse38.html#x50-102002r80">progn</a>  of  the  selected  clause.  If,  however,  the  clause
           selected is a singleton clause, then only a single value (the non-<a 
href="clmse31.html#x42-77002r19">nil</a>
           predicate value) is returned. This is true even if the singleton
           clause is the last clause of the <a 
href="clmse40.html#x52-120002r100">cond</a>. It is <i>not</i> permitted to treat
           a ﬁnal clause (x) as being the same as (t x) for this reason; the
           latter passes back multiple values from the form x.
           </li>
           <li class="itemize"><a 
href="clmse40.html#x52-120002r100">cond</a>              передает              обратно              несколько
           значений из последней подформы неявного <a 
href="clmse38.html#x50-102002r80">progn</a> выделенного
           подвыражения.   Однако,   если   выделенное   подвыражение
           является   «синглтоном»,   будет   возвращено   только   одно
           значение (не-<a 
href="clmse31.html#x42-77002r19">nil</a> значение предиката). Это верно, даже если
           выражение «синглтон» является последним подвыражением
           <a 
href="clmse40.html#x52-120002r100">cond</a>. Нельзя рассматривать последнее подвыражение (x), как
           будто оно (t x). Последнее подвыражение передает обратно
           несколько значений из формы x.
           </li></ul>
      <li><b>
<i>Returning from a block Возврат из блока</i> </b></li>
           <ul class="itemize1">
           <li class="itemize">The  <a 
href="clmse41.html#x53-124002r103">block</a>  construct  passes  back  multiple  values  from  its  last
           subform when it exits normally. If <a 
href="clmse41.html#x53-125002r104">return-from</a> (or <a 
href="clmse142.html#x173-367002r883">return</a>) is used
           to terminate the <a 
href="clmse41.html#x53-124002r103">block</a> prematurely, then <a 
href="clmse41.html#x53-125002r104">return-from</a> passes back
           multiple values from its subform as the values of the terminated
                                                                          

                                                                          
           <a 
href="clmse41.html#x53-124002r103">block</a>. Other constructs that create implicit blocks, such as <a 
href="clmse142.html#x173-366002r881">do</a>,
           <a 
href="clmse42.html#x54-134002r111">dolist</a>, <a 
href="clmse42.html#x54-135003r112">dotimes</a>, <a 
href="clmse42.html#x54-139002r120">prog</a>, and <a 
href="clmse42.html#x54-139004r121">prog*</a>, also pass back multiple values
           speciﬁed by <a 
href="clmse41.html#x53-125002r104">return-from</a> (or <a 
href="clmse142.html#x173-367002r883">return</a>).
           </li>
           <li class="itemize">При  нормальном  завершении  конструкция  <a 
href="clmse41.html#x53-124002r103">block</a>  передает
           обратно несколько значений из ее последней подформы. Если
           для завершения использовалась <a 
href="clmse41.html#x53-125002r104">return-from</a> (или <a 
href="clmse142.html#x173-367002r883">return</a>), тогда
           <a 
href="clmse41.html#x53-125002r104">return-from</a>  передает  обратно  несколько  значений  из  своей
           подформы,  как  значения  всей  конструкции  <a 
href="clmse41.html#x53-124002r103">block</a>.  Другие
           конструкции, создающие неявные блоки, такие как <a 
href="clmse142.html#x173-366002r881">do</a>, <a 
href="clmse42.html#x54-134002r111">dolist</a>,
           <a 
href="clmse42.html#x54-135003r112">dotimes</a>,  <a 
href="clmse42.html#x54-139002r120">prog</a>  и  <a 
href="clmse42.html#x54-139004r121">prog*</a>,  также  передают  обратно  несколько
           значений, заданных с помощью <a 
href="clmse41.html#x53-125002r104">return-from</a> (или <a 
href="clmse142.html#x173-367002r883">return</a>).
           </li>
           <li class="itemize"><a 
href="clmse142.html#x173-366002r881">do</a> passes back multiple values from the last form of the exit clause,
           exactly as if the exit clause were a <a 
href="clmse40.html#x52-120002r100">cond</a> clause. Similarly, <a 
href="clmse42.html#x54-134002r111">dolist</a>
           and <a 
href="clmse42.html#x54-135003r112">dotimes</a> pass back multiple values from the <i>resultform</i> if that
           is executed. These situations are all examples of implicit uses of
           <a 
href="clmse41.html#x53-125002r104">return-from</a>.
           </li>
           <li class="itemize"><a 
href="clmse142.html#x173-366002r881">do</a>   передает   обратно   несколько   значений   из   последней
           формы  подвыражения  выхода,  точно  также,  как  если  бы
           подвыражение выхода было подвыражение <a 
href="clmse40.html#x52-120002r100">cond</a>. Подобным
           образом   действуют   <a 
href="clmse42.html#x54-134002r111">dolist</a>   и   <a 
href="clmse42.html#x54-135003r112">dotimes</a>.   Они   возвращают
           несколько  значений  из  формы  <i>resultform</i>,  если  она  была
           выполнена. Эти ситуации также являются примерами явного
           использования <a 
href="clmse41.html#x53-125002r104">return-from</a>.
           </li></ul>
      <li><b>
<i>Throwing out of a catch Выход из catch</i> </b></li>
           <ul class="itemize1">
           <li class="itemize">The <a 
href="clmse45.html#x57-152006r132">catch</a> construct returns multiple values if the result form in
           a <a 
href="clmse45.html#x57-154003r134">throw</a> exiting from such a catch produces multiple values.
           </li>
           <li class="itemize">Конструкция  <a 
href="clmse45.html#x57-152006r132">catch</a>  возвращает  несколько  значений,  если
           результат  формы  в  <a 
href="clmse45.html#x57-154003r134">throw</a>,  которая  осуществляет  выход  из
                                                                          

                                                                          
           этого catch, возвращает несколько значений.</li></ul>
      <li><b>
<i>Miscellaneous situations Остальные ситуации</i> </b></li>
           <ul class="itemize1">
           <li class="itemize"><a 
href="#x56-146002r128">multiple-value-prog1</a>  passes  back  multiple  values  from  its  ﬁrst
           subform. However, <a 
href="clmse38.html#x50-103002r81">prog1</a> always returns a single value.
           </li>
           <li class="itemize"><a 
href="#x56-146002r128">multiple-value-prog1</a> передает обратно несколько значений из
           его первой подформы. Однако, <a 
href="clmse38.html#x50-103002r81">prog1</a> всегда возвращает одно
           значение.
           </li>
           <li class="itemize"><a 
href="clmse45.html#x57-153004r133">unwind-protect</a>  returns  multiple  values  if  the  form  it  protects
           returns multiple values.
           </li>
           <li class="itemize"><a 
href="clmse45.html#x57-153004r133">unwind-protect</a> возвращает несколько значений, если форма,
           которую он защищает, вернула несколько значений.
           </li>
           <li class="itemize"><a 
href="clmse53.html#x67-173002r158">the</a> returns multiple values if the form it contains returns multiple
           values.
           </li>
           <li class="itemize"><a 
href="clmse53.html#x67-173002r158">the</a> возвращает несколько значений, если в нем содержащаяся
           форма возвращает несколько значений.</li></ul>
      </ul>
</div>
<!--l. 6379--><p class="indent" >   Among special forms that <i>never</i> pass back multiple values are <a 
href="clmse38.html#x50-103002r81">prog1</a>, <a 
href="clmse38.html#x50-104002r82">prog2</a>,
<a 
href="clmse35.html#x47-90002r61">setq</a>, and <a 
href="#x56-148002r130">multiple-value-setq</a>. The conventional way to force only one value to be
returned from a form x is to write (values x).
<!--l. 6385--><p class="indent" >   <a 
href="clmse38.html#x50-103002r81">prog1</a>, <a 
href="clmse38.html#x50-104002r82">prog2</a>, <a 
href="clmse35.html#x47-90002r61">setq</a> и <a 
href="#x56-148002r130">multiple-value-setq</a> — это формы, которые <i>никогда</i> не
передают обратно несколько значений. Стандартный метод для явного
указания возврата одного значения из формы x является запись (values
x).
<!--l. 6391--><p class="indent" >   The most important rule about multiple values is: <b>No matter how many
values a form produces, if the form is an argument form in a function
call, then exactly one value (the ﬁrst one) is used.</b>
                                                                          

                                                                          
<!--l. 6396--><p class="indent" >   Наиболее важное правило насчет нескольких значений: <b>Не важно
сколько значений возвращает форма, если форма является
аргументом в вызове функции, то только одно значение (первое)
будет использовано.</b>
<!--l. 6401--><p class="indent" >   For example, if you write (cons (ﬂoor x)), then <a 
href="clmse86.html#x106-224062r474">cons</a> will always receive <i>exactly</i>
one argument (which is of course an error), even though <a 
href="clmse71.html#x88-206012r256">ﬂoor</a> returns two values.
To pass both values from <a 
href="clmse71.html#x88-206012r256">ﬂoor</a> to <a 
href="clmse86.html#x106-224062r474">cons</a>, one must write something like
(multiple-value-call #&#x2019;cons (ﬂoor x)). In an ordinary function call, each argument
form produces exactly <i>one</i> argument; if such a form returns zero values, <a 
href="clmse31.html#x42-77002r19">nil</a> is
used for the argument, and if more than one value, all but the ﬁrst are
discarded. Similarly, conditional constructs such as <a 
href="clmse141.html#x172-364002r878">if</a> that test the value of a
form will use exactly one value, the ﬁrst one, from that form and discard
the rest; such constructs will use <a 
href="clmse31.html#x42-77002r19">nil</a> as the test value if zero values are
returned.
<!--l. 6414--><p class="indent" >   Например, если вы записали (cons (ﬂoor x)), тогда <a 
href="clmse86.html#x106-224062r474">cons</a> всегда получить
<i>только</i> один аргумент (что, конечно, является ошибкой), хотя и <a 
href="clmse71.html#x88-206012r256">ﬂoor</a>
возвращает два значения. Для того, чтобы поместить оба значения <a 
href="clmse71.html#x88-206012r256">ﬂoor</a> в
<a 
href="clmse86.html#x106-224062r474">cons</a>, можно записать что-то вроде этого: (multiple-value-call #&#x2019;cons
(ﬂoor x)). В обычном вызовае функции, каждый форма аргумента
предоставляется только <i>один</i> аргумент. Если такая форма возвращает ноль
значение, в качестве аргумента используется <a 
href="clmse31.html#x42-77002r19">nil</a>. А если возвращает более
одного значения, все они, кроме первого, игнорируются. Также и
условные конструкции, например <a 
href="clmse141.html#x172-364002r878">if</a>, которые проверяют значения формы,
используют только одно первое значение, остальные игнорируются.
Такие конструкции будут использовать <a 
href="clmse31.html#x42-77002r19">nil</a> если форма вернула ноль
значений.
                                                                          

                                                                          
   <!--l. 6427--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse45.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse43.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse43.html#tailclmse43.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse44.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch7.html#clmse44.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 6427--><p class="indent" >   <a 
 id="tailclmse44.html"></a>  
</body></html> 
