<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Output Functions</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-19 00:40:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 4048--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse113.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse111.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse111.html#tailclmse111.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse112.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch22.html#clmse112.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">22.3   </span> <a 
 id="x139-25900022.3"></a>Output Functions</h3>
<!--l. 4050--><p class="noindent" >The output functions are divided into two groups: those that operate on streams
of characters and those that operate on streams of binary data. The function
<a 
href="#x139-263003r687">format</a> operates on streams of characters but is described in a section
separate from the other character-output functions because of its great
complexity.
<!--l. 4057--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">22.3.1   </span> <a 
 id="x139-26000022.3.1"></a>Output to Character Streams</h4>
<!--l. 4059--><p class="noindent" >These functions all take an optional argument called <i>output-stream</i>, which is
where to send the output. If unsupplied or <a 
href="clmse31.html#x42-74002r18">nil</a>, <i>output-stream</i> defaults to the value
of the variable <a 
href="clmse107.html#x133-241004r598">*standard-output*</a>. If it is <a 
href="clmse31.html#x42-74004r19">t</a>, the value of the variable <a 
href="clmse107.html#x133-241012r602">*terminal-io*</a>
is used.
<div class=obsolete>
<div class=defun>
<!--l. 4066--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-260001"></a><a 
 id="x139-260002r667"></a><b> write</b>  <i>object</i> &#x0026;key  <i>:stream</i> <i>:escape</i> <i>:radix</i> <i>:base</i> <i>:circle</i> <i>:pretty</i> <i>:level</i>
<i>:length</i> <i>:case</i> <i>:gensym</i> <i>:array</i>
<!--l. 4068--><p class="noindent" >The printed representation of <i>object</i> is written to the output stream speciﬁed by
:stream, which defaults to the value of <a 
href="clmse107.html#x133-241004r598">*standard-output*</a>.
<!--l. 4072--><p class="indent" >   The other keyword arguments specify values used to control the generation of
the printed representation. Each defaults to the value of the corresponding global
variable: see *print-escape*, *print-radix*, *print-base*, *print-circle*,
*print-pretty*, *print-level*, *print-length*, *print-case*, *print-array*, and
*print-gensym*. (This is the means by which these variables aﬀect printing
operations: supplying default values for the <a 
href="#x139-260006r668">write</a> function.) Note that the printing
of symbols is also aﬀected by the value of the variable <a 
href="clmse60.html#x76-168002r141">*package*</a>. <a 
href="#x139-260006r668">write</a> returns
<i>object</i>.
</div>
</div>
                                                                          

                                                                          
<div class=newer>
<!--l. 4089--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx139-260003"></a>to add the keyword argument :readably to the
function <a 
href="#x139-260006r668">write</a>, and voted in June 1989 <a 
 id="dx139-260004"></a>to add the keyword arguments
:right-margin, :miser-width, :lines, and :pprint-dispatch. The revised description is
as follows.
<div class=defun>
<!--l. 4096--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-260005"></a><a 
 id="x139-260006r668"></a><b> write</b>  <i>object</i> &#x0026;key  <i>:stream</i> <i>:escape</i> <i>:radix</i> <i>:base</i> <i>:circle</i> <i>:pretty</i> <i>:level</i>
<i>:length</i> <i>:case</i> <i>:gensym</i> <i>:array</i> <i>:readably</i> <i>:right-margin</i> <i>:miser-width</i> <i>:lines</i>
<i>:pprint-dispatch</i>
<!--l. 4100--><p class="noindent" >The printed representation of <i>object</i> is written to the output stream speciﬁed by
:stream, which defaults to the value of <a 
href="clmse107.html#x133-241004r598">*standard-output*</a>.
<!--l. 4104--><p class="indent" >   The other keyword arguments specify values used to control the generation of
the printed representation. Each defaults to the value of the corresponding global
variable: see *print-escape*, *print-radix*, *print-base*, *print-circle*,
*print-pretty*, *print-level*, *print-length*, and *print-case*, in addition to
*print-array*, *print-gensym*, *print-readably*, *print-right-margin*,
*print-miser-width*, *print-lines*, and *print-pprint-dispatch*. (This is the means
by which these variables aﬀect printing operations: supplying default values for
the <a 
href="#x139-260006r668">write</a> function.) Note that the printing of symbols is also aﬀected by the value
of the variable <a 
href="clmse60.html#x76-168002r141">*package*</a>. <a 
href="#x139-260006r668">write</a> returns <i>object</i>.
</div>
</div>
<div class=defun>
<!--l. 4124--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-260007"></a><a 
 id="x139-260008r669"></a><b> prin1</b>  <i>object</i> &#x0026;optional  <i>output-stream</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx139-260009"></a><a 
 id="x139-260010r670"></a><b> print</b>  <i>object</i> &#x0026;optional  <i>output-stream</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx139-260011"></a><a 
 id="x139-260012r671"></a><b> pprint</b>  <i>object</i> &#x0026;optional  <i>output-stream</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx139-260013"></a><a 
 id="x139-260014r672"></a><b> princ</b>  <i>object</i> &#x0026;optional  <i>output-stream</i>
<!--l. 4129--><p class="noindent" >prin1 outputs the printed representation of <i>object</i> to <i>output-stream</i>. Escape
characters are used as appropriate. Roughly speaking, the output from prin1 is
suitable for input to the function <a 
href="clmse111.html#x138-257003r653">read</a>. prin1 returns the <i>object</i> as its value.
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(prin1 <i>object</i> <i>output-stream</i>)
</td></tr></table>
<!--l. 4135--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ≡</span> (write <i>object</i> :stream <i>output-stream</i> :escape t)</td></tr></table>
<!--l. 4137--><p class="indent" >
</div>
                                                                          

                                                                          
</div>
<!--l. 4139--><p class="indent" >   <a 
href="#x139-260010r670">print</a> is just like prin1 except that the printed representation of <i>object</i> is
preceded by a newline (see <a 
href="#x139-260034r680">terpri</a>) and followed by a space. <a 
href="#x139-260010r670">print</a> returns
<i>object</i>.
<!--l. 4144--><p class="indent" >   <a 
href="#x139-260012r671">pprint</a> is just like <a 
href="#x139-260010r670">print</a> except that the trailing space is omitted and the <i>object</i>
is printed with the *print-pretty* ﬂag non-<a 
href="clmse31.html#x42-74002r18">nil</a> to produce “pretty” output.
<a 
href="#x139-260012r671">pprint</a> returns no values (that is, what the expression (values) returns: zero
values).
<div class=new>
<!--l. 4152--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx139-260015"></a>to adopt a facility for user-controlled pretty
printing (see chapter <a 
href="clmch27.html#x170-35000027">27<!--tex4ht:ref: PPRINT --></a>).
</div>
<!--l. 4158--><p class="indent" >   <a 
href="#x139-260014r672">princ</a> is just like prin1 except that the output has no escape characters. A
symbol is printed as simply the characters of its print name; a string is printed
without surrounding double quotes; and there may be diﬀerences for other data
types as well. The general rule is that output from <a 
href="#x139-260014r672">princ</a> is intended to look
good to people, while output from prin1 is intended to be acceptable to
the function <a 
href="clmse111.html#x138-257003r653">read</a>. <div class=newer> X3J13 voted in June 1987 <a 
 id="dx139-260016"></a>to clarify that <a 
href="#x139-260014r672">princ</a> prints
a character in exactly the same manner as <a 
href="#x139-260028r677">write-char</a>: the character is
simply sent to the output <i>stream</i>. This was implied by the speciﬁcation in
section <a 
href="clmse110.html#x137-25400022.1.6">22.1.6<!--tex4ht:ref: PRINTER --></a> in the ﬁrst edition, but is worth pointing out explicitly
here.
</div> <a 
href="#x139-260014r672">princ</a> returns the <i>object</i> as its value. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(princ <i>object</i> <i>output-stream</i>)
</td></tr></table>
<!--l. 4174--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ≡</span> (write <i>object</i> :stream <i>output-stream</i> :escape <a 
href="clmse31.html#x42-74002r18">nil</a>)</td></tr></table>
<!--l. 4176--><p class="indent" >
</div>
</div>
<div class=incompatibility>
<!--l. 4179--><p class="noindent" ><b>Compatibility note:</b> In MacLisp, the functions prin1, <a 
href="#x139-260010r670">print</a>, and <a 
href="#x139-260014r672">princ</a> return <a 
href="clmse31.html#x42-74004r19">t</a>, not the
argument <i>object</i>.
</div>
</div>
<div class=obsolete>
<div class=defun>
                                                                          

                                                                          
<!--l. 4187--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-260017"></a><a 
 id="x139-260018r673"></a><b> write-to-string</b>  <i>object</i> &#x0026;key  <i>:escape</i> <i>:radix</i> <i>:base</i> <i>:circle</i> <i>:pretty</i>
<i>:level</i> <i>:length</i> <i>:case</i> <i>:gensym</i> <i>:array</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx139-260019"></a><a 
 id="x139-260020r674"></a><b> prin1-to-string</b>  <i>object</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx139-260021"></a><a 
 id="x139-260022r675"></a><b> princ-to-string</b>  <i>object</i>
<!--l. 4192--><p class="noindent" >The object is eﬀectively printed as if by <a 
href="#x139-260006r668">write</a>, prin1, or <a 
href="#x139-260014r672">princ</a>, respectively, and
the characters that would be output are made into a string, which is
returned.
</div>
</div>
<div class=incompatibility>
<!--l. 4201--><p class="noindent" ><b>Compatibility note:</b> The Interlisp function mkstring corresponds to the Common Lisp
function <a 
href="#x139-260022r675">princ-to-string</a>.
</div>
<div class=new>
<div class=defun>
<!--l. 4208--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-260023"></a><a 
 id="x139-260024r676"></a><b> write-to-string</b>  <i>object</i> &#x0026;key  <i>:escape</i> <i>:radix</i> <i>:base</i> <i>:circle</i> <i>:pretty</i>
<i>:level</i> <i>:length</i> <i>:case</i> <i>:gensym</i> <i>:array</i> <i>:readably</i> <i>:right-margin</i> <i>:miser-width</i> <i>:lines</i>
<i>:pprint-dispatch</i>
<!--l. 4212--><p class="noindent" >X3J13 voted in June 1989 (<a 
 id="dx139-260025"></a> and <a 
 id="dx139-260026"></a>) to add keyword arguments to <a 
href="#x139-260006r668">write</a>; presumably
they should also be added to <a 
href="#x139-260024r676">write-to-string</a>.
</div>
</div>
<div class=defun>
<!--l. 4220--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-260027"></a><a 
 id="x139-260028r677"></a><b> write-char</b>  <i>character</i> &#x0026;optional  <i>output-stream</i>
<!--l. 4222--><p class="noindent" ><a 
href="#x139-260028r677">write-char</a> outputs the <i>character</i> to <i>output-stream</i>, and returns <i>character</i>.
</div>
<div class=defun>
<!--l. 4228--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-260029"></a><a 
 id="x139-260030r678"></a><b> write-string</b>  <i>string</i> &#x0026;optional  <i>output-stream</i> &#x0026;key  <i>:start</i>
<i>:end</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx139-260031"></a><a 
 id="x139-260032r679"></a><b> write-line</b>  <i>string</i> &#x0026;optional  <i>output-stream</i> &#x0026;key  <i>:start</i>
<i>:end</i>
<!--l. 4231--><p class="noindent" ><a 
href="#x139-260030r678">write-string</a> writes the characters of the speciﬁed substring of <i>string</i> to the
<i>output-stream</i>. The :start and :end parameters delimit a substring of <i>string</i> in
the usual manner (see chapter <a 
href="clmch14.html#x94-19500014">14<!--tex4ht:ref: KSEQUE --></a>). <a 
href="#x139-260032r679">write-line</a> does the same thing but
then outputs a newline afterwards. (See <a 
href="clmse111.html#x138-257013r657">read-line</a>.) In either case, the
<i>string</i> is returned (<i>not</i> the substring delimited by :start and :end). In some
implementations these may be much more eﬃcient than an explicit loop using
<a 
href="#x139-260028r677">write-char</a>.
                                                                          

                                                                          
</div>
<div class=defun>
<!--l. 4246--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-260033"></a><a 
 id="x139-260034r680"></a><b> terpri</b>  &#x0026;optional  <i>output-stream</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx139-260035"></a><a 
 id="x139-260036r681"></a><b> fresh-line</b>  &#x0026;optional  <i>output-stream</i>
<!--l. 4249--><p class="noindent" >The function <a 
href="#x139-260034r680">terpri</a> outputs a newline to <i>output-stream</i>. It is identical in eﬀect to
(write-char #\Newline <i>output-stream</i>); however, <a 
href="#x139-260034r680">terpri</a> always returns
<a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 4255--><p class="indent" >   <a 
href="#x139-260036r681">fresh-line</a> is similar to <a 
href="#x139-260034r680">terpri</a> but outputs a newline only if the stream is not
already at the start of a line. (If for some reason this cannot be determined, then
a newline is output anyway.) This guarantees that the stream will be
on a “fresh line” while consuming as little vertical distance as possible.
<a 
href="#x139-260036r681">fresh-line</a> is a predicate that is true if it output a newline, and otherwise
false.
</div>
<div class=defun>
<!--l. 4265--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-260037"></a><a 
 id="x139-260038r682"></a><b> ﬁnish-output</b>  &#x0026;optional  <i>output-stream</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx139-260039"></a><a 
 id="x139-260040r683"></a><b> force-output</b>  &#x0026;optional  <i>output-stream</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx139-260041"></a><a 
 id="x139-260042r684"></a><b> clear-output</b>  &#x0026;optional  <i>output-stream</i>
<!--l. 4269--><p class="noindent" >Some streams may be implemented in an asynchronous or buﬀered manner. The
function <a 
href="#x139-260038r682">ﬁnish-output</a> attempts to ensure that all output sent to <i>output-stream</i>
has reached its destination, and only then returns <a 
href="clmse31.html#x42-74002r18">nil</a>. <a 
href="#x139-260040r683">force-output</a> initiates the
emptying of any internal buﬀers but returns <a 
href="clmse31.html#x42-74002r18">nil</a> without waiting for completion or
acknowledgment.
<!--l. 4277--><p class="indent" >   The function <a 
href="#x139-260042r684">clear-output</a>, on the other hand, attempts to abort any
outstanding output operation in progress in order to allow as little output as
possible to continue to the destination. This is useful, for example, to abort a
lengthy output to the terminal when an asynchronous error occurs. <a 
href="#x139-260042r684">clear-output</a>
returns <a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 4284--><p class="indent" >   The precise actions of all three of these operations are implementation-dependent.
</div>
<div class=newer>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> print-unreadable-object </b><a 
 id="dx139-260043"></a><a 
 id="x139-260044r685"></a> (object stream
</td></tr></table>
                                                                          

                                                                          
<!--l. 4291--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> [[<span class="math">: type!type|: identity!id]] )</span></td></tr></table>
<!--l. 4292--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  { form}* </td></tr></table>
<!--l. 4293--><p class="indent" >
</div>
<!--l. 4293--><p class="noindent" ><span class="paragraphHead"><a 
 id="x139-26100022.3.1"></a></span>
   X3J13 voted in June 1989 <a 
 id="dx139-261001"></a>to add <a 
href="#x139-260044r685">print-unreadable-object</a>, which will
output a printed representation of <i>object</i> on <i>stream</i>, beginning with #&#x003C;
and ending with <a 
href="clmse63.html#x80-177008r176">&#x003E;</a>. Everything output to the <i>stream</i> during execution
of the body forms is enclosed in the angle brackets. If <i>type</i> is true, the
body output is preceded by a brief description of the object&#x2019;s type and
a space character. If <i>id</i> is true, the body output is followed by a space
character and a representation of the object&#x2019;s identity, typically a storage
address.
<!--l. 4306--><p class="indent" >   If *print-readably* is true, <a 
href="#x139-260044r685">print-unreadable-object</a> signals an error of type
print-not-readable without printing anything.
<!--l. 4309--><p class="indent" >   The <i>object</i>, <i>stream</i>, <i>type</i>, and <i>id</i> arguments are all evaluated normally. The
<i>type</i> and <i>id</i> default to false. It is valid to provide no body forms. If <i>type</i> and <i>id</i> are
both true and there are no body forms, only one space character separates the
printed type and the printed identity.
<!--l. 4314--><p class="indent" >   The value returned by <a 
href="#x139-260044r685">print-unreadable-object</a> is <a 
href="clmse31.html#x42-74002r18">nil</a>. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod print-object ((obj airplane) stream)
</td></tr></table>
<!--l. 4316--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (print-unreadable-object (obj stream :type t :identity t)</td></tr></table>
<!--l. 4317--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (princ (tail-number obj) stream)))</td></tr></table>
<!--l. 4318--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(print my-airplane)  prints</td></tr></table>
<!--l. 4319--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#&#x003C;Airplane NW0773 777500123135&#x003E;     ;In implementation A</td></tr></table>
<!--l. 4320--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     or perhaps</td></tr></table>
<!--l. 4321--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#&#x003C;FAA:AIRPLANE NW0773 17&#x003E;           ;In implementation B</td></tr></table>
<!--l. 4323--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
<!--l. 4324--><p class="noindent" >The big advantage of <a 
href="#x139-260044r685">print-unreadable-object</a> is that it allows a user to write
<a 
href="clmse146.html#x179-420038r925">print-object</a> methods that adhere to implementation-speciﬁc style without
requiring the user to write implementation-dependent code.
<!--l. 4329--><p class="indent" >   The X3J13 vote left it unclear whether <a 
href="#x139-260044r685">print-unreadable-object</a> permits
declarations to appear before the body of the macro call. I believe that was the
intent, and this is reﬂected in the syntax shown above; but this is only my
interpretation.
</div>
</div>
<!--l. 4336--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">22.3.2   </span> <a 
 id="x139-26200022.3.2"></a>Output to Binary Streams</h4>
<!--l. 4338--><p class="noindent" >Common Lisp currently speciﬁes only a very simple facility for binary output: the
writing of a single byte as an integer.
<div class=defun>
<!--l. 4341--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-262001"></a><a 
 id="x139-262002r686"></a><b> write-byte</b>  <i>integer</i> <i>binary-output-stream</i>
<!--l. 4343--><p class="noindent" ><a 
href="#x139-262002r686">write-byte</a> writes one byte, the value of <i>integer</i>. It is an error if <i>integer</i> is not of
the type speciﬁed as the :element-type argument to <a 
href="clmse115.html#x143-278002r725">open</a> when the stream was
created. The value <i>integer</i> is returned.
</div>
<!--l. 4352--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">22.3.3   </span> <a 
 id="x139-26300022.3.3"></a>Formatted Output to Character Streams</h4>
<a 
 id="dx139-263001"></a>
<!--l. 4356--><p class="noindent" >The function <a 
href="#x139-263003r687">format</a> is very useful for producing nicely formatted text, producing
good-looking messages, and so on. <a 
href="#x139-263003r687">format</a> can generate a string or output to a
stream.
<!--l. 4360--><p class="indent" >   Formatted output is performed not only by the <a 
href="#x139-263003r687">format</a> function itself but by
certain other functions that accept a control string “the way <a 
href="#x139-263003r687">format</a> does.” For
example, error-signaling functions such as <a 
href="clmse150.html#x184-447004r948">cerror</a> accept <a 
href="#x139-263003r687">format</a> control
strings.
<div class=defun>
<!--l. 4365--><p class="noindent" ><i>[Function]</i><a 
 id="dx139-263002"></a><a 
 id="x139-263003r687"></a><b> format</b>  <i>destination</i> <i>control-string</i> &#x0026;rest  <i>arguments</i>
<!--l. 4367--><p class="noindent" ><a 
href="#x139-263003r687">format</a> is used to produce formatted output. <a 
href="#x139-263003r687">format</a> outputs the characters of
<i>control-string</i>, except that a tilde (~) introduces a directive. The character after
                                                                          

                                                                          
the tilde, possibly preceded by preﬁx parameters and modiﬁers, speciﬁes what
kind of formatting is desired. Most directives use one or more elements
of <i>arguments</i> to create their output; the typical directive puts the next
element of <i>arguments</i> into the output, formatted in some special way. It is
an error if no argument remains for a directive requiring an argument,
but it is not an error if one or more arguments remain unprocessed by a
directive.
<!--l. 4380--><p class="indent" >   The output is sent to <i>destination</i>. If <i>destination</i> is <a 
href="clmse31.html#x42-74002r18">nil</a>, a string is created that
contains the output; this string is returned as the value of the call to
<a 
href="#x139-263003r687">format</a>.
<div class=new>
<!--l. 4385--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx139-263004"></a>to specify that when the ﬁrst argument to
<a 
href="#x139-263003r687">format</a> is <a 
href="clmse31.html#x42-74002r18">nil</a>, <a 
href="#x139-263003r687">format</a> creates a stream of type string-stream in much the same
manner as <a 
href="clmse108.html#x134-244002r614">with-output-to-string</a>. (This stream may be visible to the user if, for
example, the ~S directive is used to print a <a 
href="clmse99.html#x123-227002r580">defstruct</a> structure that has a
user-supplied print function.)
</div>
<!--l. 4395--><p class="indent" >   In all other cases <a 
href="#x139-263003r687">format</a> returns <a 
href="clmse31.html#x42-74002r18">nil</a>, performing output to <i>destination</i> as a side
eﬀect. If <i>destination</i> is a stream, the output is sent to it. If <i>destination</i>
is <a 
href="clmse31.html#x42-74004r19">t</a>, the output is sent to the stream that is the value of the variable
<a 
href="clmse107.html#x133-241004r598">*standard-output*</a>. If <i>destination</i> is a string with a ﬁll pointer, then in eﬀect
the output characters are added to the end of the string (as if by use of
<a 
href="clmse93.html#x115-219008r552">vector-push-extend</a>).
<!--l. 4405--><p class="indent" >   The <a 
href="#x139-263003r687">format</a> function includes some extremely complicated and specialized
features. It is not necessary to understand all or even most of its features to
use <a 
href="#x139-263003r687">format</a> eﬀectively. The beginner should skip over anything in the
following documentation that is not immediately useful or clear. The
more sophisticated features (such as conditionals and iteration) are there
for the convenience of programs with especially complicated formatting
requirements.
<!--l. 4414--><p class="indent" >   A <a 
href="#x139-263003r687">format</a> directive consists of a tilde (~), optional preﬁx parameters separated
by commas, optional colon (:) and at-sign (@) modiﬁers, and a single character
indicating what kind of directive this is. The alphabetic case of the directive
character is ignored. The preﬁx parameters are generally integers, notated as
optionally signed decimal numbers.
<div class=newer>
<!--l. 4423--><p class="indent" >   X3J13 voted in June 1987 <a 
 id="dx139-263005"></a>to specify that if both colon and at-sign modiﬁers
are present, they may appear in either order; thus ~:@R and ~@:R mean the same
                                                                          

                                                                          
thing. However, it is traditional to put the colon ﬁrst, and all the examples in this
book put colons before at-signs.
</div>
<!--l. 4430--><p class="indent" >   Examples of control strings: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">&#x0022;~S&#x0022;           ;An ~S directive with no parameters or modiﬁers
</td></tr></table>
<!--l. 4432--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">&#x0022;~3,-4:@s&#x0022;     ;An ~S directive with two parameters, 3 and <span class="math"> − 4</span>,</td></tr></table>
<!--l. 4433--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               ; and both the colon and at-sign ﬂags</td></tr></table>
<!--l. 4434--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">&#x0022;~,+4S&#x0022;        ;First preﬁx parameter is omitted and takes</td></tr></table>
<!--l. 4435--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               ; on its default value; the second parameter is 4</td></tr></table>
<!--l. 4437--><p class="indent" >
</div>
</div>
<!--l. 4438--><p class="noindent" >Sometimes a preﬁx parameter is used to specify a character, for instance the
padding character in a right- or left-justifying operation. In this case a
single quote (&#x2019;) followed by the desired character may be used as a preﬁx
parameter, to mean the character object that is the character following
the single quote. For example, you can use ~5,&#x2019;0d to print an integer in
decimal radix in ﬁve columns with leading zeros, or ~5,&#x2019;*d to get leading
asterisks.
<!--l. 4447--><p class="indent" >   In place of a preﬁx parameter to a directive, you can put the letter V (or v),
which takes an argument from <i>arguments</i> for use as a parameter to the directive.
Normally this should be an integer or character object, as appropriate. This
feature allows variable-width ﬁelds and the like. If the argument used by a V
parameter is <a 
href="clmse31.html#x42-74002r18">nil</a>, the eﬀect is as if the parameter had been omitted. You may also
use the character # in place of a parameter; it represents the number of
arguments remaining to be processed.
<!--l. 4456--><p class="indent" >   It is an error to give a format directive more parameters than it is described
here as accepting. It is also an error to give colon or at-sign modiﬁers
to a directive in a combination not speciﬁcally described here as being
meaningful.
</div>
                                                                          

                                                                          
<div class=new>
<!--l. 4465--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx139-263006"></a>to clarify the interaction between <a 
href="#x139-263003r687">format</a> and the
various printer control variables (those named *print-<i>xxx</i>*). This is important
because many <a 
href="#x139-263003r687">format</a> operations are deﬁned, directly or indirectly, in terms of
prin1 or <a 
href="#x139-260014r672">princ</a>, which are aﬀected by the printer control variables. The general rule
is that <a 
href="#x139-263003r687">format</a> does not bind any of the standard printer control variables except
as speciﬁed in the individual descriptions of directives. An implementation
may not bind any standard printer control variable not speciﬁed in the
description of a <a 
href="#x139-263003r687">format</a> directive, nor may an implementation fail to bind
any standard printer control variables that is speciﬁed to be bound by
such a description. (See these descriptions for speciﬁc changes voted by
X3J13.)
<!--l. 4480--><p class="indent" >   One consequence of this change is that the user is guaranteed to be able to use
the <a 
href="#x139-263003r687">format</a> ~A and ~S directives to do pretty printing, under control of the
*print-pretty* variable. Implementations have diﬀered on this point in their
interpretations of the ﬁrst edition. The new ~W directive may be more
appropriate than either ~A and ~S for some purposes, whether for pretty printing
or ordinary printing. See section <a 
href="clmse142.html#x174-35700027.4">27.4<!--tex4ht:ref: PPRINT-FORMAT-DIRECTIVES-SECTION --></a> for a discussion of ~W and other new
<a 
href="#x139-263003r687">format</a> directives related to pretty printing.
</div>
<!--l. 4492--><p class="indent" >   Here are some relatively simple examples to give you the general ﬂavor of how
<a 
href="#x139-263003r687">format</a> is used. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;foo&#x0022;) <span class="math"> ⇒</span> &#x0022;foo&#x0022;
</td></tr></table>
<!--l. 4495--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4496--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq x 5)</td></tr></table>
<!--l. 4497--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4498--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;The answer is ~D.&#x0022; x) <span class="math"> ⇒</span> &#x0022;The answer is 5.&#x0022;</td></tr></table>
<!--l. 4499--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4500--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;The answer is ~3D.&#x0022; x) <span class="math"> ⇒</span> &#x0022;The answer is   5.&#x0022;</td></tr></table>
<!--l. 4501--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4502--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;The answer is ~3,&#x2019;0D.&#x0022; x) <span class="math"> ⇒</span> &#x0022;The answer is 005.&#x0022;</td></tr></table>
<!--l. 4503--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4504--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;The answer is ~:D.&#x0022; (expt 47 x))</td></tr></table>
<!--l. 4505--><p class="indent" >    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                <span class="math"> ⇒</span> &#x0022;The answer is 229,345,007.&#x0022;</td></tr></table>
<!--l. 4507--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq y &#x0022;elephant&#x0022;)
</td></tr></table>
<!--l. 4510--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4511--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;Look at the ~A!&#x0022; y) <span class="math"> ⇒</span> &#x0022;Look at the elephant!&#x0022;</td></tr></table>
<!--l. 4512--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4513--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;Type ~:C to ~A.&#x0022;</td></tr></table>
<!--l. 4514--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (set-char-bit #\D :control t)</td></tr></table>
<!--l. 4515--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x0022;delete all your ﬁles&#x0022;)</td></tr></table>
<!--l. 4516--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> &#x0022;Type Control-D to delete all your ﬁles.&#x0022;</td></tr></table>
<!--l. 4518--><p class="indent" >
</div>
</div>
<!--l. 4520--><p class="indent" >
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq n 3)
</td></tr></table>
<!--l. 4524--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~D item~:P found.&#x0022; n) <span class="math"> ⇒</span> &#x0022;3 items found.&#x0022;
</td></tr></table>
<!--l. 4527--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~R dog~:[s are~; is~] here.&#x0022; n (= n 1))
</td></tr></table>
<!--l. 4529--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <span class="math"> ⇒</span> &#x0022;three dogs are here.&#x0022;</td></tr></table>
<!--l. 4531--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~R dog~:*~[s are~; is~:;s are~] here.&#x0022; n)
</td></tr></table>
<!--l. 4533--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <span class="math"> ⇒</span> &#x0022;three dogs are here.&#x0022;</td></tr></table>
<!--l. 4535--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;Here ~[are~;is~:;are~] ~:*~R pupp~:@P.&#x0022; n)
</td></tr></table>
<!--l. 4537--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <span class="math"> ⇒</span> &#x0022;Here are three puppies.&#x0022;</td></tr></table>
<!--l. 4539--><p class="indent" >
</div>
</div>
<!--l. 4541--><p class="indent" >   In the descriptions of the directives that follow, the term <i>arg</i> in general refers
to the next item of the set of <i>arguments</i> to be processed. The word or phrase at
the beginning of each description is a mnemonic (not necessarily an accurate one)
for the directive. <div class=flushdesc>
      <ul><li><b>
 ~A </b></li><i>Ascii</i>. An <i>arg</i>, any Lisp object, is printed without escape characters (as
      by <a 
href="#x139-260014r672">princ</a>). In particular, if <i>arg</i> is a string, its characters will be output
      verbatim. If <i>arg</i> is <a 
href="clmse31.html#x42-74002r18">nil</a>, it will be printed as <a 
href="clmse31.html#x42-74002r18">nil</a>; the colon modiﬁer (~:A)
      will cause an <i>arg</i> of <a 
href="clmse31.html#x42-74002r18">nil</a> to be printed as (), but if <i>arg</i> is a composite
      structure, such as a list or vector, any contained occurrences of <a 
href="clmse31.html#x42-74002r18">nil</a> will
      still be printed as <a 
href="clmse31.html#x42-74002r18">nil</a>.
      <!--l. 4557--><p class="noindent" >~<i>mincol</i>A inserts spaces on the right, if necessary, to make the width at
      least <i>mincol</i> columns. The @ modiﬁer causes the spaces to be inserted
      on the left rather than the right.
      <!--l. 4561--><p class="noindent" >~<i>mincol</i>,<i>colinc</i>,<i>minpad</i>,<i>padchar</i>A is the full form of ~A, which allows
      elaborate control of the padding. The string is padded on the right (or
      on the left if the @ modiﬁer is used) with at least <i>minpad</i> copies of
      <i>padchar</i>; padding characters are then inserted <i>colinc</i> characters at a
      time until the total width is at least <i>mincol</i>. The defaults are 0 for
      <i>mincol</i> and <i>minpad</i>, 1 for <i>colinc</i>, and the space character for <i>padchar</i>.
<div class=new>
      <!--l. 4571--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263007"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74002r18">nil</a> during the processing of the ~A directive.
      </div>
                                                                          

                                                                          
      <li><b>
  ~S </b></li><i>S-expression</i>. This is just like ~A, but <i>arg</i> is printed <i>with</i> escape characters
      (as by prin1 rather than <a 
href="#x139-260014r672">princ</a>). The output is therefore suitable for
      input to <a 
href="clmse111.html#x138-257003r653">read</a>. ~S accepts all the arguments and modiﬁers that ~A
      does.
<div class=new>
      <!--l. 4585--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263008"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74004r19">t</a> during the processing of the ~S directive.
      </div>
      <!--l. 4591--><p class="noindent" >
                                                                          

                                                                          
      <li><b>
 ~D </b></li><i>Decimal</i>. An <i>arg</i>, which should be an integer, is printed in decimal radix.
      ~D will never put a decimal point after the number.
      <!--l. 4598--><p class="noindent" >~<i>mincol</i>D uses a column width of <i>mincol</i>; spaces are inserted on the left if
      the number requires fewer than <i>mincol</i> columns for its digits and sign. If the
      number doesn&#x2019;t ﬁt in <i>mincol</i> columns, additional columns are used as
      needed.
      <!--l. 4603--><p class="noindent" >~<i>mincol</i>,<i>padchar</i>D uses <i>padchar</i> as the pad character instead of
      space.
      <!--l. 4606--><p class="noindent" >If <i>arg</i> is not an integer, it is printed in ~A format and decimal base.
<div class=new>
      <!--l. 4610--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263009"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74002r18">nil</a>, *print-radix* to <a 
href="clmse31.html#x42-74002r18">nil</a>, and *print-base* to 10 during processing of
      ~D.
      </div>
      <!--l. 4617--><p class="noindent" >The @ modiﬁer causes the number&#x2019;s sign to be printed always; the default is
      to print it only if the number is negative. The : modiﬁer causes commas to
      be printed between groups of three digits; the third preﬁx parameter may be
      used to change the character used as the comma. Thus the most general
      form of ~D is ~<i>mincol</i>,<i>padchar</i>,<i>commachar</i>D.
<div class=new>
      <!--l. 4625--><p class="noindent" >X3J13 voted in March 1988 <a 
 id="dx139-263010"></a>to add a fourth parameter, the <i>commainterval</i>.
      This must be an integer; if it is not provided, it defaults to 3. This
      parameter controls the number of digits in each group separated by the
      <i>commachar</i>.
      <!--l. 4632--><p class="noindent" >By extension, each of the ~B, ~O, and ~X directives accepts a <i>commainterval</i>
      as a fourth parameter, and the ~R directive accepts a <i>commainterval</i> as its
      ﬁfth parameter. Examples: <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil &#x0022;~„&#x2019; ,4B&#x0022; #xFACE) <span class="math"> ⇒</span> &#x0022;1111 1010 1100 1110&#x0022;
</td></tr></table>
      <!--l. 4637--><p class="noindent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil &#x0022;~„&#x2019; ,4B&#x0022; #x1CE) <span class="math"> ⇒</span> &#x0022;1 1100 1110&#x0022;</td></tr></table>
      <!--l. 4638--><p class="noindent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil &#x0022;~19„&#x2019; ,4B&#x0022; #xFACE) <span class="math"> ⇒</span> &#x0022;1111 1010 1100 1110&#x0022;</td></tr></table>
                                                                          

                                                                          
      <!--l. 4639--><p class="noindent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil &#x0022;~19„&#x2019; ,4B&#x0022; #x1CE) <span class="math"> ⇒</span> &#x0022;0000 0001 1100 1110&#x0022;</td></tr></table>
      <!--l. 4641--><p class="noindent" >
</div>
</div>
      <!--l. 4642--><p class="noindent" >This is one of those little improvements that probably don&#x2019;t matter much
      but aren&#x2019;t hard to implement either. It was pretty silly having the number 3
      wired into the deﬁnition of comma separation when it is just as easy to
      make it a parameter.
      </div>
      <li><b>
  ~B </b></li><i>Binary</i>. This is just like ~D but prints in binary radix (radix 2) instead of
      decimal. The full form is therefore ~<i>mincol</i>,<i>padchar</i>,<i>commachar</i>B.
<div class=new>
      <!--l. 4655--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263011"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74002r18">nil</a>, *print-radix* to <a 
href="clmse31.html#x42-74002r18">nil</a>, and *print-base* to 2 during processing of
      ~B.
      </div>
      <li><b>
 ~O </b></li><i>Octal</i>. This is just like ~D but prints in octal radix (radix 8) instead of
      decimal. The full form is therefore ~<i>mincol</i>,<i>padchar</i>,<i>commachar</i>O.
<div class=new>
      <!--l. 4669--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263012"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74002r18">nil</a>, *print-radix* to <a 
href="clmse31.html#x42-74002r18">nil</a>, and *print-base* to 8 during processing of
      ~O.
      </div>
      <li><b>
 ~X </b></li><i>Hexadecimal</i>. This is just like ~D but prints in hexadecimal radix (radix 16)
      instead of decimal. The full form is therefore ~<i>mincol</i>,<i>padchar</i>,<i>commachar</i>X.
<div class=new>
      <!--l. 4683--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263013"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74002r18">nil</a>, *print-radix* to <a 
href="clmse31.html#x42-74002r18">nil</a>, and *print-base* to 16 during processing of
      ~X.
      </div>
                                                                          

                                                                          
<div class=incompatibility>
      <!--l. 4691--><p class="noindent" ><b>Compatibility note:</b> In MacLisp and Lisp Machine Lisp the ~X directive
      outputs a space, and ~<i>n</i>X outputs <i>n</i> spaces, in a manner analogous to
      Fortran X format. In Common Lisp the directive ~@T is used for that
      purpose.
</div>
      <li><b>
 ~R </b></li><i>Radix</i>. ~<i>n</i>R prints <i>arg</i> in radix <i>n</i>. The modiﬁer ﬂags and any remaining
      parameters are used as for the ~D directive. Indeed, ~D is the same as
      ~10R. The full form here is therefore ~<i>radix</i>,<i>mincol</i>,<i>padchar</i>,<i>commachar</i>R.
<div class=new>
      <!--l. 4708--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263014"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape*
      to <a 
href="clmse31.html#x42-74002r18">nil</a>, *print-radix* to <a 
href="clmse31.html#x42-74002r18">nil</a>, and *print-base* to the value of the
      ﬁrst parameter during the processing of the ~R directive with a
      parameter.
      </div>
      <!--l. 4716--><p class="noindent" >If no parameters are given to ~R, then an entirely diﬀerent interpretation is
      given. <div class=new><i>Notice of correction.</i> In the ﬁrst edition, this sentence referred to
      “arguments” given to ~R. The correct term is “parameters.”
      </div> The argument should be an integer; suppose it is 4. Then ~R prints <i>arg</i> as
      a cardinal English number: four; ~:R prints <i>arg</i> as an ordinal English
      number: <a 
href="clmse82.html#x102-203014r445">fourth</a>; ~@R prints <i>arg</i> as a Roman numeral: IV; and ~:@R prints
      <i>arg</i> as an old Roman numeral: IIII.
<div class=new>
      <!--l. 4731--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263015"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-base* to 10
      during the processing of the ~R directive with no parameter.
      </div>
<div class=new>
      <!--l. 4738--><p class="noindent" >The ﬁrst edition did not specify how ~R and its variants should handle
      arguments that are very large or not positive. Actual practice varies, and
      X3J13 has not yet addressed the topic. Here is a sampling of current
      practice.
      <!--l. 4743--><p class="noindent" >For ~@R and ~:@R, nearly all implementations produce Roman numerals
      only for integers in the range 1 to 3999, inclusive. Some implementations
      will produce old-style Roman numerals for integers in the range 1 to 4999,
                                                                          

                                                                          
      inclusive. All other integers are printed in decimal notation, as if ~D had
      been used.
      <!--l. 4749--><p class="noindent" >For zero, most implementations print zero for ~R and zeroth for
      ~:R.
      <!--l. 4752--><p class="noindent" >For ~R with a negative argument, most implementations simply
      print the word minus followed by its absolute value as a cardinal in
      English.
      <!--l. 4755--><p class="noindent" >For ~:R with a negative argument, some implementations also print the
      word minus followed by its absolute value as an ordinal in English; other
      implementations print the absolute value followed by the word <a 
href="clmse153.html#x188-480008r1036">previous</a>.
      Thus the argument -4 might produce minus fourth or fourth previous. Each
      has its charm, but one is not always a suitable substitute for the other; users
      should be careful.
      <!--l. 4762--><p class="noindent" >There is standard English nomenclature for fairly large integers (up
      to <span class="math">10<sup>6</sup>0</span>, at least), based on appending the suﬃx -illion to Latin
      names of integers. Thus we have the names <i>trillion</i>, <i>quadrillion</i>,
      <i>sextillion</i>, <i>septillion</i>, and so on. For extremely large integers, one
      may express powers of ten in English. One implementation gives
      1606938044258990275541962092341162602522202993782792835301376
      (which is <span class="math">2<sup>200</sup></span>, the result of (ash 1 200)) in this manner:
      <div class="flushleft" 
>
<!--l. 4771--><p class="noindent" >
 one times ten to the sixtieth power six hundred six times ten to the ﬁfty-seventh
power nine hundred thirty-eight septdecillion forty-four sexdecillion two hundred
ﬁfty-eight quindecillion nine hundred ninety quattuordecillion two hundred
seventy-ﬁve tredecillion ﬁve hundred forty-one duodecillion nine hundred
sixty-two undecillion ninety-two decillion three hundred forty-one nonillion one
hundred sixty-two octillion six hundred two septillion ﬁve hundred twenty-two
sextillion two hundred two quintillion nine hundred ninety-three quadrillion seven
hundred eighty-two trillion seven hundred ninety-two billion eight hundred
thirty-ﬁve million three hundred one thousand three hundred seventy-six</div>
      <!--l. 4784--><p class="noindent" >Another implementation prints it this way (note the use of plus):
      <div class="flushleft" 
>
                                                                          

                                                                          
<!--l. 4785--><p class="noindent" >
 one times ten to the sixtieth power plus six hundred six times ten to the
ﬁfty-seventh power plus ... plus two hundred seventy-ﬁve times ten to the
forty-second power plus ﬁve hundred forty-one duodecillion nine hundred
sixty-two undecillion ... three hundred seventy-six</div>
      <!--l. 4792--><p class="noindent" >(I have elided some of the text here to save space.)
      <!--l. 4794--><p class="noindent" >Unfortunately, the meaning of this nomenclature diﬀers between American
      English (in which k-illion means <span class="math">10<sup>3(k+1)</sup></span>, so one trillion is <span class="math">10<sup>12</sup></span>) and British
      English (in which k-illion means <span class="math">10<sup>6k</sup></span>, so one trillion is <span class="math">10<sup>18</sup></span>). To avoid both
      confusion and prolixity, I recommend using decimal notation for all numbers
      above 999,999,999; this is similar to the escape hatch used for Roman
      numerals.
      </div>
      <li><b>
  ~P </b></li><i>Plural</i>. If <i>arg</i> is not <a 
href="clmse33.html#x44-78004r45">eql</a> to the integer 1, a lowercase s is printed; if <i>arg</i> is <a 
href="clmse33.html#x44-78004r45">eql</a>
      to 1, nothing is printed. (Notice that if <i>arg</i> is a ﬂoating-point 1.0, the s <i>is</i>
      printed.) ~:P does the same thing, after doing a ~:* to back up one
      argument; that is, it prints a lowercase s if the <i>last</i> argument was not 1. This
      is useful after printing a number using ~D. ~@P prints y if the argument is
      1, or ies if it is not. ~:@P does the same thing, but backs up ﬁrst.
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~D tr~:@P/~D win~:P&#x0022; 7 1) <span class="math"> ⇒</span> &#x0022;7 tries/1 win&#x0022;
</td></tr></table>
      <!--l. 4814--><p class="noindent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~D tr~:@P/~D win~:P&#x0022; 1 0) <span class="math"> ⇒</span> &#x0022;1 try/0 wins&#x0022;</td></tr></table>
      <!--l. 4815--><p class="noindent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~D tr~:@P/~D win~:P&#x0022; 1 3) <span class="math"> ⇒</span> &#x0022;1 try/3 wins&#x0022;</td></tr></table>
      <!--l. 4817--><p class="noindent" >
</div>
</div>
      <li><b>
 ~C </b></li><i>Character</i>. The next <i>arg</i> should be a character; it is printed according to the
      modiﬁer ﬂags.
                                                                          

                                                                          
<div class=obsolete>
      <!--l. 4824--><p class="noindent" >~C prints the character in an implementation-dependent abbreviated
      format. This format should be culturally compatible with the host
      environment.
      </div>
<div class=newer>
      <!--l. 4830--><p class="noindent" >X3J13 voted in June 1987 <a 
 id="dx139-263016"></a>to specify that ~C performs exactly the same
      action as <a 
href="#x139-260028r677">write-char</a> if the character to be printed has zero for its bits
      attributes. X3J13 voted in March 1989 <a 
 id="dx139-263017"></a>to eliminate the bits and font
      attributes, replacing them with the notion of implementation-deﬁned
      attributes. The net eﬀect is that characters whose implementation-deﬁned
      attributes all have the “standard” values should be printed by ~C in the
      same way that <a 
href="#x139-260028r677">write-char</a> would print them.
      </div>
      <!--l. 4841--><p class="noindent" >~:C spells out the names of the control bits and represents non-printing
      characters by their names: Control-Meta-F, Control-Return, Space. This is a
      “pretty” format for printing characters.
      <!--l. 4846--><p class="noindent" >~:@C prints what ~:C would, and then if the character requires unusual
      shift keys on the keyboard to type it, this fact is mentioned: Control-<span class="math">∂</span>
      (Top-F). This is the format for telling the user about a key he or she is
      expected to type, in prompts, for instance. The precise output may depend
      not only on the implementation but on the particular I/O devices in
      use.
      <!--l. 4853--><p class="noindent" >~@C prints the character so that the Lisp reader can read it, using #\
      syntax.
<div class=new>
      <!--l. 4857--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263018"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74004r19">t</a> during the processing of the ~@C directive. Other variants of the ~C
      directive do not bind any printer control variables.
      </div>
<div class=rationale>
      <!--l. 4865--><p class="noindent" ><b>Rationale:</b> In some implementations the ~S directive would do what ~C does,
      but ~C is compatible with Lisp dialects such as MacLisp that do not have a
      character data type.
</div>
                                                                          

                                                                          
      <li><b>
  ~F </b></li><i>Fixed-format ﬂoating-point</i>. The next <i>arg</i> is printed as a ﬂoating-point
      number.
      <!--l. 4878--><p class="noindent" >The full form is ~<i>w</i>,<i>d</i>,<i>k</i>,<i>overﬂowchar</i>,<i>padchar</i>F. The parameter <i>w</i> is
      the width of the ﬁeld to be printed; <i>d</i> is the number of digits to
      print after the decimal point; <i>k</i> is a scale factor that defaults to
      zero.
      <!--l. 4884--><p class="noindent" >Exactly <i>w</i> characters will be output. First, leading copies of the character
      <i>padchar</i> (which defaults to a space) are printed, if necessary, to pad the ﬁeld
      on the left. If the <i>arg</i> is negative, then a minus sign is printed; if the <i>arg</i> is
      not negative, then a plus sign is printed if and only if the @ modiﬁer was
      speciﬁed. Then a sequence of digits, containing a single embedded decimal
      point, is printed; this represents the magnitude of the value of <i>arg</i> times <span class="math">10<sup>k</sup></span>,
      rounded to <i>d</i> fractional digits. (When rounding up and rounding down
      would produce printed values equidistant from the scaled value of <i>arg</i>, then
      the implementation is free to use either one. For example, printing the
      argument 6.375 using the format ~4,2F may correctly produce either
      6.37 or 6.38.) Leading zeros are not permitted, except that a single
      zero digit is output before the decimal point if the printed value
      is less than 1, and this single zero digit is not output after all if
      <span class="math"><i>w</i> = <i>d</i> + 1</span>.
      <!--l. 4904--><p class="noindent" >If it is impossible to print the value in the required format in a ﬁeld of width
      <i>w</i>, then one of two actions is taken. If the parameter <i>overﬂowchar</i> is
      speciﬁed, then <i>w</i> copies of that parameter are printed instead of the scaled
      value of <i>arg</i>. If the <i>overﬂowchar</i> parameter is omitted, then the scaled value
      is printed using more than <i>w</i> characters, as many more as may be
      needed.
      <!--l. 4912--><p class="noindent" >If the <i>w</i> parameter is omitted, then the ﬁeld is of variable width. In eﬀect, a
      value is chosen for <i>w</i> in such a way that no leading pad characters need to
      be printed and exactly <i>d</i> characters will follow the decimal point.
      For example, the directive ~,2F will print exactly two digits after
      the decimal point and as many as necessary before the decimal
      point.
      <!--l. 4920--><p class="noindent" >If the parameter <i>d</i> is omitted, then there is no constraint on the number
      of digits to appear after the decimal point. A value is chosen for
      <i>d</i> in such a way that as many digits as possible may be printed
                                                                          

                                                                          
      subject to the width constraint imposed by the parameter <i>w</i> and the
      constraint that no trailing zero digits may appear in the fraction, except
      that if the fraction to be printed is zero, then a single zero digit
      should appear after the decimal point if permitted by the width
      constraint.
      <!--l. 4929--><p class="noindent" >If both <i>w</i> and <i>d</i> are omitted, then the eﬀect is to print the value using
      ordinary free-format output; prin1 uses this format for any number
      whose magnitude is either zero or between <span class="math">10<sup>−3</sup></span> (inclusive) and <span class="math">10<sup>7</sup></span>
      (exclusive).
      <!--l. 4934--><p class="noindent" >If <i>w</i> is omitted, then if the magnitude of <i>arg</i> is so large (or, if <i>d</i> is also
      omitted, so small) that more than 100 digits would have to be printed, then
      an implementation is free, at its discretion, to print the number using
      exponential notation instead, as if by the directive ~E (with all
      parameters to ~E defaulted, not taking their values from the ~F
      directive).
      <!--l. 4941--><p class="noindent" >If <i>arg</i> is a rational number, then it is coerced to be a single-ﬂoat and then
      printed. (Alternatively, an implementation is permitted to process a rational
      number by any other method that has essentially the same behavior but
      avoids such hazards as loss of precision or overﬂow because of the coercion.
      However, note that if <i>w</i> and <i>d</i> are unspeciﬁed and the number has no exact
      decimal representation, for example 1/3, some precision cutoﬀ must be
      chosen by the implementation: only a ﬁnite number of digits may be
      printed.)
      <!--l. 4950--><p class="noindent" >If <i>arg</i> is a complex number or some non-numeric object, then it
      is printed using the format directive ~<i>w</i>D, thereby printing it in
      decimal radix and a minimum ﬁeld width of <i>w</i>. (If it is desired to
      print each of the real part and imaginary part of a complex number
      using a ~F directive, then this must be done explicitly with two
      ~F directives and code to extract the two parts of the complex
      number.)
<div class=new>
      <!--l. 4959--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263019"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74002r18">nil</a> during the processing of the ~F directive.
      </div>
<div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun foo (x)
</td></tr></table>
      <!--l. 4966--><p class="noindent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (format nil &#x0022;~6,2F|~6,2,1,&#x2019;*F|~6,2„&#x2019;?F|~6F|~,2F|~F&#x0022;</td></tr></table>
      <!--l. 4967--><p class="noindent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">          x x x x x x))</td></tr></table>
      <!--l. 4968--><p class="noindent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 3.14159)  <span class="math"> ⇒</span> &#x0022;  3.14| 31.42|  3.14|3.1416|3.14|3.14159&#x0022;</td></tr></table>
      <!--l. 4969--><p class="noindent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo -3.14159) <span class="math"> ⇒</span> &#x0022; -3.14|-31.42| -3.14|-3.142|-3.14|-3.14159&#x0022;</td></tr></table>
      <!--l. 4970--><p class="noindent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 100.0)    <span class="math"> ⇒</span> &#x0022;100.00|******|100.00| 100.0|100.00|100.0&#x0022;</td></tr></table>
      <!--l. 4971--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 1234.0)   <span class="math"> ⇒</span> &#x0022;1234.00|******|??????|1234.0|1234.00|1234.0&#x0022;</td></tr></table>
      <!--l. 4972--><p class="noindent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 0.006)    <span class="math"> ⇒</span> &#x0022;  0.01|  0.06|  0.01| 0.006|0.01|0.006&#x0022;</td></tr></table>
      <!--l. 4974--><p class="noindent" >
</div>
</div>
<div class=incompatibility>
      <!--l. 4977--><p class="noindent" ><b>Compatibility note:</b> The ~F directive is similar to the F<i>w</i>.<i>d</i> edit descriptor in
      Fortran.
      <!--l. 4981--><p class="noindent" >The presence or absence of the @ modiﬁer corresponds to the eﬀect of the Fortran
      SS or SP edit descriptor; nothing in Common Lisp corresponds to the Fortran S
      edit descriptor.
      <!--l. 4986--><p class="noindent" >The scale factor speciﬁed by the parameter <i>k</i> corresponds to the scale factor <i>k</i>
      speciﬁed by the Fortran <i>k</i>P edit descriptor.
      <!--l. 4990--><p class="noindent" >In Fortran, the leading zero that precedes the decimal point when the printed
      value is less than 1 is optional; in Common Lisp, the implementation is required to
      print that zero digit.
      <!--l. 4994--><p class="noindent" >In Common Lisp, the <i>w</i> and <i>d</i> parameters are optional; in Fortran, they are
      required.
      <!--l. 4997--><p class="noindent" >In Common Lisp, the pad character and overﬂow character are user-speciﬁable; in
      Fortran, they are always space and asterisk, respectively.
      <!--l. 5000--><p class="noindent" >A Fortran implementation is prohibited from printing a representation of negative
      zero; Common Lisp permits the printing of such a representation when
      appropriate.
                                                                          

                                                                          
      <!--l. 5004--><p class="noindent" >In MacLisp and Lisp Machine Lisp, the ~F format directive takes a single
      parameter: the number of digits to use in the printed representation. This
      incompatibility between Common Lisp and MacLisp was introduced for the sake
      of cultural compatibility with Fortran.
</div>
      <li><b>
  ~E </b></li><i>Exponential ﬂoating-point</i>. The next <i>arg</i> is printed in exponential
      notation.
      <!--l. 5016--><p class="noindent" >The full form is ~<i>w</i>,<i>d</i>,<i>e</i>,<i>k</i>,<i>overﬂowchar</i>,<i>padchar</i>,<i>exponentchar</i>E. The
      parameter <i>w</i> is the width of the ﬁeld to be printed; <i>d</i> is the number of digits
      to print after the decimal point; <i>e</i> is the number of digits to use when
      printing the exponent; <i>k</i> is a scale factor that defaults to 1 (not
      zero).
      <!--l. 5023--><p class="noindent" >Exactly <i>w</i> characters will be output. First, leading copies of the character
      <i>padchar</i> (which defaults to a space) are printed, if necessary, to pad the ﬁeld
      on the left. If the <i>arg</i> is negative, then a minus sign is printed; if the <i>arg</i> is
      not negative, then a plus sign is printed if and only if the @ modiﬁer was
      speciﬁed. Then a sequence of digits, containing a single embedded decimal
      point, is printed. The form of this sequence of digits depends on the scale
      factor <i>k</i>. If <i>k</i> is zero, then <i>d</i> digits are printed after the decimal point,
      and a single zero digit appears before the decimal point if the total
      ﬁeld width will permit it. If <i>k</i> is positive, then it must be strictly
      less than <span class="math"><i>d</i> + 2</span>; <i>k</i> signiﬁcant digits are printed before the decimal
      point, and <span class="math"><i>d</i> −<i>k</i> + 1</span> digits are printed after the decimal point. If <i>k</i> is
      negative, then it must be strictly greater than <span class="math"> −<i>d</i></span>; a single zero
      digit appears before the decimal point if the total ﬁeld width will
      permit it, and after the decimal point are printed ﬁrst <span class="math"> −<i>k</i></span> zeros and
      then <span class="math"><i>d</i> + <i>k</i></span> signiﬁcant digits. The printed fraction must be properly
      rounded. (When rounding up and rounding down would produce
      printed values equidistant from the scaled value of <i>arg</i>, then the
      implementation is free to use either one. For example, printing 637.5
      using the format ~8,2E may correctly produce either 6.37E+02 or
      6.38E+02.)
      <!--l. 5050--><p class="noindent" >Following the digit sequence, the exponent is printed. First the character
      parameter <i>exponentchar</i> is printed; if this parameter is omitted, then the
      exponent marker that prin1 would use is printed, as determined
                                                                          

                                                                          
      from the type of the ﬂoating-point number and the current value of
      *read-default-ﬂoat-format*. Next, either a plus sign or a minus sign is
      printed, followed by <i>e</i> digits representing the power of 10 by which the
      printed fraction must be multiplied to properly represent the rounded value
      of <i>arg</i>.
      <!--l. 5061--><p class="noindent" >If it is impossible to print the value in the required format in a ﬁeld of width
      <i>w</i>, possibly because <i>k</i> is too large or too small or because the exponent
      cannot be printed in <i>e</i> character positions, then one of two actions is
      taken. If the parameter <i>overﬂowchar</i> is speciﬁed, then <i>w</i> copies of
      that parameter are printed instead of the scaled value of <i>arg</i>. If
      the <i>overﬂowchar</i> parameter is omitted, then the scaled value is
      printed using more than <i>w</i> characters, as many more as may be
      needed; if the problem is that <i>d</i> is too small for the speciﬁed <i>k</i> or
      that <i>e</i> is too small, then a larger value is used for <i>d</i> or <i>e</i> as may be
      needed.
      <!--l. 5073--><p class="noindent" >If the <i>w</i> parameter is omitted, then the ﬁeld is of variable width. In eﬀect a
      value is chosen for <i>w</i> in such a way that no leading pad characters need to
      be printed.
      <!--l. 5077--><p class="noindent" >If the parameter <i>d</i> is omitted, then there is no constraint on the number of
      digits to appear. A value is chosen for <i>d</i> in such a way that as many digits
      as possible may be printed subject to the width constraint imposed
      by the parameter <i>w</i>, the constraint of the scale factor <i>k</i>, and the
      constraint that no trailing zero digits may appear in the fraction, except
      that if the fraction to be printed is zero, then a single zero digit
      should appear after the decimal point if the width constraint allows
      it.
      <!--l. 5087--><p class="noindent" >If the parameter <i>e</i> is omitted, then the exponent is printed using the
      smallest number of digits necessary to represent its value.
      <!--l. 5090--><p class="noindent" >If all of <i>w</i>, <i>d</i>, and <i>e</i> are omitted, then the eﬀect is to print the value using
      ordinary free-format exponential-notation output; prin1 uses this format for
      any non-zero number whose magnitude is less than <span class="math">10<sup>−3</sup></span> or greater than or
      equal to <span class="math">10<sup>7</sup></span>.
<div class=new>
      <!--l. 5096--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263020"></a>to amend the previous paragraph as
      follows:
                                                                          

                                                                          
      <!--l. 5100--><p class="noindent" >If all of <i>w</i>, <i>d</i>, and <i>e</i> are omitted, then the eﬀect is to print the value using
      ordinary free-format exponential-notation output; prin1 uses a similar
      format for any non-zero number whose magnitude is less than <span class="math">10<sup>−3</sup></span> or
      greater than or equal to <span class="math">10<sup>7</sup></span>. The only diﬀerence is that the ~E directive
      always prints a plus or minus sign before the exponent, while prin1 omits
      the plus sign if the exponent is non-negative.
      <!--l. 5108--><p class="noindent" >(The amendment reconciles this paragraph with the speciﬁcation several
      paragraphs above that ~E always prints a plus or minus sign before the
      exponent.)
      </div>
      <!--l. 5113--><p class="noindent" >If <i>arg</i> is a rational number, then it is coerced to be a single-ﬂoat and then
      printed. (Alternatively, an implementation is permitted to process a rational
      number by any other method that has essentially the same behavior but
      avoids such hazards as loss of precision or overﬂow because of the coercion.
      However, note that if <i>w</i> and <i>d</i> are unspeciﬁed and the number has no exact
      decimal representation, for example 1/3, some precision cutoﬀ must be
      chosen by the implementation: only a ﬁnite number of digits may be
      printed.)
      <!--l. 5122--><p class="noindent" >If <i>arg</i> is a complex number or some non-numeric object, then it
      is printed using the format directive ~<i>w</i>D, thereby printing it in
      decimal radix and a minimum ﬁeld width of <i>w</i>. (If it is desired to
      print each of the real part and imaginary part of a complex number
      using a ~E directive, then this must be done explicitly with two
      ~E directives and code to extract the two parts of the complex
      number.)
<div class=new>
      <!--l. 5131--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263021"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74002r18">nil</a> during the processing of the ~E directive.
      </div>
<div class=lisp>
<div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun foo (x)
</td></tr></table>
      <!--l. 5138--><p class="noindent" >                                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (format <a 
href="clmse31.html#x42-74002r18">nil</a></td></tr></table>
                                                                          

                                                                          
      <!--l. 5139--><p class="noindent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">          &#x0022;~9,2,1„&#x2019;*E|~10,3,2,2,&#x2019;?„&#x2019;$E|~9,3,2,-2,&#x2019;%@E|~9,2E&#x0022;</td></tr></table>
      <!--l. 5140--><p class="noindent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">          x x x x))</td></tr></table>
      <!--l. 5141--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 3.14159)  <span class="math"> ⇒</span> &#x0022;  3.14E+0| 31.42$-01|+.003E+03|  3.14E+0&#x0022;</td></tr></table>
      <!--l. 5142--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo -3.14159) <span class="math"> ⇒</span> &#x0022; -3.14E+0|-31.42$-01|-.003E+03| -3.14E+0&#x0022;</td></tr></table>
      <!--l. 5143--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 1100.0)   <span class="math"> ⇒</span> &#x0022;  1.10E+3| 11.00$+02|+.001E+06|  1.10E+3&#x0022;</td></tr></table>
      <!--l. 5144--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 1100.0L0) <span class="math"> ⇒</span> &#x0022;  1.10L+3| 11.00$+02|+.001L+06|  1.10L+3&#x0022;</td></tr></table>
      <!--l. 5145--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 1.1E13)   <span class="math"> ⇒</span> &#x0022;*********| 11.00$+12|+.001E+16| 1.10E+13&#x0022;</td></tr></table>
      <!--l. 5146--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 1.1L120)  <span class="math"> ⇒</span> &#x0022;*********|??????????|%%%%%%%%%|1.10L+120&#x0022;</td></tr></table>
      <!--l. 5147--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 1.1L1200) <span class="math"> ⇒</span> &#x0022;*********|??????????|%%%%%%%%%|1.10L+1200&#x0022;</td></tr></table>
      <!--l. 5149--><p class="noindent" >
</div>
</div>
      <!--l. 5150--><p class="noindent" >Here is an example of the eﬀects of varying the scale factor: <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(dotimes (k 13)
</td></tr></table>
      <!--l. 5152--><p class="noindent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (format t &#x0022; %Scale factor  2D: | 13,6,2,VE|&#x0022;</td></tr></table>
      <!--l. 5153--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:219;" 
class="tabbing"></td><td style="width:321;" 
class="tabbing">          (- k 5) 3.14159))</td><td style="width:44;" 
class="tabbing-right">                                   ;Prints 13 lines</td></tr></table>
      <!--l. 5154--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor -5: | 0.000003E+06|</td></tr></table>
      <!--l. 5155--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor -4: | 0.000031E+05|</td></tr></table>
      <!--l. 5156--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor -3: | 0.000314E+04|</td></tr></table>
      <!--l. 5157--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor -2: | 0.003142E+03|</td></tr></table>
      <!--l. 5158--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor -1: | 0.031416E+02|</td></tr></table>
      <!--l. 5159--><p class="noindent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor  0: | 0.314159E+01|</td></tr></table>
      <!--l. 5160--><p class="noindent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor  1: | 3.141590E+00|</td></tr></table>
      <!--l. 5161--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor  2: | 31.41590E-01|</td></tr></table>
      <!--l. 5162--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor  3: | 314.1590E-02|</td></tr></table>
      <!--l. 5163--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor  4: | 3141.590E-03|</td></tr></table>
                                                                          

                                                                          
      <!--l. 5164--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor  5: | 31415.90E-04|</td></tr></table>
      <!--l. 5165--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td style="width:44;" 
class="tabbing">Scale factor  6: | 314159.0E-05|</td></tr></table>
      <!--l. 5166--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td><td  
class="tabbing">Scale factor  7: | 3141590.E-06|</td></tr></table>
      <!--l. 5168--><p class="noindent" >
</div>
</div>
<div class=incompatibility>
      <!--l. 5171--><p class="noindent" ><b>Compatibility note:</b> The ~E directive is similar to the E<i>w</i>.<i>d</i> and E<i>w</i>.<i>d</i>E<i>e</i> edit
      descriptors in Fortran.
      <!--l. 5176--><p class="noindent" >The presence or absence of the @ modiﬁer corresponds to the eﬀect of the Fortran
      SS or SP edit descriptor; nothing in Common Lisp corresponds to the Fortran S
      edit descriptor.
      <!--l. 5181--><p class="noindent" >The scale factor speciﬁed by the parameter <i>k</i> corresponds to the scale factor <i>k</i>
      speciﬁed by the Fortran <i>k</i>P edit descriptor; note, however, that the default value
      for <i>k</i> is 1 in Common Lisp, as opposed to the default value of zero in Fortran. (On
      the other hand, note that a scale factor of 1 is used for Fortran list-directed
      output, which is roughly equivalent to using ~E with the <i>w</i>, <i>d</i>, <i>e</i>, and
      <i>overﬂowchar</i> parameters omitted.)
      <!--l. 5192--><p class="noindent" >In Common Lisp, the <i>w</i> and <i>d</i> parameters are optional; in Fortran, they are
      required.
      <!--l. 5195--><p class="noindent" >In Fortran, omitting <i>e</i> causes the exponent to be printed using either two or three
      digits; if three digits are required, then the exponent marker is omitted. In
      Common Lisp, omitting <i>e</i> causes the exponent to be printed using as few digits as
      possible; the exponent marker is never omitted.
      <!--l. 5201--><p class="noindent" >In Common Lisp, the pad character and overﬂow character are user-speciﬁable; in
      Fortran they are always space and asterisk, respectively.
      <!--l. 5204--><p class="noindent" >A Fortran implementation is prohibited from printing a representation of negative
      zero; Common Lisp permits the printing of such a representation when
      appropriate.
      <!--l. 5208--><p class="noindent" >In MacLisp and Lisp Machine Lisp, the ~E format directive takes a single
      parameter: the number of digits to use in the printed representation. This
      incompatibility between Common Lisp and MacLisp was introduced for the sake
      of cultural compatibility with Fortran.
</div>
      <!--l. 5216--><p class="noindent" >
                                                                          

                                                                          
      <li><b>
 ~G </b></li><i>General ﬂoating-point</i>. The next <i>arg</i> is printed as a ﬂoating-point number in
      either ﬁxed-format or exponential notation as appropriate.
      <!--l. 5222--><p class="noindent" >The full form is ~<i>w</i>,<i>d</i>,<i>e</i>,<i>k</i>,<i>overﬂowchar</i>,<i>padchar</i>,<i>exponentchar</i>G. The format
      in which to print <i>arg</i> depends on the magnitude (absolute value) of the <i>arg</i>.
      Let <i>n</i> be an integer such that <span class="math">10<sup>n−1</sup> ≤<i>arg</i> &#x003C; 10<sup>n</sup></span>. (If <i>arg</i> is zero, let <i>n</i> be 0.)
      Let <i>ee</i> equal <span class="math"><i>e</i> + 2</span>, or 4 if <i>e</i> is omitted. Let <i>ww</i> equal <span class="math"><i>w</i> −<i>ee</i></span>, or <a 
href="clmse31.html#x42-74002r18">nil</a> if <i>w</i> is
      omitted. If <i>d</i> is omitted, ﬁrst let <i>q</i> be the number of digits needed
      to print <i>arg</i> with no loss of information and without leading or
      trailing zeros; then let <i>d</i> equal (max <i>q</i> (min <i>n</i> 7)). Let <i>dd</i> equal
      <span class="math"><i>d</i> −<i>n</i></span>.
      <!--l. 5235--><p class="noindent" >If <span class="math">0 ≤<i>dd</i> ≤<i>d</i></span>, then <i>arg</i> is printed as if by the format directives
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">~<i>ww</i>,<i>dd</i>„<i>overﬂowchar</i>,<i>padchar</i>F~<i>ee</i>@T
</td></tr></table>
      <!--l. 5239--><p class="noindent" >
</div>
</div>
      <!--l. 5240--><p class="noindent" >Note that the scale factor <i>k</i> is not passed to the ~F directive. For
      all other values of <i>dd</i>, <i>arg</i> is printed as if by the format directive
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">~<i>w</i>,<i>d</i>,<i>e</i>,<i>k</i>,<i>overﬂowchar</i>,<i>padchar</i>,<i>exponentchar</i>E
</td></tr></table>
      <!--l. 5245--><p class="noindent" >
</div>
</div>
      <!--l. 5247--><p class="noindent" >In either case, an @ modiﬁer is speciﬁed to the ~F or ~E directive if and
      only if one was speciﬁed to the ~G directive.
<div class=new>
                                                                          

                                                                          
      <!--l. 5252--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263022"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74002r18">nil</a> during the processing of the ~G directive.
      </div> <div class=obsolete> Examples: <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun foo (x)
</td></tr></table>
      <!--l. 5260--><p class="noindent" >                                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (format <a 
href="clmse31.html#x42-74002r18">nil</a></td></tr></table>
      <!--l. 5261--><p class="noindent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">          &#x0022;~9,2,1„&#x2019;*G|~9,3,2,3,&#x2019;?„&#x2019;$G|~9,3,2,0,&#x2019;%G|~9,2G&#x0022;</td></tr></table>
      <!--l. 5262--><p class="noindent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">          x x x))</td></tr></table>
      <!--l. 5263--><p class="noindent" >
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 0.0314159) <span class="math"> ⇒</span> &#x0022;  3.14E-2|314.2$-04|0.314E-01|  3.14E-2&#x0022;
</td></tr></table>
      <!--l. 5264--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 0.314159)  <span class="math"> ⇒</span> &#x0022;  0.31   |0.314    |0.314    | 0.31    &#x0022;</td></tr></table>
      <!--l. 5265--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 3.14159)   <span class="math"> ⇒</span> &#x0022;   3.1   | 3.14    | 3.14    |  3.1    &#x0022;</td></tr></table>
      <!--l. 5266--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 31.4159)   <span class="math"> ⇒</span> &#x0022;   31.   | 31.4    | 31.4    |  31.    &#x0022;</td></tr></table>
      <!--l. 5267--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 314.159)   <span class="math"> ⇒</span> &#x0022;  3.14E+2| 314.    | 314.    |  3.14E+2&#x0022;</td></tr></table>
      <!--l. 5268--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 3141.59)   <span class="math"> ⇒</span> &#x0022;  3.14E+3|314.2$+01|0.314E+04|  3.14E+3&#x0022;</td></tr></table>
      <!--l. 5269--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 3141.59L0) <span class="math"> ⇒</span> &#x0022;  3.14L+3|314.2$+01|0.314L+04|  3.14L+3&#x0022;</td></tr></table>
      <!--l. 5270--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 3.14E12)   <span class="math"> ⇒</span> &#x0022;*********|314.0$+10|0.314E+13| 3.14E+12&#x0022;</td></tr></table>
      <!--l. 5271--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 3.14L120)  <span class="math"> ⇒</span> &#x0022;*********|?????????|%%%%%%%%%|3.14L+120&#x0022;</td></tr></table>
      <!--l. 5272--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(foo 3.14L1200) <span class="math"> ⇒</span> &#x0022;*********|?????????|%%%%%%%%%|3.14L+1200&#x0022;</td></tr></table>
      <!--l. 5274--><p class="noindent" >
</div>
</div>
</div>
      <!--l. 5276--><p class="noindent" >
                                                                          

                                                                          
<div class=new>
<i>
      <!--l. 5278--><p class="noindent" >Notice of correction.</i> In the ﬁrst edition, the example for the value 3.14E12
      contained two typographical errors: <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td style="width:288;" 
class="tabbing">(foo 3.14E12)   <span class="math"> ⇒</span> &#x0022;*********|314.</td><td style="width:182;" 
class="tabbing">2$+10|0.314E+13| 3.14</td><td  
class="tabbing">L+12&#x0022;
</td></tr></table>
      <!--l. 5282--><p class="noindent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td style="width:288;" 
class="tabbing">                                                 </td><td style="width:182;" 
class="tabbing"><span class="math">↑</span>            </td><td  
class="tabbing"><span class="math">↑</span> </td></tr></table>
      <!--l. 5283--><p class="noindent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td style="width:288;" 
class="tabbing">                     </td><td style="width:182;" 
class="tabbing">should be 0                </td><td  
class="tabbing">should be E</td></tr></table>
      <!--l. 5285--><p class="noindent" >
</div>
</div>
      <!--l. 5286--><p class="noindent" >These have been corrected above.
      </div>
<div class=incompatibility>
      <!--l. 5290--><p class="noindent" ><b>Compatibility note:</b> The ~G directive is similar to the G<i>w</i>.<i>d</i> edit descriptor in
      Fortran.
      <!--l. 5294--><p class="noindent" >The Common Lisp rules for deciding between the use of ~F and ~E are compatible
      with the rules used by Fortran but have been extended to cover the cases where <i>w</i>
      or <i>d</i> is omitted or where <i>e</i> is speciﬁed.
      <!--l. 5299--><p class="noindent" >In MacLisp and Lisp Machine Lisp, the ~G format directive is equivalent to the
      Common Lisp ~@* directive. This incompatibility between Common Lisp
      and MacLisp was introduced for the sake of cultural compatibility with
      Fortran.
</div>
      <li><b>
  ~$ </b></li><i>Dollars ﬂoating-point</i>. The next <i>arg</i> is printed as a ﬂoating-point number in
      ﬁxed-format notation. This format is particularly convenient for printing a
      value as dollars and cents.
      <!--l. 5311--><p class="noindent" >The full form is ~<i>d</i>,<i>n</i>,<i>w</i>,<i>padchar</i>$. The parameter <i>d</i> is the number of digits
      to print after the decimal point (default value 2); <i>n</i> is the minimum number
      of digits to print before the decimal point (default value 1); <i>w</i> is
      the minimum total width of the ﬁeld to be printed (default value
      0).
                                                                          

                                                                          
      <!--l. 5319--><p class="noindent" >First padding and the sign are output. If the <i>arg</i> is negative, then a
      minus sign is printed; if the <i>arg</i> is not negative, then a plus sign is
      printed if and only if the @ modiﬁer was speciﬁed. If the : modiﬁer is
      used, the sign appears before any padding, and otherwise after the
      padding. If <i>w</i> is speciﬁed and the number of other characters to be
      output is less than <i>w</i>, then copies of <i>padchar</i> (which defaults to a
      space) are output to make the total ﬁeld width equal <i>w</i>. Then <i>n</i>
      digits are printed for the integer part of <i>arg</i>, with leading zeros if
      necessary; then a decimal point; then <i>d</i> digits of fraction, properly
      rounded.
      <!--l. 5333--><p class="noindent" >If the magnitude of <i>arg</i> is so large that more than <i>m</i> digits would
      have to be printed, where <i>m</i> is the larger of <i>w</i> and 100, then an
      implementation is free, at its discretion, to print the number using
      exponential notation instead, as if by the directive ~<i>w</i>,<i>q</i>„„<i>padchar</i>E, where
      <i>w</i> and <i>padchar</i> are present or omitted according to whether they were
      present or omitted in the ~$ directive, and where <span class="math"><i>q</i> = <i>d</i> + <i>n</i> − 1</span>,
      where <i>d</i> and <i>n</i> are the (possibly default) values given to the ~$
      directive.
      <!--l. 5343--><p class="noindent" >If <i>arg</i> is a rational number, then it is coerced to be a single-ﬂoat and then
      printed. (Alternatively, an implementation is permitted to process a rational
      number by any other method that has essentially the same behavior but
      avoids such hazards as loss of precision or overﬂow because of the
      coercion.)
      <!--l. 5349--><p class="noindent" >If <i>arg</i> is a complex number or some non-numeric object, then it is printed
      using the format directive ~<i>w</i>D, thereby printing it in decimal radix and a
      minimum ﬁeld width of <i>w</i>. (If it is desired to print each of the real part and
      imaginary part of a complex number using a ~$ directive, then this must be
      done explicitly with two ~$ directives and code to extract the two parts of
      the complex number.)
<div class=new>
      <!--l. 5358--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx139-263023"></a>to specify that <a 
href="#x139-263003r687">format</a> binds *print-escape* to
      <a 
href="clmse31.html#x42-74002r18">nil</a> during the processing of the ~$ directive.
      </div>
      <li><b>
 ~% </b></li>This outputs a #\Newline character, thereby terminating the current
      output line and beginning a new one (see <a 
href="#x139-260034r680">terpri</a>).
                                                                          

                                                                          
      <!--l. 5370--><p class="noindent" >~<i>n</i>% outputs <i>n</i> newlines.
      <!--l. 5372--><p class="noindent" >No <i>arg</i> is used. Simply putting a newline in the control string would work,
      but ~% is often used because it makes the control string look nicer in the
      middle of a Lisp program.
      <li><b>
 ~&#x0026; </b></li>Unless it can be determined that the output stream is already at the
      beginning of a line, this outputs a newline (see <a 
href="#x139-260036r681">fresh-line</a>).
      <!--l. 5381--><p class="noindent" >~<i>n</i>&#x0026; calls <a 
href="#x139-260036r681">fresh-line</a> and then outputs <span class="math"><i>n</i> − 1</span> newlines. ~0&#x0026; does
      nothing.
      <li><b>
  ~| </b></li>This outputs a page separator character, if possible. ~<i>n</i>| does this <i>n</i> times. |
      is vertical bar, not capital I.
      <li><b>
  ~~ </b></li><i>Tilde</i>. This outputs a tilde. ~<i>n</i>~ outputs <i>n</i> tildes.
      <li><b>
~<span class="math">⟨</span>newline<span class="math">⟩</span> </b></li>Tilde immediately followed by a newline ignores the newline and any
      following non-newline whitespace characters. With a :, the newline is
      ignored, but any following whitespace is left in place. With an @, the
      newline is left in place, but any following whitespace is ignored. This
      directive is typically used when a format control string is too long to ﬁt
      nicely into one line of the program: <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun type-clash-error (fn nargs argnum right-type wrong-type)
</td></tr></table>
      <!--l. 5404--><p class="noindent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (format *error-output*</td></tr></table>
      <!--l. 5405--><p class="noindent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">          &#x0022;~&#x0026;Function ~S requires its ~:[~:R~;~*~] ~</td></tr></table>
      <!--l. 5406--><p class="noindent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">           argument to be of type ~S,~%but it was called ~</td></tr></table>
      <!--l. 5407--><p class="noindent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">           with an argument of type ~S.~%&#x0022;</td></tr></table>
      <!--l. 5408--><p class="noindent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">          fn (eql nargs 1) argnum right-type wrong-type))</td></tr></table>
      <!--l. 5409--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 5410--><p class="noindent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(type-clash-error &#x2019;aref nil 2 &#x2019;integer &#x2019;vector) prints:</td></tr></table>
                                                                          

                                                                          
      <!--l. 5411--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">Function AREF requires its second argument to be of type INTEGER,</td></tr></table>
      <!--l. 5412--><p class="noindent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">but it was called with an argument of type VECTOR.</td></tr></table>
      <!--l. 5413--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 5414--><p class="noindent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(type-clash-error &#x2019;car 1 1 &#x2019;list &#x2019;short-ﬂoat) prints:</td></tr></table>
      <!--l. 5415--><p class="noindent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">Function CAR requires its argument to be of type LIST,</td></tr></table>
      <!--l. 5416--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">but it was called with an argument of type SHORT-FLOAT.</td></tr></table>
      <!--l. 5418--><p class="noindent" >
</div>
</div>
      <!--l. 5419--><p class="noindent" >Note that in this example newlines appear in the output only as
      speciﬁed by the ~&#x0026; and ~% directives; the actual newline characters in
      the control string are suppressed because each is preceded by a
      tilde.
      <li><b>
 ~T </b></li><i>Tabulate</i>. This spaces over to a given column. ~<i>colnum</i>,<i>colinc</i>T will output
      suﬃcient spaces to move the cursor to column <i>colnum</i>. If the cursor is
      already at or beyond column <i>colnum</i>, it will output spaces to move it to
      column <i>colnum</i>+<i>k</i>*<i>colinc</i> for the smallest positive integer <i>k</i> possible, unless
      <i>colinc</i> is zero, in which case no spaces are output if the cursor is
      already at or beyond column <i>colnum</i>. <i>colnum</i> and <i>colinc</i> default to
      1.
      <!--l. 5434--><p class="noindent" >Ideally, the current column position is determined by examination of the
      destination, whether a stream or string. (Although no user-level
      operation for determining the column position of a stream is deﬁned by
      Common Lisp, such a facility may exist at the implementation level.) If
      for some reason the current absolute column position cannot be
      determined by direct inquiry, <a 
href="#x139-263003r687">format</a> may be able to deduce the current
      column position by noting that certain directives (such as ~%, or
      ~&#x0026;, or ~A with the argument being a string containing a newline)
      cause the column position to be reset to zero, and counting the
      number of characters emitted since that point. If that fails, <a 
href="#x139-263003r687">format</a>
      may attempt a similar deduction on the riskier assumption that the
      destination was at column zero when <a 
href="#x139-263003r687">format</a> was invoked. If even this
      heuristic fails or is implementationally inconvenient, at worst the
                                                                          

                                                                          
      ~T operation will simply output two spaces. (All this implies that
      code that uses <a 
href="#x139-263003r687">format</a> is more likely to be portable if all format
      control strings that use the ~T directive either begin with ~% or
      ~&#x0026; to force a newline or are designed to be used only when the
      destination is known from other considerations to be at column
      zero.)
      <!--l. 5456--><p class="noindent" >~@T performs <i>relative</i> tabulation. ~<i>colrel</i>,<i>colinc</i>@T outputs <i>colrel</i> spaces
      and then outputs the smallest non-negative number of additional spaces
      necessary to move the cursor to a column that is a multiple of <i>colinc</i>. For
      example, the directive ~3,8@T outputs three spaces and then moves the
      cursor to a “standard multiple-of-eight tab stop” if not at one already. If the
      current output column cannot be determined, however, then <i>colinc</i> is
      ignored, and exactly <i>colrel</i> spaces are output.
<div class=new>
      <!--l. 5468--><p class="noindent" >X3J13 voted in June 1989 <a 
 id="dx139-263024"></a>to deﬁne ~:T and ~:@T to perform tabulation
      relative to a point deﬁned by the pretty printing process (see section <a 
href="clmse142.html#x174-35700027.4">27.4<!--tex4ht:ref: PPRINT-FORMAT-DIRECTIVES-SECTION --></a>).
      </div>
      <li><b>
  ~* </b></li>The next <i>arg</i> is ignored. ~<i>n</i>* ignores the next <i>n</i> arguments.
      <!--l. 5476--><p class="noindent" >~:* “ignores backwards”; that is, it backs up in the list of arguments so that
      the argument last processed will be processed again. ~<i>n</i>:* backs up <i>n</i>
      arguments.
      <!--l. 5480--><p class="noindent" >When within a ~{ construct (see below), the ignoring (in either
      direction) is relative to the list of arguments being processed by the
      iteration.
      <!--l. 5484--><p class="noindent" >~<i>n</i>@* is an “absolute goto” rather than a “relative goto”: it goes to the <i>n</i>th
      <i>arg</i>, where 0 means the ﬁrst one; <i>n</i> defaults to 0, so ~@* goes back to the
      ﬁrst <i>arg</i>. Directives after a ~<i>n</i>@* will take arguments in sequence
      beginning with the one gone to. When within a ~{ construct, the
      “goto” is relative to the list of arguments being processed by the
      iteration.
      <li><b>
  ~? </b></li><i>Indirection</i>. The next <i>arg</i> must be a string, and the one after it a list; both
      are consumed by the ~? directive. The string is processed as a <a 
href="#x139-263003r687">format</a>
      control string, with the elements of the list as the arguments. Once the
                                                                          

                                                                          
      recursive processing of the control string has been ﬁnished, then processing
      of the control string containing the ~? directive is resumed. Example:
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil &#x0022;~? ~D&#x0022; &#x0022;&#x003C;~A ~D&#x003E;&#x0022; &#x2019;(&#x0022;Foo&#x0022; 5) 7) <span class="math"> ⇒</span> &#x0022;&#x003C;Foo 5&#x003E; 7&#x0022;
</td></tr></table>
      <!--l. 5502--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil &#x0022;~? ~D&#x0022; &#x0022;&#x003C;~A ~D&#x003E;&#x0022; &#x2019;(&#x0022;Foo&#x0022; 5 14) 7) <span class="math"> ⇒</span> &#x0022;&#x003C;Foo 5&#x003E; 7&#x0022;</td></tr></table>
      <!--l. 5504--><p class="noindent" >
</div>
</div>
      <!--l. 5505--><p class="noindent" >Note that in the second example three arguments are supplied to the control
      string &#x0022;&#x003C;~A ~D&#x003E;&#x0022;, but only two are processed and the third is therefore
      ignored.
      <!--l. 5509--><p class="noindent" >With the @ modiﬁer, only one <i>arg</i> is directly consumed. The <i>arg</i> must be a
      string; it is processed as part of the control string as if it had appeared in
      place of the ~@? construct, and any directives in the recursively processed
      control string may consume arguments of the control string containing the
      ~@? directive. Example: <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil &#x0022;~@? ~D&#x0022; &#x0022;&#x003C;~A ~D&#x003E;&#x0022; &#x0022;Foo&#x0022; 5 7) <span class="math"> ⇒</span> &#x0022;&#x003C;Foo 5&#x003E; 7&#x0022;
</td></tr></table>
      <!--l. 5517--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil &#x0022;~@? ~D&#x0022; &#x0022;&#x003C;~A ~D&#x003E;&#x0022; &#x0022;Foo&#x0022; 5 14 7) <span class="math"> ⇒</span> &#x0022;&#x003C;Foo 5&#x003E; 14&#x0022;</td></tr></table>
      <!--l. 5519--><p class="noindent" >
</div>
</div>
      <!--l. 5521--><p class="noindent" >Here is a rather sophisticated example. The <a 
href="#x139-263003r687">format</a> function itself,
      as implemented at one time in Lisp Machine Lisp, used a routine
      internal to the <a 
href="#x139-263003r687">format</a> package called format-error to signal error
      messages; format-error in turn used <a 
href="clmse151.html#x185-472012r984">error</a>, which used <a 
href="#x139-263003r687">format</a> recursively.
      Now format-error took a string and arguments, just like <a 
href="#x139-263003r687">format</a>, but
      also printed the control string to <a 
href="#x139-263003r687">format</a> (which at this point was
                                                                          

                                                                          
      available in the global variable *ctl-string*) and a little arrow showing
      where in the processing of the control string the error occurred. The
      variable *ctl-index* pointed one character after the place of the error.
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun format-error (string &#x0026;rest args)     ;Example
</td></tr></table>
      <!--l. 5534--><p class="noindent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (error <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~?~%~V@T<span class="math"> ⇓</span>~%~3@T\&#x0022;~A\&#x0022;~%&#x0022;</td></tr></table>
      <!--l. 5535--><p class="noindent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         string args (+ *ctl-index* 3) *ctl-string*))</td></tr></table>
      <!--l. 5537--><p class="noindent" >
</div>
</div>
      <!--l. 5538--><p class="noindent" >(The character set used in the Lisp Machine Lisp implementation contains a
      down-arrow character <span class="math"> ⇓</span>, which is not a standard Common Lisp character.)
      This ﬁrst processed the given string and arguments using ~?, then output a
      newline, tabbed a variable amount for printing the down-arrow, and printed
      the control string between double quotes (note the use of \&#x0022; to include
      double quotes within the control string). The eﬀect was something like this:
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format t &#x0022;The item is a ~[Foo~;Bar~;Loser~].&#x0022; &#x2019;quux)
</td></tr></table>
      <!--l. 5546--><p class="noindent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">»ERROR: The argument to the FORMAT &#x0022;~[&#x0022; command</td></tr></table>
      <!--l. 5547--><p class="noindent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         must be a number.</td></tr></table>
      <!--l. 5548--><p class="noindent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                   <span class="math"> ⇓</span></td></tr></table>
      <!--l. 5549--><p class="noindent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">   &#x0022;The item is a ~[Foo~;Bar~;Loser~].&#x0022;</td></tr></table>
      <!--l. 5551--><p class="noindent" >
</div>
</div>
<div class=implementation>
                                                                          

                                                                          
      <!--l. 5554--><p class="noindent" ><b>Implementation note:</b> Implementors may wish to report errors occurring within
      <a 
href="#x139-263003r687">format</a> control strings in the manner outlined here. It looks pretty ﬂashy when
      done properly.
</div>
      </ul>
</div>
<div class=new>
<!--l. 5563--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx139-263025"></a>to introduce certain <a 
href="#x139-263003r687">format</a> directives to
support the user interface to the pretty printer described in detail in
chapter <a 
href="clmch27.html#x170-35000027">27<!--tex4ht:ref: PPRINT --></a>.
<div class=flushdesc>
      <ul><li><b>
 ~_ </b></li><i>Conditional  newline.</i>  Without   any   modiﬁers,   the   directive   ~_
      is  equivalent  to  (pprint-newline  :linear).  The  directive  ~@_  is
      equivalent to (pprint-newline :miser). The directive ~:_ is equivalent
      to   (pprint-newline   :ﬁll).   The   directive   ~:@_   is   equivalent   to
      (pprint-newline :mandatory).
      <li><b>
 ~W </b></li><i>Write.</i> An <i>arg</i>, any Lisp object, is printed obeying <i>every</i> printer control
      variable (as by <a 
href="#x139-260006r668">write</a>). See section <a 
href="clmse142.html#x174-35700027.4">27.4<!--tex4ht:ref: PPRINT-FORMAT-DIRECTIVES-SECTION --></a> for details.
      <li><b>
  ~I </b></li><i>Indent.</i> The directive ~<i>n</i>I is equivalent to (pprint-indent :block <i>n</i>).
      The directive ~:<i>n</i>I is equivalent to (pprint-indent :current <i>n</i>). In both
      cases, <i>n</i> defaults to zero, if it is omitted.</ul>
</div>
</div>
<!--l. 5592--><p class="indent" >   The format directives after this point are much more complicated than
the foregoing; they constitute control structures that can perform case
conversion, conditional selection, iteration, justiﬁcation, and non-local
exits. Used with restraint, they can perform powerful tasks. Used with
abandon, they can produce completely unreadable and unmaintainable
code.
<!--l. 5599--><p class="indent" >   The case-conversion, conditional, iteration, and justiﬁcation constructs can
contain other formatting constructs by bracketing them. These constructs
                                                                          

                                                                          
must nest properly with respect to each other. For example, it is not
legitimate to put the start of a case-conversion construct in each arm of a
conditional and the end of the case-conversion construct outside the conditional:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~:[abc~:@(def~;ghi~:@(jkl~]mno~)&#x0022; x)     ;Illegal!
</td></tr></table>
<!--l. 5607--><p class="indent" >
</div>
</div>
<!--l. 5608--><p class="noindent" >One might expect this to produce either &#x0022;abcDEFMNO&#x0022; or &#x0022;ghiJKLMNO&#x0022;,
depending on whether x is false or true; but in fact the construction is illegal
because the ~[...~;...~] and ~(...~) constructs are not properly nested.
<!--l. 5613--><p class="indent" >   The processing indirection caused by the ~? directive is also a kind of nesting
for the purposes of this rule of proper nesting. It is not permitted to start a
bracketing construct within a string processed under control of a ~? directive
and end the construct at some point after the ~? construct in the string
containing that construct, or vice versa. For example, this situation is illegal:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~?ghi~)&#x0022; &#x0022;abc~@(def&#x0022;)     ;Illegal!
</td></tr></table>
<!--l. 5623--><p class="indent" >
</div>
</div>
<!--l. 5624--><p class="noindent" >One might expect it to produce &#x0022;abcDEFGHI&#x0022;, but in fact the construction is illegal
because the ~? and ~(...~) constructs are not properly nested.
<div class=flushdesc>
      <ul><li><b>
~(<i>str</i>~) </b></li><i>Case conversion</i>. The contained control string <i>str</i> is processed, and what
      it produces is subject to case conversion: ~( converts every uppercase
      character to the corresponding lowercase character; ~:( capitalizes all words,
      as if by <a 
href="clmse97.html#x120-224014r575">string-capitalize</a>; ~@( capitalizes just the ﬁrst word and
      forces the rest to lowercase; ~:@( converts every lowercase character
                                                                          

                                                                          
      to the corresponding uppercase character. In this example, ~@( is
      used to cause the ﬁrst word produced by ~@R to be capitalized:
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil &#x0022;~@R ~(~@R~)&#x0022; 14 14) <span class="math"> ⇒</span> &#x0022;XIV xiv&#x0022;
</td></tr></table>
      <!--l. 5642--><p class="noindent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun f (n) (format nil &#x0022;~@(~R~) error~:P detected.&#x0022; n))</td></tr></table>
      <!--l. 5643--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(f 0) <span class="math"> ⇒</span> &#x0022;Zero errors detected.&#x0022;</td></tr></table>
      <!--l. 5644--><p class="noindent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(f 1) <span class="math"> ⇒</span> &#x0022;One error detected.&#x0022;</td></tr></table>
      <!--l. 5645--><p class="noindent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(f 23) <span class="math"> ⇒</span> &#x0022;Twenty-three errors detected.&#x0022;</td></tr></table>
      <!--l. 5647--><p class="noindent" >
</div>
</div>
      <li><b>
~[<i>str0</i>~;<i>str1</i>~;<i>...</i>~;<i>strn</i>~] </b></li><i>Conditional expression</i>. This is a set of control strings,
      called <i>clauses</i>, one of which is chosen and used. The clauses are
      separated by ~; and the construct is terminated by ~]. For example,
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">&#x0022;~[Siamese~;Manx~;Persian~] Cat&#x0022;
</td></tr></table>
      <!--l. 5656--><p class="noindent" >
</div>
</div>
      <!--l. 5657--><p class="noindent" >The <i>arg</i>th clause is selected, where the ﬁrst clause is number 0. If a preﬁx
      parameter is given (as ~<i>n</i>[), then the parameter is used instead of an
      argument. (This is useful only if the parameter is speciﬁed by #, to dispatch
      on the number of arguments remaining to be processed.) If <i>arg</i> is out of
      range, then no clause is selected (and no error is signaled). After the selected
      alternative has been processed, the control string continues after the
      ~].
                                                                          

                                                                          
      <!--l. 5668--><p class="noindent" >~[<i>str0</i>~;<i>str1</i>~;<i>...</i>~;<i>strn</i>~:;<i>default</i>~] has a default case. If the <i>last</i> ~; used
      to separate clauses is ~:; instead, then the last clause is an “else”
      clause that is performed if no other clause is selected. For example:
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">&#x0022;~[Siamese~;Manx~;Persian~:;Alley~] Cat&#x0022;
</td></tr></table>
      <!--l. 5675--><p class="noindent" >
</div>
</div>
      <!--l. 5677--><p class="noindent" >~:[<i>false</i>~;<i>true</i>~] selects the <i>false</i> control string if <i>arg</i> is <a 
href="clmse31.html#x42-74002r18">nil</a>, and selects the
      <i>true</i> control string otherwise.
      <!--l. 5680--><p class="noindent" >~@[<i>true</i>~] tests the argument. If it is not <a 
href="clmse31.html#x42-74002r18">nil</a>, then the argument is not used
      up by the ~@[ command but remains as the next one to be processed, and
      the one clause <i>true</i> is processed. If the <i>arg</i> is <a 
href="clmse31.html#x42-74002r18">nil</a>, then the argument is used
      up, and the clause is not processed. The clause therefore should normally
      use exactly one argument, and may expect it to be non-<a 
href="clmse31.html#x42-74002r18">nil</a>. For example:
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(setq *print-level* <a 
href="clmse31.html#x42-74002r18">nil</a> *print-length* 5)
</td></tr></table>
      <!--l. 5690--><p class="noindent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~@[ print level = ~D~]~@[ print length = ~D~]&#x0022;</td></tr></table>
      <!--l. 5691--><p class="noindent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">            *print-level* *print-length*)</td></tr></table>
      <!--l. 5692--><p class="noindent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">   <span class="math"> ⇒</span> &#x0022; print length = 5&#x0022;</td></tr></table>
      <!--l. 5694--><p class="noindent" >
</div>
</div>
      <!--l. 5696--><p class="noindent" >The combination of ~[ and # is useful, for example, for dealing with English
      conventions for printing lists: <div class=lisp><div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(setq foo &#x0022;Items:~#[ none~; ~S~; ~S and ~S~
</td></tr></table>
      <!--l. 5699--><p class="noindent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">           ~:;~@{~#[~; and~] ~S~̂,~}~].&#x0022;)</td></tr></table>
      <!--l. 5701--><p class="noindent" >                                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> foo)</td></tr></table>
      <!--l. 5702--><p class="noindent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        <span class="math"> ⇒</span> &#x0022;Items: none.&#x0022;</td></tr></table>
      <!--l. 5702--><p class="noindent" >                                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> foo &#x2019;foo)</td></tr></table>
      <!--l. 5703--><p class="noindent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        <span class="math"> ⇒</span> &#x0022;Items: FOO.&#x0022;</td></tr></table>
      <!--l. 5704--><p class="noindent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> foo &#x2019;foo &#x2019;bar)</td></tr></table>
      <!--l. 5705--><p class="noindent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        <span class="math"> ⇒</span> &#x0022;Items: FOO and BAR.&#x0022;</td></tr></table>
      <!--l. 5706--><p class="noindent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> foo &#x2019;foo &#x2019;bar &#x2019;baz)</td></tr></table>
      <!--l. 5707--><p class="noindent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        <span class="math"> ⇒</span> &#x0022;Items: FOO, BAR, and BAZ.&#x0022;</td></tr></table>
      <!--l. 5708--><p class="noindent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> foo &#x2019;foo &#x2019;bar &#x2019;baz &#x2019;quux)</td></tr></table>
      <!--l. 5709--><p class="noindent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        <span class="math"> ⇒</span> &#x0022;Items: FOO, BAR, BAZ, and QUUX.&#x0022;</td></tr></table>
      <!--l. 5711--><p class="noindent" >
</div>
</div>
      <li><b>
  ~; </b></li>This separates clauses in ~[ and ~&#x003C; constructions. It is an error
      elsewhere.
      <li><b>
  ~] </b></li>This terminates a ~[. It is an error elsewhere.
      <li><b>
~{<i>str</i>~} </b></li><i>Iteration</i>. This is an iteration construct. The argument should be a list,
      which is used as a set of arguments as if for a recursive call to <a 
href="#x139-263003r687">format</a>. The
      string <i>str</i> is used repeatedly as the control string. Each iteration can absorb
      as many elements of the list as it likes as arguments; if <i>str</i> uses up two
      arguments by itself, then two elements of the list will get used up each
      time around the loop. If before any iteration step the list is empty,
      then the iteration is terminated. Also, if a preﬁx parameter <i>n</i> is
      given, then there will be at most <i>n</i> repetitions of processing of <i>str</i>.
                                                                          

                                                                          
      Finally, the ~̂ directive can be used to terminate the iteration
      prematurely.
      <!--l. 5735--><p class="noindent" >Here are some simple examples: <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a>
</td></tr></table>
      <!--l. 5737--><p class="noindent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        &#x0022;The winners are:~{ ~S~}.&#x0022;</td></tr></table>
      <!--l. 5738--><p class="noindent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        &#x2019;(fred harry jill))</td></tr></table>
      <!--l. 5739--><p class="noindent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">     <span class="math"> ⇒</span> &#x0022;The winners are: FRED HARRY JILL.&#x0022;</td></tr></table>
      <!--l. 5740--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 5741--><p class="noindent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;Pairs:~{ &#x003C;~S,~S&#x003E;~}.&#x0022; &#x2019;(a 1 b 2 c 3))</td></tr></table>
      <!--l. 5742--><p class="noindent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">     <span class="math"> ⇒</span> &#x0022;Pairs: &#x003C;A,1&#x003E; &#x003C;B,2&#x003E; &#x003C;C,3&#x003E;.&#x0022;</td></tr></table>
      <!--l. 5744--><p class="noindent" >
</div>
</div>
      <!--l. 5746--><p class="noindent" >~:{<i>str</i>~} is similar, but the argument should be a list of sublists. At
      each repetition step, one sublist is used as the set of arguments
      for processing <i>str</i>; on the next repetition, a new sublist is used,
      whether or not all of the last sublist had been processed. Example:
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;Pairs:~:{ &#x003C;~S,~S&#x003E;~}.&#x0022;
</td></tr></table>
      <!--l. 5751--><p class="noindent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">            &#x2019;((a 1) (b 2) (c 3)))</td></tr></table>
      <!--l. 5752--><p class="noindent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">     <span class="math"> ⇒</span> &#x0022;Pairs: &#x003C;A,1&#x003E; &#x003C;B,2&#x003E; &#x003C;C,3&#x003E;.&#x0022;</td></tr></table>
      <!--l. 5754--><p class="noindent" >
</div>
</div>
      <!--l. 5756--><p class="noindent" >~@{<i>str</i>~} is similar to ~{<i>str</i>~}, but instead of using one argument that is a
      list, all the remaining arguments are used as the list of arguments for the
      iteration. Example: <div class=lisp><div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;Pairs:~@{ &#x003C;~S,~S&#x003E;~}.&#x0022;
</td></tr></table>
      <!--l. 5761--><p class="noindent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">            &#x2019;a 1 &#x2019;b 2 &#x2019;c 3)</td></tr></table>
      <!--l. 5762--><p class="noindent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">     <span class="math"> ⇒</span> &#x0022;Pairs: &#x003C;A,1&#x003E; &#x003C;B,2&#x003E; &#x003C;C,3&#x003E;.&#x0022;</td></tr></table>
      <!--l. 5764--><p class="noindent" >
</div>
</div>
      <!--l. 5765--><p class="noindent" >If the iteration is terminated before all the remaining arguments
      are consumed, then any arguments not processed by the iteration
      remain to be processed by any directives following the iteration
      construct.
      <!--l. 5769--><p class="noindent" >~:@{<i>str</i>~} combines the features of ~:{<i>str</i>~} and ~@{<i>str</i>~}. All the
      remaining arguments are used, and each one must be a list. On each
      iteration, the next argument is used as a list of arguments to <i>str</i>. Example:
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;Pairs:~:@{ &#x003C;~S,~S&#x003E;~}.&#x0022;
</td></tr></table>
      <!--l. 5777--><p class="noindent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">            &#x2019;(a 1) &#x2019;(b 2) &#x2019;(c 3))</td></tr></table>
      <!--l. 5778--><p class="noindent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">     <span class="math"> ⇒</span> &#x0022;Pairs: &#x003C;A,1&#x003E; &#x003C;B,2&#x003E; &#x003C;C,3&#x003E;.&#x0022;</td></tr></table>
      <!--l. 5780--><p class="noindent" >
</div>
</div>
      <!--l. 5782--><p class="noindent" >Terminating the repetition construct with ~:} instead of ~} forces <i>str</i> to
      be processed at least once, even if the initial list of arguments is
      null (however, it will not override an explicit preﬁx parameter of
      zero).
      <!--l. 5787--><p class="noindent" >If <i>str</i> is empty, then an argument is used as <i>str</i>. It must be a string and
      precede any arguments processed by the iteration. As an example, the
      following are equivalent: <div class=lisp><div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(apply #&#x2019;format stream string arguments)
</td></tr></table>
      <!--l. 5791--><p class="noindent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format stream &#x0022;~1{~:}&#x0022; string arguments)</td></tr></table>
      <!--l. 5793--><p class="noindent" >
</div>
</div>
      <!--l. 5794--><p class="noindent" >This will use <a 
href="clmse97.html#x120-224022r579">string</a> as a formatting string. The ~1{ says it will be
      processed at most once, and the ~:} says it will be processed at
      least once. Therefore it is processed exactly once, using arguments
      as the arguments. This case may be handled more clearly by the
      ~? directive, but this general feature of ~{ is more powerful than
      ~?.
      <li><b>
  ~} </b></li>This terminates a ~{. It is an error elsewhere.
      <li><b>
~<i>mincol</i>,<i>colinc</i>,<i>minpad</i>,<i>padchar</i>&#x003C;<i>str</i>~&#x003E; </b></li><i>Justiﬁcation</i>. This justiﬁes the text
      produced by processing <i>str</i> within a ﬁeld at least <i>mincol</i> columns wide. <i>str</i>
      may be divided up into segments with ~;, in which case the spacing is evenly
      divided between the text segments.
      <!--l. 5811--><p class="noindent" >With no modiﬁers, the leftmost text segment is left-justiﬁed in the ﬁeld, and
      the rightmost text segment right-justiﬁed; if there is only one text element,
      as a special case, it is right-justiﬁed. The : modiﬁer causes spacing to be
      introduced before the ﬁrst text segment; the @ modiﬁer causes spacing to be
      added after the last. The <i>minpad</i> parameter (default 0) is the minimum
      number of padding characters to be output between each segment. The
      padding character is speciﬁed by <i>padchar</i>, which defaults to the space
      character. If the total width needed to satisfy these constraints is greater
      than <i>mincol</i>, then the width used is <i>mincol</i>+<i>k</i>*<i>colinc</i> for the smallest
      possible non-negative integer value <i>k</i>; <i>colinc</i> defaults to 1, and <i>mincol</i>
      defaults to 0.
<div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~10&#x003C;foo~;bar~&#x003E;&#x0022;)          <span class="math"> ⇒</span> &#x0022;foo    bar&#x0022;
</td></tr></table>
      <!--l. 5827--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~10:&#x003C;foo~;bar~&#x003E;&#x0022;)         <span class="math"> ⇒</span> &#x0022;  foo  bar&#x0022;</td></tr></table>
      <!--l. 5828--><p class="noindent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~10:@&#x003C;foo~;bar~&#x003E;&#x0022;)        <span class="math"> ⇒</span> &#x0022;  foo bar &#x0022;</td></tr></table>
      <!--l. 5829--><p class="noindent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~10&#x003C;foobar~&#x003E;&#x0022;)            <span class="math"> ⇒</span> &#x0022;    foobar&#x0022;</td></tr></table>
      <!--l. 5830--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~10:&#x003C;foobar~&#x003E;&#x0022;)           <span class="math"> ⇒</span> &#x0022;    foobar&#x0022;</td></tr></table>
      <!--l. 5831--><p class="noindent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~10@&#x003C;foobar~&#x003E;&#x0022;)           <span class="math"> ⇒</span> &#x0022;foobar    &#x0022;</td></tr></table>
      <!--l. 5832--><p class="noindent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~10:@&#x003C;foobar~&#x003E;&#x0022;)          <span class="math"> ⇒</span> &#x0022;  foobar  &#x0022;</td></tr></table>
      <!--l. 5834--><p class="noindent" >
</div>
</div>
      <!--l. 5836--><p class="noindent" >Note that <i>str</i> may include <a 
href="#x139-263003r687">format</a> directives. All the clauses in <i>str</i>
      are processed in order; it is the resulting pieces of text that are
      justiﬁed.
      <!--l. 5840--><p class="noindent" >The ~̂ directive may be used to terminate processing of the clauses
      prematurely, in which case only the completely processed clauses are
      justiﬁed.
      <!--l. 5844--><p class="noindent" >If the ﬁrst clause of a ~&#x003C; is terminated with ~:; instead of ~;, then it is used
      in a special way. All of the clauses are processed (subject to ~̂, of course),
      but the ﬁrst one is not used in performing the spacing and padding. When
      the padded result has been determined, then if it will ﬁt on the
      current line of output, it is output, and the text for the ﬁrst clause is
      discarded. If, however, the padded text will not ﬁt on the current
      line, then the text segment for the ﬁrst clause is output before the
      padded text. The ﬁrst clause ought to contain a newline (such as
      a ~% directive). The ﬁrst clause is always processed, and so any
      arguments it refers to will be used; the decision is whether to use the
      resulting segment of text, not whether to process the ﬁrst clause. If
      the ~:; has a preﬁx parameter <i>n</i>, then the padded text must ﬁt
      on the current line with <i>n</i> character positions to spare to avoid
      outputting the ﬁrst clause&#x2019;s text. For example, the control string
      <div class=lisp><div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">&#x0022;~%;; ~{~&#x003C;~%;; ~1:; ~S~&#x003E;~̂,~}.~%&#x0022;
</td></tr></table>
      <!--l. 5861--><p class="noindent" >
</div>
</div>
      <!--l. 5862--><p class="noindent" >can be used to print a list of items separated by commas without breaking
      items over line boundaries, beginning each line with ;; . The preﬁx
      parameter 1 in ~1:; accounts for the width of the comma that will follow the
      justiﬁed item if it is not the last element in the list, or the period if it is. If
      ~:; has a second preﬁx parameter, then it is used as the width of the line,
      thus overriding the natural line width of the output stream. To
      make the preceding example use a line width of 50, one would write
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">&#x0022;~%;; ~{~&#x003C;~%;; ~1,50:; ~S~&#x003E;~̂,~}.~%&#x0022;
</td></tr></table>
      <!--l. 5872--><p class="noindent" >
</div>
</div>
      <!--l. 5874--><p class="noindent" >If the second argument is not speciﬁed, then <a 
href="#x139-263003r687">format</a> uses the line width
      of the output stream. If this cannot be determined (for example,
      when producing a string result), then <a 
href="#x139-263003r687">format</a> uses 72 as the line
      length.
      <li><b>
 ~&#x003E; </b></li>Terminates a ~&#x003C;. It is an error elsewhere. <div class=new> X3J13 voted in June 1989 <a 
 id="dx139-263026"></a>to
      introduce certain <a 
href="#x139-263003r687">format</a> directives to support the user interface to the
      pretty printer. If ~:&#x003E; is used to terminate a ~&#x003C;... directive, the directive is
      equivalent to a call on <a 
href="clmse141.html#x173-353005r850">pprint-logical-block</a>. See section <a 
href="clmse142.html#x174-35700027.4">27.4<!--tex4ht:ref: PPRINT-FORMAT-DIRECTIVES-SECTION --></a> for
      details.
      </div>
                                                                          

                                                                          
      <li><b>
  ~̂ </b></li><i>Up and out</i>. This is an escape construct. If there are no more arguments
      remaining to be processed, then the immediately enclosing ~{ or ~&#x003C;
      construct is terminated. If there is no such enclosing construct, then the
      entire formatting operation is terminated. In the ~&#x003C; case, the formatting <i>is</i>
      performed, but no more segments are processed before doing the
      justiﬁcation. The ~̂ should appear only at the <i>beginning</i> of a ~&#x003C;
      clause, because it aborts the entire clause it appears in (as well as
      all following clauses). ~̂ may appear anywhere in a ~{ construct.
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(setq donestr &#x0022;Done.~̂ ~D warning~:P.~̂ ~D error~:P.&#x0022;)
</td></tr></table>
      <!--l. 5903--><p class="noindent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> donestr) <span class="math"> ⇒</span> &#x0022;Done.&#x0022;</td></tr></table>
      <!--l. 5904--><p class="noindent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> donestr 3) <span class="math"> ⇒</span> &#x0022;Done. 3 warnings.&#x0022;</td></tr></table>
      <!--l. 5905--><p class="noindent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> donestr 1 5) <span class="math"> ⇒</span> &#x0022;Done. 1 warning. 5 errors.&#x0022;</td></tr></table>
      <!--l. 5907--><p class="noindent" >
</div>
</div>
      <!--l. 5909--><p class="noindent" >If a preﬁx parameter is given, then termination occurs if the parameter is
      zero. (Hence ~̂ is equivalent to ~#̂.) If two parameters are given,
      termination occurs if they are equal. If three parameters are given,
      termination occurs if the ﬁrst is less than or equal to the second and the
      second is less than or equal to the third. Of course, this is useless if all the
      preﬁx parameters are constants; at least one of them should be a # or a V
      parameter.
      <!--l. 5917--><p class="noindent" >If ~̂ is used within a ~:{ construct, then it merely terminates the current
      iteration step (because in the standard case it tests for remaining arguments
      of the current step only); the next iteration step commences immediately. To
      terminate the entire iteration process, use ~:̂.
<div class=new>
      <!--l. 5924--><p class="noindent" >X3J13 voted in March 1988 <a 
 id="dx139-263027"></a>to clarify the behavior of ~:̂ as follows. It may
      be used only if the command it would terminate is ~:{ or ~:@{. The entire
                                                                          

                                                                          
      iteration process is terminated if and only if the sublist that is supplying the
      arguments for the current iteration step is the last sublist (in the
      case of terminating a ~:{ command) or the last argument to that
      call to <a 
href="#x139-263003r687">format</a> (in the case of terminating a ~:@{ command). Note
      furthermore that while ~̂ is equivalent to ~#̂ in all circumstances, ~:̂ is
      <i>not</i> equivalent to ~:#̂ because the latter terminates the entire
      iteration if and only if no arguments remain for <i>the current iteration
      step</i> (as opposed to no arguments remaining for the entire iteration
      process).
      <!--l. 5940--><p class="noindent" >Here are some examples of the diﬀerences in the behaviors of ~̂, ~:̂, and
      ~:#̂. <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil
</td></tr></table>
      <!--l. 5944--><p class="noindent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        &#x0022;~:{/~S~̂ ...~}&#x0022;</td></tr></table>
      <!--l. 5945--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        &#x2019;((hot dog) (hamburger) (ice cream) (french fries)))</td></tr></table>
      <!--l. 5946--><p class="noindent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"> <span class="math"> ⇒</span> &#x0022;/HOT .../HAMBURGER/ICE .../FRENCH ...&#x0022;</td></tr></table>
      <!--l. 5948--><p class="noindent" >
</div>
</div>
      <!--l. 5949--><p class="noindent" >For each sublist, “ ...” appears after the ﬁrst word unless there are no
      additional words. <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil
</td></tr></table>
      <!--l. 5952--><p class="noindent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        &#x0022;~:{/~S~:̂ ...~}&#x0022;</td></tr></table>
      <!--l. 5953--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        &#x2019;((hot dog) (hamburger) (ice cream) (french fries)))</td></tr></table>
      <!--l. 5954--><p class="noindent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"> <span class="math"> ⇒</span> &#x0022;/HOT .../HAMBURGER .../ICE .../FRENCH&#x0022;</td></tr></table>
      <!--l. 5956--><p class="noindent" >
                                                                          

                                                                          
</div>
</div>
      <!--l. 5957--><p class="noindent" >For each sublist, “ ...” always appears after the ﬁrst word, unless it is
      the last sublist, in which case the entire iteration is terminated.
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format nil
</td></tr></table>
      <!--l. 5960--><p class="noindent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        &#x0022;~:{/~S~:#̂ ...~}&#x0022;</td></tr></table>
      <!--l. 5961--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        &#x2019;((hot dog) (hamburger) (ice cream) (french fries)))</td></tr></table>
      <!--l. 5962--><p class="noindent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"> <span class="math"> ⇒</span> &#x0022;/HOT .../HAMBURGER&#x0022;</td></tr></table>
      <!--l. 5964--><p class="noindent" >
</div>
</div>
      <!--l. 5965--><p class="noindent" >For each sublist, “ ...” appears after the ﬁrst word, but if the sublist has only
      one word then the entire iteration is terminated.
      </div>
      <!--l. 5969--><p class="noindent" >If ~̂ appears within a control string being processed under the control of a
      ~? directive, but not within any ~{ or ~&#x003C; construct within that string,
      then the string being processed will be terminated, thereby ending
      processing of the ~? directive. Processing then continues within
      the string containing the ~? directive at the point following that
      directive.
      <!--l. 5978--><p class="noindent" >If ~̂ appears within a ~[ or ~( construct, then all the commands up to the
      ~̂ are properly selected or case-converted, the ~[ or ~( processing is
      terminated, and the outward search continues for a ~{ or ~&#x003C; construct to be
      terminated. For example: <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(setq tellstr &#x0022;~@(~@[~R~]~̂ ~A.~)&#x0022;)
</td></tr></table>
      <!--l. 5984--><p class="noindent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> tellstr 23) <span class="math"> ⇒</span> &#x0022;Twenty-three.&#x0022;</td></tr></table>
                                                                          

                                                                          
      <!--l. 5985--><p class="noindent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> tellstr nil &#x0022;losers&#x0022;) <span class="math"> ⇒</span> &#x0022;Losers.&#x0022;</td></tr></table>
      <!--l. 5986--><p class="noindent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> tellstr 23 &#x0022;losers&#x0022;) <span class="math"> ⇒</span> &#x0022;Twenty-three losers.&#x0022;</td></tr></table>
      <!--l. 5988--><p class="noindent" >
</div>
</div>
      <!--l. 5990--><p class="noindent" >Here are some examples of the use of ~̂ within a ~&#x003C; construct.
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~15&#x003C;~S~;~̂~S~;~̂~S~&#x003E;&#x0022; &#x2019;foo)
</td></tr></table>
      <!--l. 5992--><p class="noindent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        <span class="math"> ⇒</span> &#x0022;            FOO&#x0022;</td></tr></table>
      <!--l. 5993--><p class="noindent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~15&#x003C;~S~;~̂~S~;~̂~S~&#x003E;&#x0022; &#x2019;foo &#x2019;bar)</td></tr></table>
      <!--l. 5994--><p class="noindent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        <span class="math"> ⇒</span> &#x0022;FOO         BAR&#x0022;</td></tr></table>
      <!--l. 5995--><p class="noindent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(format <a 
href="clmse31.html#x42-74002r18">nil</a> &#x0022;~15&#x003C;~S~;~̂~S~;~̂~S~&#x003E;&#x0022; &#x2019;foo &#x2019;bar &#x2019;baz)</td></tr></table>
      <!--l. 5996--><p class="noindent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        <span class="math"> ⇒</span> &#x0022;FOO   BAR   BAZ&#x0022;</td></tr></table>
      <!--l. 5998--><p class="noindent" >
</div>
</div>
      </ul>
</div>
<div class=obsolete>
<div class=incompatibility>
<!--l. 6003--><p class="noindent" ><b>Compatibility note:</b> The ~Q directive and user-deﬁned directives of Zetalisp have
been omitted here, as well as control lists (as opposed to strings), which are rumored to
be changing in meaning.
</div>
</div>
<div class=new>
<!--l. 6012--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx139-263028"></a>to introduce user-deﬁned directives in the form of
the ~/.../ directive. See section <a 
href="clmse142.html#x174-35700027.4">27.4<!--tex4ht:ref: PPRINT-FORMAT-DIRECTIVES-SECTION --></a> for details.
</div>
                                                                          

                                                                          
<div class=new>
<!--l. 6019--><p class="indent" >   The hairiest <a 
href="#x139-263003r687">format</a> control string I have ever seen in shown in table <a 
href="#x139-2630298">22.8<!--tex4ht:ref: XAPPING-FORMAT-TABLE --></a>. It
started innocently enough as part of the simulator for Connection Machine Lisp
<span class="cite">[<a 
href="clmli5.html#XCONNECTION-MACHINE-LISP">44</a>, <a 
href="clmli5.html#XCMLISP-IMPLEMENTATION">57</a>]</span>; the <i>xapping</i> data type, deﬁned by <a 
href="clmse99.html#x123-227002r580">defstruct</a>, needed a :print-function
option so that xappings would print properly. As this data type became more
complicated, step by step, so did the <a 
href="#x139-263003r687">format</a> control string.
</div> <div class="table">
                                                                          

                                                                          
<!--l. 6027--><p class="indent" >   <a 
 id="x139-2630298"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
 <div class="caption" 
><span class="id">Table 22.8: </span><span  
class="content">Print Function for the Xapping Data Type</span></div><!--tex4ht:label?: x139-2630298 -->
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun print-xapping (xapping stream depth)
</td></tr></table>
<!--l. 6033--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (ignore depth))</td></tr></table>
<!--l. 6034--><p class="noindent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (format stream</td></tr></table>
<!--l. 6035--><p class="noindent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          ;; Are you ready for this one?</td></tr></table>
<!--l. 6036--><p class="noindent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          &#x0022;~:[{~;[~]~:{~S~:[<span class="math"> ⇒</span>~S~;~*~]~:̂ ~}~:[~; ~]~</td></tr></table>
<!--l. 6037--><p class="noindent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           ~{~S<span class="math"> ⇒</span>~̂ ~}~:[~; ~]~[~*~;<span class="math"> ⇒</span>~S~;<span class="math"> ⇒</span>~*~]~:[}~;]~]&#x0022;</td></tr></table>
<!--l. 6038--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          ;; Is that clear?</td></tr></table>
<!--l. 6039--><p class="noindent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (xectorp xapping)</td></tr></table>
<!--l. 6040--><p class="noindent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (do ((vp (xectorp xapping))</td></tr></table>
<!--l. 6041--><p class="noindent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (sp (ﬁnite-part-is-xetp xapping))</td></tr></table>
<!--l. 6042--><p class="noindent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (d (xapping-domain xapping) (cdr d))</td></tr></table>
<!--l. 6043--><p class="noindent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (r (xapping-range xapping) (cdr r))</td></tr></table>
<!--l. 6044--><p class="noindent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (z &#x2019;() (cons (list (if vp (car r) (car d))</td></tr></table>
<!--l. 6045--><p class="noindent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                  (or vp sp)</td></tr></table>
<!--l. 6046--><p class="noindent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                  (car r))</td></tr></table>
<!--l. 6047--><p class="noindent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                            z)))</td></tr></table>
<!--l. 6048--><p class="noindent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              ((null d) (reverse z)))</td></tr></table>
<!--l. 6049--><p class="noindent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (and (xapping-domain xapping)</td></tr></table>
<!--l. 6050--><p class="noindent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (or (xapping-exceptions xapping)</td></tr></table>
<!--l. 6051--><p class="noindent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   (xapping-inﬁnite xapping)))</td></tr></table>
<!--l. 6052--><p class="noindent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (xapping-exceptions xapping)</td></tr></table>
<!--l. 6053--><p class="noindent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (and (xapping-exceptions xapping)</td></tr></table>
<!--l. 6054--><p class="noindent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (xapping-inﬁnite xapping))</td></tr></table>
<!--l. 6055--><p class="noindent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (ecase (xapping-inﬁnite xapping)</td></tr></table>
<!--l. 6056--><p class="noindent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            ((nil) 0)</td></tr></table>
<!--l. 6057--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (:constant 1)</td></tr></table>
<!--l. 6058--><p class="noindent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (:universal 2))</td></tr></table>
<!--l. 6059--><p class="noindent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (xapping-default xapping)</td></tr></table>
<!--l. 6060--><p class="noindent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (xectorp xapping)))</td></tr></table>
<!--l. 6062--><p class="noindent" >
</div>
</div>
See section <a 
href="clmse110.html#x137-25300022.1.5">22.1.5<!--tex4ht:ref: READTABLE-SECTION --></a> for the <a 
href="clmse99.html#x123-227002r580">defstruct</a> deﬁnition of the xapping data type, whose
accessor functions are used in this code.
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
<div class=new>
<!--l. 6069--><p class="indent" >   See the description of <a 
href="clmse110.html#x137-253014r635">set-macro-character</a> for a discussion of xappings and the
<a 
href="clmse99.html#x123-227002r580">defstruct</a> deﬁnition. Assume that the predicate xectorp is true of a xapping if it is
a xector, and that the predicate ﬁnite-part-is-xetp is true if every value in the
range is the same as its corresponding index.
<!--l. 6074--><p class="indent" >   Here is a blow-by-blow description of the parts of this format string:
</div>
<div class="flushleft" 
>
<!--l. 6077--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" >~:[{~;[~]                          </td><td align="left" ><!--l. 6080--><p class="noindent" >Print “[” for a xector, and “{” otherwise.</td>
</tr><tr><td align="left" >~:{~S~:[<span class="math"> ⇒</span>~S~;~*~]~:̂ ~} </td><td align="left" ><!--l. 6082--><p class="noindent" >Given a list of lists, print the pairs. Each
sublist has three elements: the index (or
the value if we&#x2019;re printing a xector); a
ﬂag that is true for either a xector or xet
(in which case no arrow is printed); and
the value. Note the use of ~:{ to iterate,
and the use of ~:̂ to avoid printing a
separating space after the ﬁnal pair (or
at all, if there are no pairs).               </td>
</tr><tr><td align="left" >~:[~; ~]                           </td><td align="left" ><!--l. 6089--><p class="noindent" >If   there   were   pairs   and   there   are
exceptions  or  an  inﬁnite  part,  print  a
separating space.                              </td>
</tr><tr><td align="left" >~<span class="math">⟨</span>newline<span class="math">⟩</span>          </td><td align="left" ><!--l. 6091--><p class="noindent" >Do  nothing.  This  merely  allows  the
format control string to be broken across
two lines.                                        </td>
</tr><tr><td align="left" >~{~S<span class="math"> ⇒</span>~̂ ~}                  </td><td align="left" ><!--l. 6093--><p class="noindent" >Given a list of exception indices, print
them.  Note  the  use  of  ~{  to  iterate,
and  the  use  of  ~̂  to  avoid  printing
a   separating   space   after   the   ﬁnal
exception  (or  at  all,  if  there  are  no
exceptions).                                    </td>
</tr><tr><td align="left" >~:[~; ~]                           </td><td align="left" ><!--l. 6098--><p class="noindent" >If there were exceptions and there is an
inﬁnite part, print a separating space.  </td>
</tr><tr><td align="left" >~[~*~;<span class="math"> ⇒</span>~S~;<span class="math"> ⇒</span>~*~]        </td><td align="left" ><!--l. 6100--><p class="noindent" >Use ~[ to choose one of three cases for
printing the inﬁnite part.                   </td>
</tr><tr><td align="left" >~:[}~;]~]                          </td><td align="left" ><!--l. 6102--><p class="noindent" >Print “]” for a xector, and “}” otherwise.</td></tr></table>
</div></div>
                                                                          

                                                                          
                                                                          

                                                                          
   <!--l. 6106--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse113.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse111.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse111.html#tailclmse111.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse112.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch22.html#clmse112.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 6106--><p class="indent" >   <a 
 id="tailclmse112.html"></a>  
</body></html> 
