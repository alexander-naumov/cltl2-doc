<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>14 Sequences</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-02-20 00:42:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 6--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse81.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse80.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse80.html#tailclmse80.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmch14.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clm.html#clmch14.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter 14</span><br /><a 
 id="x99-14100014"></a>Sequences</h2>
<!--l. 9--><p class="noindent" >The type <i>sequence</i> encompasses both lists and vectors (one-dimensional arrays).
While these are diﬀerent data structures with diﬀerent structural properties
leading to diﬀerent algorithmic uses, they do have a common property: each
contains an ordered set of elements. Note that <i>nil</i> is considered to be a sequence
of length zero.
<!--l. 16--><p class="indent" >   Some operations are useful on both lists and arrays because they deal with
ordered sets of elements. One may ask the number of elements, reverse the
ordering, extract a subsequence, and so on. For such purposes Common Lisp
provides a set of generic functions on sequences.
<div class=new>
<!--l. 22--><p class="indent" >   Note that this remark, predating the design of the Common Lisp Object
System, uses the term “generic” in a generic sense, and not necessarily in the
technical sense used by CLOS (see chapter <a 
href="clmch2.html#x9-150002">2<!--tex4ht:ref: DTYPES --></a>).
</div>
<div class="flushleft" 
>
<!--l. 28--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" >elt         </td><td align="left" >reverse      </td><td align="left" >map      </td><td align="left" >remove              </td>
</tr><tr><td align="left" >length    </td><td align="left" >nreverse     </td><td align="left" >some     </td><td align="left" >remove-duplicates</td>
</tr><tr><td align="left" >subseq   </td><td align="left" >concatenate</td><td align="left" >every    </td><td align="left" >delete                </td>
</tr><tr><td align="left" >copy-seq </td><td align="left" >position     </td><td align="left" >notany  </td><td align="left" >delete-duplicates  </td>
</tr><tr><td align="left" >ﬁll         </td><td align="left" >ﬁnd           </td><td align="left" >notevery</td><td align="left" >substitute          </td>
</tr><tr><td align="left" >replace   </td><td align="left" >sort          </td><td align="left" >reduce   </td><td align="left" >nsubstitute         </td>
</tr><tr><td align="left" >count     </td><td align="left" >merge        </td><td align="left" >search   </td><td align="left" >mismatch           </td></tr></table></div></div>
<!--l. 40--><p class="noindent" >Some of these operations come in more than one version. Such versions are indicated
by adding a suﬃx (or occasionally a preﬁx) to the basic name of the operation. In
addition, many operations accept one or more optional keyword arguments that
can modify the operation in various ways.
<!--l. 46--><p class="indent" >   If the operation requires testing sequence elements according to some
criterion, then the criterion may be speciﬁed in one of two ways. The basic
operation accepts an item, and elements are tested for being <i>eql</i> to that
item. (A test other than <i>eql</i> can be speciﬁed by the <i>:test</i> or <i>:test-not</i>
keyword. It is an error to use both of these keywords in the same call.) The
variants formed by adding <i>-if </i> and <i>-if-not</i> to the basic operation name do
not take an item, but instead a one-argument predicate, and elements
are tested for satisfying or not satisfying the predicate. As an example, <div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove item sequence)
</td></tr></table>
<!--l. 60--><p class="indent" >
</div>
</div>
<!--l. 61--><p class="noindent" >returns a copy of sequence from which all elements <i>eql</i> to item have been removed; <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove item sequence <i>:test</i> #&#x2019;equal)
</td></tr></table>
<!--l. 65--><p class="indent" >
</div>
</div>
<!--l. 66--><p class="noindent" >returns a copy of sequence from which all elements <i>equal</i> to item have been removed; <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-if #&#x2019;numberp sequence)
</td></tr></table>
<!--l. 70--><p class="indent" >
</div>
</div>
<!--l. 71--><p class="noindent" >returns a copy of sequence from which all numbers have been removed.
<!--l. 73--><p class="indent" >   If an operation tests elements of a sequence in any manner, the keyword
argument <i>:key</i>, if not <i>nil</i>, should be a function of one argument that will extract
from an element the part to be tested in place of the whole element. For example,
the eﬀect of the MacLisp expression <i>(assq item seq)</i> could be obtained by <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ﬁnd item sequence <i>:test</i> #&#x2019;eq <i>:key</i> #&#x2019;car)
</td></tr></table>
<!--l. 81--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
<!--l. 82--><p class="noindent" >This searches for the ﬁrst element of sequence whose car is <i>eq</i> to item. <div class=newer> X3J13 voted
in June 1988 ⟨<b>?</b>⟩ to allow the <i>:key</i> function to be only of type <i>symbol</i> or <i>function</i>;
a lambda-expression is no longer acceptable as a functional argument. One must
use the <i>function</i> special form or the abbreviation <i>#&#x2019;</i> before a lambda-expression
that appears as an explicit argument form.
</div>
<!--l. 92--><p class="indent" >   For some operations it can be useful to specify the direction in which the
sequence is conceptually processed. In this case the basic operation normally
processes the sequence in the forward direction, and processing in the reverse
direction is indicated by a non-<i>nil</i> value for the keyword argument <i>:from-end</i>.
(The processing order speciﬁed by the <i>:from-end</i> is purely conceptual. Depending
on the object to be processed and on the implementation, the actual processing
order may be diﬀerent. For this reason a user-supplied test function should be free
of side eﬀects.)
<!--l. 102--><p class="indent" >   Many operations allow the speciﬁcation of a subsequence to be operated upon.
Such operations have keyword arguments called <i>:start</i> and <i>:end</i>. These arguments
should be integer indices into the sequence, with start ≤ end (it is an error if
start &#x003E; end). They indicate the subsequence starting with and including element
start and up to but excluding element end. The length of the subsequence is
therefore end − start. If start is omitted, it defaults to zero; and if end
is omitted or <i>nil</i>, it defaults to the length of the sequence. Therefore
if both start and end are omitted, the entire sequence is processed by
default. For the most part, subsequence speciﬁcation is permitted purely for
the sake of eﬃciency; one could simply call <i>subseq</i> instead to extract the
subsequence before operating on it. Note, however, that operations that calculate
indices return indices into the original sequence, not into the subsequence: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(position #<tt>\</tt>b &#x0022;foobar&#x0022; <i>:start</i> 2 <i>:end</i> 5)  ⇒ 3
</td></tr></table>
<!--l. 121--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(position #<tt>\</tt>b (subseq &#x0022;foobar&#x0022; 2 5))  ⇒ 1</td></tr></table>
<!--l. 123--><p class="indent" >
</div>
</div>
<!--l. 124--><p class="noindent" >If two sequences are involved, then the keyword arguments <i>:start1</i>, <i>:end1</i>,
<i>:start2</i>, and <i>:end2</i> are used to specify separate subsequences for each
sequence.
                                                                          

                                                                          
<div class=newer>
<!--l. 130--><p class="indent" >   X3J13 voted in June 1988 ⟨<b>?</b>⟩ (and further clariﬁcation was voted in
January 1989 ⟨<b>?</b>⟩) to specify that these rules apply not only to all built-in
functions that have keyword parameters named <i>:start</i>, <i>:start1</i>, <i>:start2</i>, <i>:end</i>,
<i>:end1</i>, or <i>:end2</i> but also to functions such as <i>subseq</i> that take required
or optional parameters that are documented as being named start or
end.
      <ul class="itemize1">
      <li class="itemize">A “start” argument must always be a non-negative integer and defaults
      to zero if not supplied; it is not permissible to pass <i>nil</i> as a “start”
      argument.
      </li>
      <li class="itemize">An “end” argument must be either a non-negative integer or <i>nil</i> (which
      indicates the end of the sequence) and defaults to <i>nil</i> if not supplied;
      therefore supplying <i>nil</i> is equivalent to not supplying such an argument.
      </li>
      <li class="itemize">If the “end”  argument is an integer, it must be no greater than the
      active length of the corresponding sequence (as returned by the function
      <i>length</i>).
      </li>
      <li class="itemize">The default value for the “end”  argument is the active length of the
      corresponding sequence.
      </li>
      <li class="itemize">The “start” value (after defaulting, if necessary) must not be greater
      than the corresponding “end” value (after defaulting, if necessary).</li></ul>
<!--l. 156--><p class="noindent" >This may be summarized as follows. Let x be the sequence within which indices
are to be considered. Let s be the “start” argument for that sequence of
any standard function, whether explicitly speciﬁed or defaulted, through
omission, to zero. Let e be the “end” argument for that sequence of any
standard function, whether explicitly speciﬁed or defaulted, through omission
or an explicitly passed <i>nil</i> value, to the active length of x, as returned
by <i>length</i>. Then it is an error if the test <i>(&#x003C;= 0 s e (length x))</i> is not
true.
</div>
                                                                          

                                                                          
<!--l. 168--><p class="indent" >   For some functions, notably <i>remove</i> and <i>delete</i>, the keyword argument <i>:count</i>
is used to specify how many occurrences of the item should be aﬀected. If this is
<i>nil</i> or is not supplied, all matching items are aﬀected.
<!--l. 173--><p class="indent" >   In the following function descriptions, an element x of a sequence “satisﬁes the
test” if any of the following holds:
      <ul class="itemize1">
      <li class="itemize">A basic function was called, testfn was speciﬁed by the keyword <i>:test</i>,
      and <i>(funcall testfn item (keyfn x))</i> is true.
      </li>
      <li class="itemize">A  basic  function  was  called,  testfn  was  speciﬁed  by  the  keyword
      <i>:test-not</i>, and <i>(funcall testfn item (keyfn x))</i> is false.
      </li>
      <li class="itemize">An <i>-if </i> function was called, and <i>(funcall predicate (keyfn x))</i> is true.
      </li>
      <li class="itemize">An <i>-if-not</i> function was called, and <i>(funcall predicate (keyfn x))</i> is false.</li></ul>
<!--l. 194--><p class="noindent" >In each case keyfn is the value of the <i>:key</i> keyword argument (the default being the
identity function). See, for example, <i>remove</i>.
<!--l. 198--><p class="indent" >   In the following function descriptions, two elements x and y taken from
sequences “match” if either of the following holds:
      <ul class="itemize1">
      <li class="itemize">testfn was speciﬁed by the keyword <i>:test</i>, and <i>(funcall testfn (keyfn x)
      (keyfn y))</i> is true.
      </li>
      <li class="itemize">testfn was speciﬁed by the keyword <i>:test-not</i>, and <i>(funcall testfn (keyfn
      x) (keyfn y))</i> is false.</li></ul>
<!--l. 210--><p class="noindent" >See, for example, <i>search</i>.
<div class=newer>
<!--l. 213--><p class="indent" >   X3J13 voted in June 1988 ⟨<b>?</b>⟩ to allow the testfn or <i>predicate</i> to be only of
type <i>symbol</i> or <i>function</i>; a lambda-expression is no longer acceptable as
a functional argument. One must use the <i>function</i> special form or the
abbreviation <i>#&#x2019;</i> before a lambda-expression that appears as an explicit argument
form.
</div>
                                                                          

                                                                          
<!--l. 221--><p class="indent" >   You may depend on the order in which arguments are given to testfn; this
permits the use of non-commutative test functions in a predictable manner. The
order of the arguments to testfn corresponds to the order in which those
arguments (or the sequences containing those arguments) were given to the
sequence function in question. If a sequence function gives two elements from the
same sequence argument to testfn, they are given in the same order in which they
appear in the sequence.
<!--l. 232--><p class="indent" >   Whenever a sequence function must construct and return a new vector, it
always returns a simple vector (see section <a 
href="clmse7.html#x14-290002.5">2.5<!--tex4ht:ref: ARRAY-TYPE-SECTION --></a>). Similarly, any strings constructed
will be simple strings.
<div class=new>
<!--l. 238--><p class="indent" >   X3J13 voted in January 1989 ⟨<b>?</b>⟩ to deprecate the use of <i>:test-not</i> keyword
arguments and <i>-if-not</i> functions. This means that these features are very likely to
be retained in the forthcoming standard but are regarded as candidates for
removal in a future revision of the ANSI standard. X3J13 also voted in January
1989 ⟨<b>?</b>⟩ to add the <i>complement</i> function, intended to reduce or eliminate the
need for these deprecated features. Time will tell. I note that many features in
Fortran have been deprecated but very few indeed have actually been removed or
altered incompatibly.
<div class=defun>
<!--l. 251--><p class="noindent" > <i>[Function]</i>   <b>complement</b> <a 
 id="dx99-141001"></a><a 
 id="x99-141002r397"></a>   <i>fn</i>
<!--l. 253--><p class="noindent" >Returns a function whose value is the same as that of <i>not</i> applied to the result of
applying the function fn to the same arguments. One could deﬁne <i>complement</i> as
follows: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun complement (fn)
</td></tr></table>
<!--l. 258--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  #&#x2019;(lambda (&#x0026;rest arguments)</td></tr></table>
<!--l. 259--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (not (apply fn arguments))))</td></tr></table>
<!--l. 261--><p class="indent" >
</div>
</div>
<!--l. 263--><p class="indent" >   One intended use of <i>complement</i> is to supplant the use of <i>:test-not</i> arguments
and <i>-if-not</i> functions. <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-if-not #&#x2019;virtuous senators)  ≡
</td></tr></table>
                                                                          

                                                                          
<!--l. 266--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (remove-if (complement #&#x2019;virtuous) senators)</td></tr></table>
<!--l. 267--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 268--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-duplicates telephone-book</td></tr></table>
<!--l. 269--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   :test-not #&#x2019;mismatch)  ≡</td></tr></table>
<!--l. 270--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (remove-duplicates telephone-book</td></tr></table>
<!--l. 271--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      :test (complement #&#x2019;mismatch))</td></tr></table>
<!--l. 273--><p class="indent" >
</div>
</div>
</div>
</div>
   <div class="sectionTOCS">
    <span class="sectionToc" >14.1 <a 
href="clmse81.html#x100-14200014.1">Simple Sequence Functions</a></span>
<br />    <span class="sectionToc" >14.2 <a 
href="clmse82.html#x101-14300014.2">Concatenating, Mapping, and Reducing Sequences</a></span>
<br />    <span class="sectionToc" >14.3 <a 
href="clmse83.html#x102-14400014.3">Modifying Sequences</a></span>
<br />    <span class="sectionToc" >14.4 <a 
href="clmse84.html#x103-14500014.4">Searching Sequences for Items</a></span>
<br />    <span class="sectionToc" >14.5 <a 
href="clmse85.html#x104-14600014.5">Sorting and Merging</a></span>
   </div>




                                                                          

                                                                          
   <!--l. 6--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse81.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse80.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse80.html#tailclmse80.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch14.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clm.html#clmch14.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 6--><p class="indent" >   <a 
 id="tailclmch14.html"></a>  
</body></html> 
