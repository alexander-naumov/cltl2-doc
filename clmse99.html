<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Changing the Dimensions of an Array</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-02-20 00:42:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 821--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch18.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse98.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse98.html#tailclmse98.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse99.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#clmse99.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">17.6   </span> <a 
 id="x121-16300017.6"></a>Changing the Dimensions of an Array</h3>
<!--l. 823--><p class="noindent" >This function may be used to resize or reshape an array. Its options are similar to
those of <i>make-array</i>.
<div class=defun>
<!--l. 826--><p class="noindent" > <i>[Function]</i>   <b>adjust-array</b> <a 
 id="dx121-163001"></a><a 
 id="x121-163002r591"></a>   <i>array</i>  <i>new-dimensions</i>  <b>&#x0026;key</b>  :element-type
:initial-element  :initial-contents  :ﬁll-pointer  :displaced-to  :displaced-index-oﬀset
<!--l. 828--><p class="noindent" ><i>adjust-array</i> takes an array and a number of other arguments as for <i>make-array</i>.
The number of dimensions speciﬁed by new-dimensions must equal the rank of
array.
<i>
<!--l. 833--><p class="indent" >   adjust-array</i> returns an array of the same type and rank as array, with the
speciﬁed new-dimensions. In eﬀect, the array argument itself is modiﬁed to
conform to the new speciﬁcations, but this may be achieved either by modifying
the array or by creating a new array and modifying the array argument to be
displaced to the new array.
<!--l. 840--><p class="indent" >   In the simplest case, one speciﬁes only the new-dimensions and possibly
an <i>:initial-element</i> argument. Those elements of array that are still in
bounds appear in the new array. The elements of the new array that are
not in the bounds of array are initialized to the <i>:initial-element</i>; if this
argument is not provided, then the initial contents of any new elements are
undeﬁned.
<!--l. 848--><p class="indent" >   If <i>:element-type</i> is speciﬁed, then array must be such that it could have
been originally created with that type; otherwise an error is signaled.
Specifying <i>:element-type</i> to <i>adjust-array</i> serves only to require such an error
check.
<!--l. 853--><p class="indent" >   If <i>:initial-contents</i> or <i>:displaced-to</i> is speciﬁed, then it is treated as for
<i>make-array</i>. In this case none of the original contents of array appears in the new
array.
<!--l. 858--><p class="indent" >   If <i>:ﬁll-pointer</i> is speciﬁed, the ﬁll pointer of the array is reset as speciﬁed. An
error is signaled if array had no ﬁll pointer already.
<div class=new>
                                                                          

                                                                          
<!--l. 863--><p class="indent" >   X3J13 voted in June 1988 ⟨<b>?</b>⟩ to clarify the treatment of the <i>:ﬁll-pointer</i>
argument as follows.
<!--l. 868--><p class="indent" >   If the <i>:ﬁll-pointer</i> argument is not supplied, then the ﬁll pointer of the array is
left alone. It is an error to try to adjust the array to a total size that is smaller
than its ﬁll pointer.
<!--l. 873--><p class="indent" >   If the <i>:ﬁll-pointer</i> argument is supplied, then its value must be either an
integer, <i>t</i>, or <i>nil</i>. If it is an integer, then it is the new value for the ﬁll
pointer; it must be non-negative and no greater than the new size to
which the array is being adjusted. If it is <i>t</i>, then the ﬁll pointer is set
equal to the new size for the array. If it is <i>nil</i>, then the ﬁll pointer is
left alone; it is as if the argument had not been supplied. Again, it is an
error to try to adjust the array to a total size that is smaller than its ﬁll
pointer.
<!--l. 885--><p class="indent" >   An error is signaled if a non-<i>nil</i> <i>:ﬁll-pointer</i> value is supplied and the array to
be adjusted does not already have a ﬁll pointer.
<!--l. 889--><p class="indent" >   This extended treatment of the <i>:ﬁll-pointer</i> argument to <i>adjust-array</i> is
consistent with the previously existing treatment of the <i>:ﬁll-pointer</i> argument to
<i>make-array</i>.
</div>
<i>
<!--l. 894--><p class="indent" >   adjust-array</i> may, depending on the implementation and the arguments,
simply alter the given array or create and return a new one. In the latter case the
given array will be altered so as to be displaced to the new array and have the
given new dimensions.
<div class=obsolete>
<!--l. 900--><p class="indent" >   It is not permitted to call <i>adjust-array</i> on an array that was not created with
the <i>:adjustable</i> option. The predicate <i>adjustable-array-p</i> may be used to determine
whether or not an array is adjustable.
</div>
<div class=newer>
<!--l. 907--><p class="indent" >   X3J13 voted in January 1989 ⟨<b>?</b>⟩ to allow <i>adjust-array</i> to be applied to any
array. If <i>adjust-array</i> is applied to an array that was originally created with
<i>:adjustable</i> true, the array returned is <i>eq</i> to its ﬁrst argument. It is not speciﬁed
whether <i>adjust-array</i> returns an array <i>eq</i> to its ﬁrst argument for any other
arrays. If the array returned by <i>adjust-array</i> is not <i>eq</i> to its ﬁrst argument,
the original array is unchanged and does not share storage with the new
array.
<!--l. 918--><p class="indent" >   Under this new deﬁnition, it is wise to treat <i>adjust-array</i> in the same manner
                                                                          

                                                                          
as <i>delete</i> and <i>nconc</i>: one should carefully retain the returned value, for example
by writing <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq my-array (adjust-array my-array ...))
</td></tr></table>
<!--l. 923--><p class="indent" >
</div>
</div>
<!--l. 924--><p class="noindent" >rather than relying solely on a side eﬀect.
</div>
<!--l. 927--><p class="indent" >   If <i>adjust-array</i> is applied to an array that is displaced to another array x, then
afterwards neither array nor the returned result is displaced to x unless such
displacement is explicitly re-speciﬁed in the call to <i>adjust-array</i>.
<!--l. 932--><p class="indent" >   For example, suppose that the 4-by-4 array <i>m</i> looks like this: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#2A( ( alpha     beta      gamma     delta )
</td></tr></table>
<!--l. 934--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     ( epsilon   zeta      eta       theta )</td></tr></table>
<!--l. 935--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     ( iota      kappa     lambda    mu    )</td></tr></table>
<!--l. 936--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     ( nu        xi        omicron   pi    ) )</td></tr></table>
<!--l. 938--><p class="indent" >
</div>
</div>
<!--l. 939--><p class="noindent" >Then the result of <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(adjust-array m &#x2019;(3 5) :initial-element &#x2019;baz)
</td></tr></table>
<!--l. 942--><p class="indent" >
</div>
</div>
<!--l. 943--><p class="noindent" >is a 3-by-5 array with contents <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#2A( ( alpha     beta      gamma     delta     baz )
</td></tr></table>
<!--l. 945--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     ( epsilon   zeta      eta       theta     baz )</td></tr></table>
<!--l. 946--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     ( iota      kappa     lambda    mu        baz ) )</td></tr></table>
<!--l. 948--><p class="indent" >
</div>
</div>
<!--l. 949--><p class="noindent" >Note that if array <i>a</i> is created displaced to array <i>b</i> and subsequently array <i>b</i> is given
to <i>adjust-array</i>, array <i>a</i> will still be displaced to array <i>b</i>; the eﬀects of this
displacement and the rule of row-major storage order must be taken into
account.
<div class=newer>
<!--l. 955--><p class="indent" >   X3J13 voted in June 1988 ⟨<b>?</b>⟩ to clarify the interaction of <i>adjust-array</i> with
array displacement.
<!--l. 958--><p class="indent" >   Suppose that an array A is to be adjusted. There are four cases according to
whether or not A was displaced before adjustment and whether or not the result
is displaced after adjustment.
      <ul class="itemize1">
      <li class="itemize">Suppose A is not displaced either before or after. The dimensions of A
      are altered, and the contents are rearranged as appropriate. Additional
      elements of A are taken from the <i>:initial-element</i> argument. However,
      the use of the <i>:initial-contents</i> argument causes all old contents to be
      discarded.
      </li>
      <li class="itemize">Suppose A is not displaced before, but is displaced to array C after.
      None of the original contents of A appears in A afterwards; A now
      contains (some of) the contents of C, without any rearrangement of C.
      </li>
      <li class="itemize">Suppose A is displaced to array B before the call, and is displaced to
      array C after the call. (Note that B and C may be the same array.)
      The contents of B do not appear in A afterwards (unless such contents
      also happen to be in C, as when B and C are the same, for example).
      If <i>:displaced-index-oﬀset</i> is not speciﬁed in the call to <i>adjust-array</i>, it
      defaults to zero; the old oﬀset (into B) is not retained.
      </li>
                                                                          

                                                                          
      <li class="itemize">Suppose A is displaced to array B before the call, but is not displaced
      afterwards.  In  this  case  A gets  a  new  “data  region”  and  (some  of)
      the contents of B are copied into it as appropriate to maintain the
      existing  old  contents.  Additional  elements  of  A are  taken  from  the
      <i>:initial-element</i> argument.  However,  the  use  of  the  <i>:initial-contents</i>
      argument causes all old contents to be discarded.</li></ul>
<!--l. 998--><p class="indent" >   If array X is displaced to array Y, and array Y is displaced to array Z, and
array Y is altered by <i>adjust-array</i>, array X must now refer to the adjusted
contents of Y. This means that an implementation may not collapse the chain to
make X refer to Z directly and forget that the chain of reference passes through
array Y. (Caching techniques are of course permitted, as long as they preserve the
semantics speciﬁed here.)
<!--l. 1006--><p class="indent" >   If X is displaced to Y, it is an error to adjust Y in such a way that it no longer
has enough elements to satisfy X. This error may be signaled at the time of the
adjustment, but this is not required.
<!--l. 1010--><p class="indent" >   Note that omitting the <i>:displaced-to</i> argument to <i>adjust-array</i> is equivalent to
specifying <i>:displaced-to nil</i>; in either case, the array is not displaced after the call
regardless of whether it was displaced before the call.
</div>
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
   <!--l. 5--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch18.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse98.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse98.html#tailclmse98.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse99.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#clmse99.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 5--><p class="indent" >   <a 
 id="tailclmse99.html"></a>  
</body></html> 
