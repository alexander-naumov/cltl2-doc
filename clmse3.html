<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Числа</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-06 02:11:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 1821--><p class="noindent" > <div id="main_container"> <div id="content"> <!--l. 1821--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse4.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html#tailclmch2.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse3.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html#clmse3.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">2.1   </span> <a 
href="clm.html#QQ2-10-23" id="x10-180002.1">Числа</a></h3>
<!--l. 1823--><p class="noindent" >В Common Lisp&#x2019;е определены некоторые виды чисел. Они подразделяются
на <i>целочисленные (integer)</i>; <i>дробные (ratios)</i>; <i>с плавающей точкой
(ﬂoating-point)</i> с четырьмя видами представления, <i>действительные (real)</i> и
<i>комплексные</i>.
<!--l. 1829--><p class="indent" >   Числовой (<tt>number</tt>) тип данных захватывает все числовые типы. Также
для удобства предоставлены имена для некоторых числовых подтипов.
Целые числа и дроби принадлежат к <i>рациональному</i>. Рациональные числа и
с плавающей точкой к <i>действительному</i>. Действительные и комплексные к
<i>числовому (number)</i> типу.
<!--l. 1835--><p class="indent" >   Несмотря на то, что эти типы выбирались из математической терминологии,
соответствие не всегда полное. Модель целочисленных (integers) и дробных
(ratios) типов полностью совпадает с математической. Числа с <i>плавающей
точкой (ﬂoat)</i> могут использоваться для аппроксимации действительных
(real) чисел: рациональных (rational) и иррациональных (irrational).
<i>Действительный (real)</i> тип включает все Common Lisp числа, которые
отображают действительные (real) математические числа, однако для
математических иррациональных (irrational) аналогии в Cоmmon Lisp&#x2019;е нет.
Только <i>действительные (real)</i> числа могут быть отсортированы с помощью
функций <tt><a 
href="clmse62.html#x79-176006r175">&#x003C;</a></tt>, <tt><a 
href="clmse62.html#x79-176008r176">&#x003E;</a></tt>, <tt><a 
href="clmse62.html#x79-176010r177">&#x003C;=</a></tt> и <tt><a 
href="clmse62.html#x79-176012r178">&#x003E;=</a></tt>. (Ох жеш FIXME).
<!--l. 1847--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1.1   </span> <a 
href="clmli1.html#QQ2-10-24" id="x10-190002.1.1">Целые числа</a></h4>
<a 
 id="dx10-19001"></a>
<i>
<!--l. 1851--><p class="noindent" >Целочисленный</i> тип данных предназначен для отображения математических
целых чисел. В отличие от большинства языков программирования, Common
Lisp принципиально не навязывает ограничений на величину целого числа.
Место для хранения больших чисел выделяется автоматически по мере
необходимости.
                                                                          

                                                                          
<!--l. 1858--><p class="indent" >   В каждой реализации Common Lisp&#x2019;а есть интервал целых чисел, которые
хранятся более оптимально, чем другие. Каждое такое число называется
<i>ﬁxnum</i>, и число не являющееся ﬁxnum&#x2019;ом называется <i>bignum</i>. Common Lisp
спроектирован так, чтобы скрыть различие настолько, насколько это
возможно. Различие между ﬁxnums и bignums видимо пользователю, только в
тех местах, где важна эффективность работы алгоритма. Какие числа
являются ﬁxnums зависит от реализации; обычно это числа в интервале от
<span class="math"> − 2<sup>n</sup></span> to <span class="math">2<sup>n</sup> − 1</span>, включительно, для некоторого <i>n</i> не меньше 15. См.
<tt><a 
href="clmse69.html#x86-187002r284">most-positive-fixnum</a></tt> и <tt><a 
href="clmse69.html#x86-187004r285">most-negative-fixnum</a></tt>.
<tt>
<!--l. 1869--><p class="indent" >   fixnum</tt> должен быть супертипом для типа (signed-byte 16)
, и в дополнение к этому, значения <tt><a 
href="clmse87.html#x109-213006r503">array-dimension-limit</a></tt> должны
принадлежать ﬁxnum (разработчики должны выбрать интервал ﬁxnum,
чтобы в него можно было включить наибольшее число поддерживаемых
измерений для массивов). <div class=rationale>
<!--l. 1875--><p class="noindent" ><b>Обоснование:</b> Эта спецификация позволяет программистам объявлять
переменные в переносимом коде типа <tt>fixnum</tt> для эффективности. Fixnums
гарантированно заключают в себе множество знаковых 16-битных чисел чисел (это
сравнимо с типом данных short int
в языке программирования C). В дополнение к всему, любой корректный индекс
массива должен быть ﬁxnum, и в таком случае переменные, которые хранят
индексы массива (например переменная в <tt><a 
href="clmse41.html#x53-122002r94">dotimes</a></tt>) могут быть объявлены как
<tt>fixnum</tt> в переносимом коде.
</div>
<!--l. 1888--><p class="indent" >   Целые числа обычно записываются в десятичном виде, как
последовательность десятичных цифр опционально с предшествующим
знаком и опционально с последующей точкой. Например: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                              </td><td  
class="tabbing">0       ;Нуль
</td></tr></table>
<!--l. 1893--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                             </td><td  
class="tabbing">-0       ;Это <i>всегда</i> значит то же, что и 0</td></tr></table>
<!--l. 1894--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                            </td><td  
class="tabbing">+6       ;Первое совершенное число</td></tr></table>
<!--l. 1895--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                             </td><td  
class="tabbing">28       ;Второе совершенное число</td></tr></table>
<!--l. 1896--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                          </td><td  
class="tabbing">1024.       ;Два в десятой степени</td></tr></table>
<!--l. 1897--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                             </td><td  
class="tabbing">-1       ;<span class="math">e<sup>πi</sup></span></td></tr></table>
<!--l. 1898--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing"> </td><td  
class="tabbing">15511210043330985984000000.       ;факториал от 25 (25!), скорее все bignum</td></tr></table>
<!--l. 1901--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 1903--><p class="indent" >   Целые числа могут быть представлены с основаниями отличными от
десяти. Синтаксис: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#<i>nn</i>r<i>ddddd</i> or #<i>nn</i>R<i>ddddd</i>
</td></tr></table>
<!--l. 1907--><p class="indent" >
</div>
</div>
<!--l. 1908--><p class="noindent" >означает, что целое число с основанием <i>nn</i> определённое с помощью цифр и букв
<i>ddddd</i>. Более точное описание: символ #
, не пустая последовательность десятичных цифр представляющих десятичное
число <i>n</i>, <tt>r</tt> (или <tt>R</tt>), опционально знак + или -, и последовательность цифр для
заданной системы счисления (система счисления должна быть между 2 и 36,
включительно). Для заданной системы счисления могут использоваться для
задания числа только корректные символы. Например для восьмеричного
числа могут использоваться только цифры от 0 до 7 включительно. Для
систем счисления больших десятичной, могут использоваться буквы
алфавита в любом регистре в алфавитном порядке. Двоичные, восьмеричные
и шестнадцатеричные основания можно использовать с помощью следующих
аббревиатур: #b
для #2r
, #o
для #8r
, #x
для #16r
. Например: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing"></td><td  
class="tabbing">#2r11010101      ;Другой способ определения числа 213
</td></tr></table>
<!--l. 1925--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing"></td><td  
class="tabbing">#b11010101      ;то же самое</td></tr></table>
<!--l. 1926--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing"></td><td  
class="tabbing">#b+11010101      ;то же самое</td></tr></table>
<!--l. 1927--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">      </td><td  
class="tabbing">#o235       ;То же самое, в восьмеричной системе</td></tr></table>
<!--l. 1928--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">      </td><td  
class="tabbing">#xD5       ;То же самое, в шестнадцатеричной системе</td></tr></table>
<!--l. 1929--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">  </td><td  
class="tabbing">#16r+D5       ;То же самое</td></tr></table>
                                                                          

                                                                          
<!--l. 1930--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">     </td><td  
class="tabbing">#o-300       ;Десятичное число -192, записанное восьмеричным числом</td></tr></table>
<!--l. 1931--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">  </td><td  
class="tabbing">#3r-21010       ;То же самое, в троичное системе счисления</td></tr></table>
<!--l. 1932--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">   </td><td  
class="tabbing">#25R-7H       ;То же самое с основанием 25</td></tr></table>
<!--l. 1933--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing"></td><td  
class="tabbing">#xACCEDED      ;181202413, в шестнадцатеричной системе</td></tr></table>
<!--l. 1935--><p class="indent" >
</div>
</div>
<!--l. 1937--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1.2   </span> <a 
href="clmli1.html#QQ2-10-25" id="x10-200002.1.2">Дробные числа</a></h4>
<a 
 id="dx10-20001"></a>
<a 
 id="dx10-20002"></a>
<i>
<!--l. 1941--><p class="noindent" >Дробное число</i> — это число отображающее математическое отношение между
двумя целыми числами. Целые и дробные числа вместе составляют тип
рациональных (rational) чисел. Образцовое отображение дробных чисел - это
целое число, если значение целое, в противном случае это отношение двух
целых чисел, <i>числителя</i> и <i>знаменателя</i>, наибольший общий делитель
которых единица, в котором знаменатель положителен (и фактически
больший чем единица, иначе дробь является целым числом). Дробь
записывается с помощью разделителя <tt><a 
href="clmse104.html#x129-237016r575">/</a></tt>, так: 3/5
. Есть возможность использовать нестандартную запись такую, как
4/6
, но Lisp функция prin1
всегда выводит дробь в стандартной форме.
<!--l. 1953--><p class="indent" >   Если какое-либо вычисление привело к результату, являющемуся дробью
двух целых чисел, где знаменатель делит числитель нацело, тогда результат
немедленно преобразуется в эквивалентное целое число. Это называется
правилом <i>канонизации дробей</i>.
<!--l. 1958--><p class="indent" >   Дробные числа могут быть записаны так: опционально знак + или -, за
ним следуют две не пустые последовательности цифр разделённых с
помощью <tt><a 
href="clmse104.html#x129-237016r575">/</a></tt> . Такой синтаксис может быть описан так:
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>ratio</i> ::=  [<i><i>sign</i></i>]  {<i><i>digit</i></i>}+  <tt><a 
href="clmse104.html#x129-237016r575">/</a></tt> {<i><i>digit</i></i>}+
</td></tr></table>
<!--l. 1964--><p class="indent" >
</div>
<!--l. 1966--><p class="indent" >   Вторая последовательность не может состоять только из нулей.
Например: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">2/3                 ;Это каноническая запись
</td></tr></table>
<!--l. 1969--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">4/6                 ;Это неканоническая запись предыдущего числа</td></tr></table>
<!--l. 1970--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">-17/23              ;Не очень интересная дробь</td></tr></table>
<!--l. 1971--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">-30517578125/32768  ;Это <span class="math">(−5∕12)<sup>15</sup></span></td></tr></table>
<!--l. 1972--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">10/5                ;Это каноническая запись для 2</td></tr></table>
<!--l. 1974--><p class="indent" >
</div>
</div>
<!--l. 1976--><p class="indent" >   Для задания дробей в системе счисления отличной от десятичной,
необходимо использовать спецификатор основания (один из #<i>nn</i>R
, #O
, #B
или #X
) как и для целых чисел. Например:
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#o-101/75         ;Восьмеричная запись для -65/61
</td></tr></table>
<!--l. 1981--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#3r120/21         ;Третичная запись для 15/7</td></tr></table>
<!--l. 1982--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#Xbc/ad           ;Шестнадцатеричная запись для 188/173</td></tr></table>
<!--l. 1983--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#xFADED/FACADE    ;Шестнадцатеричная запись для 1027565/16435934</td></tr></table>
<!--l. 1985--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
<!--l. 1987--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1.3   </span> <a 
href="clmli1.html#QQ2-10-26" id="x10-210002.1.3">Числа с плавающей точкой</a></h4>
<!--l. 1989--><p class="noindent" >Common Lisp позволяет реализации содержать один и более типов чисел с
плавающей точкой, которые все вместе составляют тип <tt><a 
href="clmse65.html#x82-183002r214">float</a></tt>. Число с
плавающей точкой является (математически) рациональным числом формы
<span class="math"><i>s</i> ⋅<i>f</i> ⋅<i>b</i><sup>e−p</sup></span>, где <i>s</i> <span class="math"> + 1</span> или <span class="math"> − 1</span>, является <i>знаком</i>; <i>b</i> целое число большее 1,
является <i>основанием</i> для представления; <i>p</i> положительное целое, является
<i>точностью</i> (количество цифр по основанию <i>b</i>) числа с плавающей точкой; <i>f </i>
положительное целое между <span class="math"><i>b</i><sup>p−1</sup></span> и <span class="math"><i>b</i><sup>p</sup> − 1</span> (включительно), является
мантиссой; и <i>e</i> целое число, является экспонентой. Значение <i>p</i> и интервал <i>e</i>
зависит от реализации, также может быть «минус ноль». Если «минус ноль»
отсутствует, тогда 0.0
и -0.0
оба интерпретируются, как ноль с плавающей точкой.
<!--l. 2005--><p class="indent" >   В зависимости от реализации числа с плавающей точкой могут
предоставляться с различными точностями и размерами. Высококачественные
программы с вычислениями с плавающей точкой зависят от того, какая
предоставлена точность, и не всегда могут быть полностью переносимы. Для
содействия по умеренной переносимости программ, сделаны следующие
определения:
      <ul class="itemize1">
      <li class="itemize"><i>Короткий</i>  тип  числа  с  плавающей  точкой  (тип  <tt>short-float</tt>)
      является  представлением  числа  с  наименьшей  фиксированной
      точностью, предоставляемого реализацией.
      </li>
      <li class="itemize"><i>Длинный</i>  тип  числа  с  плавающей  точкой  (тип  <tt>long-float</tt>)
      является  представлением  числа  с  наибольшей  фиксированной
      точностью, предоставляемого реализацией.
      </li>
      <li class="itemize">Промежуточными   форматами   между   коротким   и   длинным
      форматами является два других формата, называемых <i>одинарный</i>
      и <i>двойной</i> (типы <tt>single-float</tt> и <tt>double-float</tt>).</li></ul>
<!--l. 2025--><p class="indent" >   Определение точности для этих категорий зависит от реализации. Однако,
примерная цель такая, что короткий тип с плавающий точкой должен
содержать точность как минимум 4 позиции после запятой (и также
                                                                          

                                                                          
должен иметь эффективное представление в памяти); одинарный
тип с плавающей точкой — как минимум 7 знаков после запятой;
двойной тип с плавающей точкой — как минимум 14 знаков после
запятой. Предполагается, что размер точности (измеряется в битах
и рассчитывается как <span class="math">p log <sub>2</sub>b</span>) и экспоненты (измеряется в битах и
рассчитывается как логарифм с основанием 2 от (1 плюс максимальное
значение экспоненты) должен быть как минимум таким же большим как
значения из таблицы <a 
href="#x10-210011">2.1<!--tex4ht:ref: Floating-Format-Requirements-Table --></a>.
   <div class="table">
                                                                          

                                                                          
<!--l. 2036--><p class="indent" >   <a 
 id="x10-210011"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
 <div class="caption" 
><span class="id">Table 2.1: </span><span  
class="content">Рекомендуемый размер для точности и экспоненты для типа
с плавающей точкой</span></div><!--tex4ht:label?: x10-210011 -->
<div class="tabular"><table width="100%"><tr><td align="left" >Формат    </td><td align="left" >Минимальная точность   </td><td align="left" >Минимальный размер экспоненты</td>
</tr><tr><td align="left" >Короткое  </td><td align="left" >13 бит                           </td><td align="left" >5 бит                                        </td>
</tr><tr><td align="left" >Одинарное</td><td align="left" >24 бит                           </td><td align="left" >8 бит                                        </td>
</tr><tr><td align="left" >Двойное    </td><td align="left" >50 бит                           </td><td align="left" >8 бит                                        </td>
</tr><tr><td align="left" >Длинное   </td><td align="left" >50 бит                           </td><td align="left" >8 бит                                        </td></tr></table></div>
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
<!--l. 2048--><p class="indent" >   Числа с плавающей точкой записываются в двух формах десятичной
дробью и компьютеризированной научной записью: необязательный знак,
затем не пустая последовательность цифр с встроенной точкой, затем
необязательная часть определения экспоненты. Если определения экспоненты
нет, тогда требуется точка, и после неё должны быть цифры. Определение
экспоненты составляется из маркера экспоненты, необязательного знака и
негустой последовательности цифр. Для ясности приведена БНФ для записи
чисел с плавающей точкой.
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:257;" 
class="tabbing"><i>число-с-плавающей-точкой</i> ::= </td><td  
class="tabbing"> [<i><i>знак</i></i>]  {<i><i>цифра</i></i>}*  точка {<i><i>цифра</i></i>}+  [<i><i>экспонента</i></i>]
</td></tr></table>
<!--l. 2060--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:257;" 
class="tabbing">                                            </td><td  
class="tabbing">|  [<i>знак</i>]  {<i><i>цифра</i></i>}+  [<i><i>точка</i>  {<i><i>цифра</i></i>}*</i>]  экспонента</td></tr></table>
<!--l. 2063--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>знак</i> ::= <tt><a 
href="clmse104.html#x129-237002r568">+</a></tt> | <tt><a 
href="clmse104.html#x129-237008r571">-</a></tt></td></tr></table>
<!--l. 2064--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>точка</i> ::= .</td></tr></table>
<!--l. 2065--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>цифра</i> ::= 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9</td></tr></table>
<!--l. 2067--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>экспонента</i> ::= <i>маркер-экспоненты</i> [<i><i>знак</i></i>]  {<i><i>цифра</i></i>}+ </td></tr></table>
<!--l. 2068--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>маркер-экспоненты</i> ::= <tt>e</tt> | <tt>s</tt> | <tt>f</tt> | <tt>d</tt> | <tt>l</tt> | <tt>E</tt> | <tt>S</tt> | <tt>F</tt> | <tt>D</tt> | <tt>L</tt></td></tr></table>
<!--l. 2072--><p class="indent" >
</div>
<!--l. 2074--><p class="indent" >   Если определение экспоненты отсутствует или если используется маркер
экспоненты <tt>e</tt> (или <tt>E</tt>), тогда используемые формат точности не задан. Когда
такое представление считывается и конвертируется во внутренний формат
объекта числа с плавающей точкой, формат задаётся с помощью переменной
<tt>*read-default-float-format*</tt>; первоначальное значение данной переменной
<tt>single-float</tt>.
<!--l. 2081--><p class="indent" >   Буквы <tt>s</tt>, <tt>f</tt>, <tt>d</tt> и <tt>l</tt> (или их эквиваленты в верхнем регистре) явно
задают использование типа: <i>короткий</i>, <i>одинарный</i>, <i>двойной</i> и <i>длинный</i>,
соответственно.
<!--l. 2085--><p class="indent" >   Примеры чисел с плавающей точкой: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0.0                         ;Ноль с плавающей точкой в формате по умолчанию
</td></tr></table>
                                                                          

                                                                          
<!--l. 2087--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0E0                         ;Также ноль с плавающей точкой в формате по умолчанию</td></tr></table>
<!--l. 2088--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">-.0                         ;Это может быть нулём или минус нулём</td></tr></table>
<!--l. 2089--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                            ; в зависимости от реализации</td></tr></table>
<!--l. 2090--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0.                          ;<i>Целый</i> ноль, не с плавающей точкой!</td></tr></table>
<!--l. 2091--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0.0s0                       ;Ноль с плавающей точкой в <i>коротком</i> формате</td></tr></table>
<!--l. 2092--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0s0                         ;Также ноль с плавающей точкой в <i>коротком</i> формате</td></tr></table>
<!--l. 2093--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">3.1415926535897932384d0     ;Аппроксимация числе пи в <i>двойном</i> формате</td></tr></table>
<!--l. 2094--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">6.02E+23                    ;Число Авогадро в формате по умолчанию</td></tr></table>
<!--l. 2095--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">602E+21                     ;Также число Авогадро в формате по умолчанию</td></tr></table>
<!--l. 2096--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">3.010299957f-1              ;<span class="math"> log <sub>10</sub>2</span>, в <i>одинарном</i> формате</td></tr></table>
<!--l. 2097--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">-0.000000001s9              ;<span class="math">e<sup>πi</sup></span> в коротком формате</td></tr></table>
<!--l. 2099--><p class="indent" >
</div>
</div>
<!--l. 2101--><p class="indent" >   Внутренний формат, используемый для внешнего представления, зависит
только от маркера экспоненты и не зависит от количества знаков после
запятой во внешнем представлении.
<!--l. 2105--><p class="indent" >   Тогда как Common Lisp содержит терминологию и систему обозначений
для включения 4 различных типов чисел с плавающей точкой, не все
реализации будут иметь желание поддержки такого большого количества
типов. Реализации разрешается предоставлять меньшее, чем 4, количество
внутренних форматов чисел с плавающей точкой, в таком случае как
минимум один из этих типов будет «общим» для более одного внешнего
имени <i>короткого</i>, <i>одинарного</i>, <i>двойного</i> и <i>длинного</i> в соответствии со
следующими правилами:
      <ul class="itemize1">
      <li class="itemize">Если предоставляется один внутренний формат, то он рассматривается
      как <i>одинарный</i>, но также служит <i>коротким</i>, <i>двойным</i> и <i>длинным</i>. Типы
      данный <tt>short-float</tt>, <tt>single-float</tt>, <tt>double-float</tt> и <tt>long-float</tt>
      считаются идентичными. В этой реализации такое выражение, как (eql
      1.0s0 1.0d0)
      будет истинным, потому что два числа 1.0s0
      и 1.0d0
      будут конвертированы в один и тот же внутренний формат и таким
      образом будут считаться принадлежащим одному типу данных,
                                                                          

                                                                          
      несмотря на различный внешний синтаксис. В такой реализации и
      выражение (typep 1.0L0 &#x2019;short-float)
      будет истинным. В механизме вывода все числа с плавающей точкой
      будут выводится в <i>одинарном</i> формате, таким образом будет вывод
      экспоненты с буквой E
      или F
      .
      </li>
      <li class="itemize">Если предоставляется два внутренних формата, то может быть выбрано
      одно из двух соответствий, в зависимости от того, какое является более
      подходящим:
           <ul class="itemize2">
           <li class="itemize">Один формат является <i>коротким</i>, другой <i>длинным</i>, и они
           представлены и как <i>двойной</i> и <i>длинный</i>. Типы данных <tt>single-float</tt>,
           <tt>double-float</tt> и <tt>long-float</tt> считаются идентичными, но
           <tt>short-float</tt> от них отличается. Выражение, такое как (eql 1.0s0
           1.0d0)
           будет ложным, но (eql 1.0f0 1.0d0)
           будет истинным. Также и (typep 1.0L0 &#x2019;short-float)
           будет ложным, но (typep 1.0L0 &#x2019;single-float)
           будет истинным. В механизме вывода все числа с плавающей
           точкой считаются <i>короткими</i> или <i>одинарными</i>.
           </li>
           <li class="itemize">Одни формат <i>одинарный</i> и также представляет <i>короткий</i>. Другой
           формат <i>двойной</i> и также представляет <i>длинный</i>. Типы данных
           <tt>short-float</tt> и <tt>single-float</tt> считаются одинаковыми, и
           <tt>double-float</tt> и <tt>long-float</tt> считаются одинаковыми. Такое
           выражение, как (eql 1.0s0 1.0d0)
           будет ложным, так же как и (eql 1.0f0 1.0d0)
           , но (eql 1.0d0 1.0L0)
           будет положительным. Также (typep 1.0L0 &#x2019;short-float)
           будет ложным, но (typep 1.0L0 &#x2019;double-float)
           будет истинным. В механизме вывода все числа с плавающей
           точкой считаются <i>одинарными</i> или <i>двойными</i>.</li></ul>
      </li>
                                                                          

                                                                          
      <li class="itemize">Если предоставляется три внутренних формата, тогда может быть
      выбрано одно из двух соответствий, в зависимости от того, какое
      является более подходящим:
           <ul class="itemize2">
           <li class="itemize">Один формат <i>короткий</i>, другой <i>одинарный</i> и третий <i>двойной</i>
           и также рассматривается как <i>длинный</i>. Тогда применяются
           уже названные ограничения.
           </li>
           <li class="itemize">Один  формат  <i>одинарный</i>  и  также  рассматривается,  как
           <i>короткий</i>, другой формат <i>двойной</i> и третий <i>длинный</i>.</li></ul>
      </li></ul>
<div class=implementation>
<!--l. 2172--><p class="noindent" ><b>Заметка для реализации:</b> Рекомендуется предоставлять столько различных
типов чисел с плавающей точкой, сколько возможно, используя при этом
таблицу <a 
href="#x10-210011">2.1<!--tex4ht:ref: Floating-Format-Requirements-Table --></a> в качестве указаний. В идеальной ситуации, <i>короткий</i> формат числа с
плавающей точкой должен быть «быстрым», в частности, не требующим выделения
места в куче. <i>одинарный</i> должен приближаться к стандарту IEEE для одинарного
формата. <i>двойной</i> должен приближаться к стандарту IEEE для двойного формата.
<span class="cite">[?, ?, ?]</span>.
</div>
   <h4 class="subsectionHead"><span class="titlemark">2.1.4   </span> <a 
href="clmli1.html#QQ2-10-28" id="x10-220002.1.4">Комплексные числа</a></h4>
<!--l. 2186--><p class="noindent" >Комплексные числа (тип <tt><a 
href="clmse65.html#x82-183046r236">complex</a></tt>) представляются в алгебраической форме,
с действительной и мнимой частями, каждая из которых является не
комплексным числом (целым, дробным, или с плавающей точкой). Следует
отметить, что части комплексного числа не обязательно числа с плавающей
точкой; в это Common Lisp похож на PL/I и отличается от Fortran&#x2019;а. Однако
обе части должны быть одного типа: обе рациональные, или обе какого-либо
формата с плавающей точкой.
<!--l. 2194--><p class="indent" >   Комплексные числа могут быть обозначены с помощью записи символа
#C
с последующим списком действительной и мнимой частей. Если две части,
как было отмечено, не принадлежат одному типу, тогда они будут
преобразованы в соответствие с правилами преобразования чисел с
плавающей точкой описанными в главе <a 
href="clmch12.html#x76-17300012">12<!--tex4ht:ref: NUMBER --></a>.
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#C(3.0s1 2.0s-1)     ;Действительная и мнимая части в коротком формате
</td></tr></table>
<!--l. 2201--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#C(5 -3)             ;Целое Гаусса</td></tr></table>
<!--l. 2202--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#C(5/3 7.0)          ;Будет преобразовано в #C(1.66666 7.0)</td></tr></table>
<!--l. 2203--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#C(0 1)              ;Мнимая единица, <i>i</i></td></tr></table>
<!--l. 2205--><p class="indent" >
</div>
</div>
<!--l. 2207--><p class="indent" >   Тип заданного комплексного числа определяется с помощью списка:
слова <tt><a 
href="clmse65.html#x82-183046r236">complex</a></tt> и типа компонентов; например, специализированное
представление для комплексных чисел с частями принадлежащими
типу «короткое с плавающей точкой», будет выглядеть так (complex
short-float)
. Тип <tt><a 
href="clmse65.html#x82-183046r236">complex</a></tt> включает все представления комплексных типов.
<!--l. 2213--><p class="indent" >   Комплексное число типа (complex rational)
, в котором части принадлежат рациональному типу, никогда не может
содержать нулевую мнимую часть. Если в результате вычислений получится
комплексное число с нулевой мнимой частью, то данное число будет
автоматически конвертировано в не комплексное дробное число, равное
действительной часть исходного числа. Это называется правилом
<i>канонизации комплексного числа</i>. Данное правило не применяется для
комплексных чисел с плавающими точками, то есть #C(5.0 0.0)
и 5.0
различные числа.
                                                                          

                                                                          
   <!--l. 2222--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse4.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html#tailclmch2.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse3.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html#clmse3.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 2222--><p class="indent" >   <a 
 id="tailclmse3.html"></a>  </div> </div> 
</body></html> 
