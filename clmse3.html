<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Числа</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-19 00:40:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 2067--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse4.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html#tailclmch2.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse3.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html#clmse3.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">2.1   </span> <a 
 id="x10-180002.1"></a>Числа</h3>
<!--l. 2069--><p class="noindent" >В Common Lisp&#x2019;е определены некоторые виды чисел. Они подразделяются
на <i>целочисленные (integer)</i>; <i>дробные (ratios)</i>; <i>с плавающей точкой
(ﬂoating-point)</i>, с четырьмя видами представления и <i>комплексные</i>.
<div class=newer>
<!--l. 2075--><p class="indent" >   X3J13 проголосовал в марте 1989 <a 
 id="dx10-18001"></a>добавить тип real.
<!--l. 2077--><p class="indent" >   Числовой тип данных захватывает все числовые типы. Также для
удобства предоставлены имена для некоторых числовых подтипов. Целые
числа и дроби принадлежат к <i>рациональному</i>. Рациональные числа и с
плавающей точкой к <i>действительному</i>. Действительные и комплексные к
<i>числовому</i> типу.
<!--l. 2083--><p class="indent" >   Несмотря на то, что эти типы выбирались из математической терминологии,
соответствие не всегда полное. Модель целочисленных (integers) и
дробных (ratios) типов полностью совпадает с математической. Числа с
<i>плавающей точкой (ﬂoat)</i> могут использоваться для аппроксимации
действительных (real) чисел: рациональных (rational) и иррациональных
(irrational). <i>Действительный (real)</i> тип включает все Common Lisp числа,
которые отображают действительные (real) математические числа,
однако для математических иррациональных (irrational) аналогии
в Cоmmon Lisp&#x2019;е нет. Только <i>действительные (real)</i> числа могут
быть отсортированы с помощью функций <a 
href="clmse63.html#x80-177006r175">&#x003C;</a>, <a 
href="clmse63.html#x80-177008r176">&#x003E;</a>, <a 
href="clmse63.html#x80-177010r177">&#x003C;=</a> и <a 
href="clmse63.html#x80-177012r178">&#x003E;=</a>. (Ох жеш
FIXME).
                                                                          

                                                                          
<div class=incompatibility>
<!--l. 2096--><p class="noindent" ><b>Compatibility note:</b> Примечание о совместимости: стандарт Fortran 77 определяет
термин <i>действительное число</i>, как «аппроксимация значения действительного
числа». На практике Fortran&#x2019;овский <i>базовый действительный</i> тип соотносится с
числом плавающей точкой, которое в Common Lisp зовётся <i>single-ﬂoat</i>. Fortran тип
<i>с двойной точностью</i> является Common Lisp типом <i>double-ﬂoat</i>. Pascal&#x2019;евский
<i>действительный</i> тип данных является «платформозависимым подмножеством
действительных чисел». На практике это обычно тип с плавающей точкой, то, что в
Common Lisp&#x2019;е называется <i>double-ﬂoat</i>.
<!--l. 2107--><p class="indent" >   Трансляция алгоритмов, написанных на Фортране или Паскале, которые
используют <i>действительные</i> числа, обычно соответствует необходимой точности
для Common Lisp&#x2019;овых типов <i>с плавающей точкой</i> (ﬂoat). Некоторые алгоритмы
могут получить выигрыш или гибкость с использованием Common Lisp&#x2019;овых
<i>дробных (rational)</i> или <i>действительных (real)</i> типов.
</div>
</div>
<!--l. 2117--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1.1   </span> <a 
 id="x10-190002.1.1"></a>Целые числа</h4>
<a 
 id="dx10-19001"></a>
<i>
<!--l. 2121--><p class="noindent" >Целочисленный</i> тип данных предназначен для отображения математических
целых чисел. В отличие от большинства языков программирования, Common
Lisp принципиально не навязывает ограничений на величину целого числа;
место для хранения выделяется автоматически по мере необходимости для
отображения больших чисел.
<!--l. 2128--><p class="indent" >   В каждой реализации Common Lisp&#x2019;а есть интервал целых чисел, которые
хранятся более оптимально, чем другие; каждое такое число называется
<i>ﬁxnum</i>, и число не являющееся ﬁxnum называется <i>bignum</i>. Common Lisp
спроектирован так, чтобы скрыть различие так сильно, как это возможно;
различие между ﬁxnums и bignums видимо пользователю, только в тех
местах, где важна эффективность работы алгоритма. Какие числа
являются ﬁxnums зависит от реализации; обычно это числа в интервале от
<span class="math"> − 2<sup>n</sup></span> to <span class="math">2<sup>n</sup> − 1</span>, включительно, для некоторого n не меньше 15. См.
<a 
href="clmse70.html#x87-188002r284">most-positive-ﬁxnum</a> и <a 
href="clmse70.html#x87-188004r285">most-negative-ﬁxnum</a>.
<div class=new>
<!--l. 2140--><p class="indent" >   X3J13 проголосовал в январе 1989 <a 
 id="dx10-19002"></a>, что ﬁxnum должен быть
                                                                          

                                                                          
супертипом для типа (signed-byte 16), и в дополнение к этому, значения
<a 
href="clmse89.html#x111-215006r522">array-dimension-limit</a> должны принадлежать ﬁxnum (разработчики должны
выбрать интервал ﬁxnum, чтобы в него можно было включить наибольшее
число поддерживаемых измерений для массивов). <div class=rationale>
<!--l. 2148--><p class="noindent" ><b>Rationale:</b> Эта спецификация позволяет программистам объявлять переменные в
переносимом коде типа ﬁxnum для эффективности. Fixnums гарантированно
заключают в себе множество знаковых 16-битных чисел чисел (это сравнимо с
типом данных short int в языке программирования C). В дополнение к всему, любой
корректный индекс массива должен быть ﬁxnum, и в таком случае переменные,
которые хранят индексы массива (например переменная в <a 
href="clmse42.html#x54-123002r94">dotimes</a>) могут быть
объявлены как ﬁxnum в переносимом коде.
</div>
</div>
<!--l. 2162--><p class="indent" >   Целые числа обычно записываются в десятичном виде, как
последовательность десятичных цифр, опционально с предшествующим
знаком и опционально с последующей точкой. Например: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                              </td><td  
class="tabbing">0       ;Нуль
</td></tr></table>
<!--l. 2165--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                             </td><td  
class="tabbing">-0       ;Это <i>всегда</i> значит то же, что и 0</td></tr></table>
<!--l. 2166--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                            </td><td  
class="tabbing">+6       ;Первое совершенное число</td></tr></table>
<!--l. 2167--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                             </td><td  
class="tabbing">28       ;Второе совершенное число</td></tr></table>
<!--l. 2168--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                          </td><td  
class="tabbing">1024.       ;Два в десятой степени</td></tr></table>
<!--l. 2169--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing">                             </td><td  
class="tabbing">-1       ;<span class="math">e<sup>πi</sup></span></td></tr></table>
<!--l. 2170--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:297;" 
class="tabbing"> </td><td  
class="tabbing">15511210043330985984000000.       ;факториал от 25 (25!), скорее все bignum</td></tr></table>
<!--l. 2173--><p class="indent" >
</div>
</div>
<!--l. 2175--><p class="indent" >   Целые числа могут быть представлены с основаниями отличными от
десяти. Синтаксис: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#<i>nn</i>r<i>ddddd</i> or #<i>nn</i>R<i>ddddd</i>
</td></tr></table>
<!--l. 2179--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 2180--><p class="noindent" >означает, что целое число с основанием <i>nn</i> определённое с помощью цифр и букв
<i>ddddd</i>. Более точное описание: символ #, не пустая последовательность
десятичных цифр представляющих десятичное число <i>n</i>, r (или R),
опционально знак + или -, и последовательность цифр для заданной
системы счисления (система счисления должна быть между 2 и 36,
включительно). Только корректные символы для заданной системы
счисления могут использоваться для задания числа; например для
восьмеричного числа могут использоваться только цифры от 0 до 7
включительно. Для систем счисления больших десятичной, могут
использоваться буквы алфавита в любом регистре в алфавитном порядке.
Двоичные, восьмеричные и шестнадцатеричные основания можно
использовать с помощью следующих аббревиатур: #b для #2r, #o для #8r,
#x для #16r. Например:
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing"></td><td  
class="tabbing">#2r11010101      ;Другой способ определения числа 213
</td></tr></table>
<!--l. 2188--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing"></td><td  
class="tabbing">#b11010101      ;то же самое</td></tr></table>
<!--l. 2189--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing"></td><td  
class="tabbing">#b+11010101      ;то же самое</td></tr></table>
<!--l. 2190--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">      </td><td  
class="tabbing">#o235       ;То же самое, в восьмеричной системе</td></tr></table>
<!--l. 2191--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">      </td><td  
class="tabbing">#xD5       ;То же самое, в шестнадцатеричной системе</td></tr></table>
<!--l. 2192--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">  </td><td  
class="tabbing">#16r+D5       ;То же самое</td></tr></table>
<!--l. 2193--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">     </td><td  
class="tabbing">#o-300       ;Десятичное число -192, записанное восьмеричным числом</td></tr></table>
<!--l. 2194--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">  </td><td  
class="tabbing">#3r-21010       ;То же самое, в троичное системе счисления</td></tr></table>
<!--l. 2195--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing">   </td><td  
class="tabbing">#25R-7H       ;То же самое с основанием 25</td></tr></table>
<!--l. 2196--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:148;" 
class="tabbing"></td><td  
class="tabbing">#xACCEDED      ;181202413, в шестнадцатеричной системе</td></tr></table>
<!--l. 2198--><p class="indent" >
</div>
</div>
<!--l. 2200--><p class="noindent" >
                                                                          

                                                                          
   <h4 class="subsectionHead"><span class="titlemark">2.1.2   </span> <a 
 id="x10-200002.1.2"></a>Дробные числа</h4>
<a 
 id="dx10-20001"></a>
<a 
 id="dx10-20002"></a>
<i>
<!--l. 2204--><p class="noindent" >Дробное число</i> - это число отображающее математическое отношение между
двумя целыми числами. Целые и дробные числа вместе составляют тип
рациональных (rational) чисел. Образцовое отображение дробных чисел - это
целое число, если значение целое, в противном случае это отношение двух
целых чисел, <i>числителя</i> и <i>знаменателя</i>, наибольший общий делитель
которых единица, в котором знаменатель положителен (и фактически
больший чем единица, иначе дробь является целым числом). Дробь
записывается с помощью разделителя <a 
href="clmse106.html#x131-239016r594">/</a>, так: 3/5. Есть возможность
использовать нестандартную запись такую, как 4/6, но Lisp функция prin1
всегда выводит дробь в стандартной форме.
<!--l. 2216--><p class="indent" >   Если какое-либо вычисление привело к результату, являющемуся дробью
двух целых чисел, где знаменатель делит числитель нацело, тогда результат
немедленно преобразуется в эквивалентное целое число. Это называется
правилом <i>канонизации дробей</i>.
<!--l. 2221--><p class="indent" >   Дробные числа могут быть записаны так: опционально знак + или -, за
ним следуют две не пустые последовательности цифр разделённых с
помощью <a 
href="clmse106.html#x131-239016r594">/</a> . Такой синтаксис может быть описан так:
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>ratio</i> ::=  [<i><i>sign</i></i>]  {<i><i>digit</i></i>}+  <a 
href="clmse106.html#x131-239016r594">/</a>  {<i><i>digit</i></i>}+
</td></tr></table>
<!--l. 2227--><p class="indent" >
</div>
<!--l. 2229--><p class="indent" >   Вторая последовательность не может состоять только из нулей.
Например: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">2/3                 ;Это каноническая запись
</td></tr></table>
<!--l. 2232--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">4/6                 ;Это неканоническая запись предыдущего числа</td></tr></table>
<!--l. 2233--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">-17/23              ;Не очень интересная дробь</td></tr></table>
                                                                          

                                                                          
<!--l. 2234--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">-30517578125/32768  ;Это <span class="math">(−5∕12)<sup>15</sup></span></td></tr></table>
<!--l. 2235--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">10/5                ;Это каноническая запись для 2</td></tr></table>
<!--l. 2237--><p class="indent" >
</div>
</div>
<!--l. 2239--><p class="indent" >   Для задания дробей в системе счисления отличной от десятичной,
необходимо использовать спецификатор основания (один из #<i>nn</i>R, #O, #B
или #X) как и для целых чисел. Например:
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#o-101/75         ;Восьмеричная запись для -65/61
</td></tr></table>
<!--l. 2244--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#3r120/21         ;Третичная запись для 15/7</td></tr></table>
<!--l. 2245--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#Xbc/ad           ;Шестнадцатеричная запись для 188/173</td></tr></table>
<!--l. 2246--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#xFADED/FACADE    ;Шестнадцатеричная запись для 1027565/16435934</td></tr></table>
<!--l. 2248--><p class="indent" >
</div>
</div>
<!--l. 2250--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1.3   </span> <a 
 id="x10-210002.1.3"></a>Числа с плавающей точкой</h4>
<!--l. 2252--><p class="noindent" >Common Lisp позволяет реализации предоставлять один и более типов чисел
с плавающей точкой, которые все вместе составляют тип <a 
href="clmse66.html#x83-184002r214">ﬂoat</a>. Число с
плавающей точкой является (математически) рациональным числом формы
<span class="math"><i>s</i> ⋅<i>f</i> ⋅<i>b</i><sup>e−p</sup></span>, где <i>s</i> <span class="math"> + 1</span> или <span class="math"> − 1</span>, является <i>знаком</i>; <i>b</i> целое число большее 1,
является <i>основанием</i> для представления; <i>p</i> положительное целое, является
<i>точностью</i> (количество цифр по основанию <i>b</i>) числа с плавающей точкой; <i>f </i>
положительное целое между <span class="math"><i>b</i><sup>p−1</sup></span> и <span class="math"><i>b</i><sup>p</sup> − 1</span> (включительно), является
мантиссой; и <i>e</i> целое число, является экспонентой. Значение <i>p</i> и интервал <i>e</i>
зависит от реализации, также может быть «минус ноль». Если «минус ноль»
отсутствует, тогда 0.0 и -0.0 оба интерпретируются, как ноль с плавающей
точкой.
                                                                          

                                                                          
<!--l. 2268--><p class="indent" >   Числа с плавающей точкой могут предоставляться с различными
точностями и размерами, в зависимости от реализации. Высококачественные
программы с вычислениями с плавающей точкой зависят от того, какая
точность предоставляется, и не всегда могут быть полностью переносимы.
Для содействия по умеренной переносимости программ, сделаны следующие
определения:
      <ul class="itemize1">
      <li class="itemize"><i>Короткий</i> тип числа с плавающей точкой (тип short-ﬂoat) является
      представлением  числа  с  наименьшей  фиксированной  точностью,
      предоставляемого реализацией.
      </li>
      <li class="itemize"><i>Длинный</i> тип числа с плавающей точкой (тип long-ﬂoat) является
      представлением  числа  с  наибольшей  фиксированной  точностью,
      предоставляемого реализацией.
      </li>
      <li class="itemize">Промежуточными   форматами   между   коротким   и   длинным
      форматами является два других формата, называемых <i>одинарный</i>
      и <i>двойной</i> (типы single-ﬂoat и double-ﬂoat).</li></ul>
<!--l. 2288--><p class="indent" >   Определение точности для этих категорий зависит от реализации. Однако,
примерная цель, что короткий тип с плавающий точкой должен содержать
точность, как минимум 4 позиции после запятой (и также должен иметь
эффективное представление в памяти); одинарный тип с плавающей точкой –
как минимум 7 знаков после запятой; двойной тип с плавающей точкой – как
минимум 14 знаков после запятой. Предполагается, что размер точности
(измеряется в битах и рассчитывается как <span class="math">p log <sub>2</sub>b</span>) и экспоненты (измеряется
в битах и рассчитывается как логарифм с основанием 2 от (1 плюс
максимальное значение экспоненты) должен быть как минимум таким же
большим как значения из таблицы <a 
href="#x10-210011">2.1<!--tex4ht:ref: Floating-Format-Requirements-Table --></a>.
   <div class="table">
                                                                          

                                                                          
<!--l. 2298--><p class="indent" >   <a 
 id="x10-210011"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
 <div class="caption" 
><span class="id">Table 2.1: </span><span  
class="content">Рекомендуемый размер для точности и экспоненты для типа
с плавающей точкой</span></div><!--tex4ht:label?: x10-210011 -->
<div class="tabular"><table width="100%"><tr><td align="left" >Формат    </td><td align="left" >Минимальная точность   </td><td align="left" >Минимальный размер экспоненты</td>
</tr><tr><td align="left" >Короткое  </td><td align="left" >13 бит                           </td><td align="left" >5 бит                                        </td>
</tr><tr><td align="left" >Одинарное</td><td align="left" >24 бит                           </td><td align="left" >8 бит                                        </td>
</tr><tr><td align="left" >Двойное    </td><td align="left" >50 бит                           </td><td align="left" >8 бит                                        </td>
</tr><tr><td align="left" >Длинное   </td><td align="left" >50 бит                           </td><td align="left" >8 бит                                        </td></tr></table></div>
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
<!--l. 2310--><p class="indent" >   Числа с плавающей точкой записываются в двух формах десятичной
дробью и компьютеризированной научной записью: необязательный знак,
затем не пустая последовательность цифр с встроенной точкой, затем
необязательная часть определения экспоненты. Если определения экспоненты
нет, тогда требуется точка, и после неё должны быть цифры. Определение
экспоненты составляется из маркера экспоненты, необязательного знака и
негустой последовательности цифр. Для ясности приведена БНФ для записи
чисел с плавающей точкой.
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:257;" 
class="tabbing"><i>число-с-плавающей-точкой</i> ::= </td><td  
class="tabbing"> [<i><i>знак</i></i>]  {<i><i>цифра</i></i>}*  точка {<i><i>цифра</i></i>}+  [<i><i>экспонента</i></i>]
</td></tr></table>
<!--l. 2322--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:257;" 
class="tabbing">                                            </td><td  
class="tabbing">|  [<i>знак</i>]  {<i><i>цифра</i></i>}+  [<i><i>точка</i>  {<i><i>цифра</i></i>}*</i>]  экспонента</td></tr></table>
<!--l. 2325--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>знак</i> ::= <a 
href="clmse106.html#x131-239002r587">+</a> | <a 
href="clmse106.html#x131-239008r590">-</a></td></tr></table>
<!--l. 2326--><p class="indent" >                                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>точка</i> ::= .</td></tr></table>
<!--l. 2327--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>цифра</i> ::= 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9</td></tr></table>
<!--l. 2329--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>экспонента</i> ::= <i>маркер-экспоненты</i> [<i><i>знак</i></i>]  {<i><i>цифра</i></i>}+ </td></tr></table>
<!--l. 2330--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>маркер-экспоненты</i> ::= e | s | <a 
href="clmse146.html#x179-412004r863">f</a> | d | l | E | S | F | D | L</td></tr></table>
<!--l. 2334--><p class="indent" >
</div>
<!--l. 2336--><p class="indent" >   Если определение экспоненты отсутствует или если используется маркер
экспоненты e (или E), тогда используемые формат точности не задан. Когда
такое представление считывается и конвертируется во внутренний формат
объекта числа с плавающей точкой, формат задаётся с помощью переменной
*read-default-ﬂoat-format*; первоначальное значение данной переменной
single-ﬂoat.
<!--l. 2343--><p class="indent" >   Буквы s, <a 
href="clmse146.html#x179-412004r863">f</a>, d и l (или их эквиваленты в верхнем регистре) явно
задают использование типа: <i>короткий</i>, <i>одинарный</i>, <i>двойной</i> и <i>длинный</i>,
соответственно.
<!--l. 2347--><p class="indent" >   Примеры чисел с плавающей точкой: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0.0                         ;Ноль с плавающей точкой в формате по умолчанию
</td></tr></table>
                                                                          

                                                                          
<!--l. 2349--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0E0                         ;Также ноль с плавающей точкой в формате по умолчанию</td></tr></table>
<!--l. 2350--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">-.0                         ;Это может быть нулём или минус нулём</td></tr></table>
<!--l. 2351--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                            ; в зависимости от реализации</td></tr></table>
<!--l. 2352--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0.                          ;<i>Целый</i> ноль, не с плавающей точкой!</td></tr></table>
<!--l. 2353--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0.0s0                       ;Ноль с плавающей точкой в <i>коротком</i> формате</td></tr></table>
<!--l. 2354--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">0s0                         ;Также ноль с плавающей точкой в <i>коротком</i> формате</td></tr></table>
<!--l. 2355--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">3.1415926535897932384d0     ;Аппроксимация числе пи в <i>двойном</i> формате</td></tr></table>
<!--l. 2356--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">6.02E+23                    ;Число Авогадро в формате по умолчанию</td></tr></table>
<!--l. 2357--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">602E+21                     ;Также число Авогадро в формате по умолчанию</td></tr></table>
<!--l. 2358--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">3.010299957f-1              ;<span class="math"> log <sub>10</sub>2</span>, в <i>одинарном</i> формате</td></tr></table>
<!--l. 2359--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">-0.000000001s9              ;<span class="math">e<sup>πi</sup></span> в коротком формате</td></tr></table>
<!--l. 2361--><p class="indent" >
</div>
</div>
<!--l. 2363--><p class="indent" >   Внутренний формат, используемый для внешнего представления, зависит
только от маркера экспоненты и не зависит от количества знаков после
запятой во внешнем представлении.
<!--l. 2367--><p class="indent" >   Тогда как Common Lisp предоставляет терминологию и систему
обозначений для включения 4 различных типов чисел с плавающей точкой,
не все реализации будет иметь намерения для поддержки такого большого
количества типов. Реализации разрешается предоставлять меньшее, чем 4,
количество внутренних форматов чисел с плавающей точкой, в таком случае
как минимум один из этих типов будет «общим» для более одного внешнего
имени <i>короткого</i>, <i>одинарного</i>, <i>двойного</i> и <i>длинного</i> в соответствии со
следующими правилами:
      <ul class="itemize1">
      <li class="itemize">Если
      предоставляется один внутренний формат, то он рассматривается
      как <i>одинарные</i>, но также служит <i>коротким</i>, <i>двойным</i> и <i>длинным</i>.
      Типы   данный   short-ﬂoat,   single-ﬂoat,   double-ﬂoat   и   long-ﬂoat
      считаются идентичными. В такой реализации такое выражение,
      как  (eql  1.0s0  1.0d0)  будет  истинным,  потому  что  два  числа
      1.0s0 и 1.0d0 будут конвертированы в один и тот же внутренний
      формат и таким образом будут считаться принадлежащим одному
      типу  данных,  несмотря  на  различный  внешний  синтаксис.  В
                                                                          

                                                                          
      такой  реализации  и  выражение  (typep  1.0L0  &#x2019;short-ﬂoat)  будет
      истинным.  В  механизме  вывода  все  числа  с  плавающей  точкой
      будут выводится в <i>одинарном</i> формате, таким образом будет вывод
      экспоненты с буквой E или F.
      </li>
      <li class="itemize">Если предоставляется два внутренних формата, то может быть выбрано
      одно из двух соответствий, в зависимости от того, какое является более
      подходящим:
           <ul class="itemize2">
           <li class="itemize">Один  формат  является  <i>коротким</i>,  другой  <i>длинным</i>,  и  они
           представлены  и  как  <i>двойной</i>  и  <i>длинный</i>.  Типы  данных
           single-ﬂoat, double-ﬂoat и long-ﬂoat считаются идентичными,
           но  short-ﬂoat  от  них  отличается.  Выражение,  такое  как
           (eql  1.0s0  1.0d0)  будет  ложным,  но  (eql  1.0f0  1.0d0)  будет
           истинным. Также и (typep 1.0L0 &#x2019;short-ﬂoat) будет ложным,
           но  (typep  1.0L0  &#x2019;single-ﬂoat)  будет  истинным.  В  механизме
           вывода все числа с плавающей точкой считаются <i>короткими</i>
           или <i>одинарными</i>.
           </li>
           <li class="itemize">Одни  формат  <i>одинарный</i>  и  также  представляет  <i>короткий</i>.
           Другой  формат  <i>двойной</i>  и  также  представляет  <i>длинный</i>.
           Типы данных short-ﬂoat и single-ﬂoat считаются одинаковыми,
           и  double-ﬂoat  и  long-ﬂoat  считаются  одинаковыми.  Такое
           выражение, как (eql 1.0s0 1.0d0) будет ложным, так же как
           и (eql 1.0f0 1.0d0), но (eql 1.0d0 1.0L0) будет положительным.
           Также (typep 1.0L0 &#x2019;short-ﬂoat) будет ложным, но (typep 1.0L0
           &#x2019;double-ﬂoat) будет истинным. В механизме вывода все числа
           с плавающей точкой считаются <i>одинарными</i> или <i>двойными</i>.</li></ul>
      </li>
      <li class="itemize">Если предоставляется три внутренних формата, тогда может быть
      выбрано одно из двух соответствий, в зависимости от того, какое
      является более подходящим:
           <ul class="itemize2">
           <li class="itemize">Один формат <i>короткий</i>, другой <i>одинарный</i> и третий <i>двойной</i>
           и также рассматривается как <i>длинный</i>. Тогда применяются
                                                                          

                                                                          
           уже названные ограничения.
           </li>
           <li class="itemize">Один  формат  <i>одинарный</i>  и  также  рассматривается,  как
           <i>короткий</i>, другой формат <i>двойной</i> и третий <i>длинный</i>.</li></ul>
      </li></ul>
<div class=implementation>
<!--l. 2433--><p class="noindent" ><b>Implementation note:</b> Рекомендуется предоставлять столько различных типов
чисел с плавающей точкой, сколько возможно, используя при этом таблицу <a 
href="#x10-210011">2.1<!--tex4ht:ref: Floating-Format-Requirements-Table --></a> в
качестве указаний. В идеальной ситуации, <i>короткий</i> формат числа с плавающей
точкой должен быть представлен «быстрым», не требующим выделения места в
куче. <i>одинарный</i> должен приближаться к стандарту IEEE для одинарного
формата. <i>двойной</i> должен приближаться к стандарту IEEE для двойного формата.
<span class="cite">[<a 
href="clmli5.html#XIEEE-PROPOSED-FLOATING-POINT-STANDARD">23</a>, <a 
href="clmli5.html#XIEEE-FLOATING-POINT-IMPL-GUIDE">17</a>, <a 
href="clmli5.html#XIEEE-FLOATING-POINT-IMPL-GUIDE-ERRATA">16</a>]</span>.
</div>
   <h4 class="subsectionHead"><span class="titlemark">2.1.4   </span> <a 
 id="x10-220002.1.4"></a>Комплексные числа</h4>
<!--l. 2447--><p class="noindent" >Комплексные числа (тип <a 
href="clmse66.html#x83-184046r236">complex</a>) представляются в алгебраической форме, с
действительной и мнимой частями, каждая из которых является не
комплексным числом (целым, дробным, или с плавающей точкой). Следует
отметить, что части комплексного числа не обязательно числа с плавающей
точкой; в это Common Lisp похож на PL/I и отличается от Fortran&#x2019;а. Однако
обе части должны быть одного типа: обе рациональные, или обе какого-либо
формата с плавающей точкой.
<!--l. 2455--><p class="indent" >   Комплексные числа могут быть обозначены с помощью записи символа
#C с последующим списком действительной и мнимой частей. Если две
части, как было отмечено, не принадлежат одному типу, тогда они будут
преобразованы в соответствие с правилами преобразования чисел с
плавающей точкой описанными в главе <a 
href="clmch12.html#x77-17400012">12<!--tex4ht:ref: NUMBER --></a>.
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#C(3.0s1 2.0s-1)     ;Действительная и мнимая части в коротком формате
</td></tr></table>
<!--l. 2462--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#C(5 -3)             ;Целое Гаусса</td></tr></table>
                                                                          

                                                                          
<!--l. 2463--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#C(5/3 7.0)          ;Будет преобразовано в #C(1.66666 7.0)</td></tr></table>
<!--l. 2464--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">#C(0 1)              ;Мнимая единица, <i>i</i></td></tr></table>
<!--l. 2466--><p class="indent" >
</div>
</div>
<!--l. 2468--><p class="indent" >   Тип заданного комплексного числа определяется с помощью списка:
слова <a 
href="clmse66.html#x83-184046r236">complex</a> и типа компонентов; например, специализированное
представление для комплексных чисел с частями принадлежащими
типу короткое с плавающей точкой, будет выглядеть так (complex
short-ﬂoat). Тип <a 
href="clmse66.html#x83-184046r236">complex</a> включает все представления комплексных
типов.
<!--l. 2474--><p class="indent" >   Комплексное число типа (complex rational), в котором части принадлежат
дробному типу, никогда не может содержать нулевую мнимую часть. Если в
результате вычислений получится комплексное число с нулевой мнимой
частью, то данное число будет автоматически конвертировано в не
комплексное дробное число, равное действительной часть исходного числа.
Это называется правилом канонизации комплексного числа. Данное правило
не применяется для комплексных чисел с плавающими точками; #C(5.0 0.0)
и 5.0 различные числа.
                                                                          

                                                                          
   <!--l. 2482--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse4.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html#tailclmch2.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse3.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch2.html#clmse3.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 2482--><p class="indent" >   <a 
 id="tailclmse3.html"></a>  
</body></html> 
