<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Renaming, Deleting, and Other File Operations</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-06 23:16:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 2456--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse122.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse120.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse120.html#tailclmse120.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse121.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch23.html#clmse121.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">23.3   </span> <a 
 id="x149-101300023.3"></a>Renaming, Deleting, and Other File Operations</h3>
<!--l. 2458--><p class="noindent" >These functions provide a standard interface to operations provided in some form
by most ﬁle systems. It may be that some implementations of Common Lisp
cannot support them all completely.
<div class=defun>
<!--l. 2462--><p class="noindent" ><i>[Function]</i><a 
 id="dx149-1013001"></a><a 
 id="x149-1013002r770"></a><b> rename-ﬁle</b>  <i>ﬁle</i> <i>new-name</i>
<!--l. 2464--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-1014000770"></a></span>
   The speciﬁed ﬁle is renamed to new-name (which must be a ﬁle name). The
ﬁle may be a string, a pathname, or a stream. If it is an open stream associated
with a ﬁle, then the stream itself and the ﬁle associated with it are aﬀected (if the
ﬁle system permits).
<div class=new>
<!--l. 2471--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx149-1014001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse119.html#x147-72000023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<!--l. 2477--><p class="indent" >   <a 
href="#x149-736002r770">rename-ﬁle</a> returns three values if successful. The ﬁrst value is the new-name
with any missing components ﬁlled in by performing a <a 
href="clmse119.html#x147-723005r745">merge-pathnames</a>
operation using ﬁle as the defaults. The second value is the <a 
href="clmse119.html#x147-721005r743">truename</a> of the ﬁle
before it was renamed. The third value is the <a 
href="clmse119.html#x147-721005r743">truename</a> of the ﬁle after it was
renamed.
<!--l. 2483--><p class="indent" >   If the renaming operation is not successful, an error is signaled.
<div class=obsolete>
<!--l. 2486--><p class="indent" >   It is an error to specify a ﬁle name containing a :wild component, for ﬁle to
contain a <a 
href="clmse31.html#x42-86002r19">nil</a> component where the ﬁle system does not permit a <a 
href="clmse31.html#x42-86002r19">nil</a> component, or
for the result of defaulting missing components of new-name from ﬁle
to contain a <a 
href="clmse31.html#x42-86002r19">nil</a> component where the ﬁle system does not permit a <a 
href="clmse31.html#x42-86002r19">nil</a>
component.
</div> <div class=newer> X3J13 voted in June 1989 <a 
 id="dx149-1014002"></a>to specify that supplying a wild pathname as the ﬁle
argument to <a 
href="#x149-736002r770">rename-ﬁle</a> has implementation-dependent consequences; <a 
href="#x149-736002r770">rename-ﬁle</a>
might signal an error, for example, or might rename all ﬁles that match the wild
                                                                          

                                                                          
pathname.
</div>
<div class=newer>
<!--l. 2501--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx149-1014003"></a>to require <a 
href="#x149-736002r770">rename-ﬁle</a> to accept logical pathnames
(see section <a 
href="clmse119.html#x147-70800023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>).
</div>
<div class=incompatibility>
<!--l. 2506--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-101500023.3"></a></span>
   <b>Compatibility note:</b> This corresponds to the function called renamef in
MacLisp and Lisp Machine Lisp. The name renamef is not used in Common Lisp
because the convention that a trailing <a 
href="clmse151.html#x184-936004r906">f</a> means “ﬁle” conﬂicts with the use of a
trailing <a 
href="clmse151.html#x184-936004r906">f</a> for forms related to <a 
href="clmse36.html#x48-142002r66">setf</a>.
<!--l. 2513--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-101600023.3"></a>
<!--l. 2513--><p class="indent" >   </span>
   incompatibility
</div>
</div>
<div class=defun>
<!--l. 2517--><p class="noindent" ><i>[Function]</i><a 
 id="dx149-1016001"></a><a 
 id="x149-1016002r771"></a><b> delete-ﬁle</b>  <i>ﬁle</i>
<!--l. 2519--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-1017000771"></a></span>
   The speciﬁed ﬁle is deleted. The ﬁle may be a string, a pathname, or a stream.
If it is an open stream associated with a ﬁle, then the stream itself and the ﬁle
associated with it are aﬀected (if the ﬁle system permits), in which case the
stream may or may not be closed immediately, and the deletion may be
immediate or delayed until the stream is explicitly closed, depending on the
requirements of the ﬁle system.
<div class=new>
<!--l. 2529--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx149-1017001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse119.html#x147-72000023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<!--l. 2535--><p class="indent" >   <a 
href="#x149-737005r771">delete-ﬁle</a> returns a non-<a 
href="clmse31.html#x42-86002r19">nil</a> value if successful. It is left to the discretion of the
implementation whether an attempt to delete a non-existent ﬁle is considered
to be successful. If the deleting operation is not successful, an error is
                                                                          

                                                                          
signaled.
<div class=obsolete>
<!--l. 2541--><p class="indent" >   It is an error to specify a ﬁle name that contains a :wild component or one
that contains a <a 
href="clmse31.html#x42-86002r19">nil</a> component where the ﬁle system does not permit a <a 
href="clmse31.html#x42-86002r19">nil</a>
component.
</div> <div class=newer> X3J13 voted in June 1989 <a 
 id="dx149-1017002"></a>to clarify that supplying a wild pathname as the ﬁle
argument to <a 
href="#x149-737005r771">delete-ﬁle</a> has implementation-dependent consequences; <a 
href="#x149-737005r771">delete-ﬁle</a>
might signal an error, for example, or might delete all ﬁles that match the wild
pathname.
</div>
<div class=newer>
<!--l. 2554--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx149-1017003"></a>to require <a 
href="#x149-737005r771">delete-ﬁle</a> to accept logical pathnames
(see section <a 
href="clmse119.html#x147-70800023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>).
</div>
<div class=incompatibility>
<!--l. 2559--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-101800023.3"></a></span>
   <b>Compatibility note:</b> This corresponds to the function called deletef in
MacLisp and Lisp Machine Lisp.
<!--l. 2562--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-101900023.3"></a>
<!--l. 2562--><p class="indent" >   </span>
   incompatibility
</div>
</div>
<div class=defun>
<!--l. 2566--><p class="noindent" ><i>[Function]</i><a 
 id="dx149-1019001"></a><a 
 id="x149-1019002r772"></a><b> probe-ﬁle</b>  <i>ﬁle</i>
<!--l. 2568--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-1020000772"></a></span>
   This predicate is false if there is no ﬁle named ﬁle, and otherwise returns a
pathname that is the true name of the ﬁle (which may be diﬀerent from
ﬁle because of ﬁle links, version numbers, or other artifacts of the ﬁle
system). Note that if the ﬁle is an open stream associated with a ﬁle, then
<a 
href="#x149-738005r772">probe-ﬁle</a> cannot return <a 
href="clmse31.html#x42-86002r19">nil</a> but will produce the true name of the associated
ﬁle. See <a 
href="clmse119.html#x147-721005r743">truename</a> and the :probe value for the :direction argument to
<a 
href="clmse120.html#x148-733002r768">open</a>.
                                                                          

                                                                          
<div class=incompatibility>
<!--l. 2580--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-102100023.3"></a></span>
   <b>Compatibility note:</b> This corresponds to the function called probef in
MacLisp and Lisp Machine Lisp.
<!--l. 2583--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-102200023.3"></a>
<!--l. 2583--><p class="indent" >   </span>
   incompatibility
</div>
<div class=new>
<!--l. 2587--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx149-1022001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse119.html#x147-72000023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<div class=newer>
<!--l. 2594--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx149-1022002"></a>to clarify that <a 
href="#x149-738005r772">probe-ﬁle</a> accepts only non-wild
pathnames; an error is signaled if <a 
href="clmse119.html#x147-704003r733">wild-pathname-p</a> would be true of the ﬁle
argument.
</div>
<div class=newer>
<!--l. 2601--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx149-1022003"></a>to require <a 
href="#x149-738005r772">probe-ﬁle</a> to accept logical pathnames
(see section <a 
href="clmse119.html#x147-70800023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>). However, <a 
href="#x149-738005r772">probe-ﬁle</a> never returns a logical pathname.
</div>
<div class=new>
<!--l. 2607--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx149-1022004"></a>to specify that <a 
href="#x149-738005r772">probe-ﬁle</a> is unaﬀected by
whether the ﬁrst argument, if a stream, is open or closed. If the ﬁrst
argument is a stream, <a 
href="#x149-738005r772">probe-ﬁle</a> behaves as if the function <a 
href="clmse119.html#x147-720005r742">pathname</a>
were applied to the stream and the resulting pathname used instead.
However, X3J13 further commented that the treatment of open streams may
diﬀer considerably from one implementation to another; for example,
in some operating systems open ﬁles are written under a temporary or
invisible name and later renamed when closed. In general, programmers
writing code intended to be portable should be very careful when using
<a 
href="#x149-738005r772">probe-ﬁle</a>.
</div>
</div>
                                                                          

                                                                          
<div class=defun>
<!--l. 2621--><p class="noindent" ><i>[Function]</i><a 
 id="dx149-1022005"></a><a 
 id="x149-1022006r773"></a><b> ﬁle-write-date</b>  <i>ﬁle</i>
<!--l. 2623--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-1023000773"></a></span>
   ﬁle can be a ﬁle name or a stream that is open to a ﬁle. This returns the time
at which the ﬁle was created or last written as an integer in universal time format
(see section <a 
href="clmse130.html#x160-80200025.4.1">25.4.1<!--tex4ht:ref: TIME-SECTION --></a>), or <a 
href="clmse31.html#x42-86002r19">nil</a> if this cannot be determined.
<div class=new>
<!--l. 2631--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx149-1023001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse119.html#x147-72000023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<div class=newer>
<!--l. 2638--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx149-1023002"></a>to clarify that <a 
href="#x149-739006r773">ﬁle-write-date</a> accepts only non-wild
pathnames; an error is signaled if <a 
href="clmse119.html#x147-704003r733">wild-pathname-p</a> would be true of the ﬁle
argument.
</div>
<div class=newer>
<!--l. 2645--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx149-1023003"></a>to require <a 
href="#x149-739006r773">ﬁle-write-date</a> to accept logical
pathnames (see section <a 
href="clmse119.html#x147-70800023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 2650--><p class="noindent" ><i>[Function]</i><a 
 id="dx149-1023004"></a><a 
 id="x149-1023005r774"></a><b> ﬁle-author</b>  <i>ﬁle</i>
<!--l. 2652--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-1024000774"></a></span>
   ﬁle can be a ﬁle name or a stream that is open to a ﬁle. This returns
the name of the author of the ﬁle as a string, or <a 
href="clmse31.html#x42-86002r19">nil</a> if this cannot be
determined.
<div class=new>
<!--l. 2658--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx149-1024001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse119.html#x147-72000023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<div class=newer>
<!--l. 2665--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx149-1024002"></a>to clarify that <a 
href="#x149-740005r774">ﬁle-author</a> accepts only non-wild
pathnames; an error is signaled if <a 
href="clmse119.html#x147-704003r733">wild-pathname-p</a> would be true of the ﬁle
argument.
</div>
                                                                          

                                                                          
<div class=newer>
<!--l. 2672--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx149-1024003"></a>to require <a 
href="#x149-740005r774">ﬁle-author</a> to accept logical pathnames
(see section <a 
href="clmse119.html#x147-70800023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 2677--><p class="noindent" ><i>[Function]</i><a 
 id="dx149-1024004"></a><a 
 id="x149-1024005r775"></a><b> ﬁle-position</b>  <i>ﬁle-stream</i> &#x0026;optional  <i>position</i>
<!--l. 2679--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-1025000775"></a></span>
   <a 
href="#x149-741005r775">ﬁle-position</a> returns or sets the current position within a random-access
ﬁle.
<!--l. 2683--><p class="indent" >   (ﬁle-position ﬁle-stream) returns a non-negative integer indicating the current
position within the ﬁle-stream, or <a 
href="clmse31.html#x42-86002r19">nil</a> if this cannot be determined. The ﬁle
position at the start of a ﬁle will be zero. The value returned by <a 
href="#x149-741005r775">ﬁle-position</a>
increases monotonically as input or output operations are performed. For a
character ﬁle, performing a single <a 
href="clmse116.html#x143-669002r701">read-char</a> or <a 
href="clmse117.html#x144-686004r720">write-char</a> operation may cause the
ﬁle position to be increased by more than 1 because of character-set translations
(such as translating between the Common Lisp #\Newline character and an
external ASCII carriage-return/line-feed sequence) and other aspects of the
implementation. For a binary ﬁle, every <a 
href="clmse116.html#x143-678002r709">read-byte</a> or <a 
href="clmse117.html#x144-692002r729">write-byte</a> operation
increases the ﬁle position by 1.
<!--l. 2696--><p class="indent" >   (ﬁle-position ﬁle-stream position) sets the position within ﬁle-stream to be
position. The position may be an integer, or :start for the beginning of the stream,
or :end for the end of the stream. If the integer is too large or otherwise
inappropriate, an error is signaled (the <a 
href="#x149-742002r776">ﬁle-length</a> function returns the length
beyond which <a 
href="#x149-741005r775">ﬁle-position</a> may not access). An integer returned by <a 
href="#x149-741005r775">ﬁle-position</a> of
one argument should, in general, be acceptable as a second argument for use with
the same ﬁle. With two arguments, <a 
href="#x149-741005r775">ﬁle-position</a> returns <a 
href="clmse31.html#x42-87002r20">t</a> if the repositioning was
performed successfully, or <a 
href="clmse31.html#x42-86002r19">nil</a> if it was not (for example, because the ﬁle was not
random-access).
<div class=implementation>
<!--l. 2711--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-102600023.3"></a></span>
   <b>Implementation note:</b> Implementations that have character ﬁles represented
as a sequence of records of bounded size might choose to encode the ﬁle position
as, for example, record-number*256+character-within-record. This is a valid
                                                                          

                                                                          
encoding because it increases monotonically as each character is read
or written, though not necessarily by 1 at each step. An integer might
then be considered “inappropriate” as a second argument to <a 
href="#x149-741005r775">ﬁle-position</a>
if, when decoded into record number and character number, it turned
out that the speciﬁed record was too short for the speciﬁed character
number.
<!--l. 2722--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-102700023.3"></a>
<!--l. 2722--><p class="indent" >   </span>
   implementation
</div> <div class=incompatibility>
<!--l. 2724--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-102800023.3"></a></span>
   <b>Compatibility note:</b> This corresponds to the function called ﬁlepos in
MacLisp and Lisp Machine Lisp.
<!--l. 2727--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-102900023.3"></a>
<!--l. 2727--><p class="indent" >   </span>
   incompatibility
</div>
</div>
<div class=defun>
<!--l. 2731--><p class="noindent" ><i>[Function]</i><a 
 id="dx149-1029001"></a><a 
 id="x149-1029002r776"></a><b> ﬁle-length</b>  <i>ﬁle-stream</i>
<!--l. 2733--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-1030000776"></a></span>
   ﬁle-stream must be a stream that is open to a ﬁle. The length of the ﬁle is
returned as a non-negative integer, or <a 
href="clmse31.html#x42-86002r19">nil</a> if the length cannot be determined. For
a binary ﬁle, the length is speciﬁcally measured in units of the :element-type
speciﬁed when the ﬁle was opened (see <a 
href="clmse120.html#x148-733002r768">open</a>).
<div class=incompatibility>
<!--l. 2743--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-103100023.3"></a></span>
   <b>Compatibility note:</b> This corresponds to the function called lengthf in
MacLisp and Lisp Machine Lisp.
                                                                          

                                                                          
<!--l. 2746--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-103200023.3"></a>
<!--l. 2746--><p class="indent" >   </span>
   incompatibility
</div>
</div>
<div class=newer>
<div class=defun>
<!--l. 2752--><p class="noindent" ><i>[Function]</i><a 
 id="dx149-1032001"></a><a 
 id="x149-1032002r777"></a><b> ﬁle-string-length</b>  <i>ﬁle-stream</i> <i>object</i>
<!--l. 2754--><p class="noindent" ><span class="paragraphHead"><a 
 id="x149-1033000777"></a></span>
   X3J13 voted in June 1989 <a 
 id="dx149-1033001"></a>to add the function <a 
href="#x149-743002r777">ﬁle-string-length</a>. The object
must be a string or a character. The function <a 
href="#x149-743002r777">ﬁle-string-length</a> returns a
non-negative integer that is the diﬀerence between what the <a 
href="#x149-741005r775">ﬁle-position</a> of the
ﬁle-stream would be after and before writing the object to the ﬁle-stream, or <a 
href="clmse31.html#x42-86002r19">nil</a> if
this diﬀerence cannot be determined. The value returned may depend on the
current state of the ﬁle-stream; that is, calling <a 
href="#x149-743002r777">ﬁle-string-length</a> on the
same arguments twice may in certain circumstances produce two diﬀerent
integers.
</div>
</div>
                                                                          

                                                                          
   <!--l. 2769--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse122.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse120.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse120.html#tailclmse120.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse121.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch23.html#clmse121.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 2769--><p class="indent" >   <a 
 id="tailclmse121.html"></a>  
</body></html> 
