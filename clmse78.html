<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Modifying Sequences</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-18 22:46:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 663--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse79.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse77.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse77.html#tailclmse77.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse78.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch14.html#clmse78.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">14.3   </span> <a 
 id="x97-19800014.3"></a>Modifying Sequences</h3>
<!--l. 665--><p class="noindent" >Each of these functions alters the contents of a sequence or produces an altered
copy of a given sequence.
<div class=defun>
<!--l. 668--><p class="noindent" ><i>[Function]</i><a 
 id="dx97-198001"></a><a 
 id="x97-198002r377"></a><b> ﬁll</b>  <i>sequence</i> <i>item</i> &#x0026;key  <i>:start</i> <i>:end</i>
<!--l. 670--><p class="noindent" >The sequence is destructively modiﬁed by replacing each element of the
subsequence speciﬁed by the :start and :end parameters with the item. The item
may be any Lisp object but must be a suitable element for the sequence. The
item is stored into all speciﬁed components of the sequence, beginning at
the one speciﬁed by the :start index (which defaults to zero), up to but
not including the one speciﬁed by the :end index (which defaults to the
length of the sequence). <a 
href="#x97-198002r377">ﬁll</a> returns the modiﬁed sequence. For example:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq x (vector &#x2019;a &#x2019;b &#x2019;c &#x2019;d &#x2019;e)) <span class="math"> ⇒</span> #(a b c d e)
</td></tr></table>
<!--l. 681--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ﬁll x &#x2019;z :start 1 :end 3) <span class="math"> ⇒</span> #(a z z d e)</td></tr></table>
<!--l. 682--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  and now x <span class="math"> ⇒</span> #(a z z d e)</td></tr></table>
<!--l. 683--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ﬁll x &#x2019;p) <span class="math"> ⇒</span> #(p p p p p)</td></tr></table>
<!--l. 684--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  and now x <span class="math"> ⇒</span> #(p p p p p)</td></tr></table>
<!--l. 686--><p class="indent" >
</div>
</div>
</div>
<div class=defun>
<!--l. 689--><p class="noindent" ><i>[Function]</i><a 
 id="dx97-198003"></a><a 
 id="x97-198004r378"></a><b> replace</b>  <i>sequence1</i> <i>sequence2</i> &#x0026;key  <i>:start1</i> <i>:end1</i> <i>:start2 :end2</i>
<!--l. 691--><p class="noindent" >The sequence sequence1 is destructively modiﬁed by copying successive elements
into it from sequence2. The elements of sequence2 must be of a type that
may be stored into sequence1. The subsequence of sequence2 speciﬁed by
:start2 and :end2 is copied into the subsequence of sequence1 speciﬁed by
                                                                          

                                                                          
:start1 and :end1. (The arguments :start1 and :start2 default to zero.
The arguments :end1 and :end2 default to <a 
href="clmse31.html#x42-74002r18">nil</a>, meaning the end of the
appropriate sequence.) If these subsequences are not of the same length,
then the shorter length determines how many elements are copied; the
extra elements near the end of the longer subsequence are not involved
in the operation. The number of elements copied may be expressed as:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(min (- end1 start1) (- end2 start2))
</td></tr></table>
<!--l. 708--><p class="indent" >
</div>
</div>
<!--l. 709--><p class="noindent" >The value returned by <a 
href="#x97-198004r378">replace</a> is the modiﬁed sequence1.
<!--l. 711--><p class="indent" >   If sequence1 and sequence2 are the same (<a 
href="clmse33.html#x44-78002r44">eq</a>) object and the region being
modiﬁed overlaps the region being copied from, then it is as if the entire source
region were copied to another place and only then copied back into the target
region. However, if sequence1 and sequence2 are not the same, but the
region being modiﬁed overlaps the region being copied from (perhaps
because of shared list structure or displaced arrays), then after the <a 
href="#x97-198004r378">replace</a>
operation the subsequence of sequence1 being modiﬁed will have unpredictable
contents.
</div>
<div class=defun>
<!--l. 723--><p class="noindent" ><i>[Function]</i><a 
 id="dx97-198005"></a><a 
 id="x97-198006r379"></a><b> remove</b>  <i>item</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:test</i> <i>:test-not</i> <i>:start</i> <i>:end</i>
<i>:count</i> <i>:key</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx97-198007"></a><a 
 id="x97-198008r380"></a><b> remove-if</b>  <i>predicate</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:start</i> <i>:end</i> <i>:count</i>
<i>:key</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx97-198009"></a><a 
 id="x97-198010r381"></a><b> remove-if-not</b>  <i>predicate</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:start</i> <i>:end</i>
<i>:count</i> <i>:key</i>
<!--l. 727--><p class="noindent" >The result is a sequence of the same kind as the argument sequence that has the
same elements except that those in the subsequence delimited by :start and :end
and satisfying the test (see above) have been removed. This is a non-destructive
operation; the result is a copy of the input sequence, save that some elements are
not copied. Elements not removed occur in the same order in the result as they
did in the argument.
                                                                          

                                                                          
<!--l. 736--><p class="indent" >   The :count argument, if supplied, limits the number of elements removed; if
more than :count elements satisfy the test, then of these elements only the
leftmost are removed, as many as speciﬁed by :count.
<div class=new>
<!--l. 742--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx97-198011"></a>to clarify that the :count argument must be
either <a 
href="clmse31.html#x42-74002r18">nil</a> or an integer, and that supplying a negative integer produces the same
behavior as supplying zero.
</div>
<!--l. 749--><p class="indent" >   A non-<a 
href="clmse31.html#x42-74002r18">nil</a> :from-end speciﬁcation matters only when the :count argument is
provided; in that case only the rightmost :count elements satisfying the test are
removed. For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove 4 &#x2019;(1 2 4 1 3 4 5)) <span class="math"> ⇒</span> (1 2 1 3 5)
</td></tr></table>
<!--l. 755--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove 4 &#x2019;(1 2 4 1 3 4 5) :count 1) <span class="math"> ⇒</span> (1 2 1 3 4 5)</td></tr></table>
<!--l. 756--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove 4 &#x2019;(1 2 4 1 3 4 5) :count 1 :from-end t)</td></tr></table>
<!--l. 757--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> (1 2 4 1 3 5)</td></tr></table>
<!--l. 758--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove 3 &#x2019;(1 2 4 1 3 4 5) :test #&#x2019;&#x003E;) <span class="math"> ⇒</span> (4 3 4 5)</td></tr></table>
<!--l. 759--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-if #&#x2019;oddp &#x2019;(1 2 4 1 3 4 5)) <span class="math"> ⇒</span> (2 4 4)</td></tr></table>
<!--l. 760--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-if #&#x2019;evenp &#x2019;(1 2 4 1 3 4 5) :count 1 :from-end t)</td></tr></table>
<!--l. 761--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> (1 2 4 1 3 5)</td></tr></table>
<!--l. 763--><p class="indent" >
</div>
</div>
<!--l. 764--><p class="noindent" >The result of <a 
href="#x97-198006r379">remove</a> may share with the argument sequence; a list result may share a
tail with an input list, and the result may be <a 
href="clmse33.html#x44-78002r44">eq</a> to the input sequence if no
elements need to be removed.
<div class=new>
<!--l. 770--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx97-198012"></a>to restrict user side eﬀects; see section ??.
</div>
</div>
<div class=defun>
<!--l. 776--><p class="noindent" ><i>[Function]</i><a 
 id="dx97-198013"></a><a 
 id="x97-198014r382"></a><b> delete</b>  <i>item</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:test</i> <i>:test-not</i>
<i>:start :end :count :key</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx97-198015"></a><a 
 id="x97-198016r383"></a><b> delete-if</b>  <i>predicate</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:start :end :count :key</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx97-198017"></a><a 
 id="x97-198018r384"></a><b> delete-if-not</b>  <i>predicate</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:start :end :count :key</i>
<!--l. 780--><p class="noindent" >This is the destructive counterpart to <a 
href="#x97-198006r379">remove</a>. The result is a sequence of the same
                                                                          

                                                                          
kind as the argument sequence that has the same elements except that those in
the subsequence delimited by :start and :end and satisfying the test (see above)
have been deleted. This is a destructive operation. The argument sequence may be
destroyed and used to construct the result; however, the result may or may not be
<a 
href="clmse33.html#x44-78002r44">eq</a> to sequence. Elements not deleted occur in the same order in the result as they
did in the argument.
<!--l. 791--><p class="indent" >   The :count argument, if supplied, limits the number of elements deleted; if
more than :count elements satisfy the test, then of these elements only the
leftmost are deleted, as many as speciﬁed by :count.
<div class=new>
<!--l. 797--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx97-198019"></a>to clarify that the :count argument must be
either <a 
href="clmse31.html#x42-74002r18">nil</a> or an integer, and that supplying a negative integer produces the same
behavior as supplying zero.
</div>
<!--l. 804--><p class="indent" >   A non-<a 
href="clmse31.html#x42-74002r18">nil</a> :from-end speciﬁcation matters only when the :count argument is
provided; in that case only the rightmost :count elements satisfying the test are
deleted. For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(delete 4 &#x2019;(1 2 4 1 3 4 5)) <span class="math"> ⇒</span> (1 2 1 3 5)
</td></tr></table>
<!--l. 810--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(delete 4 &#x2019;(1 2 4 1 3 4 5) :count 1) <span class="math"> ⇒</span> (1 2 1 3 4 5)</td></tr></table>
<!--l. 811--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(delete 4 &#x2019;(1 2 4 1 3 4 5) :count 1 :from-end t)</td></tr></table>
<!--l. 812--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> (1 2 4 1 3 5)</td></tr></table>
<!--l. 813--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(delete 3 &#x2019;(1 2 4 1 3 4 5) :test #&#x2019;&#x003E;) <span class="math"> ⇒</span> (4 3 4 5)</td></tr></table>
<!--l. 814--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(delete-if #&#x2019;oddp &#x2019;(1 2 4 1 3 4 5)) <span class="math"> ⇒</span> (2 4 4)</td></tr></table>
<!--l. 815--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(delete-if #&#x2019;evenp &#x2019;(1 2 4 1 3 4 5) :count 1 :from-end t)</td></tr></table>
<!--l. 816--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> (1 2 4 1 3 5)</td></tr></table>
<!--l. 818--><p class="indent" >
</div>
</div>
<div class=new>
<!--l. 821--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx97-198020"></a>to restrict user side eﬀects; see section ??.
</div>
<div class=newer>
<!--l. 827--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx97-198021"></a>to clarify the permissible side eﬀects of certain
operations. When the sequence is a list, <a 
href="#x97-198014r382">delete</a> is permitted to perform a <a 
href="clmse36.html#x48-90002r64">setf</a> on
                                                                          

                                                                          
any part, car or cdr, of the top-level list structure of that list. When the sequence
is an array, <a 
href="#x97-198014r382">delete</a> is permitted to alter the dimensions of the given array and to
slide some of its elements into new positions without permuting them in order to
produce the resulting array.
<!--l. 837--><p class="indent" >   Furthermore, (delete-if predicate sequence ...) is required to behave exactly like
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(delete nil sequence
</td></tr></table>
<!--l. 840--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        :test #&#x2019;(lambda (unused item)</td></tr></table>
<!--l. 841--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   (declare (ignore unused))</td></tr></table>
<!--l. 842--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   (funcall predicate item))</td></tr></table>
<!--l. 843--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ...)</td></tr></table>
<!--l. 845--><p class="indent" >
</div>
</div>
</div>
<div class=incompatibility>
<!--l. 849--><p class="noindent" ><b>Compatibility note:</b> In MacLisp, the <a 
href="#x97-198014r382">delete</a> function uses an <a 
href="clmse33.html#x44-78006r46">equal</a> comparison rather
than <a 
href="clmse33.html#x44-78004r45">eql</a>, which is the default test for <a 
href="#x97-198014r382">delete</a> in Common Lisp. Where in MacLisp one
would write (delete x y), one must in Common Lisp write (delete x y :test #&#x2019;equal) to
get the completely identical eﬀect. Similarly, one can get the precise eﬀect, and no
more, of the MacLisp (delq x y) by writing in Common Lisp (delete x y :test
#&#x2019;eq).
</div>
</div>
<div class=defun>
<!--l. 861--><p class="noindent" ><i>[Function]</i><a 
 id="dx97-198022"></a><a 
 id="x97-198023r385"></a><b> remove-duplicates</b>  <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:test</i> <i>:test-not</i> <i>:start</i>
<i>:end</i> <i>:key</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx97-198024"></a><a 
 id="x97-198025r386"></a><b> delete-duplicates</b>  <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:test</i> <i>:test-not</i> <i>:start</i>
<i>:end</i> <i>:key</i>
<!--l. 864--><p class="noindent" >The elements of sequence are compared pairwise, and if any two match, then the
one occurring earlier in the sequence is discarded (but if the :from-end argument
is true, then the one later in the sequence is discarded). The result is a sequence of
the same kind as the argument sequence with enough elements removed so
that no two of the remaining elements match. The order of the elements
remaining in the result is the same as the order in which they appear in
                                                                          

                                                                          
sequence.
<!--l. 874--><p class="indent" >   <a 
href="#x97-198023r385">remove-duplicates</a> is the non-destructive version of this operation. The result
of <a 
href="#x97-198023r385">remove-duplicates</a> may share with the argument sequence; a list result may
share a tail with an input list, and the result may be <a 
href="clmse33.html#x44-78002r44">eq</a> to the input sequence if
no elements need to be removed.
<!--l. 881--><p class="indent" >   <a 
href="#x97-198025r386">delete-duplicates</a> may destroy the argument sequence.
<!--l. 883--><p class="indent" >   Some examples: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-duplicates &#x2019;(a b c b d d e)) <span class="math"> ⇒</span> (a c b d e)
</td></tr></table>
<!--l. 885--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-duplicates &#x2019;(a b c b d d e) :from-end t) <span class="math"> ⇒</span> (a b c d e)</td></tr></table>
<!--l. 886--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-duplicates &#x2019;((foo #\a) (bar #\%) (baz #\A))</td></tr></table>
<!--l. 887--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   :test #&#x2019;char-equal :key #&#x2019;cadr)</td></tr></table>
<!--l. 888--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> ((bar #\%) (baz #\A))</td></tr></table>
<!--l. 889--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-duplicates &#x2019;((foo #\a) (bar #\%) (baz #\A))</td></tr></table>
<!--l. 890--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   :test #&#x2019;char-equal :key #&#x2019;cadr :from-end t)</td></tr></table>
<!--l. 891--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> ((foo #\a) (bar #\%))</td></tr></table>
<!--l. 893--><p class="indent" >
</div>
</div>
<!--l. 895--><p class="indent" >   These functions are useful for converting a sequence into a canonical form
suitable for representing a set.
<div class=new>
<!--l. 899--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx97-198026"></a>to restrict user side eﬀects; see section ??.
</div>
<div class=newer>
<!--l. 905--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx97-198027"></a>to clarify the permissible side eﬀects of certain
operations. When the sequence is a list, <a 
href="#x97-198025r386">delete-duplicates</a> is permitted to perform
a <a 
href="clmse36.html#x48-90002r64">setf</a> on any part, car or cdr, of the top-level list structure of that list.
When the sequence is an array, <a 
href="#x97-198025r386">delete-duplicates</a> is permitted to alter
the dimensions of the given array and to slide some of its elements into
new positions without permuting them in order to produce the resulting
array.
</div>
</div>
<div class=defun>
                                                                          

                                                                          
<!--l. 917--><p class="noindent" ><i>[Function]</i><a 
 id="dx97-198028"></a><a 
 id="x97-198029r387"></a><b> substitute</b>  <i>newitem</i> <i>olditem</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:test</i> <i>:test-not</i>
<i>:start</i> <i>:end</i> <i>:count</i> <i>:key</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx97-198030"></a><a 
 id="x97-198031r388"></a><b> substitute-if</b>  <i>newitem</i> <i>test</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:start :end</i>
<i>:count</i> <i>:key</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx97-198032"></a><a 
 id="x97-198033r389"></a><b> substitute-if-not</b>  <i>newitem</i> <i>test</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:start</i>
<i>:end</i> <i>:count</i> <i>:key</i>
<!--l. 921--><p class="noindent" >The result is a sequence of the same kind as the argument sequence that has the
same elements except that those in the subsequence delimited by :start and :end
and satisfying the test (see above) have been replaced by newitem. This is a
non-destructive operation; the result is a copy of the input sequence, save that
some elements are changed.
<!--l. 929--><p class="indent" >   The :count argument, if supplied, limits the number of elements altered; if
more than :count elements satisfy the test, then of these elements only the
leftmost are replaced, as many as speciﬁed by :count.
<div class=new>
<!--l. 935--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx97-198034"></a>to clarify that the :count argument must be
either <a 
href="clmse31.html#x42-74002r18">nil</a> or an integer, and that supplying a negative integer produces the same
behavior as supplying zero.
</div>
<!--l. 943--><p class="indent" >   A non-<a 
href="clmse31.html#x42-74002r18">nil</a> :from-end speciﬁcation matters only when the :count argument is
provided; in that case only the rightmost :count elements satisfying the test are
replaced. For example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(substitute 9 4 &#x2019;(1 2 4 1 3 4 5)) <span class="math"> ⇒</span> (1 2 9 1 3 9 5)
</td></tr></table>
<!--l. 949--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(substitute 9 4 &#x2019;(1 2 4 1 3 4 5) :count 1) <span class="math"> ⇒</span> (1 2 9 1 3 4 5)</td></tr></table>
<!--l. 950--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(substitute 9 4 &#x2019;(1 2 4 1 3 4 5) :count 1 :from-end t)</td></tr></table>
<!--l. 951--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> (1 2 4 1 3 9 5)</td></tr></table>
<!--l. 952--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(substitute 9 3 &#x2019;(1 2 4 1 3 4 5) :test #&#x2019;&#x003E;) <span class="math"> ⇒</span> (9 9 4 9 3 4 5)</td></tr></table>
<!--l. 953--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(substitute-if 9 #&#x2019;oddp &#x2019;(1 2 4 1 3 4 5)) <span class="math"> ⇒</span> (9 2 4 9 9 4 9)</td></tr></table>
<!--l. 954--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(substitute-if 9 #&#x2019;evenp &#x2019;(1 2 4 1 3 4 5) :count 1 :from-end t)</td></tr></table>
<!--l. 955--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> (1 2 4 1 3 9 5)</td></tr></table>
<!--l. 957--><p class="indent" >
</div>
</div>
<!--l. 958--><p class="noindent" >The result of <a 
href="#x97-198029r387">substitute</a> may share with the argument sequence; a list result may
                                                                          

                                                                          
share a tail with an input list, and the result may be <a 
href="clmse33.html#x44-78002r44">eq</a> to the input sequence if
no elements need to be changed.
<!--l. 963--><p class="indent" >   See also <a 
href="clmse84.html#x104-208003r474">subst</a>, which performs substitutions throughout a tree.
<div class=new>
<!--l. 966--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx97-198035"></a>to restrict user side eﬀects; see section ??.
</div>
</div>
<div class=defun>
<!--l. 972--><p class="noindent" ><i>[Function]</i><a 
 id="dx97-198036"></a><a 
 id="x97-198037r390"></a><b> nsubstitute</b>  <i>newitem</i> <i>olditem</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:test</i>
<i>:test-not</i> <i>:start</i> <i>:end</i> <i>:count</i> <i>:key</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx97-198038"></a><a 
 id="x97-198039r391"></a><b> nsubstitute-if</b>  <i>newitem</i> <i>test</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:start :end</i>
<i>:count</i> <i>:key</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx97-198040"></a><a 
 id="x97-198041r392"></a><b> nsubstitute-if-not</b>  <i>newitem</i> <i>test</i> <i>sequence</i> &#x0026;key  <i>:from-end</i> <i>:start</i>
<i>:end</i> <i>:count</i> <i>:key</i>
<!--l. 976--><p class="noindent" >This is the destructive counterpart to <a 
href="#x97-198029r387">substitute</a>. The result is a sequence
of the same kind as the argument sequence that has the same elements
except that those in the subsequence delimited by :start and :end and
satisfying the test (see above) have been replaced by newitem. This is
a destructive operation. The argument sequence may be destroyed and
used to construct the result; however, the result may or may not be <a 
href="clmse33.html#x44-78002r44">eq</a> to
sequence.
<!--l. 985--><p class="indent" >   See also <a 
href="clmse84.html#x104-208010r477">nsubst</a>, which performs destructive substitutions throughout a
tree.
<div class=new>
<!--l. 989--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx97-198042"></a>to restrict user side eﬀects; see section ??.
</div>
<div class=newer>
<!--l. 995--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx97-198043"></a>to clarify the permissible side eﬀects of certain
operations. When the sequence is a list, <a 
href="#x97-198037r390">nsubstitute</a> or <a 
href="#x97-198039r391">nsubstitute-if</a> is
required to perform a <a 
href="clmse36.html#x48-90002r64">setf</a> on any car of the top-level list structure of that
list whose old contents must be replaced with newitem but is forbidden
to perform a <a 
href="clmse36.html#x48-90002r64">setf</a> on any <a 
href="clmse81.html#x101-202004r408">cdr</a> of the list. When the sequence is an array,
<a 
href="#x97-198037r390">nsubstitute</a> or <a 
href="#x97-198039r391">nsubstitute-if</a> is required to perform a <a 
href="clmse36.html#x48-90002r64">setf</a> on any element
of the array whose old contents must be replaced with newitem. These
functions, therefore, may successfully be used solely for eﬀect, the caller
discarding the returned value (though some programmers ﬁnd this stylistically
distasteful).
</div>
                                                                          

                                                                          
</div>
                                                                          

                                                                          
   <!--l. 1013--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse79.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse77.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse77.html#tailclmse77.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse78.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch14.html#clmse78.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 1013--><p class="indent" >   <a 
 id="tailclmse78.html"></a>  
</body></html> 
