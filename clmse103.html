<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>By-Position Constructor Functions</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-17 21:46:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 820--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse104.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse102.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse102.html#tailclmse102.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse103.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch19.html#clmse103.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">19.6   </span> <a 
 id="x127-23200019.6"></a>By-Position Constructor Functions</h3>
<!--l. 823--><p class="noindent" >If the :constructor option is given as (:constructor name arglist), then instead of
making a keyword-driven constructor function, <a 
href="clmse99.html#x123-227002r580">defstruct</a> deﬁnes a “positional”
constructor function, taking arguments whose meaning is determined by the
argument&#x2019;s position rather than by a keyword. The arglist is used to describe
what the arguments to the constructor will be. In the simplest case something like
(:constructor make-foo (a b c)) deﬁnes make-foo to be a three-argument
constructor function whose arguments are used to initialize the slots named a, b,
and c.
<!--l. 835--><p class="indent" >   In addition, the keywords &#x0026;optional, &#x0026;rest, and &#x0026;aux are recognized in the
argument list. They work in the way you might expect, but there are a few ﬁne
points worthy of explanation. Consider this example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(:constructor create-foo
</td></tr></table>
<!--l. 840--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (a &#x0026;optional b (c &#x2019;sea) &#x0026;rest d &#x0026;aux e (f &#x2019;eﬀ)))</td></tr></table>
<!--l. 842--><p class="indent" >
</div>
</div>
<!--l. 843--><p class="noindent" >This deﬁnes create-foo to be a constructor of one or more arguments. The ﬁrst
argument is used to initialize the a slot. The second argument is used to initialize
the b slot. If there isn&#x2019;t any second argument, then the default value given in the
body of the <a 
href="clmse99.html#x123-227002r580">defstruct</a> (if given) is used instead. The third argument is used to
initialize the c slot. If there isn&#x2019;t any third argument, then the symbol sea is used
instead. Any arguments following the third argument are collected into a list
and used to initialize the d slot. If there are three or fewer arguments,
then <a 
href="clmse31.html#x42-74002r18">nil</a> is placed in the d slot. The e slot is not initialized; its initial
value is undeﬁned. Finally, the <a 
href="clmse146.html#x179-412004r863">f</a> slot is initialized to contain the symbol
eﬀ.
                                                                          

                                                                          
<!--l. 856--><p class="indent" >   The actions taken in the b and e cases were carefully chosen to allow the
user to specify all possible behaviors. Note that the &#x0026;aux “variables” can
be used to completely override the default initializations given in the
body.
<!--l. 861--><p class="indent" >   With this deﬁnition, one can write <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(create-foo 1 2)
</td></tr></table>
<!--l. 864--><p class="indent" >
</div>
</div>
<!--l. 865--><p class="noindent" >instead of <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(make-foo :a 1 :b 2)
</td></tr></table>
<!--l. 868--><p class="indent" >
</div>
</div>
<!--l. 869--><p class="noindent" >and of course create-foo provides defaulting diﬀerent from that of make-foo.
<!--l. 872--><p class="indent" >   It is permissible to use the :constructor option more than once, so that you
can deﬁne several diﬀerent constructor functions, each taking diﬀerent
parameters.
<!--l. 876--><p class="indent" >   Because a constructor of this type operates By Order of Arguments, it is
sometimes known as a BOA constructor.
<div class=new>
<!--l. 880--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx127-232001"></a>to allow &#x0026;key and &#x0026;allow-other-keys in the
parameter list of a “positional” constructor. The initialization of slots
corresponding to keyword parameters is performed in the same manner as for
&#x0026;optional parameters. A variant of the example shown above illustrates this:
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(:constructor create-foo
</td></tr></table>
<!--l. 889--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (a &#x0026;optional b (c &#x2019;sea)</td></tr></table>
<!--l. 890--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         &#x0026;key p (q &#x2019;cue) ((:why y)) ((:you u) &#x2019;ewe)</td></tr></table>
                                                                          

                                                                          
<!--l. 891--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         &#x0026;aux e (f &#x2019;eﬀ)))</td></tr></table>
<!--l. 893--><p class="indent" >
</div>
</div>
<!--l. 894--><p class="noindent" >The treatment of slots a, b, c, e, and <a 
href="clmse146.html#x179-412004r863">f</a> is the same as in the original example. In
addition, if there is a :p keyword argument, it is used to initialize the p slot; if
there isn&#x2019;t any :p keyword argument, then the default value given in the body of
the <a 
href="clmse99.html#x123-227002r580">defstruct</a> (if given) is used instead. Similarly, if there is a :q keyword
argument, it is used to initialize the q slot; if there isn&#x2019;t any :q keyword argument,
then the symbol cue is used instead.
<!--l. 905--><p class="indent" >   In order thoroughly to ﬂog this presumably already dead horse, we further
observe that if there is a :why keyword argument, it is used to initialize the y slot;
otherwise the default value for slot y is used instead. Similarly, if there is a :you
keyword argument, it is used to initialize the u slot; otherwise the symbol ewe is
used instead.
<!--l. 913--><p class="indent" >   If memory serves me correctly, <a 
href="clmse99.html#x123-227002r580">defstruct</a> was included in the original design for
Common Lisp some time before keyword arguments were approved. The failure of
positional constructors to accept keyword arguments may well have been an
oversight on my part; there is no logical reason to exclude them. I am grateful to
X3J13 for rectifying this.
<!--l. 919--><p class="indent" >   A remaining diﬃculty is that the possibility of keyword arguments renders the
term “positional constructor” a misnomer. Worse yet, it ruins the term “BOA
constructor.” I suggest that they continue to be called BOA constructors, as I
refuse to abandon a good pun. (I regret appearing to have more compassion for
puns than for horses.)
<!--l. 926--><p class="indent" >   As part of the same vote X3J13 also changed <a 
href="clmse99.html#x123-227002r580">defstruct</a> to allow BOA
constructors to have parameters (including supplied-p parameters) that do not
correspond to any slot. Such parameters may be used in subsequent initialization
forms in the parameter list. Consider this example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defstruct (ice-cream-factory
</td></tr></table>
<!--l. 933--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (:constructor fabricate-factory</td></tr></table>
<!--l. 934--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (&#x0026;key (capacity 5)</td></tr></table>
<!--l. 935--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      location</td></tr></table>
<!--l. 936--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (local-ﬂavors</td></tr></table>
                                                                          

                                                                          
<!--l. 937--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        (case location</td></tr></table>
<!--l. 938--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          ((hawaii) &#x2019;(pineapple macadamia guava))</td></tr></table>
<!--l. 939--><p class="indent" >     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          ((massachusetts) &#x2019;(lobster baked-bean))</td></tr></table>
<!--l. 940--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          ((california) &#x2019;(ginger lotus avocado</td></tr></table>
<!--l. 941--><p class="indent" >     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                          bean-sprout garlic))</td></tr></table>
<!--l. 942--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          ((texas) &#x2019;(jalapeno barbecue))))</td></tr></table>
<!--l. 943--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (ﬂavors (subseq (append local-ﬂavors</td></tr></table>
<!--l. 944--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                               &#x2019;(vanilla</td></tr></table>
<!--l. 945--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 chocolate</td></tr></table>
<!--l. 946--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 strawberry</td></tr></table>
<!--l. 947--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 pistachio</td></tr></table>
<!--l. 948--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 maple-walnut</td></tr></table>
<!--l. 949--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 peppermint))</td></tr></table>
<!--l. 950--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                       0 capacity)))))</td></tr></table>
<!--l. 951--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (capacity 3)</td></tr></table>
<!--l. 952--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (ﬂavors &#x2019;(vanilla chocolate strawberry mango)))</td></tr></table>
<!--l. 954--><p class="indent" >
</div>
</div>
<!--l. 956--><p class="indent" >   The structure type ice-cream-factory has two constructors. The standard
constructor, make-ice-cream-factory, takes two keyword arguments named
:capacity and :ﬂavors. For this constructor, the default for the capacity slot is 3
and the default list of ﬂavors is America&#x2019;s favorite threesome and a dark horse
(not a dead one). The BOA constructor fabricate-factory accepts four diﬀerent
keyword arguments. The :capacity argument defaults to 5, and the :ﬂavors
argument defaults in a complicated manner based on the other three. The
:local-ﬂavors argument may be speciﬁed directly, or may be allowed to
default based on the :location of the factory. Here are examples of various
factories:
<div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq houston (fabricate-factory :capacity 4 :location &#x2019;texas))
</td></tr></table>
<!--l. 972--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq cambridge (fabricate-factory :location &#x2019;massachusetts))</td></tr></table>
<!--l. 973--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq seattle (fabricate-factory :local-ﬂavors &#x2019;(salmon)))</td></tr></table>
<!--l. 974--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq wheaton (fabricate-factory :capacity 4 :location &#x2019;illinois))</td></tr></table>
<!--l. 975--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq pittsburgh (fabricate-factory :capacity 4))</td></tr></table>
<!--l. 976--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq cleveland (make-factory :capacity 4))</td></tr></table>
<!--l. 977--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 978--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ice-cream-factory-ﬂavors houston)</td></tr></table>
<!--l. 979--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> (jalapeno barbecue vanilla chocolate)</td></tr></table>
<!--l. 981--><p class="indent" >
</div>
</div>
<!--l. 982--><p class="noindent" >
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ice-cream-factory-ﬂavors cambridge)
</td></tr></table>
<!--l. 984--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> (lobster baked-bean vanilla chocolate strawberry)</td></tr></table>
<!--l. 985--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 986--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ice-cream-factory-ﬂavors seattle)</td></tr></table>
<!--l. 987--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> (salmon vanilla chocolate strawberry pistachio)</td></tr></table>
<!--l. 988--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 989--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ice-cream-factory-ﬂavors wheaton)</td></tr></table>
<!--l. 990--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> (vanilla chocolate strawberry pistachio)</td></tr></table>
<!--l. 991--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 992--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ice-cream-factory-ﬂavors pittsburgh)</td></tr></table>
<!--l. 993--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> (vanilla chocolate strawberry pistachio)</td></tr></table>
<!--l. 994--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 995--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ice-cream-factory-ﬂavors cleveland)</td></tr></table>
<!--l. 996--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <span class="math"> ⇒</span> (vanilla chocolate strawberry mango)</td></tr></table>
<!--l. 998--><p class="indent" >
</div>
</div>
</div>
                                                                          

                                                                          
   <!--l. 1002--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse104.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse102.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse102.html#tailclmse102.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse103.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch19.html#clmse103.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 1002--><p class="indent" >   <a 
 id="tailclmse103.html"></a>  
</body></html> 
