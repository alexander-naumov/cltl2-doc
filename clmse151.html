<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Functions in the Programmer Interface</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-02-20 00:42:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 2842--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch29.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse150.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse150.html#tailclmse150.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse151.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch28.html#clmse151.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">28.2   </span> <a 
 id="x184-31100028.2"></a>Functions in the Programmer Interface</h3>
<!--l. 2845--><p class="noindent" >This section describes the functions, macros, special forms, and generic functions
provided by the Common Lisp Object System Programmer Interface. The
Programmer Interface comprises the functions and macros that are suﬃcient for
writing most object-oriented programs.
<!--l. 2850--><p class="indent" >   This section is reference material that requires an understanding of the basic
concepts of the Common Lisp Object System. The functions are arranged in
alphabetical order for convenient reference.
<!--l. 2854--><p class="indent" >   The description of each function, macro, special form, and generic
function includes its purpose, its syntax, the semantics of its arguments and
returned values, and often an example and cross-references to related
functions.
<!--l. 2859--><p class="indent" >   The syntax description for a function, macro, or special form describes its
parameters. The description of a generic function includes descriptions of the
methods that are deﬁned on that generic function by the Common Lisp Object
System. A method signature is used to describe the parameters and parameter
specializers for each method.
<!--l. 2866--><p class="indent" >   The following is an example of the format for the syntax description of a
generic function with the method signature for one primary method:
<div class=defun>
<!--l. 2870--><p class="noindent" >  <i>[Generic function]</i>   <b>f</b> <a 
 id="dx184-311001"></a><a 
 id="x184-311002r904"></a>   <i>x</i>  <i>y</i>  <b>&#x0026;optional</b>  <i>z</i> <b>&#x0026;key</b>  :k <br 
class="newline" /><i>[Primary method]</i>   <b>f</b> <a 
 id="dx184-311003"></a><a 
 id="x184-311004r905"></a>   (t <i>x</i>  class) (t <i>y</i>  t) <b>&#x0026;optional</b>  <i>z</i> <b>&#x0026;key</b>  :k
<!--l. 2873--><p class="noindent" >This description indicates that the generic function <i>f </i> has two required
parameters, x and y. In addition, there is an optional parameter z and a keyword
parameter <i>:k</i>.
<!--l. 2878--><p class="indent" >   The method signature indicates that this method on the generic function <i>f </i> has
two required parameters, x, which must be an instance of the class <i>class</i>, and y,
which can be any object. In addition, there is an optional parameter z and a
keyword parameter <i>:k</i>. The signature also indicates that this method on <i>f </i> is a
primary method and has no qualiﬁers.
<!--l. 2885--><p class="indent" >   The syntax description for a generic function describes the lambda-list of the
                                                                          

                                                                          
generic function itself, while the method signatures describe the lambda-lists of
the deﬁned methods.
<!--l. 2889--><p class="indent" >   The generic functions described in this book are all standard generic functions.
They all use standard method combination.
<!--l. 2892--><p class="indent" >   Any implementation of the Common Lisp Object System is allowed to provide
additional methods on the generic functions described here.
<!--l. 2896--><p class="indent" >   It is useful to categorize the functions and macros according to their role in
this standard:
</div>
      <ul class="itemize1">
      <li class="itemize">Tools used for simple object-oriented programming
      <!--l. 2904--><p class="noindent" >These  tools  allow  for  deﬁning  new  classes,  methods,  and  generic
      functions and for making instances. Some tools used within method
      bodies  are  also  listed  here.  Some  of  the  macros  listed  here  have  a
      corresponding function that performs the same task at a lower level of
      abstraction.
      <div class="flushleft" 
>
<!--l. 2910--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" ><i>call-next-method           </i></td><td align="left" ><i>initialize-instance</i>  </td></tr><tr><td align="left" ><i>change-class</i> </td> <td align="left" ><i>make-instance</i></td>
</tr><tr><td align="left" ><i>defclass</i>                         </td><td align="left" ><i>next-method-p</i>       </td>
</tr><tr><td align="left" ><i>defgeneric</i>                      </td><td align="left" ><i>slot-boundp</i>          </td>
</tr><tr><td align="left" ><i>defmethod</i>                      </td><td align="left" ><i>slot-value</i>            </td>
</tr><tr><td align="left" ><i>generic-ﬂet</i>                    </td><td align="left" ><i>with-accessors</i>       </td>
</tr><tr><td align="left" ><i>generic-function</i>              </td><td align="left" ><i>with-added-methods</i></td>
</tr><tr><td align="left" ><i>generic-labels</i>                  </td><td align="left" ><i>with-slots</i>            </td></tr></table>
</div></div>
      </li>
      <li class="itemize">Functions underlying the commonly used macros
      <div class="flushleft" 
>
<!--l. 2927--><p class="noindent" >
                                                                          

                                                                          
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" ><i>add-method</i>                    </td><td align="left" ><i>reinitialize-instance</i>                  </td></tr><tr><td align="left" ><i>class-name</i> </td> <td align="left" ><i>remove-method</i></td>
</tr><tr><td align="left" ><i>compute-applicable-methods</i></td><td align="left" ><i>shared-initialize</i>                      </td>
</tr><tr><td align="left" ><i>ensure-generic-function</i>     </td><td align="left" ><i>slot-exists-p</i>                           </td>
</tr><tr><td align="left" ><i>ﬁnd-class</i>                      </td><td align="left" ><i>slot-makunbound</i>                     </td>
</tr><tr><td align="left" ><i>ﬁnd-method</i>                   </td><td align="left" ><i>slot-missing</i>                           </td>
</tr><tr><td align="left" ><i>function-keywords</i>            </td><td align="left" ><i>slot-unbound</i>                          </td>
</tr><tr><td align="left" ><i>make-instances-obsolete</i>     </td><td align="left" ><i>update-instance-for-diﬀerent-class</i> </td>
</tr><tr><td align="left" ><i>no-applicable-method</i>        </td><td align="left" ><i>update-instance-for-redeﬁned-class</i></td>
</tr><tr><td align="left" ><i>no-next-method</i>               </td><td align="left" >                                          </td></tr></table>
</div></div>
      </li>
      <li class="itemize">Tools for declarative method combination
      <div class="flushleft" 
>
<!--l. 2946--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" ><i>call-method</i>                     </td><td align="left" ><i>method-combination-error</i></td></tr><tr><td align="left" ><i>deﬁne-method-combination  </i></td> <td align="left" ><i>method-qualiﬁers</i></td>
</tr><tr><td align="left" ><i>invalid-method-error</i>          </td><td align="left" >                                </td></tr></table>
</div></div>
      </li>
      <li class="itemize">General Common Lisp support tools
      <div class="flushleft" 
>
<!--l. 2958--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" ><i>class-of </i>                           </td><td align="left" ><i>print-object</i>      </td>
</tr><tr><td align="left" ><i>documentation              </i></td><td align="left" ><i>symbol-macrolet</i></td></tr></table>
</div></div>
      <!--l. 2966--><p class="noindent" >[Note that <i>describe</i> appeared in this list in the original CLOS proposal
      <span class="cite">[<a 
href="clmli5.html#XSIGPLAN-CLOS">5</a>, <a 
href="clmli5.html#XLASC-CLOS-PART-2">7</a>]</span>, but X3J13 voted in March 1989 ⟨<b>?</b>⟩ not to make <i>describe</i> a generic
      function after all (see <i>describe-object</i>).—GLS]</li></ul>
<!--l. 2972--><p class="noindent" >[At this point the original CLOS report contained a description of the  [[ <i> </i> ]] and  ↓<i></i>
notation; that description is omitted here. I have adopted the notation for use
throughout this book. It is described in section <a 
href="clmse2.html#x8-120001.2.5">1.2.5<!--tex4ht:ref: FUNCTION-HEADER-NOTATION-SECTION --></a>.—GLS]
<div class=defun>
                                                                          

                                                                          
<!--l. 2979--><p class="noindent" >  <i>[Generic function]</i>   <b>add-method</b> <a 
 id="dx184-311005"></a><a 
 id="x184-311006r906"></a>   <i>generic-function</i>  <i>method</i> <br 
class="newline" /><i>[Primary method]</i>   <b>add-method                                </b> <a 
 id="dx184-311007"></a><a 
 id="x184-311008r907"></a>
 (t <i>generic-function</i>  standard-generic-function) (t <i>method</i>  method)
<!--l. 2982--><p class="noindent" >The generic function <i>add-method</i> adds a method to a generic function. It
destructively modiﬁes the generic function and returns the modiﬁed generic
function as its result.
<!--l. 2988--><p class="indent" >   The generic-function argument is a generic function object.
<!--l. 2991--><p class="indent" >   The method argument is a method object. The lambda-list of the method
function must be congruent with the lambda-list of the generic function, or an
error is signaled.
<!--l. 2996--><p class="indent" >   The modiﬁed generic function is returned. The result of <i>add-method</i> is <i>eq</i> to
the generic-function argument.
<!--l. 3000--><p class="indent" >   If the given method agrees with an existing method of the generic function on
parameter specializers and qualiﬁers, the existing method is replaced. See
section <a 
href="clmse150.html#x183-28000028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> for a deﬁnition of agreement in this context.
<!--l. 3005--><p class="indent" >   If the method object is a method object of another generic function, an error is
signaled.
<!--l. 3008--><p class="indent" >   See section <a 
href="clmse150.html#x183-28000028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> as well as <i>defmethod</i>, <i>defgeneric</i>, <i>ﬁnd-method</i>, and
<i>remove-method</i>.
</div>
<div class=defmac>
<!--l. 3018--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> call-method </b> <a 
 id="dx184-311009"></a><a 
 id="x184-311010r908"></a>   method next-method-list
</td></tr></table>
<!--l. 3019--><p class="indent" >
</div>
   The macro <i>call-method</i> is used in method combination. This macro hides the
implementation-dependent details of how methods are called. It can be used only
within an eﬀective method form, for the name <i>call-method</i> is deﬁned only within
the lexical scope of such a form.
   The macro <i>call-method</i> invokes the speciﬁed method, supplying it with
arguments and with deﬁnitions for <i>call-next-method</i> and for <i>next-method-p</i>. The
arguments are the arguments that were supplied to the eﬀective method form
containing the invocation of <i>call-method</i>. The deﬁnitions of <i>call-next-method</i> and
<i>next-method-p</i> rely on the list of method objects given as the second argument to
<i>call-method</i>.
                                                                          

                                                                          
   The <i>call-next-method</i> function available to the method that is the ﬁrst
subform will call the ﬁrst method in the list that is the second subform. The
<i>call-next-method</i> function available in that method, in turn, will call the second
method in the list that is the second subform, and so on, until the list of next
methods is exhausted.
   The method argument is a method object; the next-method-list argument is a
list of method objects.
   A list whose ﬁrst element is the symbol <i>make-method</i> and whose second
element is a Lisp form can be used instead of a method object as the ﬁrst subform
of <i>call-method</i> or as an element of the second subform of <i>call-method</i>. Such a list
speciﬁes a method object whose method function has a body that is the given
form.
   The result of <i>call-method</i> is the value or values returned by the method
invocation.
   See <i>call-next-method</i>, <i>deﬁne-method-combination</i>, and <i>next-method-p</i>.
</div>
<div class=defun>
<!--l. 3061--><p class="noindent" > <i>[Function]</i>   <b>call-next-method</b> <a 
 id="dx184-311011"></a><a 
 id="x184-311012r909"></a>   <b>&#x0026;rest</b>  args
<!--l. 3063--><p class="noindent" >The function <i>call-next-method</i> can be used within the body of a method deﬁned
by a method-deﬁning form to call the next method.
<!--l. 3067--><p class="indent" >   The function <i>call-next-method</i> returns the value or values returned by the
method it calls. If there is no next method, the generic function <i>no-next-method</i> is
called.
<!--l. 3071--><p class="indent" >   The type of method combination used determines which methods
can invoke <i>call-next-method</i>. The standard method combination type
allows <i>call-next-method</i> to be used within primary methods and <i>:around</i>
methods.
<!--l. 3077--><p class="indent" >   The standard method combination type deﬁnes the next method according to
the following rules:
      <ul class="itemize1">
      <li class="itemize">If <i>call-next-method</i> is used in an <i>:around</i> method, the next method is
      the next most speciﬁc <i>:around</i> method, if one is applicable.
      </li>
      <li class="itemize">If there are no <i>:around</i> methods at all or if <i>call-next-method</i> is called by
      the least speciﬁc <i>:around</i> method, other methods are called as follows:
                                                                          

                                                                          
           <ul class="itemize2">
           <li class="itemize">All the <i>:before</i> methods are called, in most-speciﬁc-ﬁrst order. The
           function <i>call-next-method</i> cannot be used in <i>:before</i> methods.
           </li>
           <li class="itemize">The most speciﬁc primary method is called. Inside the body of
           a primary method, <i>call-next-method</i> may be used to pass control
           to the next most speciﬁc primary method. The generic function
           <i>no-next-method</i> is called if <i>call-next-method</i> is used and there are
           no more primary methods.
           </li>
           <li class="itemize">All the <i>:after</i> methods are called in most-speciﬁc-last order. The
           function <i>call-next-method</i> cannot be used in <i>:after</i> methods.</li></ul>
      </li></ul>
<!--l. 3109--><p class="indent" >   For further discussion of the use of <i>call-next-method</i>, see sections <a 
href="clmse150.html#x183-28500028.1.7">28.1.7<!--tex4ht:ref: Standard-Method-Combination-SECTION --></a>
and <a 
href="clmse150.html#x183-28700028.1.7">28.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a>.
<!--l. 3116--><p class="indent" >   When <i>call-next-method</i> is called with no arguments, it passes the current
method&#x2019;s original arguments to the next method. Neither argument defaulting,
nor using <i>setq</i>, nor rebinding variables with the same names as parameters of
the method aﬀects the values <i>call-next-method</i> passes to the method it
calls.
<!--l. 3122--><p class="indent" >   When <i>call-next-method</i> is called with arguments, the next method is called
with those arguments. When providing arguments to <i>call-next-method</i>, the
following rule must be satisﬁed or an error is signaled: The ordered set of methods
applicable for a changed set of arguments for <i>call-next-method</i> must be the same
as the ordered set of applicable methods for the original arguments to the generic
function. Optimizations of the error checking are possible, but they must not
change the semantics of <i>call-next-method</i>.
<!--l. 3131--><p class="indent" >   If <i>call-next-method</i> is called with arguments but omits optional arguments, the
next method called defaults those arguments.
<!--l. 3136--><p class="indent" >   The function <i>call-next-method</i> returns the value or values returned by the
method it calls.
<!--l. 3140--><p class="indent" >   Further computation is possible after <i>call-next-method</i> returns.
<!--l. 3142--><p class="indent" >   The deﬁnition of the function <i>call-next-method</i> has lexical scope (for it is
deﬁned only within the body of a method deﬁned by a method-deﬁning form) and
indeﬁnite extent.
                                                                          

                                                                          
<!--l. 3146--><p class="indent" >   For generic functions using a type of method combination deﬁned by the short
form of <i>deﬁne-method-combination</i>, <i>call-next-method</i> can be used in <i>:around</i>
methods only.
<!--l. 3150--><p class="indent" >   The function <i>next-method-p</i> can be used to test whether or not there is a next
method.
<!--l. 3153--><p class="indent" >   If <i>call-next-method</i> is used in methods that do not support it, an error is
signaled.
<!--l. 3156--><p class="indent" >   See sections <a 
href="clmse150.html#x183-28300028.1.7">28.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>, <a 
href="clmse150.html#x183-28500028.1.7">28.1.7<!--tex4ht:ref: Standard-Method-Combination-SECTION --></a>, and <a 
href="clmse150.html#x183-28700028.1.7">28.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a> as well as the functions
<i>deﬁne-method-combination</i>, <i>next-method-p</i>, and <i>no-next-method</i>.
</div>
<div class=defun>
<!--l. 3165--><p class="noindent" >  <i>[Generic function]</i>   <b>change-class</b> <a 
 id="dx184-311013"></a><a 
 id="x184-311014r910"></a>   <i>instance</i>  <i>new-class</i> <br 
class="newline" /><i>[Primary method]</i>   <b>change-class</b> <a 
 id="dx184-311015"></a><a 
 id="x184-311016r911"></a>   (t <i>instance</i>  standard-object) (t <i>new-class</i>
 standard-class)<br 
class="newline" /><i>[Primary method]</i>   <b>change-class</b> <a 
 id="dx184-311017"></a><a 
 id="x184-311018r912"></a>   (t <i>instance</i>  t) (t <i>new-class</i>  symbol)
<!--l. 3169--><p class="noindent" >The generic function <i>change-class</i> changes the class of an instance to a new class.
It destructively modiﬁes and returns the instance.
<!--l. 3174--><p class="indent" >   If in the old class there is any slot of the same name as a local slot in the new
class, the value of that slot is retained. This means that if the slot has a value, the
value returned by <i>slot-value</i> after <i>change-class</i> is invoked is <i>eql</i> to the value
returned by <i>slot-value</i> before <i>change-class</i> is invoked. Similarly, if the slot was
unbound, it remains unbound. The other slots are initialized as described in
section <a 
href="clmse150.html#x183-30500028.1.11">28.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a>.
<!--l. 3187--><p class="indent" >   The instance argument is a Lisp object.
<!--l. 3189--><p class="indent" >   The new-class argument is a class object or a symbol that names a
class.
<!--l. 3192--><p class="indent" >   If the second of the preceding methods is selected, that method invokes
<i>change-class</i> on instance and <i>(ﬁnd-class new-class)</i>.
<!--l. 3197--><p class="indent" >   The modiﬁed instance is returned. The result of <i>change-class</i> is <i>eq</i> to the
instance argument.
<!--l. 3200--><p class="indent" >   Examples:
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass position () ())
</td></tr></table>
                                                                          

                                                                          
<!--l. 3203--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3204--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass x-y-position (position)</td></tr></table>
<!--l. 3205--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ((x :initform 0 :initarg :x)</td></tr></table>
<!--l. 3206--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (y :initform 0 :initarg :y)))</td></tr></table>
<!--l. 3207--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3208--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass rho-theta-position (position)</td></tr></table>
<!--l. 3209--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ((rho :initform 0)</td></tr></table>
<!--l. 3210--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (theta :initform 0)))</td></tr></table>
<!--l. 3211--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3212--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod update-instance-for-diﬀerent-class :before</td></tr></table>
<!--l. 3213--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           ((old x-y-position)</td></tr></table>
<!--l. 3214--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (new rho-theta-position)</td></tr></table>
<!--l. 3215--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            &#x0026;key)</td></tr></table>
<!--l. 3216--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Copy the position information from old to new to make new</td></tr></table>
<!--l. 3217--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; be a rho-theta-position at the same position as old.</td></tr></table>
<!--l. 3218--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((x (slot-value old &#x2019;x))</td></tr></table>
<!--l. 3219--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (y (slot-value old &#x2019;y)))</td></tr></table>
<!--l. 3220--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (setf (slot-value new &#x2019;rho) (sqrt (+ (* x x) (* y y)))</td></tr></table>
<!--l. 3221--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (slot-value new &#x2019;theta) (atan y x))))</td></tr></table>
<!--l. 3223--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; At this point an instance of the class x-y-position can be
</td></tr></table>
<!--l. 3225--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; changed to be an instance of the class rho-theta-position</td></tr></table>
<!--l. 3226--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; using change-class:</td></tr></table>
<!--l. 3227--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3228--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq p1 (make-instance &#x2019;x-y-position :x 2 :y 0))</td></tr></table>
<!--l. 3229--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3230--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(change-class p1 &#x2019;rho-theta-position)</td></tr></table>
<!--l. 3231--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3232--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The result is that the instance bound to p1 is now</td></tr></table>
<!--l. 3233--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; an instance of the class rho-theta-position.</td></tr></table>
                                                                          

                                                                          
<!--l. 3234--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The update-instance-for-diﬀerent-class method</td></tr></table>
<!--l. 3235--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; performed the initialization of the rho and theta</td></tr></table>
<!--l. 3236--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; slots based on the values of the x and y slots,</td></tr></table>
<!--l. 3237--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; which were maintained by the old instance.</td></tr></table>
<!--l. 3239--><p class="indent" >
</div>
</div>
<!--l. 3242--><p class="indent" >   After completing all other actions, <i>change-class</i> invokes the generic
function <i>update-instance-for-diﬀerent-class</i>. The generic function
<i>update-instance-for-diﬀerent-class</i> can be used to assign values to slots in the
transformed instance.
<!--l. 3247--><p class="indent" >   The generic function <i>change-class</i> has several semantic diﬃculties. First, it
performs a destructive operation that can be invoked within a method on an
instance that was used to select that method. When multiple methods are
involved because methods are being combined, the methods currently executing or
about to be executed may no longer be applicable. Second, some implementations
might use compiler optimizations of slot access, and when the class of an instance
is changed the assumptions the compiler made might be violated. This
implies that a programmer must not use <i>change-class</i> inside a method if
any methods for that generic function access any slots, or the results are
undeﬁned.
<!--l. 3260--><p class="indent" >   See section <a 
href="clmse150.html#x183-30500028.1.11">28.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a> as well as <i>update-instance-for-diﬀerent-class</i>.
</div>
<div class=defun>
<!--l. 3266--><p class="noindent" >  <i>[Generic function]</i>   <b>class-name</b> <a 
 id="dx184-311019"></a><a 
 id="x184-311020r913"></a>   <i>class</i> <br 
class="newline" /><i>[Primary method]</i>   <b>class-name</b> <a 
 id="dx184-311021"></a><a 
 id="x184-311022r914"></a>   (t <i>class</i>  class)
<!--l. 3269--><p class="noindent" >The generic function <i>class-name</i> takes a class object and returns its name. The
class argument is a class object. The new-value argument is any object. The name
of the given class is returned.
<!--l. 3276--><p class="indent" >   The name of an anonymous class is <i>nil</i>.
<!--l. 3278--><p class="indent" >   If S is a symbol such that S  =<i>(class-name C)</i> and C  = <i>(ﬁnd-class S)</i>, then S
is the proper name of C (see section <a 
href="clmse150.html#x183-26300028.1.2">28.1.2<!--tex4ht:ref: Classes-SECTION --></a>).
<!--l. 3281--><p class="indent" >   See also section <a 
href="clmse150.html#x183-26300028.1.2">28.1.2<!--tex4ht:ref: Classes-SECTION --></a> and <i>ﬁnd-class</i>.
</div>
<div class=defun>
<!--l. 3285--><p class="noindent" >  <i>[Generic function]</i>   <b>(setf class-name)</b> <a 
 id="dx184-311023"></a><a 
 id="x184-311024r915"></a>   <i>new-value</i>  <i>class</i> <br 
class="newline" /><i>[Primary method]</i>   <b>(setf class-name)</b> <a 
 id="dx184-311025"></a><a 
 id="x184-311026r916"></a>   <i>new-value</i>  (t <i>class</i>  class)
<!--l. 3288--><p class="noindent" >The generic function <i>(setf class-name)</i> takes a class object and sets its name.
The class argument is a class object. The new-value argument is any
object.
</div>
<div class=defun>
<!--l. 3296--><p class="noindent" > <i>[Function]</i>   <b>class-of</b> <a 
 id="dx184-311027"></a><a 
 id="x184-311028r917"></a>   <i>object</i>
<!--l. 3298--><p class="noindent" >The function <i>class-of </i> returns the class of which the given object is an instance.
The argument to <i>class-of </i> may be any Common Lisp object. The function <i>class-of </i>
returns the class of which the argument is an instance.
</div>
<div class=defun>
<!--l. 3308--><p class="noindent" > <i>[Function]</i>   <b>compute-applicable-methods</b> <a 
 id="dx184-311029"></a><a 
 id="x184-311030r918"></a>   <i>generic-function</i>
<i>function-arguments</i>
<!--l. 3310--><p class="noindent" >Given a generic function and a set of arguments, the function
<i>compute-applicable-methods</i> returns the set of methods that are applicable for
those arguments.
<!--l. 3315--><p class="indent" >   The methods are sorted according to precedence order. See section <a 
href="clmse150.html#x183-28300028.1.7">28.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>.
<!--l. 3323--><p class="indent" >   The generic-function argument must be a generic function object. The
function-arguments argument is a list of the arguments to that generic function.
The result is a list of the applicable methods in order of precedence. See
section <a 
href="clmse150.html#x183-28300028.1.7">28.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>.
</div>
<div class=defmac>
<!--l. 3332--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> defclass </b> <a 
 id="dx184-311031"></a><a 
 id="x184-311032r919"></a>   class-name ( {<i>superclass − name</i>}∗ ) ( {<i>slot − specifier</i>}∗ )  [[ <i>↓class − option</i> ]]
</td></tr></table>
<!--l. 3334--><p class="indent" >
</div>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">class-name ::= symbol
</td></tr></table>
<!--l. 3336--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">superclass-name ::= symbol</td></tr></table>
<!--l. 3337--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">slot-speciﬁer ::= slot-name | (slot-name [[↓slot-option ]])</td></tr></table>
                                                                          

                                                                          
<!--l. 3339--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">slot-name ::= symbol</td></tr></table>
<!--l. 3340--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">slot-option ::= </td><td  
class="tabbing"> {<i><i>:reader</i> reader-function-name</i>}∗</td></tr></table>
<!--l. 3341--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">            </td><td  
class="tabbing">|  {<i><i>:writer</i> writer-function-name</i>}∗</td></tr></table>
<!--l. 3342--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">            </td><td  
class="tabbing">|  {<i><i>:accessor</i> reader-function-name</i>}∗</td></tr></table>
<!--l. 3343--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">            </td><td  
class="tabbing">|  {<i><i>:allocation</i> allocation-type</i>}</td></tr></table>
<!--l. 3344--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">         </td><td  
class="tabbing">|  {<i><i>:initarg</i> initarg-name</i>}∗</td></tr></table>
<!--l. 3345--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">            </td><td  
class="tabbing">|  {<i><i>:initform</i> form</i>}</td></tr></table>
<!--l. 3346--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">         </td><td  
class="tabbing">|  {<i><i>:type</i> type-speciﬁer</i>}</td></tr></table>
<!--l. 3347--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        |  {<i><i>:documentation</i> string</i>} </td><td  
class="tabbing"></td></tr></table>
<!--l. 3349--><p class="indent" >
</div>
                                                                          

                                                                          
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">reader-function-name ::= symbol
</td></tr></table>
<!--l. 3352--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">writer-function-name ::= function-name/</td></tr></table>
<!--l. 3353--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">function-name ::=  {<i>symbol |<i>(setf symbol)</i></i>}</td></tr></table>
<!--l. 3354--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">initarg-name ::= symbol</td></tr></table>
<!--l. 3355--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">allocation-type ::= <i>:instance | :class</i></td></tr></table>
<!--l. 3356--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:127;" 
class="tabbing">class-option ::= </td><td  
class="tabbing"><i>(:default-initargs initarg-list)</i></td></tr></table>
<!--l. 3357--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:127;" 
class="tabbing">                    </td><td  
class="tabbing">| <i>(:documentation string)</i></td></tr></table>
<!--l. 3358--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  | <i>(:metaclass class-name)</i> </td><td  
class="tabbing"></td></tr></table>
<!--l. 3359--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">initarg-list ::=  {<i>initarg-name default-initial-value-form</i>}∗</td></tr></table>
<!--l. 3361--><p class="indent" >
</div>
<!--l. 3362--><p class="noindent" >The macro <i>defclass</i> deﬁnes a new named class. It returns the new class object as its
result.
<!--l. 3365--><p class="indent" >   The syntax of <i>defclass</i> provides options for specifying initialization arguments
for slots, for specifying default initialization values for slots, and for requesting
that methods on speciﬁed generic functions be automatically generated for
reading and writing the values of slots. No reader or writer functions are deﬁned
by default; their generation must be explicitly requested.
<!--l. 3372--><p class="indent" >   Deﬁning a new class also causes a type of the same name to be deﬁned. The
predicate <i>(typep object class-name)</i> returns true if the class of the given object is
class-name itself or a subclass of the class class-name. A class object can be used
as a type speciﬁer. Thus <i>(typep object class)</i> returns true if the class of the object
is class itself or a subclass of class.
<!--l. 3384--><p class="indent" >   The class-name argument is a non-<i>nil</i> symbol. It becomes the proper name of
the new class. If a class with the same proper name already exists and that class
is an instance of <i>standard-class</i>, and if the <i>defclass</i> form for the deﬁnition of the
new class speciﬁes a class of class <i>standard-class</i>, the deﬁnition of the existing
class is replaced.
<!--l. 3391--><p class="indent" >   Each superclass-name argument is a non-<i>nil</i> symbol that speciﬁes a direct
superclass of the new class. The new class will inherit slots and methods
from each of its direct superclasses, from their direct superclasses, and
so on. See section <a 
href="clmse150.html#x183-26800028.1.3">28.1.3<!--tex4ht:ref: Inheritance-SECTION --></a> for a discussion of how slots and methods are
inherited.
                                                                          

                                                                          
<!--l. 3398--><p class="indent" >   Each slot-speciﬁer argument is the name of the slot or a list consisting of the
slot name followed by zero or more slot options. The slot-name argument is a
symbol that is syntactically valid for use as a variable name. If there are any
duplicate slot names, an error is signaled.
<!--l. 3404--><p class="indent" >   The following slot options are available:
      <ul class="itemize1">
      <li class="itemize">The <i>:reader</i> slot option speciﬁes that an unqualiﬁed method is to be
      deﬁned on the generic function named reader-function-name to read
      the value of the given slot. The reader-function-name argument is a
      non-<i>nil</i> symbol. The <i>:reader</i> slot option may be speciﬁed more than
      once for a given slot.
      </li>
      <li class="itemize">The  <i>:writer</i>  slot  option  speciﬁes  that  an  unqualiﬁed  method  is  to
      be  deﬁned  on  the  generic  function  named  writer-function-name  to
      write the value of the slot. The writer-function-name argument is a
      function-name. The <i>:writer</i> slot option may be speciﬁed more than once
      for a given slot.
      </li>
      <li class="itemize">The <i>:accessor</i> slot option speciﬁes that an unqualiﬁed method is to be
      deﬁned on the generic function named reader-function-name to read the
      value of the given slot and that an unqualiﬁed method is to be deﬁned
      on the generic function named <i>(setf reader-function-name)</i> to be used
      with <i>setf </i> to modify the value of the slot. The reader-function-name
      argument  is  a  non-<i>nil</i>  symbol.  The  <i>:accessor</i>  slot  option  may  be
      speciﬁed more than once for a given slot.
      </li>
      <li class="itemize">The <i>:allocation</i> slot option is used to specify where storage is to be
      allocated for the given slot. Storage for a slot may be located in each
      instance or in the class object itself, for example. The value of the
      allocation-type argument can be either the keyword <i>:instance</i> or the
      keyword <i>:class</i>. The <i>:allocation</i> slot option may be speciﬁed at most
      once for a given slot. If the <i>:allocation</i> slot option is not speciﬁed, the
      eﬀect is the same as specifying <i>:allocation :instance</i>.
                                                                          

                                                                          
           <ul class="itemize2">
           <li class="itemize">If allocation-type is <i>:instance</i>, a local slot of the given name is
           allocated in each instance of the class.
           </li>
           <li class="itemize">If  allocation-type  is  <i>:class</i>,  a  shared  slot  of  the  given  name  is
           allocated. The value of the slot is shared by all instances of the
           class. If a class C<sub>1</sub> deﬁnes such a shared slot, any subclass C<sub>2</sub> of C<sub>1</sub>
           will share this single slot unless the <i>defclass</i> form for C<sub>2</sub> speciﬁes a
           slot of the same name or there is a superclass of C<sub>2</sub> that precedes
           C<sub>1</sub> in the class precedence list of C<sub>2</sub> and that deﬁnes a slot of the
           same name.</li></ul>
      </li>
      <li class="itemize">The <i>:initform</i> slot option is used to provide a default initial value form to be
      used in the initialization of the slot. The <i>:initform</i> slot option may
      be speciﬁed at most once for a given slot. This form is evaluated
      every time it is used to initialize the slot. The lexical environment in
      which this form is evaluated is the lexical environment in which the
      <i>defclass</i> form was evaluated. Note that the lexical environment refers
      both to variables and to functions. For local slots, the dynamic
      environment is the dynamic environment in which <i>make-instance</i> was
      called; for shared slots, the dynamic environment is the dynamic
      environment in which the <i>defclass</i> form was evaluated. See section
      <a 
href="clmse150.html#x183-29200028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>.
      <!--l. 3473--><p class="noindent" >No implementation is permitted to extend the syntax of <i>defclass</i> to
      allow <i>(slot-name form)</i> as an abbreviation for <i>(slot-name :initform
      form)</i>.
      </li>
      <li class="itemize">The <i>:initarg</i> slot option declares an initialization argument named
      initarg-name and speciﬁes that this initialization argument initializes the
      given slot. If the initialization argument has a value in the call to
      <i>initialize-instance</i>, the value will be stored into the given slot, and the slot&#x2019;s
      <i>:initform</i> slot option, if any, is not evaluated. If none of the initialization
      arguments speciﬁed for a given slot has a value, the slot is initialized
      according to the <i>:initform</i> slot option, if speciﬁed. The <i>:initarg</i> slot option
      can be speciﬁed more than once for a given slot. The initarg-name argument
      can be any symbol.
                                                                          

                                                                          
      </li>
      <li class="itemize">The <i>:type</i> slot option speciﬁes that the contents of the slot will always be of
      the speciﬁed data type. It eﬀectively declares the result type of the reader
      generic function when applied to an object of this class. The result of
      attempting to store in a slot a value that does not satisfy the type of the
      slot is undeﬁned. The <i>:type</i> slot option may be speciﬁed at most
      once for a given slot. The <i>:type</i> slot option is further discussed in
      section <a 
href="clmse150.html#x183-27000028.1.3">28.1.3<!--tex4ht:ref: Inheritance-of-Slots-and-Slot-Options-SECTION --></a>.
      </li>
      <li class="itemize">The <i>:documentation</i> slot option provides a documentation string for the
      slot.</li></ul>
<!--l. 3504--><p class="indent" >   Each class option is an option that refers to the class as a whole or to all class
slots. The following class options are available:
      <ul class="itemize1">
      <li class="itemize">The <i>:default-initargs</i> class option is followed by a list of alternating
      initialization argument names and default initial value forms. If any
      of these initialization arguments does not appear in the initialization
      argument  list  supplied  to  <i>make-instance</i>,  the  corresponding  default
      initial value form is evaluated, and the initialization argument name
      and  the  form&#x2019;s  value  are  added  to  the  end  of  the  initialization
      argument list before the instance is created (see section <a 
href="clmse150.html#x183-29200028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>). The
      default  initial  value  form  is  evaluated  each  time  it  is  used.  The
      lexical  environment  in  which  this  form  is  evaluated  is  the  lexical
      environment in which the <i>defclass</i> form was evaluated. The dynamic
      environment is the dynamic environment in which <i>make-instance</i> was
      called. If an initialization argument name appears more than once in a
      <i>:default-initargs</i> class option, an error is signaled. The <i>:default-initargs</i>
      class option may be speciﬁed at most once.
      </li>
      <li class="itemize">The <i>:documentation</i> class option causes a documentation string to be
      attached to the class name. The documentation type for this string
      is <i>type</i>. The form <i>(documentation class-name &#x2019;type)</i> may be used to
      retrieve the documentation string. The <i>:documentation</i> class option
      may be speciﬁed at most once.
                                                                          

                                                                          
      </li>
      <li class="itemize">The <i>:metaclass</i> class option is used to specify that instances of the class
      being deﬁned are to have a diﬀerent metaclass than the default provided
      by the system (the class <i>standard-class</i>). The class-name argument is
      the name of the desired metaclass. The <i>:metaclass</i> class option may be
      speciﬁed at most once.
      </li></ul>
<!--l. 3543--><p class="indent" >   The new class object is returned as the result.
<!--l. 3546--><p class="indent" >   If a class with the same proper name already exists and that class is an
instance of <i>standard-class</i>, and if the <i>defclass</i> form for the deﬁnition of the new
class speciﬁes a class of class <i>standard-class</i>, the existing class is redeﬁned, and
instances of it (and its subclasses) are updated to the new deﬁnition at the time
that they are next accessed (see section <a 
href="clmse150.html#x183-30000028.1.10">28.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a>).
<!--l. 3553--><p class="indent" >   Note the following rules of <i>defclass</i> for standard classes:
      <ul class="itemize1">
      <li class="itemize">It is not required that the superclasses of a class be deﬁned before the
      <i>defclass</i> form for that class is evaluated.
      </li>
      <li class="itemize">All the superclasses of a class must be deﬁned before an instance of the
      class can be made.
      </li>
      <li class="itemize">A class must be deﬁned before it can be used as a parameter specializer
      in a <i>defmethod</i> form.
      </li></ul>
<!--l. 3571--><p class="indent" >   The Object System may be extended to cover situations where these rules are
not obeyed.
<!--l. 3574--><p class="indent" >   Some slot options are inherited by a class from its superclasses, and some can
be shadowed or altered by providing a local slot description. No class options
except <i>:default-initargs</i> are inherited. For a detailed description of how slots and
slot options are inherited, see section <a 
href="clmse150.html#x183-27000028.1.3">28.1.3<!--tex4ht:ref: Inheritance-of-Slots-and-Slot-Options-SECTION --></a>.
<!--l. 3580--><p class="indent" >   The options to <i>defclass</i> can be extended. An implementation must signal an
error if it observes a class option or a slot option that is not implemented
locally.
                                                                          

                                                                          
<!--l. 3584--><p class="indent" >   It is valid to specify more than one reader, writer, accessor, or initialization
argument for a slot. No other slot option may appear more than once in a single
slot description, or an error is signaled.
<!--l. 3589--><p class="indent" >   If no reader, writer, or accessor is speciﬁed for a slot, the slot can be accessed
only by the function <i>slot-value</i>.
<!--l. 3592--><p class="indent" >   See sections <a 
href="clmse150.html#x183-26300028.1.2">28.1.2<!--tex4ht:ref: Classes-SECTION --></a>, <a 
href="clmse150.html#x183-26800028.1.3">28.1.3<!--tex4ht:ref: Inheritance-SECTION --></a>, <a 
href="clmse150.html#x183-30000028.1.10">28.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a>, <a 
href="clmse150.html#x183-27400028.1.5">28.1.5<!--tex4ht:ref: Determining-the-Class-Precedence-List-SECTION --></a>, <a 
href="clmse150.html#x183-29200028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a> as well as <i>slot-value</i>,
<i>make-instance</i>, and <i>initialize-instance</i>.
</div>
<div class=defmac>
<!--l. 3605--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> defgeneric </b> <a 
 id="dx184-311033"></a><a 
 id="x184-311034r920"></a>   function-name lambda-list  [[ <i>↓option|{<i>method − description</i>}∗ </div> ]]
</td></tr></table>
<!--l. 3607--><p class="indent" >
</div>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">function-name ::=  {<i>symbol |<i>(setf symbol)</i></i>}
</td></tr></table>
<!--l. 3609--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:129;" 
class="tabbing">lambda-list ::= <i>(</i></td><td  
class="tabbing">{<i>var</i>}∗</td></tr></table>
<!--l. 3610--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:129;" 
class="tabbing">             </td><td  
class="tabbing"> [<i><i>&#x0026;optional</i> {<i>var |<i>(var)</i></i>}∗</i>] </td></tr></table>
<!--l. 3611--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:129;" 
class="tabbing">                      </td><td  
class="tabbing"> [<i><i>&#x0026;rest</i> var</i>] </td></tr></table>
<!--l. 3612--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       [<i><i>&#x0026;key</i> {<i>keyword-parameter</i>}∗  [<i><i>&#x0026;allow-other-keys</i></i>] </i>] <i>)</i> </td><td  
class="tabbing"></td></tr></table>
<!--l. 3614--><p class="indent" >
</div>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">keyword-parameter ::= var |<i>({<i>var |<i>(keyword var)</i></i>})</i>
</td></tr></table>
<!--l. 3616--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">option ::= </td><td  
class="tabbing"><i>(:argument-precedence-order {<i>parameter-name</i>}+ )</i>
</td></tr></table>
<!--l. 3617--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">           </td><td  
class="tabbing">| <i>(declare {<i>declaration</i>}+ )</i>
</td></tr></table>
<!--l. 3618--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">             </td><td  
class="tabbing">| <i>(:documentation string)</i></td></tr></table>
<!--l. 3619--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">             </td><td  
class="tabbing">| <i>(:method-combination symbol {<i>arg</i>}∗ )</i></td></tr></table>
                                                                          

                                                                          
<!--l. 3620--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">             </td><td  
class="tabbing">| <i>(:generic-function-class class-name)</i></td></tr></table>
<!--l. 3621--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           | <i>(:method-class class-name)</i> </td><td style="width:256;" 
class="tabbing"></td></tr></table>
<!--l. 3622--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">method-description ::= <i>(:method </i></td><td style="width:256;" 
class="tabbing">{<i>method-qualiﬁer</i>}∗
</td></tr></table>
<!--l. 3623--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          </td><td style="width:256;" 
class="tabbing">specialized-lambda-list</td></tr></table>
<!--l. 3624--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         </td><td  
class="tabbing"> [[ <i> {<i>declaration</i>}∗ | documentation</i> ]] </td></tr></table>
<!--l. 3625--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                             {<i>form</i>}∗<i>)</i> </td><td  
class="tabbing"></td></tr></table>
<!--l. 3626--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:46;" 
class="tabbing">method-qualiﬁer ::= non-nil-atom
</td></tr></table>
<!--l. 3627--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">specialized-lambda-list ::=
</td></tr></table>
<!--l. 3628--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:46;" 
class="tabbing">      <i>(</i></td><td  
class="tabbing">{<i>var |<i>(</i>var parameter-specializer-name<i>)</i></i>}∗</td></tr></table>
<!--l. 3629--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:46;" 
class="tabbing">     </td><td  
class="tabbing"> [<i><i>&#x0026;optional</i> {<i>var |<i>(</i>var  [<i>initform  [<i>supplied-p-parameter</i>] </i>] <i>)</i></i>}∗</i>] </td></tr></table>
<!--l. 3630--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:46;" 
class="tabbing">        </td><td  
class="tabbing"> [<i><i>&#x0026;rest var</i></i>] </td></tr></table>
<!--l. 3631--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        </td><td  
class="tabbing"> [<i><i>&#x0026;key</i> {<i>specialized-keyword-parameter</i>}∗  [<i><i>&#x0026;allow-other-keys</i></i>] </i>] </td></tr></table>
<!--l. 3632--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         [<i><i>&#x0026;aux</i> {<i>var |<i>(var  [<i>initform</i>] )</i></i>}∗</i>] <i>)</i> </td><td  
class="tabbing"></td></tr></table>
<!--l. 3633--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">specialized-keyword-parameter ::=
</td></tr></table>
<!--l. 3634--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      var |<i>(</i>{<i>var |<i>(keyword var<i>)</i></i></i>}  [<i>initform  [<i>supplied-p-parameter</i>] </i>] <i>)</i></td></tr></table>
<!--l. 3636--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">parameter-specializer-name ::= symbol |<i>(eql eql-specializer-form)</i>
</td></tr></table>
<!--l. 3638--><p class="indent" >
</div>
<!--l. 3639--><p class="noindent" >The macro <i>defgeneric</i> is used to deﬁne a generic function or to specify options and
declarations that pertain to a generic function as a whole.
<!--l. 3643--><p class="indent" >   If <i>(fboundp function-name)</i> is <i>nil</i>, a new generic function is created. If
<i>(fdeﬁnition function-speciﬁer)</i> is a generic function, that generic function is
modiﬁed. If function-name/ names a non-generic function, a macro, or a special
form, an error is signaled.
<!--l. 3649--><p class="indent" >   [X3J13 voted in March 1989 ⟨<b>?</b>⟩ to use <i>fdeﬁnition</i> in the previous
paragraph, as shown, rather than <i>symbol-function</i>, as it appeared in the
original report on CLOS <span class="cite">[<a 
href="clmli5.html#XSIGPLAN-CLOS">5</a>, <a 
href="clmli5.html#XLASC-CLOS-PART-2">7</a>]</span>. The vote also changed all occurrences of
function-speciﬁer in the original report to function-name; this change is reﬂected
here.—GLS]
<!--l. 3655--><p class="indent" >   Each method-description deﬁnes a method on the generic function.
The lambda-list of each method must be congruent with the lambda-list
                                                                          

                                                                          
speciﬁed by the lambda-list option. If this condition does not hold, an
error is signaled. See section <a 
href="clmse150.html#x183-28100028.1.6">28.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a> for a deﬁnition of congruence in this
context.
<!--l. 3663--><p class="indent" >   The macro <i>defgeneric</i> returns the generic function object as its result.
<!--l. 3669--><p class="indent" >   The function-name argument is a non-<i>nil</i> symbol or a list of the form <i>(setf
symbol)</i>.
                                                                          

                                                                          
<!--l. 3674--><p class="indent" >   The lambda-list argument is an ordinary function lambda-list with the
following exceptions:
      <ul class="itemize1">
      <li class="itemize">The use of <i>&#x0026;aux</i> is not allowed.
      </li>
      <li class="itemize">Optional and keyword arguments may not have default initial value
      forms nor use supplied-p parameters. The generic function passes to
      the method all the argument values passed to it, and only those; default
      values are not supported. Note that optional and keyword arguments
      in method deﬁnitions, however, can have default initial value forms and
      can use supplied-p parameters.</li></ul>
<!--l. 3690--><p class="indent" >   The following options are provided. A given option may occur only once, or an
error is signaled.
      <ul class="itemize1">
      <li class="itemize">The <i>:argument-precedence-order</i> option is used to specify the order in
      which  the  required  arguments  in  a  call  to  the  generic  function  are
      tested for speciﬁcity when selecting a particular method. Each required
      argument, as speciﬁed in the lambda-list argument, must be included
      exactly once as a parameter-name so that the full and unambiguous
      precedence order is supplied. If this condition is not met, an error is
      signaled.
      </li>
      <li class="itemize">The <i>declare</i> option is used to specify declarations that pertain to the
      generic function. The following standard Common Lisp declaration is
      allowed:
           <ul class="itemize2">
           <li class="itemize">An <i>optimize</i> declaration speciﬁes whether method selection should
           be optimized for speed or space, but it has no eﬀect on methods.
           To control how a method is optimized, an <i>optimize</i> declaration
           must  be  placed  directly  in  the  <i>defmethod</i>  form  or  method
                                                                          

                                                                          
           description. The optimization qualities <i>speed</i> and <i>space</i> are the
           only  qualities  this  standard  requires,  but  an  implementation
           can extend the Common Lisp Object System to recognize other
           qualities.  A  simple  implementation  that  has  only  one  method
           selection technique and ignores the <i>optimize</i> declaration is valid.</li></ul>
      <!--l. 3722--><p class="noindent" >The <i>special</i>, <i>ftype</i>, <i>function</i>, <i>inline</i>, <i>notinline</i>, and <i>declaration</i> declarations
      are not permitted. Individual implementations can extend the <i>declare</i> option
      to support additional declarations. If an implementation notices a
      declaration that it does not support and that has not been proclaimed as a
      non-standard declaration name in a <i>declaration</i> proclamation, it should issue
      a warning.
      </li>
      <li class="itemize">The <i>:documentation</i> argument associates a documentation string with the
      generic function. The documentation type for this string is <i>function</i>. The
      form <i>(documentation function-name/ &#x2019;function)</i> may be used to retrieve this
      string.
      </li>
      <li class="itemize">The <i>:generic-function-class</i> option may be used to specify that the generic
      function is to have a diﬀerent class than the default provided by the system
      (the class <i>standard-generic-function</i>). The class-name argument is
      the name of a class that can be the class of a generic function. If
      function-name speciﬁes an existing generic function that has a diﬀerent
      value for the <i>:generic-function-class</i> argument and the new generic
      function class is compatible with the old, <i>change-class</i> is called
      to change the class of the generic function; otherwise an error is
      signaled.
      </li>
      <li class="itemize">The <i>:method-class</i> option is used to specify that all methods on
      this generic function are to have a diﬀerent class from the default
      provided by the system (the class <i>standard-method</i>). The class-name
      argument is the name of a class that is capable of being the class of a
      method.
      </li>
      <li class="itemize">The <i>:method-combination</i> option is followed by a symbol that names a type
                                                                          

                                                                          
      of method combination. The arguments (if any) that follow that
      symbol depend on the type of method combination. Note that the
      standard method combination type does not support any arguments.
      However, all types of method combination deﬁned by the short form of
      <i>deﬁne-method-combination</i> accept an optional argument named order,
      defaulting to <i>:most-speciﬁc-ﬁrst</i>, where a value of <i>:most-speciﬁc-last</i> reverses
      the order of the primary methods without aﬀecting the order of the
      auxiliary methods.
      </li></ul>
<!--l. 3769--><p class="indent" >   The method-description arguments deﬁne methods that will be associated with
the generic function. The method-qualiﬁer and specialized-lambda-list arguments in
a method description are the same as for <i>defmethod</i>.
<!--l. 3774--><p class="indent" >   The form arguments specify the method body. The body of the method is
enclosed in an implicit block. If function-name is a symbol, this block bears the
same name as the generic function. If function-name is a list of the form <i>(setf
symbol)</i>, the name of the block is symbol.
<!--l. 3782--><p class="indent" >   The generic function object is returned as the result.
<!--l. 3785--><p class="indent" >   The eﬀect of the <i>defgeneric</i> macro is as if the following three steps were
performed: ﬁrst, methods deﬁned by previous <i>defgeneric</i> forms are removed;
second, <i>ensure-generic-function</i> is called; and ﬁnally, methods speciﬁed by the
current <i>defgeneric</i> form are added to the generic function.
<!--l. 3791--><p class="indent" >   If no method descriptions are speciﬁed and a generic function of the
same name does not already exist, a generic function with no methods is
created.
<!--l. 3795--><p class="indent" >   The lambda-list argument of <i>defgeneric</i> speciﬁes the shape of lambda-lists for
the methods on this generic function. All methods on the resulting generic
function must have lambda-lists that are congruent with this shape. If a
<i>defgeneric</i> form is evaluated and some methods for that generic function have
lambda-lists that are not congruent with that given in the <i>defgeneric</i>
form, an error is signaled. For further details on method congruence, see
section <a 
href="clmse150.html#x183-28100028.1.6">28.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a>.
<!--l. 3805--><p class="indent" >   Implementations can extend <i>defgeneric</i> to include other options. It is required
that an implementation signal an error if it observes an option that is not
implemented locally.
<!--l. 3809--><p class="indent" >   See section <a 
href="clmse150.html#x183-28100028.1.6">28.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a> as well as <i>defmethod</i>, <i>ensure-generic-function</i>, and
<i>generic-function</i>.
<div class=defmac>
                                                                          

                                                                          
<!--l. 3815--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> deﬁne-method-combination </b> <a 
 id="dx184-311035"></a><a 
 id="x184-311036r921"></a>   name  [[ <i>↓short − form − option</i> ]] <i>[Macro]</i><b> deﬁne-method-combination </b><a 
 id="dx184-311037"></a><a 
 id="x184-311038r922"></a>namelambda − list( {<i>method − group − specifier</i>}∗ )  [ <i>(<i>:arguments</i> <i>.</i> lambda-list)</i>]   [ <i>(<i>:generic-function</i> generic-fn-symbol)</i>]   [[ <i> {<i>declaration</i>}∗  | doc-string</div> ]] {<i>form</i>}∗
</td></tr></table>
<!--l. 3822--><p class="indent" >
</div>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:172;" 
class="tabbing">short-form-option ::= </td><td  
class="tabbing"><i>:documentation string</i>
</td></tr></table>
<!--l. 3824--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:172;" 
class="tabbing">                           </td><td  
class="tabbing">| <i>:identity-with-one-argument boolean</i></td></tr></table>
<!--l. 3825--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         | <i>:operator operator</i> </td><td style="width:217;" 
class="tabbing"></td></tr></table>
<!--l. 3826--><p class="indent" >    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">method-group-speciﬁer ::= <i>(</i></td><td  
class="tabbing">variable {<i>{<i>qualiﬁer-pattern</i>}+  | predicate</i>}</td></tr></table>
<!--l. 3828--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:165;" 
class="tabbing">                 [[ <i> ↓<i>long-form-option</i></i> ]] <i>)</i> </td><td  
class="tabbing"></td></tr></table>
<!--l. 3829--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:165;" 
class="tabbing">long-form-option ::= </td><td  
class="tabbing"><i>:description format-string</i></td></tr></table>
<!--l. 3830--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          </td><td  
class="tabbing">| <i>:order order</i></td></tr></table>
<!--l. 3831--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        | <i>:required boolean</i> </td><td  
class="tabbing"></td></tr></table>
<!--l. 3833--><p class="indent" >
</div>
<!--l. 3834--><p class="noindent" >The macro <i>deﬁne-method-combination</i> is used to deﬁne new types of method
combination.
<!--l. 3837--><p class="indent" >   There are two forms of <i>deﬁne-method-combination</i>. The short form is a simple
facility for the cases that are expected to be most commonly needed. The long
form is more powerful but more verbose. It resembles <i>defmacro</i> in that the body is
an expression, usually using backquote, that computes a Lisp form. Thus
arbitrary control structures can be implemented. The long form also allows
arbitrary processing of method qualiﬁers.
<!--l. 3849--><p class="indent" >   In both the short and long forms, name is a symbol. By convention,
non-keyword, non-<i>nil</i> symbols are usually used.
<!--l. 3854--><p class="indent" >   The short-form syntax of <i>deﬁne-method-combination</i> is recognized
when the second subform is a non-<i>nil</i> symbol or is not present. When the
short form is used, name is deﬁned as a type of method combination
that produces a Lisp form <i>(operator method-call method-call … )</i>. The
operator is a symbol that can be the name of a function, macro, or special
form. The operator can be speciﬁed by a keyword option; it defaults to
name.
                                                                          

                                                                          
<!--l. 3863--><p class="indent" >   Keyword options for the short form are the following:
      <ul class="itemize1">
      <li class="itemize">The    <i>:documentation</i>    option    is    used    to    document    the
      method-combination type.
      </li>
      <li class="itemize">The <i>:identity-with-one-argument</i> option enables an optimization when
      boolean is true (the default is false). If there is exactly one applicable
      method and it is a primary method, that method serves as the eﬀective
      method and operator is not called. This optimization avoids the need
      to create a new eﬀective method and avoids the overhead of a function
      call. This option is designed to be used with operators such as <i>progn</i>,
      <i>and</i>, <i>+</i>, and <i>max</i>.
      </li>
      <li class="itemize">The <i>:operator</i> option speciﬁes the name of the operator. The operator
      argument is a symbol that can be the name of a function, macro, or
      special form. By convention, name and operator  are often the same
      symbol. This is the default, but it is not required.
      </li></ul>
<!--l. 3889--><p class="indent" >   None of the subforms is evaluated.
<!--l. 3891--><p class="indent" >   These types of method combination require exactly one qualiﬁer per method.
An error is signaled if there are applicable methods with no qualiﬁers
or with qualiﬁers that are not supported by the method combination
type.
<!--l. 3896--><p class="indent" >   A method combination procedure deﬁned in this way recognizes two roles for
methods. A method whose one qualiﬁer is the symbol naming this type of
method combination is deﬁned to be a primary method. At least one
primary method must be applicable or an error is signaled. A method with
<i>:around</i> as its one qualiﬁer is an auxiliary method that behaves the same
as an <i>:around</i> method in standard method combination. The function
<i>call-next-method</i> can be used only in <i>:around</i> methods; it cannot be used in
primary methods deﬁned by the short form of the <i>deﬁne-method-combination</i>
macro.
<!--l. 3906--><p class="indent" >   A method combination procedure deﬁned in this way accepts an optional
argument named order, which defaults to <i>:most-speciﬁc-ﬁrst</i>. A value of
                                                                          

                                                                          
<i>:most-speciﬁc-last</i> reverses the order of the primary methods without aﬀecting the
order of the auxiliary methods.
<!--l. 3912--><p class="indent" >   The short form automatically includes error checking and support for <i>:around</i>
methods.
<!--l. 3915--><p class="indent" >   For a discussion of built-in method combination types, see section <a 
href="clmse150.html#x183-28700028.1.7">28.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a>.
<!--l. 3920--><p class="indent" >   The long-form syntax of <i>deﬁne-method-combination</i> is recognized when the
second subform is a list.
<!--l. 3923--><p class="indent" >   The lambda-list argument is an ordinary lambda-list. It receives any
arguments provided after the name of the method combination type in the
<i>:method-combination</i> option to <i>defgeneric</i>.
<!--l. 3928--><p class="indent" >   A list of method group speciﬁers follows. Each speciﬁer selects a subset of the
applicable methods to play a particular role, either by matching their qualiﬁers
against some patterns or by testing their qualiﬁers with a predicate. These
method group speciﬁers deﬁne all method qualiﬁers that can be used with this
type of method combination. If an applicable method does not fall into any
method group, the system signals the error that the method is invalid for the kind
of method combination in use.
<!--l. 3936--><p class="indent" >   Each method group speciﬁer names a variable. During the execution of the
forms in the body of <i>deﬁne-method-combination</i>, this variable is bound to a list
of the methods in the method group. The methods in this list occur in
most-speciﬁc-ﬁrst order.
<!--l. 3941--><p class="indent" >   A qualiﬁer pattern is a list or the symbol <i>*</i>. A method matches a qualiﬁer
pattern if the method&#x2019;s list of qualiﬁers is <i>equal</i> to the qualiﬁer pattern (except
that the symbol <i>*</i> in a qualiﬁer pattern matches anything). Thus a qualiﬁer
pattern can be one of the following: the empty list <i>()</i>, which matches unqualiﬁed
methods; the symbol <i>*</i>, which matches all methods; a true list, which
matches methods with the same number of qualiﬁers as the length of the list
when each qualiﬁer matches the corresponding list element; or a dotted
list that ends in the symbol <i>*</i> (the <i>*</i> matches any number of additional
qualiﬁers).
<!--l. 3953--><p class="indent" >   Each applicable method is tested against the qualiﬁer patterns and predicates
in left-to-right order. As soon as a qualiﬁer pattern matches or a predicate returns
true, the method becomes a member of the corresponding method group and no
further tests are made. Thus if a method could be a member of more than one
method group, it joins only the ﬁrst such group. If a method group has more than
one qualiﬁer pattern, a method need only satisfy one of the qualiﬁer patterns to
be a member of the group.
                                                                          

                                                                          
<!--l. 3962--><p class="indent" >   The name of a predicate function can appear instead of qualiﬁer patterns in a
method group speciﬁer. The predicate is called for each method that
has not been assigned to an earlier method group; it is called with one
argument, the method&#x2019;s qualiﬁer list. The predicate should return true if
the method is to be a member of the method group. A predicate can be
distinguished from a qualiﬁer pattern because it is a symbol other than <i>nil</i> or
<i>*</i>.
<!--l. 3970--><p class="indent" >   If there is an applicable method whose qualiﬁers are not valid for the method
combination type, the function <i>invalid-method-error</i> is called.
<!--l. 3974--><p class="indent" >   Method group speciﬁers can have keyword options following the qualiﬁer
patterns or predicate. Keyword options can be distinguished from additional
qualiﬁer patterns because they are neither lists nor the symbol <i>*</i>. The keyword
options are:
      <ul class="itemize1">
      <li class="itemize">The <i>:description</i> option is used to provide a description of the role
      of methods in the method group. Programming environment tools use
      <i>(apply #&#x2019;format stream format-string (method-qualiﬁers method))</i> to
      print this description, which is expected to be concise. This keyword
      option allows the description of a method qualiﬁer to be deﬁned in the
      same module that deﬁnes the meaning of the method qualiﬁer. In most
      cases, format-string will not contain any <i>format</i> directives, but they
      are available for generality. If <i>:description</i> is not speciﬁed, a default
      description is generated based on the variable name and the qualiﬁer
      patterns and on whether this method group includes the unqualiﬁed
      methods. The argument format-string is not evaluated.
      </li>
      <li class="itemize">The <i>:order</i> option speciﬁes the order of methods. The order argument
      is a form that evaluates to <i>:most-speciﬁc-ﬁrst</i> or <i>:most-speciﬁc-last</i>. If it
      evaluates to any other value, an error is signaled. This keyword option
      is a convenience and does not add any expressive power. If <i>:order</i> is
      not speciﬁed, it defaults to <i>:most-speciﬁc-ﬁrst</i>.
      </li>
      <li class="itemize">The  <i>:required</i> option  speciﬁes  whether  at  least  one  method  in  this
      method group is required. If the boolean argument is non-<i>nil</i> and the
      method  group  is  empty  (that  is,  no  applicable  methods  match  the
      qualiﬁer patterns or satisfy the predicate), an error is signaled. This
                                                                          

                                                                          
      keyword option is a convenience and does not add any expressive power.
      If <i>:required</i> is not speciﬁed, it defaults to <i>nil</i>. The boolean argument is
      not evaluated.
      </li></ul>
<!--l. 4018--><p class="indent" >   The use of method group speciﬁers provides a convenient syntax to select
methods, to divide them among the possible roles, and to perform the necessary
error checking. It is possible to perform further ﬁltering of methods in the
body forms by using normal list-processing operations and the functions
<i>method-qualiﬁers</i> and <i>invalid-method-error</i>. It is permissible to use <i>setq</i> on the
variables named in the method group speciﬁers and to bind additional variables.
It is also possible to bypass the method group speciﬁer mechanism and do
everything in the body forms. This is accomplished by writing a single
method group with <i>*</i> as its only qualiﬁer pattern; the variable is then
bound to a list of all of the applicable methods, in most-speciﬁc-ﬁrst
order.
<!--l. 4031--><p class="indent" >   The body forms compute and return the Lisp form that speciﬁes how the
methods are combined, that is, the eﬀective method. The eﬀective method uses
the macro <i>call-method</i>. The deﬁnition of this macro has lexical scope and is
available only in an eﬀective method form. Given a method object in one of the
lists produced by the method group speciﬁers and a list of next methods, the
macro <i>call-method</i> will invoke the method so that <i>call-next-method</i> will have
available the next methods.
<!--l. 4040--><p class="indent" >   When an eﬀective method has no eﬀect other than to call a single method,
some implementations employ an optimization that uses the single method
directly as the eﬀective method, thus avoiding the need to create a new
eﬀective method. This optimization is active when the eﬀective method
form consists entirely of an invocation of the <i>call-method</i> macro whose
ﬁrst subform is a method object and whose second subform is <i>nil</i>. Each
<i>deﬁne-method-combination</i> body is responsible for stripping oﬀ redundant
invocations of <i>progn</i>, <i>and</i>, <i>multiple-value-prog1</i>, and the like, if this optimization
is desired.
<!--l. 4052--><p class="indent" >   The list <i>(:arguments . lambda-list)</i> can appear before any declaration or
documentation string. This form is useful when the method combination type
performs some speciﬁc behavior as part of the combined method and that
behavior needs access to the arguments to the generic function. Each parameter
variable deﬁned by lambda-list is bound to a form that can be inserted into the
eﬀective method. When this form is evaluated during execution of the eﬀective
                                                                          

                                                                          
method, its value is the corresponding argument to the generic function. If
lambda-list is not congruent to the generic function&#x2019;s lambda-list, additional
ignored parameters are automatically inserted until it is congruent. Thus it is
permissible for lambda-list to receive fewer arguments than the number that the
generic function expects.
<!--l. 4066--><p class="indent" >   Erroneous conditions detected by the body should be reported with
<i>method-combination-error</i> or <i>invalid-method-error</i>; these functions add any
necessary contextual information to the error message and will signal the
appropriate error.
<!--l. 4072--><p class="indent" >   The body forms are evaluated inside the bindings created by the lambda-list
and method group speciﬁers. Declarations at the head of the body are positioned
directly inside bindings created by the lambda-list and outside the bindings
of the method group variables. Thus method group variables cannot be
declared.
<!--l. 4078--><p class="indent" >   Within the body forms, generic-function-symbol is bound to the generic
function object.
<!--l. 4081--><p class="indent" >   If a doc-string argument is present, it provides the documentation for the
method combination type.
<!--l. 4084--><p class="indent" >   The functions <i>method-combination-error</i> and <i>invalid-method-error</i> can be called
from the body forms or from functions called by the body forms. The actions of
these two functions can depend on implementation-dependent dynamic variables
automatically bound before the generic function <i>compute-eﬀective-method</i> is
called.
<!--l. 4091--><p class="indent" >   Note that two methods with identical specializers, but with diﬀerent qualiﬁers,
are not ordered by the algorithm described in step 2 of the method selection and
combination process described in section <a 
href="clmse150.html#x183-28300028.1.7">28.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>. Normally the two methods play
diﬀerent roles in the eﬀective method because they have diﬀerent qualiﬁers, and
no matter how they are ordered in the result of step 2 the eﬀective method is the
same. If the two methods play the same role and their order matters, an error
is signaled. This happens as part of the qualiﬁer pattern matching in
<i>deﬁne-method-combination</i>.
                                                                          

                                                                          
<!--l. 4105--><p class="indent" >   The value returned by the <i>deﬁne-method-combination</i> macro is the new
method combination object.
<!--l. 4109--><p class="indent" >   Most examples of the long form of <i>deﬁne-method-combination</i> also illustrate
the use of the related functions that are provided as part of the declarative
method combination facility.<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Examples of the short form of deﬁne-method-combination
</td></tr></table>
<!--l. 4117--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4118--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination and :identity-with-one-argument t)</td></tr></table>
<!--l. 4119--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4120--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod func and ((x class1) y)</td></tr></table>
<!--l. 4121--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 4122--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4123--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The equivalent of this example in the long form is:</td></tr></table>
<!--l. 4124--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4125--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination and</td></tr></table>
<!--l. 4126--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (&#x0026;optional (order &#x2019;:most-speciﬁc-ﬁrst))</td></tr></table>
<!--l. 4127--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((around (:around))</td></tr></table>
<!--l. 4128--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (primary (and) :order order :required t))</td></tr></table>
<!--l. 4129--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((form (if (rest primary)</td></tr></table>
<!--l. 4130--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  <tt>‘</tt>(and ,<tt>@</tt>(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4131--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                      <tt>‘</tt>(call-method ,method ()))</td></tr></table>
<!--l. 4132--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                  primary))</td></tr></table>
<!--l. 4133--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  <tt>‘</tt>(call-method ,(ﬁrst primary) ()))))</td></tr></table>
<!--l. 4134--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (if around</td></tr></table>
<!--l. 4135--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        <tt>‘</tt>(call-method ,(ﬁrst around)</td></tr></table>
<!--l. 4136--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (,<tt>@</tt>(rest around)</td></tr></table>
<!--l. 4137--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (make-method ,form)))</td></tr></table>
<!--l. 4138--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        form)))</td></tr></table>
<!--l. 4139--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4140--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4141--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Examples of the long form of deﬁne-method-combination</td></tr></table>
<!--l. 4142--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
                                                                          

                                                                          
<!--l. 4143--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The default method-combination technique</td></tr></table>
<!--l. 4144--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4145--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination standard ()</td></tr></table>
<!--l. 4146--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((around (:around))</td></tr></table>
<!--l. 4147--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (before (:before))</td></tr></table>
<!--l. 4148--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (primary () :required t)</td></tr></table>
<!--l. 4149--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (after (:after)))</td></tr></table>
<!--l. 4150--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (ﬂet ((call-methods (methods)</td></tr></table>
<!--l. 4151--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4152--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       <tt>‘</tt>(call-method ,method ()))</td></tr></table>
<!--l. 4153--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   methods)))</td></tr></table>
<!--l. 4154--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (let ((form (if (or before after (rest primary))</td></tr></table>
<!--l. 4155--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    <tt>‘</tt>(multiple-value-prog1</td></tr></table>
<!--l. 4156--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (progn ,<tt>@</tt>(call-methods before)</td></tr></table>
<!--l. 4157--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (call-method ,(ﬁrst primary)</td></tr></table>
<!--l. 4158--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                           ,(rest primary)))</td></tr></table>
<!--l. 4159--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       ,<tt>@</tt>(call-methods (reverse after)))</td></tr></table>
<!--l. 4160--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    <tt>‘</tt>(call-method ,(ﬁrst primary) ()))))</td></tr></table>
<!--l. 4161--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (if around</td></tr></table>
<!--l. 4162--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          <tt>‘</tt>(call-method ,(ﬁrst around)</td></tr></table>
<!--l. 4163--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        (,<tt>@</tt>(rest around)</td></tr></table>
<!--l. 4164--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         (make-method ,form)))</td></tr></table>
<!--l. 4165--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          form))))</td></tr></table>
<!--l. 4167--><p class="indent" >
</div>
</div><div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; A simple way to try several methods until one returns non-nil
</td></tr></table>
<!--l. 4171--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4172--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination or ()</td></tr></table>
<!--l. 4173--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((methods (or)))</td></tr></table>
<!--l. 4174--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <tt>‘</tt>(or ,<tt>@</tt>(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4175--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     <tt>‘</tt>(call-method ,method ()))</td></tr></table>
<!--l. 4176--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 methods)))</td></tr></table>
                                                                          

                                                                          
<!--l. 4177--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4178--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; A more complete version of the preceding</td></tr></table>
<!--l. 4179--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4180--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination or</td></tr></table>
<!--l. 4181--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (&#x0026;optional (order &#x2019;:most-speciﬁc-ﬁrst))</td></tr></table>
<!--l. 4182--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((around (:around))</td></tr></table>
<!--l. 4183--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (primary (or)))</td></tr></table>
<!--l. 4184--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Process the order argument</td></tr></table>
<!--l. 4185--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (case order</td></tr></table>
<!--l. 4186--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (:most-speciﬁc-ﬁrst)</td></tr></table>
<!--l. 4187--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (:most-speciﬁc-last (setq primary (reverse primary)))</td></tr></table>
<!--l. 4188--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (otherwise (method-combination-error</td></tr></table>
<!--l. 4189--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 &#x0022;<tt>~</tt>S is an invalid order.<tt>~</tt><tt>@</tt></td></tr></table>
<!--l. 4190--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  :most-speciﬁc-ﬁrst and :most-speciﬁc-last <tt>~</tt></td></tr></table>
<!--l. 4191--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    are the possible values.&#x0022;</td></tr></table>
<!--l. 4192--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         order)))</td></tr></table>
<!--l. 4193--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Must have a primary method</td></tr></table>
<!--l. 4194--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (unless primary</td></tr></table>
<!--l. 4195--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (method-combination-error &#x0022;A primary method is required.&#x0022;))</td></tr></table>
<!--l. 4196--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Construct the form that calls the primary methods</td></tr></table>
<!--l. 4197--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((form (if (rest primary)</td></tr></table>
<!--l. 4198--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  <tt>‘</tt>(or ,<tt>@</tt>(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4199--><p class="indent" >    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                     <tt>‘</tt>(call-method ,method ()))</td></tr></table>
<!--l. 4200--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 primary))</td></tr></table>
<!--l. 4201--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  <tt>‘</tt>(call-method ,(ﬁrst primary) ()))))</td></tr></table>
<!--l. 4202--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ;; Wrap the around methods around that form</td></tr></table>
<!--l. 4203--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (if around</td></tr></table>
<!--l. 4204--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        <tt>‘</tt>(call-method ,(ﬁrst around)</td></tr></table>
<!--l. 4205--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (,<tt>@</tt>(rest around)</td></tr></table>
<!--l. 4206--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (make-method ,form)))</td></tr></table>
<!--l. 4207--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        form)))</td></tr></table>
<!--l. 4209--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The same thing, using the :order and :required keyword options
</td></tr></table>
<!--l. 4213--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination or</td></tr></table>
<!--l. 4214--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (&#x0026;optional (order &#x2019;:most-speciﬁc-ﬁrst))</td></tr></table>
<!--l. 4215--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((around (:around))</td></tr></table>
<!--l. 4216--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (primary (or) :order order :required t))</td></tr></table>
<!--l. 4217--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((form (if (rest primary)</td></tr></table>
<!--l. 4218--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  <tt>‘</tt>(or ,<tt>@</tt>(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4219--><p class="indent" >    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                     <tt>‘</tt>(call-method ,method ()))</td></tr></table>
<!--l. 4220--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 primary))</td></tr></table>
<!--l. 4221--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  <tt>‘</tt>(call-method ,(ﬁrst primary) ()))))</td></tr></table>
<!--l. 4222--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (if around</td></tr></table>
<!--l. 4223--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        <tt>‘</tt>(call-method ,(ﬁrst around)</td></tr></table>
<!--l. 4224--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (,<tt>@</tt>(rest around)</td></tr></table>
<!--l. 4225--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (make-method ,form)))</td></tr></table>
<!--l. 4226--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        form)))</td></tr></table>
<!--l. 4227--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4228--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; This short-form call is behaviorally identical to the preceding.</td></tr></table>
<!--l. 4229--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination or :identity-with-one-argument t)</td></tr></table>
<!--l. 4230--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4231--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Order methods by positive integer qualiﬁers; note that :around</td></tr></table>
<!--l. 4232--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; methods are disallowed here in order to keep the example small.</td></tr></table>
<!--l. 4233--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4234--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination example-method-combination ()</td></tr></table>
<!--l. 4235--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((methods positive-integer-qualiﬁer-p))</td></tr></table>
<!--l. 4236--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <tt>‘</tt>(progn ,<tt>@</tt>(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4237--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        <tt>‘</tt>(call-method ,method ()))</td></tr></table>
<!--l. 4238--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    (stable-sort methods #&#x2019;&#x003C;</td></tr></table>
<!--l. 4239--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      :key #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4240--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                               (ﬁrst (method-qualiﬁers</td></tr></table>
<!--l. 4241--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                        method)))))))</td></tr></table>
<!--l. 4242--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4243--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun positive-integer-qualiﬁer-p (method-qualiﬁers)</td></tr></table>
<!--l. 4244--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (and (= (length method-qualiﬁers) 1)</td></tr></table>
<!--l. 4245--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (typep (ﬁrst method-qualiﬁers) &#x2019;(integer 0 *))))</td></tr></table>
<!--l. 4246--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4247--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Example of the use of :arguments</td></tr></table>
                                                                          

                                                                          
<!--l. 4248--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination progn-with-lock ()</td></tr></table>
<!--l. 4249--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((methods ()))</td></tr></table>
<!--l. 4250--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (:arguments object)</td></tr></table>
<!--l. 4251--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <tt>‘</tt>(unwind-protect</td></tr></table>
<!--l. 4252--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (progn (lock (object-lock ,object))</td></tr></table>
<!--l. 4253--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              ,<tt>@</tt>(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4254--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                            <tt>‘</tt>(call-method ,method ()))</td></tr></table>
<!--l. 4255--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        methods))</td></tr></table>
<!--l. 4256--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (unlock (object-lock ,object))))</td></tr></table>
<!--l. 4258--><p class="indent" >
</div>
</div>
<!--l. 4262--><p class="indent" >   The <i>:method-combination</i> option of <i>defgeneric</i> is used to specify that a generic
function should use a particular method combination type. The argument to
the <i>:method-combination</i> option is the name of a method combination
type.
<!--l. 4267--><p class="indent" >   See sections <a 
href="clmse150.html#x183-28300028.1.7">28.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a> and <a 
href="clmse150.html#x183-28700028.1.7">28.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a> as well as <i>call-method</i>, <i>method-qualiﬁers</i>,
<i>method-combination-error</i>, <i>invalid-method-error</i>, and <i>defgeneric</i>.
<div class=defmac>
<!--l. 4279--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> defmethod </b> <a 
 id="dx184-311039"></a><a 
 id="x184-311040r923"></a>   function-name  {<i>method − qualifier</i>}∗  specialized-lambda-list  [[ <i> {<i>declaration</i>}∗  | doc-string</div> ]] {<i>form</i>}∗
</td></tr></table>
<!--l. 4282--><p class="indent" >
</div>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">function-name ::=  {<i>symbol |<i>(setf symbol)</i></i>}
</td></tr></table>
<!--l. 4284--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">method-qualiﬁer ::= non-nil-atom</td></tr></table>
<!--l. 4285--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">parameter-specializer-name ::= symbol |<i>(eql eql-specializer-form)</i></td></tr></table>
<!--l. 4287--><p class="indent" >
</div>
<!--l. 4288--><p class="noindent" >The macro <i>defmethod</i> deﬁnes a method on a generic function.
                                                                          

                                                                          
<!--l. 4290--><p class="indent" >   If <i>(fboundp function-name)</i> is <i>nil</i>, a generic function is created with
default values for the argument precedence order (each argument is more
speciﬁc than the arguments to its right in the argument list), for the
generic function class (the class <i>standard-generic-function</i>), for the method
class (the class <i>standard-method</i>), and for the method combination type
(the standard method combination type). The lambda-list of the generic
function is congruent with the lambda-list of the method being deﬁned;
if the <i>defmethod</i> form mentions keyword arguments, the lambda-list of
the generic function will mention <i>&#x0026;key</i> (but no keyword arguments). If
function-name names a non-generic function, a macro, or a special form, an error
is signaled.
<!--l. 4303--><p class="indent" >   If a generic function is currently named by function-name, where function-name
is a symbol or a list of the form <i>(setf symbol)</i>, the lambda-list of the method must
be congruent with the lambda-list of the generic function. If this condition does
not hold, an error is signaled. See section <a 
href="clmse150.html#x183-28100028.1.6">28.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a> for a deﬁnition of congruence in
this context.
<!--l. 4314--><p class="indent" >   The function-name argument is a non-<i>nil</i> symbol or a list of the form <i>(setf
symbol)</i>. It names the generic function on which the method is deﬁned.
<!--l. 4318--><p class="indent" >   Each method-qualiﬁer argument is an object that is used by method
combination to identify the given method. A method qualiﬁer is a non-<i>nil</i> atom.
The method combination type may further restrict what a method qualiﬁer may
be. The standard method combination type allows for unqualiﬁed methods or
methods whose sole qualiﬁer is the keyword <i>:before</i>, the keyword <i>:after</i>, or the
keyword <i>:around</i>.
<!--l. 4326--><p class="indent" >   A specialized-lambda-list is like an ordinary function lambda-list except that
the name of a required parameter can be replaced by a specialized parameter, a
list of the form <i>(variable-name parameter-specializer-name)</i>. Only required
parameters may be specialized. A parameter specializer name is a symbol that
names a class or <i>(eql eql-specializer-form)</i>. The parameter specializer name <i>(eql
eql-specializer-form)</i> indicates that the corresponding argument must be <i>eql</i> to
the object that is the value of eql-specializer-form for the method to be
applicable. If no parameter specializer name is speciﬁed for a given required
parameter, the parameter specializer defaults to the class named <i>t</i>. See section
<a 
href="clmse150.html#x183-27900028.1.6">28.1.6<!--tex4ht:ref: Introduction-to-Methods-SECTION --></a>.
<!--l. 4340--><p class="indent" >   The form arguments specify the method body. The body of the method is
enclosed in an implicit block. If function-name is a symbol, this block bears the
same name as the generic function. If function-name is a list of the form <i>(setf
symbol)</i>, the name of the block is symbol.
                                                                          

                                                                          
<!--l. 4347--><p class="indent" >   The result of <i>defmethod</i> is the method object.
<!--l. 4350--><p class="indent" >   The class of the method object that is created is that given by the method
class option of the generic function on which the method is deﬁned.
<!--l. 4353--><p class="indent" >   If the generic function already has a method that agrees with the method
being deﬁned on parameter specializers and qualiﬁers, <i>defmethod</i> replaces the
existing method with the one now being deﬁned. See section <a 
href="clmse150.html#x183-28000028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> for a
deﬁnition of agreement in this context.
<!--l. 4360--><p class="indent" >   The parameter specializers are derived from the parameter specializer names
as described in section <a 
href="clmse150.html#x183-27900028.1.6">28.1.6<!--tex4ht:ref: Introduction-to-Methods-SECTION --></a>.
<!--l. 4363--><p class="indent" >   The expansion of the <i>defmethod</i> macro refers to each specialized parameter
(see the <i>ignore</i> declaration speciﬁer), including parameters that have an explicit
parameter specializer name of <i>t</i>. This means that a compiler warning does not
occur if the body of the method does not refer to a specialized parameter. Note
that a parameter that specializes on <i>t</i> is not synonymous with an unspecialized
parameter in this context.
<!--l. 4372--><p class="indent" >   See sections <a 
href="clmse150.html#x183-27900028.1.6">28.1.6<!--tex4ht:ref: Introduction-to-Methods-SECTION --></a>, <a 
href="clmse150.html#x183-28100028.1.6">28.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a>, and <a 
href="clmse150.html#x183-28000028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a>.
<!--l. 4378--><p class="indent" >   [At this point the original CLOS report <span class="cite">[<a 
href="clmli5.html#XSIGPLAN-CLOS">5</a>, <a 
href="clmli5.html#XLASC-CLOS-PART-2">7</a>]</span> contained a speciﬁcation for
<i>describe</i> as a generic function. This speciﬁcation is omitted here because X3J13
voted in March 1989 ⟨<b>?</b>⟩ not to make <i>describe</i> a generic function after all (see
<i>describe-object</i>).—GLS]
<div class=defun>
<!--l. 4384--><p class="noindent" >  <i>[Generic function]</i>   <b>documentation</b> <a 
 id="dx184-311041"></a><a 
 id="x184-311042r924"></a>   <i>x</i>  <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>documentation</b> <a 
 id="dx184-311043"></a><a 
 id="x184-311044r925"></a>   <i>                                   </i>  (t
<i>method</i>  standard-method) <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>documentation</b> <a 
 id="dx184-311045"></a><a 
 id="x184-311046r926"></a>   <i>                                   </i>  (t
<i>generic-function</i>  standard-generic-function) <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>documentation</b> <a 
 id="dx184-311047"></a><a 
 id="x184-311048r927"></a>   (t <i>class</i>  standard-class) <b>&#x0026;optional</b>
<i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>documentation</b> <a 
 id="dx184-311049"></a><a 
 id="x184-311050r928"></a>   <i>                                   </i>  (t
<i>method-combination</i>  method-combination) <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>documentation</b> <a 
 id="dx184-311051"></a><a 
 id="x184-311052r929"></a>   <i>                                   </i>  (t
<i>slot-description</i>  standard-slot-description) <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>documentation</b> <a 
 id="dx184-311053"></a><a 
 id="x184-311054r930"></a>   (t <i>symbol</i>  symbol) <b>&#x0026;optional</b>
<i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>documentation</b> <a 
 id="dx184-311055"></a><a 
 id="x184-311056r931"></a>   (t <i>list</i>  list) <b>&#x0026;optional</b>  <i>doc-type</i>
<!--l. 4397--><p class="noindent" >The ordinary function <i>documentation</i> (see section <a 
href="clmse128.html#x158-22900025.2">25.2<!--tex4ht:ref: DOCUMENTATION-SECTION --></a>) is replaced by a generic
function. The generic function <i>documentation</i> returns the documentation string
associated with the given object if it is available; otherwise <i>documentation</i> returns
                                                                          

                                                                          
<i>nil</i>.
<!--l. 4405--><p class="indent" >   The ﬁrst argument of <i>documentation</i> is a symbol, a function-name list of the
form <i>(setf symbol)</i>, a method object, a class object, a generic function
object, a method combination object, or a slot description object. Whether
a second argument should be supplied depends on the type of the ﬁrst
argument.
      <ul class="itemize1">
      <li class="itemize">If  the  ﬁrst  argument  is  a  method  object,  a  class  object,  a  generic
      function object, a method combination object, or a slot description
      object,  the  second  argument  must  not  be  supplied,  or  an  error  is
      signaled.
      </li>
      <li class="itemize">If the ﬁrst argument is a symbol or a list of the form <i>(setf symbol)</i>, the
      second argument must be supplied.
           <ul class="itemize2">
           <li class="itemize">The forms <div class=lisp> <div class=tabbing>
           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:82;" 
class="tabbing"></td><td  
class="tabbing">(documentation symbol &#x2019;function)
</td></tr></table>
           <!--l. 4429--><p class="noindent" >
</div>
</div>
           <!--l. 4430--><p class="noindent" >and <div class=lisp> <div class=tabbing>
           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:82;" 
class="tabbing"></td><td  
class="tabbing">(documentation &#x2019;(setf symbol) &#x2019;function)
</td></tr></table>
           <!--l. 4433--><p class="noindent" >
</div>
</div>
           <!--l. 4434--><p class="noindent" >return the documentation string of the function, generic function,
           special form, or macro named by the symbol or list.
                                                                          

                                                                          
           </li>
           <li class="itemize">The form <i>(documentation symbol &#x2019;variable)</i> returns the documentation
           string of the special variable or constant named by the symbol.
           </li>
           <li class="itemize">The form <i>(documentation symbol &#x2019;structure)</i> returns the
           documentation string of the <i>defstruct</i> structure named by the
           symbol.
           </li>
           <li class="itemize">The form <i>(documentation symbol &#x2019;type)</i> returns the documentation
           string of the class object named by the symbol, if there is such a class.
           If there is no such class, it returns the documentation string of the type
           speciﬁer named by the symbol.
           </li>
           <li class="itemize">The form <i>(documentation symbol &#x2019;setf)</i> returns the documentation
           string of the <i>defsetf </i> or <i>deﬁne-setf-method</i> deﬁnition associated with the
           symbol.
           </li>
           <li class="itemize">The form <i>(documentation symbol &#x2019;method-combination)</i> returns the
           documentation string of the method combination type named by the
           symbol.</li></ul>
      </li></ul>
<!--l. 4467--><p class="indent" >   An implementation may extend the set of symbols that are acceptable as the
second argument. If a symbol is not recognized as an acceptable argument by the
implementation, an error must be signaled.
<!--l. 4472--><p class="indent" >   The documentation string associated with the given object is returned unless
none is available, in which case <i>documentation</i> returns <i>nil</i>.
</div>
<div class=defun>
<!--l. 4479--><p class="noindent" >  <i>[Generic function]</i>   <b>(setf documentation)</b> <a 
 id="dx184-311057"></a><a 
 id="x184-311058r932"></a>   <i>new-value</i>  <i>x</i>  <b>&#x0026;optional</b>
<i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>(setf documentation)</b> <a 
 id="dx184-311059"></a><a 
 id="x184-311060r933"></a>   <i>new-value</i>  <i>                  </i>  (t
<i>method</i>  standard-method) <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>(setf documentation)</b> <a 
 id="dx184-311061"></a><a 
 id="x184-311062r934"></a>   <i>new-value</i>  <i>                  </i>  (t
<i>generic-function</i>  standard-generic-function) <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>(setf documentation)</b> <a 
 id="dx184-311063"></a><a 
 id="x184-311064r935"></a>   <i>new-value</i>  <i>                  </i>  (t
<i>class</i>  standard-class) <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>(setf documentation)</b> <a 
 id="dx184-311065"></a><a 
 id="x184-311066r936"></a>   <i>new-value</i>  <i>                  </i>  (t
<i>method-combination</i>  method-combination) <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>(setf documentation)</b> <a 
 id="dx184-311067"></a><a 
 id="x184-311068r937"></a>   <i>new-value</i>  <i>                  </i>  (t
<i>slot-description</i>  standard-slot-description) <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>(setf documentation)</b> <a 
 id="dx184-311069"></a><a 
 id="x184-311070r938"></a>   <i>new-value</i>  <i>                  </i>  (t
<i>symbol</i>  symbol) <b>&#x0026;optional</b>  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i>   <b>(setf documentation)</b> <a 
 id="dx184-311071"></a><a 
 id="x184-311072r939"></a>   <i>new-value</i>  <i>                  </i>  (t
<i>list</i>  list) <b>&#x0026;optional</b>  <i>doc-type</i>
<!--l. 4495--><p class="noindent" >The generic function <i>(setf documentation)</i> is used to update the documentation.
<!--l. 4499--><p class="indent" >   The ﬁrst argument of <i>(setf documentation)</i> is the new documentation.
<!--l. 4501--><p class="indent" >   The second argument of <i>documentation</i> is a symbol, a function-name list of
the form <i>(setf symbol)</i>, a method object, a class object, a generic function object,
a method combination object, or a slot description object. Whether a third
argument should be supplied depends on the type of the second argument. See
<i>documentation</i>.
</div>
<div class=defun>
<!--l. 4511--><p class="noindent" > <i>[Function]</i>   <b>ensure-generic-function</b> <a 
 id="dx184-311073"></a><a 
 id="x184-311074r940"></a>   <i>function-name</i>  <b>&#x0026;key</b>  :lambda-list
:argument-precedence-order  :declare  :documentation  :generic-function-class
:method-combination  :method-class  :environment
<!--l. 4520--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">function-name ::=  {<i>symbol |<i>(setf symbol)</i></i>}
</td></tr></table>
<!--l. 4523--><p class="indent" >
</div>
<!--l. 4524--><p class="noindent" >The function <i>ensure-generic-function</i> is used to deﬁne a globally named generic
function with no methods or to specify or modify options and declarations that
pertain to a globally named generic function as a whole.
<!--l. 4529--><p class="indent" >   If <i>(fboundp function-name)</i> is <i>nil</i>, a new generic function is created. If
<i>(fdeﬁnition function-name)</i> is a non-generic function, a macro, or a special form,
an error is signaled.
<!--l. 4534--><p class="indent" >   [X3J13 voted in March 1989 ⟨<b>?</b>⟩ to use <i>fdeﬁnition</i> in the previous
paragraph, as shown, rather than <i>symbol-function</i>, as it appeared in the
original report on CLOS <span class="cite">[<a 
href="clmli5.html#XSIGPLAN-CLOS">5</a>, <a 
href="clmli5.html#XLASC-CLOS-PART-2">7</a>]</span>. The vote also changed all occurrences of
function-speciﬁer in the original report to function-name; this change is reﬂected
here.—GLS]
                                                                          

                                                                          
<!--l. 4540--><p class="indent" >   If function-name speciﬁes a generic function that has a diﬀerent value
for any of the following arguments, the generic function is modiﬁed to
have the new value: <i>:argument-precedence-order</i>, <i>:declare</i>, <i>:documentation</i>,
<i>:method-combination</i>.
<!--l. 4546--><p class="indent" >   If function-name speciﬁes a generic function that has a diﬀerent value for the
<i>:lambda-list</i> argument, and the new value is congruent with the lambda-lists of all
existing methods or there are no methods, the value is changed; otherwise an error
is signaled.
<!--l. 4551--><p class="indent" >   If function-name speciﬁes a generic function that has a diﬀerent value for the
<i>:generic-function-class</i> argument and if the new generic function class is
compatible with the old, <i>change-class</i> is called to change the class of the generic
function; otherwise an error is signaled.
<!--l. 4557--><p class="indent" >   If function-name speciﬁes a generic function that has a diﬀerent <i>:method-class</i>
value, the value is changed but any existing methods are not changed.
<!--l. 4564--><p class="indent" >   The function-name argument is a symbol or a list of the form <i>(setf
symbol)</i>.
<!--l. 4567--><p class="indent" >   The keyword arguments correspond to the option arguments of <i>defgeneric</i>,
except that the <i>:method-class</i> and <i>:generic-function-class</i> arguments can be class
objects as well as names.
<!--l. 4573--><p class="indent" >   The <i>:environment</i> argument is the same as the <i>&#x0026;environment</i> argument to
macro expansion functions. It is typically used to distinguish between
compile-time and run-time environments.
<!--l. 4577--><p class="indent" >   The <i>:method-combination</i> argument is a method combination object.
<!--l. 4580--><p class="indent" >   The generic function object is returned. See <i>defgeneric</i>.
</div>
<div class=defun>
<!--l. 4585--><p class="noindent" > <i>[Function]</i>   <b>ﬁnd-class</b> <a 
 id="dx184-311075"></a><a 
 id="x184-311076r941"></a>   <i>symbol</i>  <b>&#x0026;optional</b>  <i>errorp</i> <i>environment</i>
<!--l. 4587--><p class="noindent" >The function <i>ﬁnd-class</i> returns the class object named by the given symbol in the
given environment.
<!--l. 4594--><p class="indent" >   The ﬁrst argument to <i>ﬁnd-class</i> is a symbol.
<!--l. 4596--><p class="indent" >   If there is no such class and the errorp argument is not supplied or
is non-<i>nil</i>, <i>ﬁnd-class</i> signals an error. If there is no such class and the
errorp argument is <i>nil</i>, <i>ﬁnd-class</i> returns <i>nil</i>. The default value of errorp is
<i>t</i>.
<!--l. 4602--><p class="indent" >   The optional environment argument is the same as the <i>&#x0026;environment</i>
argument to macro expansion functions. It is typically used to distinguish between
compile-time and run-time environments.
<!--l. 4607--><p class="indent" >   The result of <i>ﬁnd-class</i> is the class object named by the given symbol.
                                                                          

                                                                          
<!--l. 4610--><p class="indent" >   The class associated with a particular symbol can be changed by using <i>setf </i>
with <i>ﬁnd-class</i>. The results are undeﬁned if the user attempts to change the class
associated with a symbol that is deﬁned as a type speciﬁer in chapter <a 
href="clmch4.html#x26-440004">4<!--tex4ht:ref: DTSPEC --></a>. See
section <a 
href="clmse150.html#x183-27300028.1.4">28.1.4<!--tex4ht:ref: Integrating-Types-and-Classes-SECTION --></a>.
</div>
<div class=defun>
<!--l. 4619--><p class="noindent" >  <i>[Generic function]</i>   <b>ﬁnd-method</b> <a 
 id="dx184-311077"></a><a 
 id="x184-311078r942"></a>   <i>generic-function</i>  <i>method-qualiﬁers</i>
<i>specializers</i>  <b>&#x0026;optional</b>  <i>errorp</i><br 
class="newline" /><i>[Primary method]</i>   <b>ﬁnd-method                                 </b> <a 
 id="dx184-311079"></a><a 
 id="x184-311080r943"></a>
 (t <i>generic-function</i>  standard-generic-function) <i>method-qualiﬁers</i>  <i>specializers</i>
<b>&#x0026;optional</b>  <i>errorp</i>
<!--l. 4623--><p class="noindent" >The generic function <i>ﬁnd-method</i> takes a generic function and returns the method
object that agrees on method qualiﬁers and parameter specializers with the
method-qualiﬁers and specializers arguments of <i>ﬁnd-method</i>. See section <a 
href="clmse150.html#x183-28000028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> for
a deﬁnition of agreement in this context.
<!--l. 4635--><p class="indent" >   The generic-function argument is a generic function.
<!--l. 4637--><p class="indent" >   The method-qualiﬁers argument is a list of the method qualiﬁers for the
method. The order of the method qualiﬁers is signiﬁcant.
<!--l. 4641--><p class="indent" >   The specializers argument is a list of the parameter specializers for the
method. It must correspond in length to the number of required arguments of the
generic function, or an error is signaled. This means that to obtain the default
method on a given generic function, a list whose elements are the class named <i>t</i>
must be given.
<!--l. 4648--><p class="indent" >   If there is no such method and the errorp argument is not supplied or is
non-<i>nil</i>, <i>ﬁnd-method</i> signals an error. If there is no such method and the errorp
argument is <i>nil</i>, <i>ﬁnd-method</i> returns <i>nil</i>. The default value of errorp is
<i>t</i>.
<!--l. 4655--><p class="indent" >   The result of <i>ﬁnd-method</i> is the method object with the given method
qualiﬁers and parameter specializers.
<!--l. 4658--><p class="indent" >   See section <a 
href="clmse150.html#x183-28000028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a>.
</div>
<div class=defun>
<!--l. 4663--><p class="noindent" >  <i>[Generic function]</i>   <b>function-keywords</b> <a 
 id="dx184-311081"></a><a 
 id="x184-311082r944"></a>   <i>method</i> <br 
class="newline" /><i>[Primary method]</i>   <b>function-keywords</b> <a 
 id="dx184-311083"></a><a 
 id="x184-311084r945"></a>   (t <i>method</i>  standard-method)
<!--l. 4666--><p class="noindent" >The generic function <i>function-keywords</i> is used to return the keyword parameter
speciﬁers for a given method.
<!--l. 4674--><p class="indent" >   The method argument is a method object.
<!--l. 4677--><p class="indent" >   The generic function <i>function-keywords</i> returns two values: a list of the
                                                                          

                                                                          
explicitly named keywords and a boolean that states whether <i>&#x0026;allow-other-keys</i>
had been speciﬁed in the method deﬁnition.
</div>
<div class=defspec>
<!--l. 4685--><p class="noindent" ><div class=tabbing>
</div>
<!--l. 4686--><p class="indent" >   }∗ )  {<i>form</i>}∗
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> generic-ﬂet </b> <a 
 id="dx184-311085"></a><a 
 id="x184-311086r946"></a>   ( {<i>(function − namelambda − list [[ <i>↓option|{<i>method − description</i>}∗ </div> ]] )
</td></tr></table>
<!--l. 4688--><p class="indent" >
</div>
   The <i>generic-ﬂet</i> special form is analogous to the <i>ﬂet</i> special form. It produces
new generic functions and establishes new lexical function deﬁnition bindings.
Each generic function is created with the set of methods speciﬁed by its method
descriptions.
<!--l. 4695--><p class="noindent" >The special form <i>generic-ﬂet</i> is used to deﬁne generic functions whose names are
meaningful only locally and to execute a series of forms with these function
deﬁnition bindings. Any number of such local generic functions may be
deﬁned.
<!--l. 4700--><p class="indent" >   The names of functions deﬁned by <i>generic-ﬂet</i> have lexical scope; they retain
their local deﬁnitions only within the body of the <i>generic-ﬂet</i>. Any references
within the body of the <i>generic-ﬂet</i> to functions whose names are the same as
those deﬁned within the <i>generic-ﬂet</i> are thus references to the local functions
instead of to any global functions of the same names. The scope of these generic
function deﬁnition bindings, however, includes only the body of <i>generic-ﬂet</i>, not
the deﬁnitions themselves. Within the method bodies, local function names
that match those being deﬁned refer to global functions deﬁned outside
the <i>generic-ﬂet</i>. It is thus not possible to deﬁne recursive functions with
<i>generic-ﬂet</i>.
<!--l. 4716--><p class="indent" >   The function-name, lambda-list, option, method-qualiﬁer, and specialized-lambda-list
arguments are the same as for <i>defgeneric</i>.
<!--l. 4720--><p class="indent" >   A <i>generic-ﬂet</i> local method deﬁnition is identical in form to the method
deﬁnition part of a <i>defmethod</i>.
<!--l. 4723--><p class="indent" >   The body of each method is enclosed in an implicit block. If function-name
is a symbol, this block bears the same name as the generic function. If
function-name is a list of the form <i>(setf symbol)</i>, the name of the block is
                                                                          

                                                                          
symbol.
<!--l. 4730--><p class="indent" >   The result returned by <i>generic-ﬂet</i> is the value or values returned
by the last form executed. If no forms are speciﬁed, <i>generic-ﬂet</i> returns
<i>nil</i>.
<!--l. 4734--><p class="indent" >   See <i>generic-labels</i>, <i>defmethod</i>, <i>defgeneric</i>, and <i>generic-function</i>.
<div class=defmac>
<!--l. 4739--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> generic-function </b> <a 
 id="dx184-311087"></a><a 
 id="x184-311088r947"></a>   lambda-list  [[ <i>↓option|{<i>method − description</i>}∗ </div> ]]
</td></tr></table>
<!--l. 4740--><p class="indent" >
</div>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">option ::= </td><td  
class="tabbing"><i>(:argument-precedence-order {<i>parameter-name</i>}+ )</i>
</td></tr></table>
<!--l. 4742--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">             </td><td  
class="tabbing">| <i>(declare {<i>declaration</i>}+ )</i></td></tr></table>
<!--l. 4743--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">             </td><td  
class="tabbing">| <i>(:documentation string)</i></td></tr></table>
<!--l. 4744--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">             </td><td  
class="tabbing">| <i>(:method-combination symbol {<i>arg</i>}∗ )</i></td></tr></table>
<!--l. 4745--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">             </td><td  
class="tabbing">| <i>(:generic-function-class class-name)</i></td></tr></table>
<!--l. 4746--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           | <i>(:method-class class-name)</i> </td><td style="width:256;" 
class="tabbing"></td></tr></table>
<!--l. 4747--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">method-description ::= <i>(:method </i></td><td style="width:256;" 
class="tabbing">{<i>method-qualiﬁer</i>}∗</td></tr></table>
<!--l. 4748--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          </td><td style="width:256;" 
class="tabbing">specialized-lambda-list</td></tr></table>
<!--l. 4749--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         </td><td  
class="tabbing">{<i>declaration | documentation</i>}∗</td></tr></table>
<!--l. 4750--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          {<i>form</i>}∗<i>)</i> </td><td  
class="tabbing"></td></tr></table>
<!--l. 4752--><p class="indent" >
</div>
<!--l. 4753--><p class="noindent" >The <i>generic-function</i> macro creates an anonymous generic function. The
generic function is created with the set of methods speciﬁed by its method
descriptions.
<!--l. 4760--><p class="indent" >   The option, method-qualiﬁer, and specialized-lambda-list arguments are the
same as for <i>defgeneric</i>.
<!--l. 4765--><p class="indent" >   The generic function object is returned as the result.
<!--l. 4768--><p class="indent" >   If no method descriptions are speciﬁed, an anonymous generic function with
no methods is created.
<!--l. 4771--><p class="indent" >   See <i>defgeneric</i>, <i>generic-ﬂet</i>, <i>generic-labels</i>, and <i>defmethod</i>.
                                                                          

                                                                          
<div class=defspec>
<!--l. 4776--><p class="noindent" ><div class=tabbing>
</div>
<!--l. 4777--><p class="indent" >   }∗ )  {<i>form</i>}∗
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> generic-labels </b> <a 
 id="dx184-311089"></a><a 
 id="x184-311090r948"></a>   ( {<i>(function − namelambda − list [[ <i>↓option|{<i>method − description</i>}∗ </div> ]] )
</td></tr></table>
<!--l. 4779--><p class="indent" >
</div>
   The <i>generic-labels</i> special form is analogous to the <i>labels</i> special form. It
produces new generic functions and establishes new lexical function deﬁnition
bindings. Each generic function is created with the set of methods speciﬁed by its
method descriptions.
<!--l. 4786--><p class="noindent" >The special form <i>generic-labels</i> is used to deﬁne generic functions whose names
are meaningful only locally and to execute a series of forms with these function
deﬁnition bindings. Any number of such local generic functions may be
deﬁned.
<!--l. 4791--><p class="indent" >   The names of functions deﬁned by <i>generic-labels</i> have lexical scope; they
retain their local deﬁnitions only within the body of the <i>generic-labels</i> construct.
Any references within the body of the <i>generic-labels</i> construct to functions whose
names are the same as those deﬁned within the <i>generic-labels</i> form are thus
references to the local functions instead of to any global functions of the same
names. The scope of these generic function deﬁnition bindings includes
the method bodies themselves as well as the body of the <i>generic-labels</i>
construct.
<!--l. 4804--><p class="indent" >   The function-name, lambda-list, option, method-qualiﬁer, and specialized-lambda-list
arguments are the same as for <i>defgeneric</i>.
<!--l. 4808--><p class="indent" >   A <i>generic-labels</i> local method deﬁnition is identical in form to the method
deﬁnition part of a <i>defmethod</i>.
<!--l. 4811--><p class="indent" >   The body of each method is enclosed in an implicit block. If function-name
is a symbol, this block bears the same name as the generic function. If
function-name is a list of the form <i>(setf symbol)</i>, the name of the block is
symbol.
<!--l. 4818--><p class="indent" >   The result returned by <i>generic-labels</i> is the value or values returned by
the last form executed. If no forms are speciﬁed, <i>generic-labels</i> returns
<i>nil</i>.
<!--l. 4822--><p class="indent" >   See <i>generic-ﬂet</i>, <i>defmethod</i>, <i>defgeneric</i>, <i>generic-function</i>.
                                                                          

                                                                          
<div class=defun>
<!--l. 4826--><p class="noindent" >  <i>[Generic function]</i>   <b>initialize-instance</b> <a 
 id="dx184-311091"></a><a 
 id="x184-311092r949"></a>   <i>instance</i>  <b>&#x0026;rest</b>  initargs
<br 
class="newline" /><i>[Primary method]</i>   <b>initialize-instance</b> <a 
 id="dx184-311093"></a><a 
 id="x184-311094r950"></a>   (t <i>instance</i>  standard-object) <b>&#x0026;rest</b>
 initargs
<!--l. 4829--><p class="noindent" >The generic function <i>initialize-instance</i> is called by <i>make-instance</i> to initialize a
newly created instance. The generic function <i>initialize-instance</i> is called with the
new instance and the defaulted initialization arguments.
<!--l. 4835--><p class="indent" >   The system-supplied primary method on <i>initialize-instance</i> initializes the slots
of the instance with values according to the initialization arguments and the
<i>:initform</i> forms of the slots. It does this by calling the generic function
<i>shared-initialize</i> with the following arguments: the instance, <i>t</i> (this indicates that
all slots for which no initialization arguments are provided should be
initialized according to their <i>:initform</i> forms) and the defaulted initialization
arguments.
<!--l. 4848--><p class="indent" >   The instance argument is the object to be initialized.
<!--l. 4850--><p class="indent" >   The initargs argument consists of alternating initialization argument names
and values.
<!--l. 4854--><p class="indent" >   The modiﬁed instance is returned as the result.
<!--l. 4857--><p class="indent" >   Programmers can deﬁne methods for <i>initialize-instance</i> to specify actions
to be taken when an instance is initialized. If only <i>:after</i> methods are
deﬁned, they will be run after the system-supplied primary method for
initialization and therefore will not interfere with the default behavior of
<i>initialize-instance</i>.
<!--l. 4863--><p class="indent" >   See sections <a 
href="clmse150.html#x183-29200028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>, <a 
href="clmse150.html#x183-29600028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, and <a 
href="clmse150.html#x183-29400028.1.9">28.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <i>shared-initialize</i>, <i>make-instance</i>,
<i>slot-boundp</i>, and <i>slot-makunbound</i>.
</div>
<div class=defun>
<!--l. 4873--><p class="noindent" > <i>[Function]</i>   <b>invalid-method-error</b> <a 
 id="dx184-311095"></a><a 
 id="x184-311096r951"></a>   <i>method</i>  <i>format-string</i>  <b>&#x0026;rest</b>
 args
<!--l. 4875--><p class="noindent" >The function <i>invalid-method-error</i> is used to signal an error when there
is an applicable method whose qualiﬁers are not valid for the method
combination type. The error message is constructed by using a <i>format</i> string
and any arguments to it. Because an implementation may need to add
additional contextual information to the error message, <i>invalid-method-error</i>
should be called only within the dynamic extent of a method combination
function.
<!--l. 4884--><p class="indent" >   The function <i>invalid-method-error</i> is called automatically when a method fails
                                                                          

                                                                          
to satisfy every qualiﬁer pattern and predicate in a <i>deﬁne-method-combination</i>
form. A method combination function that imposes additional restrictions should
call <i>invalid-method-error</i> explicitly if it encounters a method it cannot
accept.
<!--l. 4896--><p class="indent" >   The method argument is the invalid method object.
<!--l. 4898--><p class="indent" >   The format-string argument is a control string that can be given to <i>format</i>,
and args are any arguments required by that string.
<!--l. 4903--><p class="indent" >   Whether <i>invalid-method-error</i> returns to its caller or exits via <i>throw</i> is
implementation-dependent.
<!--l. 4906--><p class="indent" >   See <i>deﬁne-method-combination</i>.
</div>
<div class=defun>
<!--l. 4911--><p class="noindent" >  <i>[Generic function]</i>   <b>make-instance</b> <a 
 id="dx184-311097"></a><a 
 id="x184-311098r952"></a>   <i>class</i>  <b>&#x0026;rest</b>  initargs <br 
class="newline" /><i>[Primary method]</i>   <b>make-instance</b> <a 
 id="dx184-311099"></a><a 
 id="x184-311100r953"></a>   (t <i>class</i>  standard-class) <b>&#x0026;rest</b>  initargs
<br 
class="newline" /><i>[Primary method]</i>   <b>make-instance</b> <a 
 id="dx184-311101"></a><a 
 id="x184-311102r954"></a>   (t <i>class</i>  symbol) <b>&#x0026;rest</b>  initargs
<!--l. 4915--><p class="noindent" >The generic function <i>make-instance</i> creates a new instance of the given
class.
<!--l. 4919--><p class="indent" >   The generic function <i>make-instance</i> may be used as described in
section <a 
href="clmse150.html#x183-29200028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>.
<!--l. 4926--><p class="indent" >   The class argument is a class object or a symbol that names a class. The
remaining arguments form a list of alternating initialization argument names and
values.
<!--l. 4930--><p class="indent" >   If the second of the preceding methods is selected, that method invokes
<i>make-instance</i> on the arguments <i>(ﬁnd-class class)</i> and initargs.
<!--l. 4934--><p class="indent" >   The initialization arguments are checked within <i>make-instance</i> (see
section <a 
href="clmse150.html#x183-29200028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>).
<!--l. 4938--><p class="indent" >   The new instance is returned.
<!--l. 4941--><p class="indent" >   The meta-object protocol can be used to deﬁne new methods on <i>make-instance</i> to
replace the object-creation protocol.
<!--l. 4944--><p class="indent" >   See section <a 
href="clmse150.html#x183-29200028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a> as well as <i>defclass</i>, <i>initialize-instance</i>, and <i>class-of </i>.
</div>
<div class=defun>
<!--l. 4950--><p class="noindent" >  <i>[Generic function]</i>   <b>make-instances-obsolete</b> <a 
 id="dx184-311103"></a><a 
 id="x184-311104r955"></a>   <i>class</i> <br 
class="newline" /><i>[Primary method]</i>   <b>make-instances-obsolete</b> <a 
 id="dx184-311105"></a><a 
 id="x184-311106r956"></a>   (t <i>class</i>  standard-class)<br 
class="newline" /><i>[Primary method]</i>   <b>make-instances-obsolete</b> <a 
 id="dx184-311107"></a><a 
 id="x184-311108r957"></a>   (t <i>class</i>  symbol)
<!--l. 4954--><p class="noindent" >The generic function <i>make-instances-obsolete</i> is invoked automatically by the
system when <i>defclass</i> has been used to redeﬁne an existing standard class and
                                                                          

                                                                          
the set of local slots accessible in an instance is changed or the order
of slots in storage is changed. It can also be explicitly invoked by the
user.
<!--l. 4961--><p class="indent" >   The function <i>make-instances-obsolete</i> has the eﬀect of initiating the process of
updating the instances of the class. During updating, the generic function
<i>update-instance-for-redeﬁned-class</i> will be invoked.
<!--l. 4970--><p class="indent" >   The class argument is a class object symbol that names the class whose
instances are to be made obsolete.
<!--l. 4973--><p class="indent" >   If the second of the preceding methods is selected, that method invokes
<i>make-instances-obsolete</i> on <i>(ﬁnd-class class)</i>.
<!--l. 4977--><p class="indent" >   The modiﬁed class is returned. The result of <i>make-instances-obsolete</i> is <i>eq</i> to
the class argument supplied to the ﬁrst of the preceding methods.
<!--l. 4981--><p class="indent" >   See section <a 
href="clmse150.html#x183-30000028.1.10">28.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a> as well as <i>update-instance-for-redeﬁned-class</i>.
</div>
<div class=defun>
<!--l. 4987--><p class="noindent" > <i>[Function]</i>   <b>method-combination-error</b> <a 
 id="dx184-311109"></a><a 
 id="x184-311110r958"></a>   <i>format-string</i>  <b>&#x0026;rest</b>  args
<!--l. 4989--><p class="noindent" >The function <i>method-combination-error</i> is used to signal an error in method
combination. The error message is constructed by using a <i>format</i> string and any
arguments to it. Because an implementation may need to add additional
contextual information to the error message, <i>method-combination-error</i>
should be called only within the dynamic extent of a method combination
function.
<!--l. 5001--><p class="indent" >   The format-string argument is a control string that can be given to <i>format</i>,
and args are any arguments required by that string.
<!--l. 5006--><p class="indent" >   Whether <i>method-combination-error</i> returns to its caller or exits via <i>throw</i> is
implementation-dependent.
<!--l. 5009--><p class="indent" >   See <i>deﬁne-method-combination</i>.
</div>
<div class=defun>
<!--l. 5015--><p class="noindent" >  <i>[Generic function]</i>   <b>method-qualiﬁers</b> <a 
 id="dx184-311111"></a><a 
 id="x184-311112r959"></a>   <i>method</i> <br 
class="newline" /><i>[Primary method]</i>   <b>method-qualiﬁers</b> <a 
 id="dx184-311113"></a><a 
 id="x184-311114r960"></a>   (t <i>method</i>  standard-method)
<!--l. 5018--><p class="noindent" >The generic function <i>method-qualiﬁers</i> returns a list of the qualiﬁers of the given
method.
<!--l. 5026--><p class="indent" >   The method argument is a method object.
<!--l. 5029--><p class="indent" >   A list of the qualiﬁers of the given method is returned.
<!--l. 5031--><p class="indent" >   Example: <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq methods (remove-duplicates methods
</td></tr></table>
<!--l. 5033--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 :from-end t</td></tr></table>
<!--l. 5034--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 :key #&#x2019;method-qualiﬁers</td></tr></table>
<!--l. 5035--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 :test #&#x2019;equal))</td></tr></table>
<!--l. 5037--><p class="indent" >
</div>
</div>
<!--l. 5039--><p class="indent" >   See <i>deﬁne-method-combination</i>.
</div>
<div class=defun>
<!--l. 5044--><p class="noindent" > <i>[Function]</i>   <b>next-method-p</b> <a 
 id="dx184-311115"></a><a 
 id="x184-311116r961"></a>
<!--l. 5046--><p class="noindent" >The locally deﬁned function <i>next-method-p</i> can be used within the body of a
method deﬁned by a method-deﬁning form to determine whether a next method
exists.
<!--l. 5055--><p class="indent" >   The function <i>next-method-p</i> takes no arguments.
<!--l. 5058--><p class="indent" >   The function <i>next-method-p</i> returns true or false.
<!--l. 5061--><p class="indent" >   Like <i>call-next-method</i>, the function <i>next-method-p</i> has lexical scope (for it is
deﬁned only within the body of a method deﬁned by a method-deﬁning form) and
indeﬁnite extent.
<!--l. 5066--><p class="indent" >   See <i>call-next-method</i>.
</div>
<div class=defun>
<!--l. 5071--><p class="noindent" >  <i>[Generic function]</i>   <b>no-applicable-method</b> <a 
 id="dx184-311117"></a><a 
 id="x184-311118r962"></a>   <i>generic-function</i>  <b>&#x0026;rest</b>
 function-arguments <br 
class="newline" /><i>[Primary method]</i>   <b>no-applicable-method</b> <a 
 id="dx184-311119"></a><a 
 id="x184-311120r963"></a>   (t <i>generic-function</i>  t) <b>&#x0026;rest</b>
 function-arguments
<!--l. 5074--><p class="noindent" >The generic function <i>no-applicable-method</i> is called when a generic function of the
class <i>standard-generic-function</i> is invoked and no method on that generic function
is applicable. The default method signals an error.
<!--l. 5080--><p class="indent" >   The generic function <i>no-applicable-method</i> is not intended to be called by
programmers. Programmers may write methods for it.
<!--l. 5087--><p class="indent" >   The generic-function argument of <i>no-applicable-method</i> is the generic function
object on which no applicable method was found.
<!--l. 5090--><p class="indent" >   The function-arguments argument is a list of the arguments to that generic
function.
</div>
                                                                          

                                                                          
<div class=defun>
<!--l. 5095--><p class="noindent" >  <i>[Generic function]</i>   <b>no-next-method</b> <a 
 id="dx184-311121"></a><a 
 id="x184-311122r964"></a>   <i>generic-function</i>  <i>method</i>  <b>&#x0026;rest</b>
 args <br 
class="newline" /><i>[Primary method]</i>   <b>no-next-method                           </b> <a 
 id="dx184-311123"></a><a 
 id="x184-311124r965"></a>   (t
<i>generic-function</i>  standard-generic-function) (t <i>method</i>  standard-method) <b>&#x0026;rest</b>
 args
<!--l. 5099--><p class="noindent" >The generic function <i>no-next-method</i> is called by <i>call-next-method</i> when there is
no next method. The system-supplied method on <i>no-next-method</i> signals an
error.
<!--l. 5104--><p class="indent" >   The generic function <i>no-next-method</i> is not intended to be called by
programmers. Programmers may write methods for it.
<!--l. 5111--><p class="indent" >   The generic-function argument is the generic function object to which the
method that is the second argument belongs.
<!--l. 5114--><p class="indent" >   The method argument is the method that contains the call to <i>call-next-method</i>
for which there is no next method.
<!--l. 5117--><p class="indent" >   The args argument is a list of the arguments to <i>call-next-method</i>.
<!--l. 5120--><p class="indent" >   See <i>call-next-method</i>.
</div>
<div class=defun>
<!--l. 5125--><p class="noindent" >  <i>[Generic function]</i>   <b>print-object</b> <a 
 id="dx184-311125"></a><a 
 id="x184-311126r966"></a>   <i>object</i>  <i>stream</i> <br 
class="newline" /><i>[Primary method]</i>   <b>print-object</b> <a 
 id="dx184-311127"></a><a 
 id="x184-311128r967"></a>   (t <i>object</i>  standard-object) <i>stream</i>
<!--l. 5128--><p class="noindent" >The generic function <i>print-object</i> writes the printed representation of an object to
a stream. The function <i>print-object</i> is called by the print system; it should not be
called by the user.
                                                                          

                                                                          
<!--l. 5136--><p class="indent" >   Each implementation must provide a method on the class <i>standard-object</i> and
methods on enough other classes so as to ensure that there is always an applicable
method. Implementations are free to add methods for other classes. Users can
write methods for <i>print-object</i> for their own classes if they do not wish to inherit
an implementation-supplied method.
<!--l. 5143--><p class="indent" >   The ﬁrst argument is any Lisp object. The second argument is a stream; it
cannot be <i>t</i> or <i>nil</i>.
<!--l. 5146--><p class="indent" >   The function <i>print-object</i> returns its ﬁrst argument, the object.
<!--l. 5148--><p class="indent" >   Methods on <i>print-object</i> must obey the print control special variables named
<i>*print-xxx*</i> for various xxx. The speciﬁc details are the following:
      <ul class="itemize1">
      <li class="itemize">Each method must implement <i>*print-escape*</i>.
      </li>
      <li class="itemize">The <i>*print-pretty*</i> control variable can be ignored by most methods
      other than the one for lists.
      </li>
      <li class="itemize">The <i>*print-circle*</i> control variable is handled by the printer and can
      be ignored by methods.
      </li>
      <li class="itemize">The printer takes care of <i>*print-level*</i> automatically, provided that
      each  method  handles  exactly  one  level  of  structure  and  calls  <i>write</i>
      (or  an  equivalent  function)  recursively  if  there  are  more  structural
      levels. The printer&#x2019;s decision of whether an object has components (and
      therefore should not be printed when the printing depth is not less than
      <i>*print-level*</i>) is implementation-dependent. In some implementations
      its <i>print-object</i> method is not called; in others the method is called, and
      the determination that the object has components is based on what it
      tries to write to the stream.
      </li>
      <li class="itemize">Methods   that   produce   output   of   indeﬁnite   length   must   obey
      <i>*print-length*</i>, but most methods other than the one for lists can ignore
      it.
                                                                          

                                                                          
      </li>
      <li class="itemize">The  <i>*print-base*</i>,  <i>*print-radix*</i>,  <i>*print-case*</i>,  <i>*print-gensym*</i>,  and
      <i>*print-array*</i> control variables apply to speciﬁc types of objects and
      are handled by the methods for those objects.
      </li>
      <li class="itemize">X3J13 voted in June 1989 ⟨<b>?</b>⟩ to add the following point. All methods
      for <i>print-object</i> must obey <i>*print-readably*</i>, which takes precedence
      over all other printer control variables. This includes both user-deﬁned
      methods and implementation-deﬁned methods.</li></ul>
<!--l. 5195--><p class="indent" >   If these rules are not obeyed, the results are undeﬁned.
<!--l. 5197--><p class="indent" >   In general, the printer and the <i>print-object</i> methods should not rebind the
print control variables as they operate recursively through the structure, but this
is implementation-dependent.
<!--l. 5201--><p class="indent" >   In some implementations the stream argument passed to a <i>print-object</i> method
is not the original stream but is an intermediate stream that implements part of
the printer. Methods should therefore not depend on the identity of this
stream.
<!--l. 5206--><p class="indent" >   All of the existing printing functions (<i>write</i>, <i>prin1</i>, <i>print</i>, <i>princ</i>, <i>pprint</i>,
<i>write-to-string</i>, <i>prin1-to-string</i>, <i>princ-to-string</i>, the <i><tt>~</tt>S</i> and <i><tt>~</tt>A</i> <i>format</i> operations,
and the <i><tt>~</tt>B</i>, <i><tt>~</tt>D</i>, <i><tt>~</tt>E</i>, <i><tt>~</tt>F</i>, <i><tt>~</tt>G</i>, <i><tt>~</tt>$</i>, <i><tt>~</tt>O</i>, <i><tt>~</tt>R</i>, and <i><tt>~</tt>X</i> <i>format</i> operations when they
encounter a non-numeric value) are required to be changed to go through the
<i>print-object</i> generic function. Each implementation is required to replace its
former implementation of printing with one or more <i>print-object</i> methods. Exactly
which classes have methods for <i>print-object</i> is not speciﬁed; it would be valid for
an implementation to have one default method that is inherited by all
system-deﬁned classes.
</div>
<div class=defun>
<!--l. 5223--><p class="noindent" >  <i>[Generic function]</i>   <b>reinitialize-instance</b> <a 
 id="dx184-311129"></a><a 
 id="x184-311130r968"></a>   <i>instance</i>  <b>&#x0026;rest</b>  initargs
<br 
class="newline" /><i>[Primary method]</i>   <b>reinitialize-instance</b> <a 
 id="dx184-311131"></a><a 
 id="x184-311132r969"></a>   (t <i>instance</i>  standard-object) <b>&#x0026;rest</b>
 initargs
<!--l. 5226--><p class="noindent" >The generic function <i>reinitialize-instance</i> can be used to change the values of local
slots according to initialization arguments. This generic function is called by the
Meta-Object Protocol. It can also be called by users.
<!--l. 5232--><p class="indent" >   The system-supplied primary method for <i>reinitialize-instance</i> checks the
                                                                          

                                                                          
validity of initialization arguments and signals an error if an initialization
argument is supplied that is not declared valid. The method then calls the generic
function <i>shared-initialize</i> with the following arguments: the instance, <i>nil</i> (which
means no slots should be initialized according to their <i>:initform</i> forms) and the
initialization arguments it received.
<!--l. 5244--><p class="indent" >   The instance argument is the object to be initialized.
<!--l. 5246--><p class="indent" >   The initargs argument consists of alternating initialization argument names
and values.
<!--l. 5250--><p class="indent" >   The modiﬁed instance is returned as the result.
<!--l. 5253--><p class="indent" >   Initialization arguments are declared valid by using the <i>:initarg</i> option to
<i>defclass</i>, or by deﬁning methods for <i>reinitialize-instance</i> or <i>shared-initialize</i>. The
keyword name of each keyword parameter speciﬁer in the lambda-list of any
method deﬁned on <i>reinitialize-instance</i> or <i>shared-initialize</i> is declared a
valid initialization argument name for all classes for which that method is
applicable.
<!--l. 5261--><p class="indent" >   See sections <a 
href="clmse150.html#x183-30900028.1.12">28.1.12<!--tex4ht:ref: Reinitializing-an-Instance-SECTION --></a>, <a 
href="clmse150.html#x183-29600028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, <a 
href="clmse150.html#x183-29400028.1.9">28.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <i>initialize-instance</i>, <i>slot-boundp</i>,
<i>update-instance-for-redeﬁned-class</i>, <i>update-instance-for-diﬀerent-class</i>,
<i>slot-makunbound</i>, and <i>shared-initialize</i>.
</div>
<div class=defun>
<!--l. 5272--><p class="noindent" >  <i>[Generic function]</i>   <b>remove-method</b> <a 
 id="dx184-311133"></a><a 
 id="x184-311134r970"></a>   <i>generic-function</i>  <i>method</i>
<br 
class="newline" /><i>[Primary method]</i>   <b>remove-method                              </b> <a 
 id="dx184-311135"></a><a 
 id="x184-311136r971"></a>
 (t <i>generic-function</i>  standard-generic-function) <i>method</i>
<!--l. 5275--><p class="noindent" >The generic function <i>remove-method</i> removes a method from a generic function. It
destructively modiﬁes the speciﬁed generic function and returns the modiﬁed
generic function as its result.
<!--l. 5284--><p class="indent" >   The generic-function argument is a generic function object.
<!--l. 5287--><p class="indent" >   The method argument is a method object. The function <i>remove-method</i> does
not signal an error if the method is not one of the methods on the generic
function.
<!--l. 5292--><p class="indent" >   The modiﬁed generic function is returned. The result of <i>remove-method</i> is <i>eq</i>
to the generic-function argument.
<!--l. 5295--><p class="indent" >   See <i>ﬁnd-method</i>.
</div>
<div class=defun>
<!--l. 5298--><p class="noindent" >  <i>[Generic function]</i>   <b>shared-initialize</b> <a 
 id="dx184-311137"></a><a 
 id="x184-311138r972"></a>   <i>instance</i>  <i>slot-names</i>  <b>&#x0026;rest</b>  initargs
<br 
class="newline" /><i>[Primary method]</i>   <b>shared-initialize</b> <a 
 id="dx184-311139"></a><a 
 id="x184-311140r973"></a>   (t <i>instance</i>  standard-object)
<i>slot-names</i>  <b>&#x0026;rest</b>  initargs
<!--l. 5301--><p class="noindent" >The generic function <i>shared-initialize</i> is used to ﬁll the slots of an instance using
initialization arguments and <i>:initform</i> forms. It is called when an instance is
created, when an instance is re-initialized, when an instance is updated to
conform to a redeﬁned class, and when an instance is updated to conform to
a diﬀerent class. The generic function <i>shared-initialize</i> is called by the
system-supplied primary method for <i>initialize-instance</i>, <i>reinitialize-instance</i>,
<i>update-instance-for-redeﬁned-class</i>, and <i>update-instance-for-diﬀerent-class</i>.
<!--l. 5313--><p class="indent" >   The generic function <i>shared-initialize</i> takes the following arguments:
the instance to be initialized, a speciﬁcation of a set of names of slots
accessible in that instance, and any number of initialization arguments. The
arguments after the ﬁrst two must form an initialization argument list. The
system-supplied primary method on <i>shared-initialize</i> initializes the slots with
values according to the initialization arguments and speciﬁed <i>:initform</i> forms. The
second argument indicates which slots should be initialized according to
their <i>:initform</i> forms if no initialization arguments are provided for those
slots.
<!--l. 5324--><p class="indent" >   The system-supplied primary method behaves as follows, regardless of whether
the slots are local or shared:
      <ul class="itemize1">
      <li class="itemize">If an initialization argument in the initialization argument list speciﬁes
      a value for that slot, that value is stored into the slot, even if a value
      has already been stored in the slot before the method is run.
      </li>
      <li class="itemize">Any slots indicated by the second argument that are still unbound at
      this point are initialized according to their <i>:initform</i> forms. For any
      such slot that has an <i>:initform</i> form, that form is evaluated in the
      lexical environment of its deﬁning <i>defclass</i> form and the result is stored
      into the slot. For example, if a <i>:before</i> method stores a value in the slot,
      the <i>:initform</i> form will not be used to supply a value for the slot.
      </li>
      <li class="itemize">The rules mentioned in section <a 
href="clmse150.html#x183-29600028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a> are obeyed.
      </li></ul>
                                                                          

                                                                          
<!--l. 5350--><p class="indent" >   The instance argument is the object to be initialized.
<!--l. 5352--><p class="indent" >   The slot-names argument speciﬁes the slots that are to be initialized according
to their <i>:initform</i> forms if no initialization arguments apply. It is supplied in one
of three forms as follows:
      <ul class="itemize1">
      <li class="itemize">It can be a list of slot names, which speciﬁes the set of those slot names.
      </li>
      <li class="itemize">It can be <i>nil</i>, which speciﬁes the empty set of slot names.
      </li>
      <li class="itemize">It can be the symbol <i>t</i>, which speciﬁes the set of all of the slots.
      </li></ul>
<!--l. 5370--><p class="indent" >   The initargs argument consists of alternating initialization argument names
and values.
<!--l. 5374--><p class="indent" >   The modiﬁed instance is returned as the result.
<!--l. 5377--><p class="indent" >   Initialization arguments are declared valid by using the <i>:initarg</i> option to
<i>defclass</i>, or by deﬁning methods for <i>shared-initialize</i>. The keyword name of each
keyword parameter speciﬁer in the lambda-list of any method deﬁned on
<i>shared-initialize</i> is declared a valid initialization argument name for all classes for
which that method is applicable.
<!--l. 5384--><p class="indent" >   Implementations are permitted to optimize <i>:initform</i> forms that neither
produce nor depend on side eﬀects by evaluating these forms and storing them
into slots before running any <i>initialize-instance</i> methods, rather than by handling
them in the primary <i>initialize-instance</i> method. (This optimization might be
implemented by having the <i>allocate-instance</i> method copy a prototype
instance.)
<!--l. 5392--><p class="indent" >   Implementations are permitted to optimize default initial value forms for
initialization arguments associated with slots by not actually creating the
complete initialization argument list when the only method that would receive the
complete list is the method on <i>standard-object</i>. In this case, default initial value
forms can be treated like <i>:initform</i> forms. This optimization has no visible eﬀects
other than a performance improvement.
<!--l. 5400--><p class="indent" >   See sections <a 
href="clmse150.html#x183-29200028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>, <a 
href="clmse150.html#x183-29600028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, <a 
href="clmse150.html#x183-29400028.1.9">28.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <i>initialize-instance</i>, <i>reinitialize-instance</i>,
<i>update-instance-for-redeﬁned-class</i>, <i>update-instance-for-diﬀerent-class</i>,
<i>slot-boundp</i>, and <i>slot-makunbound</i>.
                                                                          

                                                                          
</div>
<div class=defun>
<!--l. 5412--><p class="noindent" > <i>[Function]</i>   <b>slot-boundp</b> <a 
 id="dx184-311141"></a><a 
 id="x184-311142r974"></a>   <i>instance</i>  <i>slot-name</i>
<!--l. 5414--><p class="noindent" >The function <i>slot-boundp</i> tests whether a speciﬁc slot in an instance is
bound.
<!--l. 5422--><p class="indent" >   The arguments are the instance and the name of the slot.
<!--l. 5425--><p class="indent" >   The function <i>slot-boundp</i> returns true or false.
<!--l. 5428--><p class="indent" >   This function allows for writing <i>:after</i> methods on <i>initialize-instance</i> in order
to initialize only those slots that have not already been bound.
<!--l. 5432--><p class="indent" >   If no slot of the given name exists in the instance, <i>slot-missing</i> is called as
follows: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(slot-missing (class-of instance)
</td></tr></table>
<!--l. 5435--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              instance</td></tr></table>
<!--l. 5436--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              slot-name</td></tr></table>
<!--l. 5437--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x2019;slot-boundp)</td></tr></table>
<!--l. 5439--><p class="indent" >
</div>
</div>
<!--l. 5441--><p class="indent" >   The function <i>slot-boundp</i> is implemented using <i>slot-boundp-using-class</i>. See
<i>slot-missing</i>.
</div>
<div class=defun>
<!--l. 5447--><p class="noindent" > <i>[Function]</i>   <b>slot-exists-p</b> <a 
 id="dx184-311143"></a><a 
 id="x184-311144r975"></a>   <i>object</i>  <i>slot-name</i>
<!--l. 5449--><p class="noindent" >The function <i>slot-exists-p</i> tests whether the speciﬁed object has a slot of the given
name.
<!--l. 5457--><p class="indent" >   The object argument is any object. The slot-name argument is a symbol.
<!--l. 5461--><p class="indent" >   The function <i>slot-exists-p</i> returns true or false.
<!--l. 5464--><p class="indent" >   The function <i>slot-exists-p</i> is implemented using <i>slot-exists-p-using-class</i>.
</div>
<div class=defun>
<!--l. 5470--><p class="noindent" > <i>[Function]</i>   <b>slot-makunbound</b> <a 
 id="dx184-311145"></a><a 
 id="x184-311146r976"></a>   <i>instance</i>  <i>slot-name</i>
<!--l. 5472--><p class="noindent" >The function <i>slot-makunbound</i> restores a slot in an instance to the unbound
state.
<!--l. 5480--><p class="indent" >   The arguments to <i>slot-makunbound</i> are the instance and the name of the
slot.
                                                                          

                                                                          
<!--l. 5484--><p class="indent" >   The instance is returned as the result.
<!--l. 5487--><p class="indent" >   If no slot of the given name exists in the instance, <i>slot-missing</i> is called as
follows: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(slot-missing (class-of instance)
</td></tr></table>
<!--l. 5490--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              instance</td></tr></table>
<!--l. 5491--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              slot-name</td></tr></table>
<!--l. 5492--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x2019;slot-makunbound)</td></tr></table>
<!--l. 5494--><p class="indent" >
</div>
</div>
<!--l. 5496--><p class="indent" >   The function <i>slot-makunbound</i> is implemented using <i>slot-makunbound-using-class</i>.
See <i>slot-missing</i>.
</div>
<div class=defun>
<!--l. 5503--><p class="noindent" >  <i>[Generic function]</i>   <b>slot-missing</b> <a 
 id="dx184-311147"></a><a 
 id="x184-311148r977"></a>   <i>class</i>  <i>object</i>  <i>slot-name</i>  <i>operation</i>
<b>&#x0026;optional</b>  <i>new-value</i><br 
class="newline" /><i>[Primary method]</i>   <b>slot-missing</b> <a 
 id="dx184-311149"></a><a 
 id="x184-311150r978"></a>   (t <i>class</i>  t) <i>object</i>  <i>slot-name</i>  <i>operation</i>
<b>&#x0026;optional</b>  <i>new-value</i>
<!--l. 5506--><p class="noindent" >The generic function <i>slot-missing</i> is invoked when an attempt is made to access a
slot in an object whose metaclass is <i>standard-class</i> and the name of the slot
provided is not a name of a slot in that class. The default method signals an
error.
<!--l. 5513--><p class="indent" >   The generic function <i>slot-missing</i> is not intended to be called by programmers.
Programmers may write methods for it.
<!--l. 5520--><p class="indent" >   The required arguments to <i>slot-missing</i> are the class of the object that is
being accessed, the object, the slot name, and a symbol that indicates the
operation that caused <i>slot-missing</i> to be invoked. The optional argument to
<i>slot-missing</i> is used when the operation is attempting to set the value of the
slot.
<!--l. 5527--><p class="indent" >   If a method written for <i>slot-missing</i> returns values, these values get returned
as the values of the original function invocation.
<!--l. 5531--><p class="indent" >   The generic function <i>slot-missing</i> may be called during evaluation of
<i>slot-value</i>, <i>(setf slot-value)</i>, <i>slot-boundp</i>, and <i>slot-makunbound</i>. For each of these
operations the corresponding symbol for the operation argument is <i>slot-value</i>,
<i>setf </i>, <i>slot-boundp</i>, and <i>slot-makunbound</i>, respectively.
                                                                          

                                                                          
<!--l. 5538--><p class="indent" >   The set of arguments (including the class of the instance) facilitates deﬁning
methods on the metaclass for <i>slot-missing</i>.
</div>
<div class=defun>
<!--l. 5544--><p class="noindent" >  <i>[Generic function]</i>   <b>slot-unbound</b> <a 
 id="dx184-311151"></a><a 
 id="x184-311152r979"></a>   <i>class</i>  <i>instance</i>  <i>slot-name</i> <br 
class="newline" /><i>[Primary method]</i>   <b>slot-unbound</b> <a 
 id="dx184-311153"></a><a 
 id="x184-311154r980"></a>   (t <i>class</i>  t) <i>instance</i>  <i>slot-name</i>
<!--l. 5547--><p class="noindent" >The generic function <i>slot-unbound</i> is called when an unbound slot is read in an
instance whose metaclass is <i>standard-class</i>. The default method signals an
error.
<!--l. 5553--><p class="indent" >   The generic function <i>slot-unbound</i> is not intended to be called by
programmers. Programmers may write methods for it. The function <i>slot-unbound</i>
is called only by the function <i>slot-value-using-class</i> and thus indirectly by
<i>slot-value</i>.
<!--l. 5562--><p class="indent" >   The arguments to <i>slot-unbound</i> are the class of the instance whose slot was
accessed, the instance itself, and the name of the slot.
<!--l. 5567--><p class="indent" >   If a method written for <i>slot-unbound</i> returns values, these values get returned
as the values of the original function invocation.
<!--l. 5571--><p class="indent" >   An unbound slot may occur if no <i>:initform</i> form was speciﬁed for the slot and
the slot value has not been set, or if <i>slot-makunbound</i> has been called on the
slot.
<!--l. 5575--><p class="indent" >   See <i>slot-makunbound</i>.
</div>
<div class=defun>
<!--l. 5579--><p class="noindent" > <i>[Function]</i>   <b>slot-value</b> <a 
 id="dx184-311155"></a><a 
 id="x184-311156r981"></a>   <i>object</i>  <i>slot-name</i>
<!--l. 5581--><p class="noindent" >The function <i>slot-value</i> returns the value contained in the slot slot-name of the
given object. If there is no slot with that name, <i>slot-missing</i> is called. If the slot is
unbound, <i>slot-unbound</i> is called.
<!--l. 5587--><p class="indent" >   The macro <i>setf </i> can be used with <i>slot-value</i> to change the value of a
slot.
<!--l. 5594--><p class="indent" >   The arguments are the object and the name of the given slot.
<!--l. 5597--><p class="indent" >   The result is the value contained in the given slot.
<!--l. 5600--><p class="indent" >   If an attempt is made to read a slot and no slot of the given name exists in the
instance, <i>slot-missing</i> is called as follows: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(slot-missing (class-of instance)
</td></tr></table>
<!--l. 5603--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              instance</td></tr></table>
                                                                          

                                                                          
<!--l. 5604--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              slot-name</td></tr></table>
<!--l. 5605--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x2019;slot-value)</td></tr></table>
<!--l. 5607--><p class="indent" >
</div>
</div>
<!--l. 5609--><p class="indent" >   If an attempt is made to write a slot and no slot of the given name exists in
the instance, <i>slot-missing</i> is called as follows: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(slot-missing (class-of instance)
</td></tr></table>
<!--l. 5612--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              instance</td></tr></table>
<!--l. 5613--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              slot-name</td></tr></table>
<!--l. 5614--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x2019;setf</td></tr></table>
<!--l. 5615--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              new-value)</td></tr></table>
<!--l. 5617--><p class="indent" >
</div>
</div>
<!--l. 5619--><p class="indent" >   The function <i>slot-value</i> is implemented using <i>slot-value-using-class</i>.
<!--l. 5622--><p class="indent" >   Implementations may optimize <i>slot-value</i> by compiling it in-line.
<!--l. 5624--><p class="indent" >   See <i>slot-missing</i> and <i>slot-unbound</i>.
</div>
<!--l. 5628--><p class="indent" >   [At this point the original CLOS report <span class="cite">[<a 
href="clmli5.html#XSIGPLAN-CLOS">5</a>, <a 
href="clmli5.html#XLASC-CLOS-PART-2">7</a>]</span> contained a speciﬁcation for
<i>symbol-macrolet</i>. This speciﬁcation is omitted here. Instead, a description of
<i>symbol-macrolet</i> appears with those of related constructs in chapter <a 
href="clmch7.html#x46-760007">7<!--tex4ht:ref: CONTRL --></a>.—GLS]
<div class=defun>
<!--l. 5634--><p class="noindent" >  <i>[Generic function]</i>   <b>update-instance-for-diﬀerent-class          </b> <a 
 id="dx184-311157"></a><a 
 id="x184-311158r982"></a>
 <i>previous</i>  <i>current</i>  <b>&#x0026;rest</b>  initargs <br 
class="newline" /><i>[Primary method]</i>   <b>update-instance-for-diﬀerent-class</b> <a 
 id="dx184-311159"></a><a 
 id="x184-311160r983"></a>   (t <i>previous</i>
 standard-object) (t <i>current</i>  standard-object) <b>&#x0026;rest</b>  initargs
<!--l. 5638--><p class="noindent" >The generic function <i>update-instance-for-diﬀerent-class</i> is not intended to be
called by programmers. Programmers may write methods for it. This function is
called only by the function <i>change-class</i>.
<!--l. 5643--><p class="indent" >   The system-supplied primary method on <i>update-instance-for-diﬀerent-class</i>
checks the validity of initialization arguments and signals an error if an
initialization argument is supplied that is not declared valid. This method then
initializes slots with values according to the initialization arguments and
                                                                          

                                                                          
initializes the newly added slots with values according to their <i>:initform</i>
forms. It does this by calling the generic function <i>shared-initialize</i> with the
following arguments: the instance, a list of names of the newly added
slots, and the initialization arguments it received. Newly added slots are
those local slots for which no slot of the same name exists in the previous
class.
<!--l. 5655--><p class="indent" >   Methods for <i>update-instance-for-diﬀerent-class</i> can be deﬁned to specify
actions to be taken when an instance is updated. If only <i>:after</i> methods for
<i>update-instance-for-diﬀerent-class</i> are deﬁned, they will be run after the
system-supplied primary method for initialization and therefore will not interfere
with the default behavior of <i>update-instance-for-diﬀerent-class</i>.
<!--l. 5668--><p class="indent" >   The arguments to <i>update-instance-for-diﬀerent-class</i> are computed by
<i>change-class</i>. When <i>change-class</i> is invoked on an instance, a copy of
that instance is made; <i>change-class</i> then destructively alters the original
instance. The ﬁrst argument to <i>update-instance-for-diﬀerent-class</i>, previous, is
that copy; it holds the old slot values temporarily. This argument has
dynamic extent within <i>change-class</i>; if it is referenced in any way once
<i>update-instance-for-diﬀerent-class</i> returns, the results are undeﬁned. The second
argument to <i>update-instance-for-diﬀerent-class</i>, current, is the altered original
instance.
<!--l. 5681--><p class="indent" >   The intended use of previous is to extract old slot values by using <i>slot-value</i> or
<i>with-slots</i> or by invoking a reader generic function, or to run other methods that
were applicable to instances of the original class.
<!--l. 5686--><p class="indent" >   The initargs argument consists of alternating initialization argument names
and values.
<!--l. 5690--><p class="indent" >   The value returned by <i>update-instance-for-diﬀerent-class</i> is ignored by
<i>change-class</i>.
<!--l. 5693--><p class="indent" >   See the example for the function <i>change-class</i>.
<!--l. 5696--><p class="indent" >   Initialization arguments are declared valid by using the <i>:initarg</i> option to
<i>defclass</i>, or by deﬁning methods for <i>update-instance-for-diﬀerent-class</i> or
<i>shared-initialize</i>. The keyword name of each keyword parameter speciﬁer in the
lambda-list of any method deﬁned on <i>update-instance-for-diﬀerent-class</i> or
<i>shared-initialize</i> is declared a valid initialization argument name for all classes for
which that method is applicable.
<!--l. 5704--><p class="indent" >   Methods on <i>update-instance-for-diﬀerent-class</i> can be deﬁned to initialize slots
diﬀerently from <i>change-class</i>. The default behavior of <i>change-class</i> is described in
section <a 
href="clmse150.html#x183-30500028.1.11">28.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a>.
<!--l. 5710--><p class="indent" >   See sections <a 
href="clmse150.html#x183-30500028.1.11">28.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a>, <a 
href="clmse150.html#x183-29600028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, and <a 
href="clmse150.html#x183-29400028.1.9">28.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <i>change-class</i> and
                                                                          

                                                                          
<i>shared-initialize</i>.
</div>
                                                                          

                                                                          
<div class=defun>
<!--l. 5718--><p class="noindent" >  <i>[Generic function]</i>   <b>update-instance-for-redeﬁned-class              </b>
<a 
 id="dx184-311161"></a><a 
 id="x184-311162r984"></a>   <i>instance</i>  <i>added-slots</i>  <i>discarded-slots</i>  <i>property-list</i>  <b>&#x0026;rest</b>  initargs
<br 
class="newline" /><i>[Primary method]</i>   <b>update-instance-for-redeﬁned-class</b> <a 
 id="dx184-311163"></a><a 
 id="x184-311164r985"></a>   (t <i>instance</i>
 standard-object) <i>added-slots</i>  <i>discarded-slots</i>  <i>property-list</i>  <b>&#x0026;rest</b>  initargs
<!--l. 5723--><p class="noindent" >
<!--l. 5726--><p class="noindent" >The generic function <i>update-instance-for-redeﬁned-class</i> is not intended to be
called by programmers. Programmers may write methods for it. The generic
function <i>update-instance-for-redeﬁned-class</i> is called by the mechanism activated
by <i>make-instances-obsolete</i>.
<!--l. 5733--><p class="indent" >   The system-supplied primary method on <i>update-instance-for-diﬀerent-class</i>
checks the validity of initialization arguments and signals an error if an
initialization argument is supplied that is not declared valid. This method then
initializes slots with values according to the initialization arguments and initializes
the newly added slots with values according to their <i>:initform</i> forms. It does
this by calling the generic function <i>shared-initialize</i> with the following
arguments: the instance, a list of names of the newly added slots, and the
initialization arguments it received. Newly added slots are those local
slots for which no slot of the same name exists in the old version of the
class.
<!--l. 5749--><p class="indent" >   When <i>make-instances-obsolete</i> is invoked or when a class has been redeﬁned
and an instance is being updated, a property list is created that captures the slot
names and values of all the discarded slots with values in the original instance.
The structure of the instance is transformed so that it conforms to the
current class deﬁnition. The arguments to <i>update-instance-for-redeﬁned-class</i>
are this transformed instance, a list of the names of the new slots added
to the instance, a list of the names of the old slots discarded from the
instance, and the property list containing the slot names and values for slots
that were discarded and had values. Included in this list of discarded
slots are slots that were local in the old class and are shared in the new
class.
<!--l. 5762--><p class="indent" >   The initargs argument consists of alternating initialization argument names
and values.
<!--l. 5766--><p class="indent" >   The value returned by <i>update-instance-for-redeﬁned-class</i> is ignored.
<!--l. 5769--><p class="indent" >   Initialization arguments are declared valid by using the <i>:initarg</i> option to
<i>defclass</i> or by deﬁning methods for <i>update-instance-for-redeﬁned-class</i> or
<i>shared-initialize</i>. The keyword name of each keyword parameter speciﬁer in the
                                                                          

                                                                          
lambda-list of any method deﬁned on <i>update-instance-for-redeﬁned-class</i> or
<i>shared-initialize</i> is declared a valid initialization argument name for all classes for
which that method is applicable.
<!--l. 5778--><p class="indent" >   See sections <a 
href="clmse150.html#x183-30000028.1.10">28.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a>, <a 
href="clmse150.html#x183-29600028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, and <a 
href="clmse150.html#x183-29400028.1.9">28.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <i>shared-initialize</i> and
<i>make-instances-obsolete</i>.
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass position () ())
</td></tr></table>
<!--l. 5785--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5786--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass x-y-position (position)</td></tr></table>
<!--l. 5787--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ((x :initform 0 :accessor position-x)</td></tr></table>
<!--l. 5788--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (y :initform 0 :accessor position-y)))</td></tr></table>
<!--l. 5789--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5790--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; It turns out polar coordinates are used more than Cartesian</td></tr></table>
<!--l. 5791--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; coordinates, so the representation is altered and some new</td></tr></table>
<!--l. 5792--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; accessor methods are added.</td></tr></table>
<!--l. 5793--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5794--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod update-instance-for-redeﬁned-class :before</td></tr></table>
<!--l. 5795--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           ((pos x-y-position) added deleted plist &#x0026;key)</td></tr></table>
<!--l. 5796--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Transform the x-y coordinates to polar coordinates</td></tr></table>
<!--l. 5797--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; and store into the new slots.</td></tr></table>
<!--l. 5798--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((x (getf plist &#x2019;x))</td></tr></table>
<!--l. 5799--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (y (getf plist &#x2019;y)))</td></tr></table>
<!--l. 5800--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (setf (position-rho pos) (sqrt (+ (* x x) (* y y)))</td></tr></table>
<!--l. 5801--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (position-theta pos) (atan y x))))</td></tr></table>
<!--l. 5802--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5803--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass x-y-position (position)</td></tr></table>
<!--l. 5804--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ((rho :initform 0 :accessor position-rho)</td></tr></table>
<!--l. 5805--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (theta :initform 0 :accessor position-theta)))</td></tr></table>
<!--l. 5807--><p class="indent" >
</div>
</div><div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; All instances of the old x-y-position class will be updated
</td></tr></table>
<!--l. 5811--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; automatically.</td></tr></table>
<!--l. 5812--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5813--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The new representation has the look and feel of the old one.</td></tr></table>
<!--l. 5814--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5815--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod position-x ((pos x-y-position))</td></tr></table>
<!--l. 5816--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (with-slots (rho theta) pos (* rho (cos theta))))</td></tr></table>
<!--l. 5817--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5818--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod (setf position-x) (new-x (pos x-y-position))</td></tr></table>
<!--l. 5819--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (with-slots (rho theta) pos</td></tr></table>
<!--l. 5820--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (let ((y (position-y pos)))</td></tr></table>
<!--l. 5821--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (setq rho (sqrt (+ (* new-x new-x) (* y y)))</td></tr></table>
<!--l. 5822--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             theta (atan y new-x))</td></tr></table>
<!--l. 5823--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       new-x)))</td></tr></table>
<!--l. 5824--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5825--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod position-y ((pos x-y-position))</td></tr></table>
<!--l. 5826--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (with-slots (rho theta) pos (* rho (sin theta))))</td></tr></table>
<!--l. 5828--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod (setf position-y) (new-y (pos x-y-position))
</td></tr></table>
<!--l. 5830--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (with-slots (rho theta) pos</td></tr></table>
<!--l. 5831--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (let ((x (position-x pos)))</td></tr></table>
<!--l. 5832--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (setq rho (sqrt (+ (* x x) (* new-y new-y)))</td></tr></table>
<!--l. 5833--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             theta (atan new-y x))</td></tr></table>
<!--l. 5834--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       new-y)))</td></tr></table>
<!--l. 5836--><p class="indent" >
</div>
</div>
</div>
                                                                          

                                                                          
<div class=defmac>
<!--l. 5844--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> with-accessors </b> <a 
 id="dx184-311165"></a><a 
 id="x184-311166r986"></a>   ( {<i>slot − entry</i>}∗ ) instance-form  {<i>declaration</i>}∗  {<i>form</i>}∗
</td></tr></table>
<!--l. 5846--><p class="indent" >
</div>
   The macro <i>with-accessors</i> creates a lexical environment in which speciﬁed slots
are lexically available through their accessors as if they were variables.
The macro <i>with-accessors</i> invokes the appropriate accessors to access the
speciﬁed slots. Both <i>setf </i> and <i>setq</i> can be used to set the value of the
slot.
   The result returned is that obtained by executing the forms speciﬁed by the
body argument.
   Example:
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-accessors ((x position-x) (y position-y)) p1
</td></tr></table>
<!--l. 5861--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (setq x y))</td></tr></table>
<!--l. 5863--><p class="indent" >
</div>
</div>
<!--l. 5866--><p class="noindent" >A <i>with-accessors</i> expression of the form <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-accessors (slot-entry<sub>1</sub> ... slot-entry<sub>n</sub>) instance
</td></tr></table>
<!--l. 5868--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  declaration<sub>1</sub> ... declaration<sub>m</sub>)</td></tr></table>
<!--l. 5869--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  form<sub>1</sub> ... form<sub>k</sub>)</td></tr></table>
<!--l. 5871--><p class="indent" >
</div>
</div>
<!--l. 5872--><p class="noindent" >expands into the equivalent of <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(let ((in instance))
</td></tr></table>
<!--l. 5874--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (symbol-macrolet ((variable-name<sub>1</sub> (accessor-name<sub>1</sub> in))</td></tr></table>
<!--l. 5875--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    ...</td></tr></table>
<!--l. 5876--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    (variable-name<sub>n</sub> (accessor-name<sub>n</sub> in)))</td></tr></table>
<!--l. 5877--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    declaration<sub>1</sub> ... declaration<sub>m</sub>)</td></tr></table>
<!--l. 5878--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    form<sub>1</sub> ... form<sub>k</sub>)</td></tr></table>
<!--l. 5880--><p class="indent" >
</div>
</div>
<!--l. 5882--><p class="indent" >   [X3J13 voted in March 1989 ⟨<b>?</b>⟩ to modify the deﬁnition of <i>symbol-macrolet</i>
substantially and also voted ⟨<b>?</b>⟩ to allow declarations before the body of
<i>symbol-macrolet</i> but with peculiar treatment of <i>special</i> and type declarations. The
syntactic changes are reﬂected in this deﬁnition of <i>with-accessors</i>.—GLS]
<!--l. 5891--><p class="indent" >   See <i>with-slots</i> and <i>symbol-macrolet</i>.
</div>
<div class=defspec>
<!--l. 5896--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> with-added-methods </b> <a 
 id="dx184-311167"></a><a 
 id="x184-311168r987"></a>   (function-name lambda-list  [[ <i>↓option|{<i>method − description</i>}∗ </div> ]] ) {<i>form</i>}∗
</td></tr></table>
<!--l. 5899--><p class="indent" >
</div>
   The <i>with-added-methods</i> special form produces new generic functions and
establishes new lexical function deﬁnition bindings. Each generic function is
created by adding the set of methods speciﬁed by its method deﬁnitions to a copy
of the lexically visible generic function of the same name and its methods. If such
a generic function does not already exist, a new generic function is created; this
generic function has lexical scope.
   The special form <i>with-added-methods</i> is used to deﬁne functions whose names
are meaningful only locally and to execute a series of forms with these function
deﬁnition bindings.
   The names of functions deﬁned by <i>with-added-methods</i> have lexical scope; they
retain their local deﬁnitions only within the body of the <i>with-added-methods</i>
                                                                          

                                                                          
construct. Any references within the body of the <i>with-added-methods</i>
construct to functions whose names are the same as those deﬁned within the
<i>with-added-methods</i> form are thus references to the local functions instead of to
any global functions of the same names. The scope of these generic function
deﬁnition bindings includes the method bodies themselves as well as the body of
the <i>with-added-methods</i> construct.
   The function-name, option, method-qualiﬁer, and specialized-lambda-list
arguments are the same as for <i>defgeneric</i>.
   The body of each method is enclosed in an implicit block. If function-name
is a symbol, this block bears the same name as the generic function. If
function-name is a list of the form <i>(setf symbol)</i>, the name of the block is
symbol.
   The result returned by <i>with-added-methods</i> is the value or values of the
last form executed. If no forms are speciﬁed, <i>with-added-methods</i> returns
<i>nil</i>.
   If a generic function with the given name already exists, the lambda-list
speciﬁed in the <i>with-added-methods</i> form must be congruent with the lambda-lists
of all existing methods on that function as well as with the lambda-lists of all
methods deﬁned by the <i>with-added-methods</i> form; otherwise an error is
signaled.
   If function-name speciﬁes an existing generic function that has a diﬀerent
value for any of the following option arguments, the copy of that generic function
is modiﬁed to have the new value: <i>:argument-precedence-order</i>, <i>declare</i>,
<i>:documentation</i>, <i>:generic-function-class</i>, <i>:method-combination</i>.
   If function-name speciﬁes an existing generic function that has a diﬀerent
value for the <i>:method-class</i> option argument, that value is changed in the copy of
that generic function, but any methods copied from the existing generic function
are not changed.
   If a function of the given name already exists, that function is copied into the
default method for a generic function of the given name. Note that this behavior
diﬀers from that of <i>defgeneric</i>.
   If a macro or special form of the given name already exists, an error is
signaled.
   If there is no existing generic function, the option arguments have the same
default values as the option arguments to <i>defgeneric</i>.
   See <i>generic-labels</i>, <i>generic-ﬂet</i>, <i>defmethod</i>, <i>defgeneric</i>, and <i>ensure-generic-function</i>.
</div>
<div class=defmac>
                                                                          

                                                                          
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> with-slots </b> <a 
 id="dx184-311169"></a><a 
 id="x184-311170r988"></a>   ( {<i>slot − entry</i>}∗ ) instance-form  {<i>declaration</i>}∗  {<i>form</i>}∗
</td></tr></table>
<!--l. 5981--><p class="indent" >
</div>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">slot-entry ::= slot-name |<i>(variable-name slot-name)</i>
</td></tr></table>
<!--l. 5984--><p class="indent" >
</div>
<!--l. 5985--><p class="noindent" >The macro <i>with-slots</i> creates a lexical context for referring to speciﬁed slots as though
they were variables. Within such a context the value of the slot can be speciﬁed
by using its slot name, as if it were a lexically bound variable. Both <i>setf </i> and <i>setq</i>
can be used to set the value of the slot.
<!--l. 5991--><p class="indent" >   The macro <i>with-slots</i> translates an appearance of the slot name as a variable
into a call to <i>slot-value</i>.
<!--l. 5998--><p class="indent" >   The result returned is that obtained by executing the forms speciﬁed by the
body argument.
<!--l. 6001--><p class="indent" >   Example:
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-slots (x y) position-1
</td></tr></table>
<!--l. 6004--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (sqrt (+ (* x x) (* y y))))</td></tr></table>
<!--l. 6005--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 6006--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-slots ((x1 x) (y1 y)) position-1</td></tr></table>
<!--l. 6007--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (with-slots ((x2 x) (y2 y)) position-2</td></tr></table>
<!--l. 6008--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (psetf x1 x2</td></tr></table>
<!--l. 6009--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           y1 y2))))</td></tr></table>
<!--l. 6010--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 6011--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-slots (x y) position</td></tr></table>
                                                                          

                                                                          
<!--l. 6012--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (setq x (1+ x)</td></tr></table>
<!--l. 6013--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        y (1+ y)))</td></tr></table>
<!--l. 6015--><p class="indent" >
</div>
</div>
<!--l. 6018--><p class="indent" >   A <i>with-slots</i> expression of the form: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-slots (slot-entry<sub>1</sub> ... slot-entry<sub>n</sub>) instance
</td></tr></table>
<!--l. 6020--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  declaration<sub>1</sub> ... declaration<sub>m</sub>)</td></tr></table>
<!--l. 6021--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  form<sub>1</sub> ... form<sub>k</sub>)</td></tr></table>
<!--l. 6023--><p class="indent" >
</div>
</div>
<!--l. 6024--><p class="noindent" >expands into the equivalent of <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(let ((in instance))
</td></tr></table>
<!--l. 6026--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (symbol-macrolet (Q<sub>1</sub> ... Q<sub>n</sub>)</td></tr></table>
<!--l. 6027--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    declaration<sub>1</sub> ... declaration<sub>m</sub>)</td></tr></table>
<!--l. 6028--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    form<sub>1</sub> ... form<sub>k</sub>)</td></tr></table>
<!--l. 6030--><p class="indent" >
</div>
</div>
<!--l. 6031--><p class="noindent" >where Q<sub>j</sub> is <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(slot-entry<sub>j</sub> (slot-value in &#x2019;slot-entry<sub>j</sub>))
</td></tr></table>
<!--l. 6034--><p class="indent" >
</div>
</div>
<!--l. 6035--><p class="noindent" >if  slot-entry<sub>j</sub> is a symbol and is <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(variable-name<sub>j</sub> (slot-value in &#x2019;slot-name<sub>j</sub>))
</td></tr></table>
<!--l. 6038--><p class="indent" >
</div>
</div>
<!--l. 6039--><p class="noindent" >if  slot-entry<sub>j</sub> is of the form <i>(variable-name<sub>j</sub> slot-name<sub>j</sub>)</i>.
<!--l. 6042--><p class="indent" >   [X3J13 voted in March 1989 ⟨<b>?</b>⟩ to modify the deﬁnition of <i>symbol-macrolet</i>
substantially and also voted ⟨<b>?</b>⟩ to allow declarations before the body of
<i>symbol-macrolet</i> but with peculiar treatment of <i>special</i> and type declarations. The
syntactic changes are reﬂected in this deﬁnition of <i>with-slots</i>.—GLS]
<!--l. 6051--><p class="indent" >   See <i>with-accessors</i> and <i>symbol-macrolet</i>.
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
   Kent M. Pitman
                                                                          

                                                                          
   <!--l. 9--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch29.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse150.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse150.html#tailclmse150.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse151.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch28.html#clmse151.html" >Up</a><tt>&#x003E;</tt></p></div>
   <a 
 id="tailclmse151.html"></a>  
</body></html> 
