<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Создание массива</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-16 00:55:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 1018--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse91.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#tailclmch17.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse90.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#clmse90.html" >Наверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">17.1   </span> <a 
href="clm.html#QQ2-112-1469" id="x112-146000017.1">Создание
массива</a></h3>
<!--l. 1020--><p class="noindent" >Не волнуйтесь о большом количестве опций для функции <tt><a 
href="#x112-1460002r518">make-array</a></tt>. Все
что действительно необходимо, это список размерностей. Остальные же
опции служат для относительно эзотерических программ.
<div class="defun">
<!--l. 1024--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx112-1460001"></a><a 
 id="x112-1460002r518"></a><b> make-array</b>  <i>dimensions</i> &#x0026;key  <i>:element-type</i> <i>:initial-element</i>
<i>:initial-contents</i> <i>:adjustable</i> <i>:ﬁll-pointer</i> <i>:displaced-to</i> <i>:displaced-index-oﬀset</i>
</div>
<!--l. 1026--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-146100017.1" id="x112-146100017.1"></a></span>
   Это базовая функция для создания массивов. Аргумент <i>dimensions</i>
должен быть списком неотрицательных целых чисел, которые являются
                                                                          

                                                                          
измерениями массива. Длина списка является размерностью массива.
Каждое измерение должно быть меньше чем <tt><a 
href="#x112-1466002r520">array-dimension-limit</a></tt>, и
произведение всех измерений должно быть меньше <tt><a 
href="#x112-1467002r521">array-total-size-limit</a></tt>.
Следует отметить, что если <i>dimensions</i> <tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt>, тогда создаётся массив с
нулевым количеством измерений. По соглашению, при создании одномерного
массива, размер измерений может быть указан как одиночное целое число, а
не список целых чисел.
<!--l. 1037--><p class="indent" >   Реализация Common Lisp&#x2019;а может иметь ограничение на ранг массива, но
это ограничение должно быть меньше 7. Таким образом, любая Common Lisp
программа может использовать массивы с рангом меньшим или равным
7.
<!--l. 1041--><p class="indent" >   Для <tt><a 
href="#x112-1460002r518">make-array</a></tt> существуют следующие именованные параметры:
<div class="flushdesc">
<!--l. 1044--><p class="indent" >
      <ul><li><b>
<tt>:element-type</tt> </b></li>Этот  аргумент  должен  быть  именем  типа  элементов
      массива. Массив создаётся с наиболее близким типом к указанному,
      и  не  может  содержать  объекты  отличные  от  этого  типа.  Тип  <tt><a 
href="clmse31.html#x42-313002r19">t</a></tt>
      указывает на создание общего массива, элементы которого могут
      быть любыми объектами. <tt><a 
href="clmse31.html#x42-313002r19">t</a></tt> является значением по-умолчанию.
      <li><b>
<tt>:initial-element</tt> </b></li>Этот                      аргумент                      может
      использоваться  для  инициализации  каждого  элемента  массива.
      Значение  должно  принадлежать  типу  указанному  в  аргументе
      <tt>:element-type</tt>.  Если  <tt>:initial-element</tt> опущен,  тогда  значение
      по-умолчанию для элементов массива не определено (если только
      не  используется  <tt>:initial-contents</tt> или  <tt>:displaced-to</tt>).  Опция
      <tt>:initial-element</tt> может не использоваться, когда указана опция
      <tt>:initial-contents</tt> или <tt>:displaced-to</tt>.
      <li><b>
<tt>:initial-contents</tt> </b></li>Этот аргумент может использоваться для инициализации
      содержимого массива. Значением параметра является структура
      вложенных последовательностей. Если массив с нулевым количеством
      измерений, тогда значение задаёт одиночный элемент. В противном
      случае, значение должно быть последовательностью с длинной, равной
      размеру первого измерения. Каждый вложенный элемент также должен
                                                                          

                                                                          
      быть последовательностью, размером равным следующему измерению
      массива. Например: <div class="lisp"><div class="tabbing">
      (make-array &#x2019;(4 2 3)
      <br>                                                                 :initial-contents<br>
                       &#x2019;(((a b c) (1 2 3))<br>
                         ((d e f) (3 1 2))<br>
                         ((g h i) (2 3 1))<br>
                         ((j k l) (0 0 0))))<br>
      <!--l. 1077--><p class="noindent" ></div>
      <!--l. 1077--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-146200017.1" id="x112-146200017.1"></a></span>
      <!--l. 1077--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-146300017.1" id="x112-146300017.1"></a></span>
</div>
      <!--l. 1078--><p class="noindent" >Количество уровней в структуре должно равняться рангу массива.
      Каждый лист вложенной структуры должен иметь тип, указанный в
      опции <tt>:type</tt>. Если опция <tt>:initial-contents</tt> опущена, первоначальное
      значение элементов массива не определено (если только не используется
      опция <tt>:initial-element</tt> или <tt>:displaced-to</tt>). Опция <tt>:initial-contents</tt>
      может не использоваться, когда указана опция <tt>:initial-element</tt> или
      <tt>:displaced-to</tt>.
      <li><b>
<tt>:adjustable</tt> </b></li>Если данный аргумент указан и не является <tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt>, тогда размер
      массива после создания может быть изменён. По-умолчанию параметр
      равен <tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt>.
      <li><b>
<tt>:fill-pointer</tt> </b></li>Данный аргумент указывает, что массив должен иметь
      указатель заполнения. Если эта опция указана и не является <tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt>, тогда
      массив должен быть одномерным. Значение используется для
                                                                          

                                                                          
      инициализации указателя заполнения массива. Если указано
      значение <tt><a 
href="clmse31.html#x42-313002r19">t</a></tt>, тогда используется длина массива. Иначе, значение
      должно быть целым числом между нулём (включительно) и
      длинной массива (включительно)ю Аргумент по-умолчанию равен
      <tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt>.
      <li><b>
<tt>:displaced-to</tt> </b></li>Если данный аргумент указан и не является <tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt>, то он
      указывает на то, что массив будет <i>соединён</i> с другим массивом. Значение
      аргумента должно быть уже созданным массивом. <tt><a 
href="#x112-1460002r518">make-array</a></tt> создаст
      <i>косвенный</i> или <i>разделяемый</i> массив, который имеет общее содержимое с
      указанным массивом. В таком случае опция <tt>:displaced-index-offset</tt>
      позволяет указать смещение общей части массивов. Если массив,
      переданный в аргумент <tt>:displaced-to</tt>, не имеет такого же типа
      элементов (<tt>:element-type</tt>), как и создаваемый массив, то генерируется
      ошибка. Опция <tt>:displaced-to</tt> не может использоваться вместе с
      опцией <tt>:initial-element</tt> или <tt>:initial-contents</tt>. По-умолчанию
      аргумент равен <tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt>.
      <li><b>
<tt>:displaced-index-offset</tt> </b></li>Данный аргумент может использоваться только в
      сочетании с опцией <tt>:displaced-to</tt>. Она должна быть неотрицательным
      целым (по-умолчанию равна нулю). Она означает смещение
      создаваемого <i>разделяемого</i> массива относительно исходного.
      <!--l. 1120--><p class="noindent" >Если при создании массива B массив A передан в качестве аргумента
      <tt>:displaced-to</tt> в функцию <tt><a 
href="#x112-1460002r518">make-array</a></tt>, тогда массив B называется
      <i>соединённым</i> с массивом A. Полное количество элементов массива,
      называемое <i>полный размер</i> массива, вычисляется как произведение
      размеров всех измерений (смотрите <tt><a 
href="clmse92.html#x114-1485002r529">array-total-size</a></tt>). Необходимо,
      чтобы полный размер массива A был не меньше чем сумма <i>полного
      размера</i> массива B и смещения <i>n</i>, указанного в аргументе
      <tt>:displaced-index-offset</tt>. Смысл соединения массивов в том, что
      массив B не имеет своих элементов и операции над ним приводят в
      действительности к операциям над массивом A. При отображении
      элементов массивов, последние рассматриваются как одномерные, с
      построчным порядком размещения элементов. Так, элемент с индексом
      <i>k</i> массива <i>B</i> отображается в элемент с индексом <i>k</i>+<i>n</i> массива
      <i>A</i>.</ul>
                                                                          

                                                                          
</div>
<!--l. 1136--><p class="indent" >   Если <tt><a 
href="#x112-1460002r518">make-array</a></tt> вызывается без указания аргументов <tt>:adjustable</tt>,
<tt>:fill-pointer</tt> и <tt>:displaced-to</tt>, или указания их в <tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt>, тогда получаемый
массив гарантированного будет <i>простым</i> (смотрите раздел <a 
href="clmse7.html#x14-950002.5">2.5<!--tex4ht:ref: ARRAY-TYPE-SECTION --></a>).
<!--l. 1141--><p class="indent" >   Вот несколько примеров использования <tt><a 
href="#x112-1460002r518">make-array</a></tt>: <div class="lisp"><div class="tabbing">
;;; Создание одномерного массива с пятью элементами.
   <br>                                      (make-array 5)<br>                                      <br>
;;; Создание двумерного массива, 3 на 4, с четырёхбитными элементами.<br>
(make-array &#x2019;(3 4) <tt>:element-type</tt> &#x2019;(mod 16))<br>                             <br>
;;; Создание массива чисел с плавающей точкой.<br>
(make-array 5 <tt>:element-type</tt> &#x2019;single-ﬂoat))<br>                               <br>
;;; Создание соединённого массива.<br>           (setq a (make-array &#x2019;(4 3)))<br>
(setq b (make-array 8 :displaced-to a<br>                      :displaced-index-oﬀset 2))<br>
;;; В таком случае:<br>                             (aref b 0) <span class="math"> ≡</span> (aref a 0 2)<br>
        (aref b 1) <span class="math"> ≡</span> (aref a 1 0)<br>              (aref b 2) <span class="math"> ≡</span> (aref a 1 1)<br>
        (aref b 3) <span class="math"> ≡</span> (aref a 1 2)<br>              (aref b 4) <span class="math"> ≡</span> (aref a 2 0)<br>
        (aref b 5) <span class="math"> ≡</span> (aref a 2 1)<br>              (aref b 6) <span class="math"> ≡</span> (aref a 2 2)<br>
        (aref b 7) <span class="math"> ≡</span> (aref a 3 0)<br>
<!--l. 1165--><p class="noindent" ></div>
<!--l. 1165--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-146400017.1" id="x112-146400017.1"></a></span>
<!--l. 1165--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-146500017.1" id="x112-146500017.1"></a></span>
</div>
</div>
<div class="defun">
<!--l. 1168--><p class="noindent" ><div class="defunheader"> <i>[Константа]</i><a 
 id="dx112-1465001"></a><a 
 id="x112-1465002r519"></a><b> array-rank-limit</b>
</div>
<!--l. 1170--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-146600017.1" id="x112-146600017.1"></a></span>
   Значение <tt><a 
href="#x112-1465002r519">array-rank-limit</a></tt> является положительным целым, которое
обозначает (невключительно) наивысший возможный ранг массива. Это
значение зависит от реализации, но не может быть меньше 8. Таком образом
                                                                          

                                                                          
каждая реализация Common Lisp&#x2019;а поддерживает массивы, ранг которых
лежит между 0 и 7 (включительно). (Разработчикам предлагается сделать
это значение большим настолько, на сколько это возможно без ущерба в
производительности.)
</div>
<div class="defun">
<!--l. 1180--><p class="noindent" ><div class="defunheader"> <i>[Константа]</i><a 
 id="dx112-1466001"></a><a 
 id="x112-1466002r520"></a><b> array-dimension-limit</b>
</div>
<!--l. 1182--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-146700017.1" id="x112-146700017.1"></a></span>
   Значение <tt><a 
href="#x112-1466002r520">array-dimension-limit</a></tt> является положительным целым,
которое обозначает (невключительно) наивысший возможный размер
измерения для массива. Это значение зависит от реализации, но не
может быть меньше 1024. (Разработчикам предлагается сделать это
значение большим настолько, на сколько это возможно без ущерба в
производительности.)
</div>
<div class="defun">
<!--l. 1190--><p class="noindent" ><div class="defunheader"> <i>[Константа]</i><a 
 id="dx112-1467001"></a><a 
 id="x112-1467002r521"></a><b> array-total-size-limit</b>
</div>
<!--l. 1192--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-146800017.1" id="x112-146800017.1"></a></span>
   Значение <tt><a 
href="#x112-1467002r521">array-total-size-limit</a></tt> является положительным целым,
которое обозначает (невключительно) наивысшее возможное количество
элементов в массиве. Это значение зависит от реализации, но не может быть
меньше 1024. (Разработчикам предлагается сделать это значение большим
настолько, на сколько это возможно без ущерба в производительности.)
<!--l. 1199--><p class="indent" >   На практике предельный размер массива может зависеть от типа
элемента массива, в таком случае <tt><a 
href="#x112-1467002r521">array-total-size-limit</a></tt> будет
наименьшим из ряда этих размеров.
</div>
<div class="defun">
<!--l. 1203--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx112-1468001"></a><a 
 id="x112-1468002r522"></a><b> vector</b>  &#x0026;rest  <i>objects</i>
</div>
<!--l. 1205--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-146900017.1" id="x112-146900017.1"></a></span>
   Функция <tt><a 
href="#x112-1468002r522">vector</a></tt> служит для создания простых базовых векторов с
                                                                          

                                                                          
заданным содержимым. Она является аналогом для функции <tt><a 
href="clmse83.html#x103-1304002r458">list</a></tt>.
<div class="lisp"><div class="tabbing">
(vector <span class="math"><i>a</i><sub>1</sub></span> <span class="math"><i>a</i><sub>2</sub></span> ... <span class="math"><i>a</i><sub>n</sub></span>)
   <br>                                          <span class="math"> ≡</span> (make-array (list <span class="math"><i>n</i></span>) :element-type t<br>
             :initial-contents (list <span class="math"><i>a</i><sub>1</sub></span> <span class="math"><i>a</i><sub>2</sub></span> ... <span class="math"><i>a</i><sub>n</sub></span>))<br>
<!--l. 1213--><p class="noindent" ></div>
<!--l. 1213--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-147000017.1" id="x112-147000017.1"></a></span>
<!--l. 1213--><p class="noindent" ><span class="paragraphHead"><a 
href="#x112-147100017.1" id="x112-147100017.1"></a></span>
</div>
</div>
                                                                          

                                                                          
<!--l. 1216--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse91.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#tailclmch17.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse90.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch17.html#clmse90.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse90.html"></a>  </div> </div> 
</body></html> 
