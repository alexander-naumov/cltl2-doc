<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Функции и переменные для системы пакетов</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-16 23:44:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 2179--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmch12.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse62.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse62.html#tailclmse62.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse63.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch11.html#clmse63.html" >Наверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">11.7   </span> <a 
href="clm.html#QQ2-79-999" id="x79-99000011.7">Функции и
переменные для системы пакетов</a></h3>
<div class="implementation">
<!--l. 2183--><p class="noindent" ><b>Заметка для реализации:</b> In the past, some Lisp compilers have read the entire ﬁle
into Lisp before processing any of the forms. Other compilers have arranged for the
loader to do all of its intern operations before evaluating any of the top-level forms.
Neither of these techniques will work in a straightforward way in Common Lisp because
of the presence of multiple packages.
</div>
<!--l. 2194--><p class="noindent" >Для описанных здесь функций, все необязательные аргументы с именем
<i>package</i> имеют значение по-умолчанию <tt><a 
href="clmli7.html#x196-3479023r23">*package*</a></tt>. Там, где функция
принимает аргумент, который может быть символом или списком символов,
значение <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> расценивается, как пустой список символов. Любой аргумент,
описанный как имя пакета, может быть символом или строкой. Если указан
символ, то используется его выводимое имя. Если строка, то пользователь
должен позаботиться о преобразовании регистра символов в верхний там, где
это необходимо.
<div class="defun">
<!--l. 2203--><p class="noindent" ><div class="defunheader"> <i>[Переменная]</i><a 
 id="dx79-990001"></a><a 
 id="x79-990002r159"></a><b> *package*</b>
</div>
<!--l. 2205--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-99100011.7" id="x79-99100011.7"></a></span>
   Значение этой переменной должно быть объектом пакета. Этот пакет
называется текущим. Первоначальное значение <tt><a 
href="clmli7.html#x196-3479023r23">*package*</a></tt> является пакетом
<tt>common-lisp-user</tt>.
<!--l. 2209--><p class="indent" >   Функции <tt><a 
href="clmli7.html#x196-3479534r534">load</a></tt> и <tt><a 
href="clmli7.html#x196-3479260r260">compile-file</a></tt> пересвязывают <tt><a 
href="clmli7.html#x196-3479023r23">*package*</a></tt> в текущее
значение. Если некоторая форма в файле во время загрузки изменяет
значение <tt><a 
href="clmli7.html#x196-3479023r23">*package*</a></tt>, старое значение будет восстановлено после завершения
загрузки.
<!--l. 2213--><p class="indent" >   Функция <tt><a 
href="clmli7.html#x196-3479260r260">compile-file</a></tt> пересвязывает <tt><a 
href="clmli7.html#x196-3479023r23">*package*</a></tt> в текущее значение.
Если некоторая форма в файле во время загрузки или компиляции изменяет
значение <tt><a 
href="clmli7.html#x196-3479023r23">*package*</a></tt>, старое значение будет восстановлено после завершения
функции.
                                                                          

                                                                          
</div>
<div class="defun">
<!--l. 2218--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-991001"></a><a 
 id="x79-991002r160"></a><b> make-package</b>  <i>package-name</i> &#x0026;key  <i>:nicknames</i> <i>:use</i>
</div>
<!--l. 2220--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-99200011.7" id="x79-99200011.7"></a></span>
   Эта функция создаёт и возвращает новый пакет с указанным именем. Как
было описано выше, аргументом может быть или символ, или строка.
Аргумент <tt>:nicknames</tt> должен быть списком строк, которые будут
псевдонимами. И здесь пользователь вместо строк может указывать символы,
в случае которых будут использоваться выводимые имена. Это имя и
псевдонимы не могут конфликтовать с уже имеющимися именами пакетов.
Если конфликт произошёл, сигнализируется ошибка с возможностью
исправления.
<!--l. 2229--><p class="indent" >   Аргумент <tt>:use</tt> является списком пакетов или имён (строк или символов)
пакетов, чьи внешние символы будут унаследованы новым пакетом. Эти
пакеты должны существовать перед вызовом функции.
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2235--><p class="indent" >   <div class="tabbing">
 <i>[Макрос]</i><b> in-package </b> <a 
 id="dx79-992001"></a><a 
 id="x79-992002r161"></a> name
   <br>
<!--l. 2236--><p class="noindent" ></div>
<!--l. 2236--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-99300011.7" id="x79-99300011.7"></a></span>
</div>
<!--l. 2237--><p class="indent" >   Этот макрос пересвязывает переменную <tt><a 
href="clmli7.html#x196-3479023r23">*package*</a></tt> с пакетом, имя
которого указано в параметре <i>name</i>. Параметр <i>name</i> может быть строкой
или символом. Форма <i>name</i> не вычисляется. В случае отсутствия пакета,
сигнализируется ошибка. Кроме того, в случае вызова в качестве формы
верхнего уровня, этот макрос работает и во время компиляции.
<tt>
                                                                          

                                                                          
<!--l. 2244--><p class="indent" >   <a 
href="clmli7.html#x196-3479474r474">in-package</a></tt> возвращает новый пакет, то есть значение <tt><a 
href="clmli7.html#x196-3479023r23">*package*</a></tt> после
выполнения операции.
</div>
<div class="defun">
<!--l. 2248--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-993001"></a><a 
 id="x79-993002r162"></a><b> ﬁnd-package</b>  <i>name</i>
</div>
<!--l. 2250--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-99400011.7" id="x79-99400011.7"></a></span>
   Параметр <i>name</i> должен быть строкой, которая является именем или
псевдонимом искомого пакета. Этот параметр может также быть символов, в
случае которого используется выводимое имя. В результате возвращается
объект пакета с указанным именем или псевдонимом. Если пакет найден не
был, то <tt><a 
href="clmli7.html#x196-3479405r405">find-package</a></tt> возвращает <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>. Сравнение имен регистрозависимо
(как в <tt><a 
href="clmli7.html#x196-3479907r907">string=</a></tt>).
<!--l. 2258--><p class="indent" >   Аргумент <i>package</i> может быть объектом пакета, в таком случае значение
аргумента сразу возвращается. Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2262--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-994001"></a><a 
 id="x79-994002r163"></a><b> package-name</b>  <i>package</i>
</div>
<!--l. 2264--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-99500011.7" id="x79-99500011.7"></a></span>
   Аргумент должен быть объектом пакета. Данная функция возвращает
строку имени указанного пакета.
<!--l. 2268--><p class="indent" >   Кроме того функция принимает имя пакета или псевдоним, и в этом
случае возвращает главное имя пакета. Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<tt>
<!--l. 2271--><p class="indent" >   <a 
href="clmli7.html#x196-3479689r689">package-name</a></tt> возвращает <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> вместо имени пакета, если пакет был
удалён. Смотрите <tt><a 
href="clmli7.html#x196-3479327r327">delete-package</a></tt>.
</div>
<div class="defun">
<!--l. 2275--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-995001"></a><a 
 id="x79-995002r164"></a><b> package-nicknames</b>  <i>package</i>
</div>
<!--l. 2277--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-99600011.7" id="x79-99600011.7"></a></span>
   Аргумент должен быть объектом пакета. Эта функция возвращает список
псевдонимов для заданного пакета, не включая главное имя.
                                                                          

                                                                          
<!--l. 2281--><p class="indent" >   Кроме того функция принимает имя пакета или псевдоним, и в этом
случае возвращается список псевдонимов пакета. Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2285--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-996001"></a><a 
 id="x79-996002r165"></a><b> rename-package</b>  <i>package</i> <i>new-name</i> &#x0026;optional  <i>new-nicknames</i>
</div>
<!--l. 2287--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-99700011.7" id="x79-99700011.7"></a></span>
   Старое имя и все старые псевдонимы пакета <i>package</i> удаляются и
заменяются на <i>new-name</i> и <i>new-nicknames</i>. Аргумент <i>new-name</i> может быть
строкой или символом. Аргумент <i>new-nicknames</i>, который по-умолчанию <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>,
является списком строк или символов.
<!--l. 2293--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<tt>
<!--l. 2296--><p class="indent" >   <a 
href="clmli7.html#x196-3479789r789">rename-package</a></tt> возвращает <i>package</i>.
</div>
<div class="defun">
<!--l. 2299--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-997001"></a><a 
 id="x79-997002r166"></a><b> package-use-list</b>  <i>package</i>
</div>
<!--l. 2301--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-99800011.7" id="x79-99800011.7"></a></span>
   Данная функция возвращает список пакетов, используемых указанным в
параметре пакетом.
<!--l. 2305--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2309--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-998001"></a><a 
 id="x79-998002r167"></a><b> package-used-by-list</b>  <i>package</i>
</div>
<!--l. 2311--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-99900011.7" id="x79-99900011.7"></a></span>
   Данная функция возвращает список пакетов, использующих указанный в
параметре пакет.
<!--l. 2315--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
                                                                          

                                                                          
<div class="defun">
<!--l. 2319--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-999001"></a><a 
 id="x79-999002r168"></a><b> package-shadowing-symbols</b>  <i>package</i>
</div>
<!--l. 2321--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-100000011.7" id="x79-100000011.7"></a></span>
   Данная функция возвращает список символов, которые были
задекларированы, как скрывающие символы, с помощью <tt><a 
href="clmli7.html#x196-3479843r843">shadow</a></tt> или
<tt><a 
href="clmli7.html#x196-3479844r844">shadowing-import</a></tt>. Все символы в этом списке является <i>родственными</i>
указанному пакету.
<!--l. 2326--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2330--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1000001"></a><a 
 id="x79-1000002r169"></a><b> list-all-packages</b>
</div>
<!--l. 2332--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-100100011.7" id="x79-100100011.7"></a></span>
   Эта функция возвращает список всех пакетов, которые существуют в
Lisp&#x2019;овой системе.
</div>
<div class="defun">
<!--l. 2337--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1001001"></a><a 
 id="x79-1001002r170"></a><b> delete-package</b>  <i>package</i>
</div>
<!--l. 2339--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-100200011.7" id="x79-100200011.7"></a></span>
   Функция <tt><a 
href="clmli7.html#x196-3479327r327">delete-package</a></tt> удаляет указанный в аргументе <i>package</i> пакет,
из всех структур данных системы пакетов. Аргумент <i>package</i> может быть как
пакетом, так и его именем.
<!--l. 2344--><p class="indent" >   Если <i>package</i> является именем, но пакета с данным именем не
существует, сигнализируется исправимая ошибка. Продолжение из этой
ошибки не делает попытку удаления, но возвращает <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> из вызова
<tt><a 
href="clmli7.html#x196-3479327r327">delete-package</a></tt>.
<!--l. 2348--><p class="indent" >   Если <i>package</i> является пакетов, но пакет уже был удалён, ошибка не
сигнализируется и попыток удаления не происходит. Вместо этого
<tt><a 
href="clmli7.html#x196-3479327r327">delete-package</a></tt> немедленно возвращает <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>.
<!--l. 2352--><p class="indent" >   Если пакет, указанный для удаления, в этот момент используется
другими пакетами, сигнализируется исправимая ошибка. Продолжение из
                                                                          

                                                                          
этой ошибки выглядит как, если бы функция <tt><a 
href="clmli7.html#x196-3479973r973">unuse-package</a></tt> была выполнена
на всех использующих пакетах для удаления зависимостей, после чего была
вызвана <tt><a 
href="clmli7.html#x196-3479327r327">delete-package</a></tt> для удаления пакета.
<!--l. 2358--><p class="indent" >   Если указанный пакет является домашним для некоторого символа, тогда
после выполнения <tt><a 
href="clmli7.html#x196-3479327r327">delete-package</a></tt>, ячейка домашнего пакета символа
становится неопределённой. Никак по-другому символы в удаляемом пакете
не модифицируются.
<!--l. 2362--><p class="indent" >   Имя и псевдонимы пакета <i>package</i> перестают быть сами собой. Объект
пакета остаётся, но анонимно: <tt><a 
href="clmli7.html#x196-3479694r694">packagep</a></tt> будет истинным, но <tt><a 
href="clmli7.html#x196-3479689r689">package-name</a></tt>
применительно к нему будет возвращать <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>.
<!--l. 2366--><p class="indent" >   Влияние любой другой операции на удалённым объектом пакета не
определена. В частности, попытка найти символ в удалённый пакет
(например, используя <tt><a 
href="clmli7.html#x196-3479485r485">intern</a></tt> или <tt><a 
href="clmli7.html#x196-3479407r407">find-symbol</a></tt>) будет иметь неопределённый
результат.
<!--l. 2370--><p class="indent" >   Если удаление было успешно, <tt><a 
href="clmli7.html#x196-3479327r327">delete-package</a></tt> возвращает <tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt>, иначе
<tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>.
</div>
<div class="defun">
<!--l. 2373--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1002001"></a><a 
 id="x79-1002002r171"></a><b> intern</b>  <i>string</i> &#x0026;optional  <i>package</i>
</div>
<!--l. 2375--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-100300011.7" id="x79-100300011.7"></a></span>
   В пакете <i>package</i>, который по-умолчанию равен текущему пакету,
осуществляется поиск символа с именем, указанным в аргументе <i>string</i>. Этот
поиск будет включить унаследованные символы, как описано в разделе <a 
href="clmse60.html#x76-98500011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>.
Если ни одного символа не найдено, то символ создаётся и устанавливается в
указанный пакет в качестве внутреннего символа (или внешнего символа,
если пакет <tt>keyword</tt>). Указанный пакет становиться домашним пакетом для
созданного символа. Возвращается два значения. Первое является
символом, который был найден или создан. Второе значение <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>,
если символ не существовал ранее, или одно из следующих значений:
<div class="indentdesc">
      <ul><li><b>
<tt>:internal</tt> </b></li>Символ  напрямую  представлен  в  пакете  как  внутренний
      символ.
      <li><b>
<tt>:external</tt> </b></li>Символ напрямую представлен в пакете как внешний символ.
                                                                          

                                                                          
      <li><b>
<tt>:inherited</tt> </b></li>Символ    унаследован    с    помощью    <tt><a 
href="clmli7.html#x196-3479981r981">use-package</a></tt>   (и
      следовательно символ является внутренним).</ul>
</div>
<!--l. 2398--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2402--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1003001"></a><a 
 id="x79-1003002r172"></a><b> ﬁnd-symbol</b>  <i>string</i> &#x0026;optional  <i>package</i>
</div>
<!--l. 2404--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-100400011.7" id="x79-100400011.7"></a></span>
   Эта функция идентична <tt><a 
href="clmli7.html#x196-3479485r485">intern</a></tt>, но она никогда не создаёт новый символ.
Если символ с указанным именем был найден в указанном пакете, напрямую
или через наследование, найденный возвращается символ как первое
значение и второе значение так же как в <tt><a 
href="clmli7.html#x196-3479485r485">intern</a></tt>. Если символ не доступен в
заданном пакете, оба значения равны <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>.
<!--l. 2411--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2415--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1004001"></a><a 
 id="x79-1004002r173"></a><b> unintern</b>  <i>symbol</i> &#x0026;optional  <i>package</i>
</div>
<!--l. 2417--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-100500011.7" id="x79-100500011.7"></a></span>
   Если указанный символ представлен в указанном пакете <i>package</i>, он
удаляется из этого пакета и также из списка затеняющих символов,
если он там был. Кроме того, если <i>package</i> для символа является
домашним пакетом, то символ отсоединяется и становится бездомным.
Следует отметить, что в некоторых обстоятельствах может продолжить
быть доступным с помощью наследования в указанном пакете. Если
удаление действительно произошло, <tt><a 
href="clmli7.html#x196-3479966r966">unintern</a></tt> возвращает <tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt>, иначе
<tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>.
<tt>
<!--l. 2427--><p class="indent" >   <a 
href="clmli7.html#x196-3479966r966">unintern</a></tt> должна использоваться с осторожностью. Она изменяет
состояние системы пакетов так, что правила согласованности перестают
действовать.
                                                                          

                                                                          
<!--l. 2430--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2434--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1005001"></a><a 
 id="x79-1005002r174"></a><b> export</b>  <i>symbols</i> &#x0026;optional  <i>package</i>
</div>
<!--l. 2436--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-100600011.7" id="x79-100600011.7"></a></span>
   Аргумент <i>symbols</i> должен быть списком символов или одиночным
символом. Эти символы становятся доступными как внешние символы в
пакете <i>package</i> (смотрите раздел <a 
href="clmse60.html#x76-98500011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). <tt><a 
href="clmli7.html#x196-3479380r380">export</a></tt> возвращает <tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt>.
<!--l. 2442--><p class="indent" >   По соглашению, вызов <tt><a 
href="clmli7.html#x196-3479380r380">export</a></tt> содержит все экспортируемые символы и
помещается рядом с началом файла, для указания того, какие символы
экспортируются данным файлом для использования другими программами.
<!--l. 2446--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2450--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1006001"></a><a 
 id="x79-1006002r175"></a><b> unexport</b>  <i>symbols</i> &#x0026;optional  <i>package</i>
</div>
<!--l. 2452--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-100700011.7" id="x79-100700011.7"></a></span>
   Аргумент <i>symbols</i> должен быть списком символов или одиночным
символом. Эти символы становятся внутренними символами в пакете <i>package</i>.
Использование этой операции для символов пакета <tt>keyword</tt> является
ошибкой. (смотрите раздел <a 
href="clmse60.html#x76-98500011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). <tt><a 
href="clmli7.html#x196-3479965r965">unexport</a></tt> возвращает <tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt>.
<!--l. 2459--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2463--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1007001"></a><a 
 id="x79-1007002r176"></a><b> import</b>  <i>symbols</i> &#x0026;optional  <i>package</i>
</div>
<!--l. 2465--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-100800011.7" id="x79-100800011.7"></a></span>
   Аргумент <i>symbols</i> должен быть списком символов или одиночным
символом. Эти символы становятся внутренними символами в пакете <i>package</i>
и, таким образом, могут быть указаны без использования полного имени (с
                                                                          

                                                                          
двоеточием). <tt><a 
href="clmli7.html#x196-3479473r473">import</a></tt> сигнализирует исправимую ошибку, если любой
из импортируемых символов имеет такое же имя, как один из уже
присутствующих в пакете символов (смотрите раздел <a 
href="clmse60.html#x76-98500011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). <tt><a 
href="clmli7.html#x196-3479473r473">import</a></tt>
возвращает <tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt>.
<!--l. 2474--><p class="indent" >   Если любой импортируемый символ не имеет домашнего пакета,
тогда <tt><a 
href="clmli7.html#x196-3479473r473">import</a></tt> устанавливает домашний пакет тот, в который символ
импортируется.
<!--l. 2477--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2481--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1008001"></a><a 
 id="x79-1008002r177"></a><b> shadowing-import</b>  <i>symbols</i> &#x0026;optional  <i>package</i>
</div>
<!--l. 2483--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-100900011.7" id="x79-100900011.7"></a></span>
   Данная функция похожа на <tt><a 
href="clmli7.html#x196-3479473r473">import</a></tt>, но не сигнализирует ошибку, даже
если импортирование символа будет затенять некоторый другой символ, уже
присутствующий в пакете. В дополнение к импортированию символ
помещается в список затеняющих символов пакета <i>package</i> (смотрите
раздел <a 
href="clmse61.html#x77-98600011.5">11.5<!--tex4ht:ref: NAME-CONFLICTS-SECTION --></a>). <tt><a 
href="clmli7.html#x196-3479844r844">shadowing-import</a></tt> возвращает <tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt>.
<tt>
<!--l. 2491--><p class="indent" >   <a 
href="clmli7.html#x196-3479844r844">shadowing-import</a></tt> должен использоваться с осторожностью. Она
изменяет состояние системы пакетов так, что правила согласованности
перестают действовать.
<!--l. 2494--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2498--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1009001"></a><a 
 id="x79-1009002r178"></a><b> shadow</b>  <i>symbols</i> &#x0026;optional  <i>package</i>
</div>
<!--l. 2500--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-101000011.7" id="x79-101000011.7"></a></span>
   Аргумент должен быть списком символов или строк или одиночным
символом или строкой. Рассматривается выводимое имя каждого
символа (или просто строка) и в указанном пакете <i>package</i> ищется
символ с таким же именем. Если данный символ присутствует в этом
пакете (напрямую, не с помощью наследования), тогда он добавляется
                                                                          

                                                                          
в список затеняющих символов. Иначе, создаётся новый символ с
указанным выводимым именем, и вставляется в пакет <i>package</i> как
внутренний символ. Символ также помещается в список затеняющих
символов пакета <i>package</i> (смотрите раздел <a 
href="clmse61.html#x77-98600011.5">11.5<!--tex4ht:ref: NAME-CONFLICTS-SECTION --></a>). <tt><a 
href="clmli7.html#x196-3479843r843">shadow</a></tt> возвращает
<tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt>.
<tt>
<!--l. 2511--><p class="indent" >   shadowing</tt> должен использоваться с осторожностью. Она изменяет
состояние системы пакетов так, что правила согласованности перестают
действовать.
<!--l. 2514--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2518--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1010001"></a><a 
 id="x79-1010002r179"></a><b> use-package</b>  <i>packages-to-use</i> &#x0026;optional  <i>package</i>
</div>
<!--l. 2520--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-101100011.7" id="x79-101100011.7"></a></span>
   Аргумент <i>packages-to-use</i> должен быть списком пакетов или их имён или
одиночным пакетом или его именем. Эти пакеты добавляются в список
использования <i>package</i>, если их там ещё нет. Все внешние символы в пакетах
становятся доступными в пакете <i>package</i> как внутренние символы (смотрите
раздел <a 
href="clmse60.html#x76-98500011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). Использование пакета <tt>keyword</tt> является ошибкой. <tt><a 
href="clmli7.html#x196-3479981r981">use-package</a></tt>
возвращает <tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt>.
<!--l. 2529--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
</div>
<div class="defun">
<!--l. 2533--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1011001"></a><a 
 id="x79-1011002r180"></a><b> unuse-package</b>  <i>packages-to-unuse</i> &#x0026;optional  <i>package</i>
</div>
<!--l. 2535--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-101200011.7" id="x79-101200011.7"></a></span>
   Аргумент <i>packages-to-use</i> должен быть списком пакетов или их имён или
одиночным пакетом или его именем. Эти пакеты удаляются из списка
использования <i>package</i>, если они там были. <tt><a 
href="clmli7.html#x196-3479973r973">unuse-package</a></tt> возвращает
<tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt>.
<!--l. 2541--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
                                                                          

                                                                          
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2546--><p class="indent" >   <div class="tabbing">
 <i>[Макрос]</i><b> defpackage </b> <a 
 id="dx79-1012001"></a><a 
 id="x79-1012002r181"></a> deﬁned-package-name {option}*
   <br>
<!--l. 2547--><p class="noindent" ></div>
<!--l. 2547--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-101300011.7" id="x79-101300011.7"></a></span>
</div>
<!--l. 2548--><p class="indent" >   Эта функция создаёт новый пакет, или модифицирует уже существующий,
имя которого является <i>deﬁned-package-name</i>. Аргумент <i>deﬁne-package-name</i>
может быть строкой или символом. Если он является символом, то
используется его выводимое имя, а не пакет, если вдруг в котором находится
данный символ. Созданный или модифицированный пакет возвращается как
значение формы <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt>.
<div class="flushdesc">
<!--l. 2557--><p class="indent" >
      <ul><li><b>
<tt>(:size <i>integer</i>)</tt> </b></li>Запись  указывает  примерное  количество  символов
      ожидаемых быть в пакете. Это просто подсказка для менеджера
      памяти так, что реализация используя хеш-таблицы для хранения
      структуры  пакета  может  указать  данный  параметр,  и  память
      будет более эффективно выделяться (удобно, например при чтении
      файла и всех его символов в пакет).
      <li><b>
<tt>(:nicknames {<i><i></i></i>}*package-name)</tt> </b></li>Запись   указывает   псевдонимы   для
      пакета. Если один из псевдонимов уже указывает на имеющийся
      пакет, то сигнализируется исправимая ошибка, как для функции
      <tt><a 
href="clmli7.html#x196-3479581r581">make-package</a></tt>.
      <li><b>
<tt>(:shadow {<i><i></i></i>}*symbol-name)</tt> </b></li>Указывает имена символов, которые будут
      затеняющими в определяемом пакете. Работает как <tt><a 
href="clmli7.html#x196-3479843r843">shadow</a></tt>.
                                                                          

                                                                          
      <li><b>
<tt>(:shadowing-import-from <i>package-name</i> {<i><i></i></i>}*symbol-name)</tt> </b></li>
      Указывает
      имена символов, которые будут размещены в определяемом пакете.
      Эти символы импортируются в пакет, будучи при необходимости
      затеняющими, как при использовании функции <tt><a 
href="clmli7.html#x196-3479844r844">shadowing-import</a></tt>.
      Ни в коем случае символы не создаются. Если для любого имени
      <i>symbol-name</i> не существует символа доступного в пакете с именем
      <i>package-name</i>, то сигнализируется исправимая ошибка.
      <li><b>
<tt>(:use {<i><i></i></i>}*package-name)</tt> </b></li>Указывает                           определяемому
      пакету «использовать» (наследовать от) пакеты указанные в этой
      опции. Работает также, как и <tt><a 
href="clmli7.html#x196-3479981r981">use-package</a></tt>. Если <tt>:use</tt> не указана,
      тогда опция имеет неопределённое значение.
      <li><b>
<tt>(:import-from <i>package-name</i> {<i><i></i></i>}*symbol-name)</tt> </b></li>Указывает   символы,
      которые будут размещены в определяемом пакете. Эти символы
      импортируются   в   пакет,   как   при   использовании   функции
      <tt><a 
href="clmli7.html#x196-3479844r844">shadowing-import</a></tt>. Ни в коем случае символы не создаются. Если
      для любого имени <i>symbol-name</i> не существует символа доступного
      в пакете с именем <i>package-name</i>, то сигнализируется исправимая
      ошибка.
      <li><b>
<tt>(:intern {<i><i></i></i>}*symbol-name)</tt> </b></li>Указанные   символы   размещаются   или
      создаются в определяемом пакете, как при использовании функции
      <tt><a 
href="clmli7.html#x196-3479485r485">intern</a></tt>. Следует отметить, что действие этой опции может зависеть
      от опции <tt>:use</tt>, так как преимущество отдаётся унаследованному
      символу, чем созданию нового.
      <li><b>
<tt>(:export {<i><i></i></i>}*symbol-name)</tt> </b></li>Указанные   символы   размещаются   или
      создаются  в  определяемом  пакете  и  затем  экспортируются,  как
      при   использовании   функции   <tt><a 
href="clmli7.html#x196-3479380r380">export</a></tt>.   Следует   отметить,   что
      действие этой опции может зависеть от опции <tt>:use</tt>, <tt>import-from</tt>
      или   <tt>shadowing-import-from</tt>  так   как   преимущество   отдаётся
      унаследованному или импортированному символу, чем созданию
                                                                          

                                                                          
      нового.</ul>
</div>
<!--l. 2607--><p class="indent" >   Порядок, в котором опции используются в форме <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt>, не имеет
значения. Часть соглашения в том, что <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt> сортирует опции
перед обработкой. Опции обрабатываются в следующем порядке:
<div class="tabbing">
1.  <tt>:shadow</tt> and <tt>:shadowing-import-from</tt>
   <br>             2.  <tt>:use</tt><br>             3.  <tt>:import-from</tt> and <tt>:intern</tt><br>
4.  <tt>:export</tt><br>
<!--l. 2616--><p class="noindent" ></div>
<!--l. 2616--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-101400011.7" id="x79-101400011.7"></a></span>
   Сначала устанавливаются затенения, чтобы избежать ложных конфликтов
при установке связей для use. Связи use должны устанавливаться перед
импортированием и интернированием, таким образом эти операции могут
ссылаться на нормально унаследованные символы, а не создавать новые.
Экспортирование выполняется последним, таким образом символы созданные
любой другой операцией, в частности, затеняющие и импортированные символы,
могут быть экспортированы. Следует отметить, что экспортирование
унаследованного символа сначала неявно импортирует его (смотрите
раздел <a 
href="clmse60.html#x76-98500011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>).
<!--l. 2626--><p class="indent" >   Если пакета с именем <i>deﬁned-package-name</i> не существовало, то
<tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt> создаст его. Если такой пакет уже существовал, то новый пакет
создан не будет. Существующий пакет модифицируется, если возможно, для
отражения нового определения. Результат не определён, если новое
определение не совместимо с текущим состоянием пакета.
<!--l. 2632--><p class="indent" >   Если одинаковый аргумент <tt><a 
href="clmli7.html#x196-3479929r929">symbol-name</a></tt> (в смысле сравнения имён с
помощью <tt><a 
href="clmli7.html#x196-3479907r907">string=</a></tt>) встречается более одного раза в опциях <tt>:shadow</tt>,
<tt>:shadowing-import-from</tt>, <tt>:import-from</tt> и <tt>:intern</tt>, сигнализируется
ошибка.
<!--l. 2637--><p class="indent" >   Если одинаковый аргумент <tt><a 
href="clmli7.html#x196-3479929r929">symbol-name</a></tt> (в смысле сравнения имён с
помощью <tt><a 
href="clmli7.html#x196-3479907r907">string=</a></tt>) встречается более одного раза в опциях <tt>:intern</tt> и
<tt>:export</tt>, сигнализируется ошибка.
                                                                          

                                                                          
<!--l. 2641--><p class="indent" >   Другие виды конфликтов обрабатывается в том же стиле, как в
соответствующих операциях <tt><a 
href="clmli7.html#x196-3479981r981">use-package</a></tt>, <tt><a 
href="clmli7.html#x196-3479473r473">import</a></tt> и <tt><a 
href="clmli7.html#x196-3479380r380">export</a></tt>.
<!--l. 2644--><p class="indent" >   Реализация может поддерживать другие опции для <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt>.
Каждая реализация должно сигнализировать ошибку при встрече с
неподдерживаемой опцией для <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt>.
<!--l. 2648--><p class="indent" >   Функция <tt><a 
href="clmli7.html#x196-3479260r260">compile-file</a></tt> должна обрабатывается формы верхнего уровня
<tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt> таким же методом, как и обрабатывает формы верхнего уровня
для работы с пакетам (как описано в начале раздела <a 
href="#x79-99000011.7">11.7<!--tex4ht:ref: PACKAGE-FUNCTIONS-SECTION --></a>).
<!--l. 2652--><p class="indent" >   Вот пример вызова <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt>, которая «не рискует (plays it safe)»,
используя только строки в качестве имён. <div class="lisp"><div class="tabbing">
(cl:defpackage &#x0022;MY-VERY-OWN-PACKAGE&#x0022;
   <br>         (:size 496)<br>         (:nicknames &#x0022;MY-PKG&#x0022; &#x0022;MYPKG&#x0022; &#x0022;MVOP&#x0022;)<br>
  (:use &#x0022;COMMON-LISP&#x0022;)<br>                     (:shadow &#x0022;CAR&#x0022; &#x0022;CDR&#x0022;)<br>
  (:shadowing-import-from &#x0022;BRAND-X-LISP&#x0022; &#x0022;CONS&#x0022;)<br>
  (:import-from &#x0022;BRAND-X-LISP&#x0022; &#x0022;GC&#x0022; &#x0022;BLINK-FRONT-PANEL-LIGHTS&#x0022;)<br>
  (:export &#x0022;EQ&#x0022; &#x0022;CONS&#x0022; &#x0022;MY-VERY-OWN-FUNCTION&#x0022;))<br>
<!--l. 2663--><p class="noindent" ></div>
<!--l. 2663--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-101500011.7" id="x79-101500011.7"></a></span>
<!--l. 2663--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-101600011.7" id="x79-101600011.7"></a></span>
</div>
<tt>
<!--l. 2664--><p class="indent" >   <a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt> пример выше спроектирован работать корректно, даже если
текущий пакет не использует пакет <tt>common-lisp</tt>. (Следует отметить, что в
этом примере используется псевдоним <tt>cl</tt> для пакета <tt>common-lisp</tt>.) Более
того, выполнение этой формы <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt> не создаст символа в текущем
пакете. А также для последующего удобства для строк использованы буквы
в верхнем регистре.
<div class="implementation">
<!--l. 2672--><p class="noindent" ><b>Заметка для реализации:</b> An implementation of <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt> might choose
to transform all the <i>package-name</i> and <i>symbol-name</i> arguments into strings
at macro expansion time, rather than at the time the resulting expansion is
                                                                          

                                                                          
executed, so that even if source code is expressed in terms of strange symbols
in the <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt> form, the binary ﬁle resulting from compiling the source
code would contain only strings. The purpose of this is simply to minimize the
creation of useless symbols in production code. This technique is permitted as an
implementation strategy but is not a behavior required by the speciﬁcation of
<tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt>.
</div>
<!--l. 2686--><p class="indent" >   А вот для контраста пример <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt>, который «играет по крупному
(plays the whale)» с использованием всех типов допустимого синтаксиса.
<div class="lisp"><div class="tabbing">
(defpackage my-very-own-package
   <br>                      (:export :EQ common-lisp:cons my-very-own-function)<br>
  (:nicknames &#x0022;MY-PKG&#x0022; #:MyPkg)<br>           (:use &#x0022;COMMON-LISP&#x0022;)<br>
  (:shadow &#x0022;CAR&#x0022;)<br>             (:size 496)<br>             (:nicknames mvop)<br>
  (:import-from &#x0022;BRAND-X-LISP&#x0022; &#x0022;GC&#x0022; Blink-Front-Panel-Lights)<br>
  (:shadow common-lisp::cdr)<br>
  (:shadowing-import-from &#x0022;BRAND-X-LISP&#x0022; CONS))<br>
<!--l. 2699--><p class="noindent" ></div>
<!--l. 2699--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-101700011.7" id="x79-101700011.7"></a></span>
<!--l. 2699--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-101800011.7" id="x79-101800011.7"></a></span>
</div>
<!--l. 2700--><p class="indent" >   Этот пример производит то же влияние на вновь созданный пакет, но
может создавать бесполезные символы в других пакетах. Использования
явных тегов пакетов особенно запутаны. Например, эта форма <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt>
делает так, что символ <tt><a 
href="clmli7.html#x196-3479197r197">cdr</a></tt> будет затенён в <i>новом пакете</i>. Данный символ не
будет затенён в пакете <tt>common-lisp</tt>. Факт, что имя «<tt>CDR</tt>» было указано
полным именем (с двоеточием) является отвлекающим маневром. Мораль в
том, что синтаксическая гибкость <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt>, как в других частях Common
Lisp&#x2019;а, даёт большие удобства в использовании в рамках здравого смысла, но
создаёт невообразимую путаницу при использовании мальтузианского
изобилия.
                                                                          

                                                                          
<!--l. 2711--><p class="indent" >   Следует отметить, что <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt> не способна сама по себе определять
взаимно рекурсивные пакеты, например, два пакета использующих друг
друга. Однако, ничто не мешает использовать <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt> для выполнения
первоначальных установок, а затем использовать такие функции, как
<tt><a 
href="clmli7.html#x196-3479981r981">use-package</a></tt>, <tt><a 
href="clmli7.html#x196-3479473r473">import</a></tt> и <tt><a 
href="clmli7.html#x196-3479380r380">export</a></tt> для создания связи.
<!--l. 2717--><p class="indent" >   Цель <tt><a 
href="clmli7.html#x196-3479315r315">defpackage</a></tt> поощрять пользователя размещать определение
пакета и его зависимостей в одном месте. Это может также позволить
проектировщику большой системы размещать определения всех необходимых
пакетов (скажем) в один файл, который может быть загружен перед
загрузкой или компиляцией кода, который зависит от этих пакетов. Такой
файл, если аккуратно сконструирован, может быть просто загружен в пакет
<tt>common-lisp-user</tt>.
<!--l. 2724--><p class="indent" >   Реализации и программные окружения могут также лучше поддерживать
процесс разработки (если только предлагая лучшую проверку ошибок) с
помощью глобальной базы значений о предполагаемых установках
пакетов.
</div>
<div class="defun">
<!--l. 2729--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx79-1018001"></a><a 
 id="x79-1018002r182"></a><b> ﬁnd-all-symbols</b>  <i>string-or-symbol</i>
</div>
<!--l. 2731--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-101900011.7" id="x79-101900011.7"></a></span>
<tt>
   <a 
href="clmli7.html#x196-3479400r400">find-all-symbols</a></tt> просматривает каждый пакет в Lisp&#x2019;овой системе для
поиска символа, имя которого совпадает с указанной строкой. Список всех
найденных символов возвращается в качестве результата. Этот поиск
регистрозависимый. Если аргумент является символом, для поиска по строке
используется его выводимое имя.
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2741--><p class="indent" >   <div class="tabbing">
 <i>[Макрос]</i><b> do-symbols </b> <a 
 id="dx79-1019001"></a><a 
 id="x79-1019002r183"></a> (var [package [result-form]])
   <br>                                                 {declaration}* {tag | statement}*<br>
<!--l. 2743--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 2743--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-102000011.7" id="x79-102000011.7"></a></span>
</div>
<tt>
<!--l. 2744--><p class="indent" >   <a 
href="clmli7.html#x196-3479343r343">do-symbols</a></tt> предоставляет прямой цикл по символам пакета. Тело
выполняется единожды для каждого символа доступного в пакете <i>package</i>.
Символ связывается с переменной <i>var</i>. Затем вычисляется форма <i>result-form</i>
(одиночная форма, <i>не</i> неявный <tt><a 
href="clmli7.html#x196-3479745r745">progn</a></tt>), и результат является результатом
формы <tt><a 
href="clmli7.html#x196-3479343r343">do-symbols</a></tt>. (Когда вычисляется форма <i>result-form</i>, переменная <i>var</i>
продолжает быть связанной и имеет значение <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>.) Если <i>result-form</i> опущена,
результат <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>. Для немедленного завершения цикла может использоваться
<tt><a 
href="clmli7.html#x196-3479798r798">return</a></tt>. Если выполнение тела влияет на то, какие символы содержаться в
пакете <i>package</i>, то возможно только удаление символа связанного
с переменной <i>var</i> с использованием <tt><a 
href="clmli7.html#x196-3479966r966">unintern</a></tt>, иначе результат не
определён.
<!--l. 2757--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<div class="new">
<!--l. 2761--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx79-1020001"></a>to specify that the body of a <tt><a 
href="clmli7.html#x196-3479343r343">do-symbols</a></tt> form
may be executed more than once for the same accessible symbol, and users should
take care to allow for this possibility.
<!--l. 2767--><p class="indent" >   The point is that the same symbol might be accessible via more than one
chain of inheritance, and it is implementationally costly to eliminate such
duplicates. Here is an example: <div class="lisp"><div class="tabbing">
(setq *a* (make-package &#x2019;a))      ;Implicitly uses package <tt>common-lisp</tt>
   <br>(setq *b* (make-package &#x2019;b))      ;Implicitly uses package <tt>common-lisp</tt><br>
(setq *c* (make-package &#x2019;c :use &#x2019;(a b)))<br>                                    <br>
(do-symbols (x *c*) (print x))    ;Symbols in package <tt>common-lisp</tt><br>
                                  ; might be printed once or twice here<br>
<!--l. 2777--><p class="noindent" ></div>
<!--l. 2777--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-102100011.7" id="x79-102100011.7"></a></span>
<!--l. 2777--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-102200011.7" id="x79-102200011.7"></a></span>
                                                                          

                                                                          
</div>
<!--l. 2779--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-1022001"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-7040007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div> Следует отметить, что конструкция <tt><a 
href="clmli7.html#x196-3479558r558">loop</a></tt> предоставляет тип выражения <tt><a 
href="clmli7.html#x196-3479421r421">for</a></tt>,
которое может проходить в цикле по символам пакета (смотрите
главу <a 
href="clmch25.html#x154-244900025">25<!--tex4ht:ref: LOOP --></a>).
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2788--><p class="indent" >   <div class="tabbing">
 <i>[Макрос]</i><b> do-external-symbols </b> <a 
 id="dx79-1022002"></a><a 
 id="x79-1022003r184"></a> (var [package [result]])
   <br>                                                 {declaration}* {tag | statement}*<br>
<!--l. 2790--><p class="noindent" ></div>
<!--l. 2790--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-102300011.7" id="x79-102300011.7"></a></span>
</div>
<tt>
<!--l. 2791--><p class="indent" >   <a 
href="clmli7.html#x196-3479342r342">do-external-symbols</a></tt> похожа на <tt><a 
href="clmli7.html#x196-3479343r343">do-symbols</a></tt> за исключением того, что
сканируются только внешние символы пакета.
<div class="new">
<!--l. 2795--><p class="indent" >   The clariﬁcation voted by X3J13 in March 1988 for <tt><a 
href="clmli7.html#x196-3479343r343">do-symbols</a></tt> <a 
 id="dx79-1023001"></a>, regarding
redundant executions of the body for the same symbol, applies also to
<tt><a 
href="clmli7.html#x196-3479342r342">do-external-symbols</a></tt>.
</div>
<!--l. 2802--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<div class="new">
<!--l. 2806--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-1023002"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-7040007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2813--><p class="indent" >   <div class="tabbing">
                                                                          

                                                                          
 <i>[Макрос]</i><b> do-all-symbols </b> <a 
 id="dx79-1023003"></a><a 
 id="x79-1023004r185"></a> (var [result-form])
   <br>                                                 {declaration}* {tag | statement}*<br>
<!--l. 2815--><p class="noindent" ></div>
<!--l. 2815--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-102400011.7" id="x79-102400011.7"></a></span>
</div>
<!--l. 2816--><p class="indent" >   Эта функция похожа на <tt><a 
href="clmli7.html#x196-3479343r343">do-symbols</a></tt>, но выполняет тело единожды для
каждого символа каждого пакета. (Функция не обрабатывает все
возможные символы, так как символ может быть доступен ни в одном
пакете. Обычно, дезинтернированые символы не доступны ни в одном
пакете.) В общем случае тело может выполняться для одно символа
несколько раз, так как этот символ может встречаться в нескольких
пакетах.
<div class="new">
<!--l. 2824--><p class="indent" >   The clariﬁcation voted by X3J13 in March 1988 for <tt><a 
href="clmli7.html#x196-3479343r343">do-symbols</a></tt> <a 
 id="dx79-1024001"></a>, regarding
redundant executions of the body for the same symbol, applies also to
<tt><a 
href="clmli7.html#x196-3479341r341">do-all-symbols</a></tt>.
</div>
<!--l. 2831--><p class="indent" >   Аргумент <i>package</i> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-98300011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<div class="new">
<!--l. 2835--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-1024002"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-7040007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2842--><p class="indent" >   <div class="tabbing">
 <i>[Макрос]</i><b> with-package-iterator </b> <a 
 id="dx79-1024003"></a><a 
 id="x79-1024004r186"></a> (mname package-list {symbol-type}+)
   <br>                                                                                   {form}*<br>
<!--l. 2844--><p class="noindent" ></div>
<!--l. 2844--><p class="noindent" ><span class="paragraphHead"><a 
href="#x79-102500011.7" id="x79-102500011.7"></a></span>
</div>
                                                                          

                                                                          
<!--l. 2845--><p class="indent" >   The name <i>mname</i> is bound and deﬁned as if by <tt><a 
href="clmli7.html#x196-3479568r568">macrolet</a></tt>, with the body
<i>form</i>s as its lexical scope, to be a “generator macro” such that each invocation of
<tt>(<i>mname</i>)</tt> will return a symbol and that successive invocations will eventually
deliver, one by one, all the symbols from the packages that are elements of the list
that is the value of the expression <i>package-list</i> (which is evaluated exactly
once).
<!--l. 2853--><p class="indent" >   Each element of the <i>package-list</i> value may be either a package or the name of
a package. As a further convenience, if the <i>package-list</i> value is itself a package or
the name of a package, it is treated as if a singleton list containing that value had
been provided. If the <i>package-list</i> value is <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>, it is considered to be an empty list
of packages.
<!--l. 2861--><p class="indent" >   At each invocation of the generator macro, there are two possibilities. If there
is yet another unprocessed symbol, then four values are returned: <tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt>, the symbol, a
keyword indicating the accessibility of the symbol within the package (see below),
and the package from which the symbol was accessed. If there are no more
unprocessed symbols in the list of packages, then one value is returned:
<tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>.
<!--l. 2870--><p class="indent" >   When the generator macro returns a symbol as its second value, the fourth
value is always one of the packages present or named in the <i>package-list</i>
value, and the third value is a keyword indicating accessibility: <tt>:internal</tt>
means present in the package and not exported; <tt>:external</tt> means present
and exported; and <tt>:inherited</tt> means not present (thus not shadowed)
but inherited from some package used by the package that is the fourth
value.
<!--l. 2879--><p class="indent" >   Each <i>symbol-type</i> in an invocation of <tt><a 
href="clmli7.html#x196-3480007r1007">with-package-iterator</a></tt> is not
evaluated. More than one may be present; their order does not matter. They
indicate the accessibility types of interest. A symbol is not returned by the
generator macro unless its actual accessibility matches one of the <i>symbol-type</i>
indicators. The standard <i>symbol-type</i> indicators are <tt>:internal</tt>, <tt>:external</tt>, and
<tt>:inherited</tt>, but implementations are permitted to extend the syntax of
<tt><a 
href="clmli7.html#x196-3480007r1007">with-package-iterator</a></tt> by recognizing additional symbol accessibility types. An
error is signaled if no <i>symbol-type</i> is supplied, or if any supplied <i>symbol-type</i> is not
recognized by the implementation.
<!--l. 2891--><p class="indent" >   The order in which symbols are produced by successive invocations of the
generator macro is not necessarily correlated in any way with the order of the
packages in the <i>package-list</i>. When more than one package is in the <i>package-list</i>,
symbols accessible from more than one package may be produced once or more
than once. Even when only one package is speciﬁed, symbols inherited in
                                                                          

                                                                          
multiple ways via used packages may be produced once or more than
once.
<!--l. 2900--><p class="indent" >   The implicit interior state of the iteration over the list of packages and
the symbols within them has dynamic extent. It is an error to invoke
the generator macro once the <tt><a 
href="clmli7.html#x196-3480007r1007">with-package-iterator</a></tt> form has been
exited.
<!--l. 2905--><p class="indent" >   Any number of invocations of <tt><a 
href="clmli7.html#x196-3480007r1007">with-package-iterator</a></tt> and related macros
may be nested, and the generator macro of an outer invocation may be called
from within an inner invocation (provided, of course, that its name is visible or
otherwise made available).
<!--l. 2910--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-1025001"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-7040007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
<div class="rationale">
<!--l. 2915--><p class="noindent" ><b>Обоснование:</b> This facility is a bit more ﬂexible in some ways than <tt><a 
href="clmli7.html#x196-3479343r343">do-symbols</a></tt> and
friends. In particular, it makes it possible to implement <tt><a 
href="clmli7.html#x196-3479558r558">loop</a></tt> clauses for iterating over
packages in a way that is both portable and eﬃcient (see chapter <a 
href="clmch25.html#x154-244900025">25<!--tex4ht:ref: LOOP --></a>).
</div>
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
<!--l. 3714--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmch12.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse62.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse62.html#tailclmse62.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse63.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch11.html#clmse63.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse63.html"></a>  </div> </div> 
</body></html> 
