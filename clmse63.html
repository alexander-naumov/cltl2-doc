<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Package System Functions and Variables</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-06 23:16:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 800--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse64.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse62.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse62.html#tailclmse62.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse63.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch11.html#clmse63.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">11.7   </span> <a 
 id="x79-38500011.7"></a>Package System Functions and Variables</h3>
<!--l. 803--><p class="noindent" >Some of the functions and variables in this section are described in previous
sections but are included here for completeness.
<div class=obsolete>
<!--l. 808--><p class="indent" >   It is up to each implementation&#x2019;s compiler to ensure that when a compiled ﬁle
is loaded, all of the symbols in the ﬁle end up in the same packages that they
would occupy if the Lisp source ﬁle were loaded. In most compilers, this will be
accomplished by treating certain package operations as though they are
surrounded by (eval-when (compile load eval) ...); see <a 
href="clmse30.html#x40-83003r18">eval-when</a>. These operations
are <a 
href="#x79-275004r174">make-package</a>, <a 
href="#x79-277005r176">in-package</a>, <a 
href="#x79-294003r193">shadow</a>, <a 
href="#x79-293004r192">shadowing-import</a>, <a 
href="#x79-290003r189">export</a>, <a 
href="#x79-291003r190">unexport</a>,
<a 
href="#x79-295004r194">use-package</a>, <a 
href="#x79-296003r195">unuse-package</a>, and <a 
href="#x79-292003r191">import</a>. To guarantee proper compilation in all
Common Lisp implementations, these functions should appear only at top level
within a ﬁle. As a matter of style, it is suggested that each ﬁle contain
only one package, and that all of the package setup forms appear near
the start of the ﬁle. This is discussed in more detail, with examples, in
section <a 
href="clmse65.html#x81-30700011.9">11.9<!--tex4ht:ref: PACKAGE-EXAMPLE-SECTION --></a>.
</div>
<div class=newer>
<!--l. 826--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx79-385001"></a>to cancel the speciﬁcations of the preceding
paragraph in order to support a model of ﬁle compilation in which the compiler
need never take special note of ordinary function calls; only special forms and
macros are recognized as aﬀecting the state of the compilation process. As part of
this change <a 
href="#x79-277005r176">in-package</a> was changed to be a macro rather than a function and its
functionality was restricted. The actions of <a 
href="#x79-294003r193">shadow</a>, <a 
href="#x79-293004r192">shadowing-import</a>,
<a 
href="#x79-295004r194">use-package</a>, <a 
href="#x79-292003r191">import</a>, <a 
href="#x79-287003r186">intern</a>, and <a 
href="#x79-290003r189">export</a> for compilation purposes may be
accomplished with the new macro <a 
href="#x79-297004r196">defpackage</a>.
</div>
<div class=implementation>
<!--l. 841--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-38600011.7"></a></span>
                                                                          

                                                                          
   <b>Implementation note:</b> In the past, some Lisp compilers have read the entire
ﬁle into Lisp before processing any of the forms. Other compilers have
arranged for the loader to do all of its intern operations before evaluating
any of the top-level forms. Neither of these techniques will work in a
straightforward way in Common Lisp because of the presence of multiple
packages.
<!--l. 849--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-38700011.7"></a>
<!--l. 849--><p class="indent" >   </span>
   implementation
</div>
<!--l. 852--><p class="indent" >   For the functions described here, all optional arguments named package default
to the current value of *package*. Where a function takes an argument that is
either a symbol or a list of symbols, an argument of <a 
href="clmse31.html#x42-86002r19">nil</a> is treated as an empty list
of symbols. Any argument described as a package name may be either a
string or a symbol. If a symbol is supplied, its print name will be used
as the package name; if a string is supplied, the user must take care to
specify the same capitalization used in the package name, normally all
uppercase.
<div class=defun>
<!--l. 861--><p class="noindent" ><i>[Variable]</i><a 
 id="dx79-387001"></a><a 
 id="x79-387002r173"></a><b> *package*</b>
<!--l. 863--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-388000173"></a></span>
   The value of this variable must be a package; this package is said to be the
current package. The initial value of *package* is the user package.
<div class=newer>
<!--l. 869--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx79-388001"></a>to specify that the forthcoming ANSI
Common Lisp will use the package name common-lisp-user instead of
user.
</div>
<!--l. 874--><p class="indent" >   The function <a 
href="clmse122.html#x150-745002r778">load</a> rebinds *package* to its current value. If some form in the
ﬁle changes the value of *package* during loading, the old value will be restored
when the loading is completed.
<div class=newer>
<!--l. 879--><p class="indent" >   X3J13 voted in October 1988 <a 
 id="dx79-388002"></a>to require <a 
href="clmse127.html#x157-773003r799">compile-ﬁle</a> to rebind *package* to its
current value.
</div>
                                                                          

                                                                          
</div>
<div class=defun>
<!--l. 884--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-388003"></a><a 
 id="x79-388004r174"></a><b> make-package</b>  <i>package-name</i> &#x0026;key  <i>:nicknames</i> <i>:use</i>
<!--l. 886--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-389000174"></a></span>
   This creates and returns a new package with the speciﬁed package name. As
described above, this argument may be either a string or a symbol. The
:nicknames argument must be a list of strings to be used as alternative names for
the package. Once again, the user may supply symbols in place of the strings, in
which case the print names of the symbols are used. These names and nicknames
must not conﬂict with any existing package names; if they do, a correctable error
is signaled.
<!--l. 896--><p class="indent" >   The :use argument is a list of packages or the names (strings or symbols) of
packages whose external symbols are to be inherited by the new package. These
packages must already exist. If not supplied, :use defaults to a list of one package,
the lisp package.
<div class=newer>
<!--l. 902--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx79-389001"></a>to specify that the forthcoming ANSI Common
Lisp will use the package name common-lisp instead of lisp.
</div>
<div class=new>
<!--l. 908--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-389002"></a>to change the speciﬁcation of <a 
href="#x79-275004r174">make-package</a> so
that the default value for the :use argument is unspeciﬁed. Portable code should
specify :use &#x2019;(&#x0022;COMMON-LISP&#x0022;) explicitly.
<div class=rationale>
<!--l. 915--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-39000011.7"></a></span>
   <b>Rationale:</b> Many existing implementations of Common Lisp happen to have
violated the ﬁrst edition speciﬁcation, providing as the default not only the lisp
package but also (or instead) a package containing implementation-dependent
language extensions. This is for good reason: usually it is much more convenient
to the user for the default :use list to be the entire, implementation-dependent,
extended language rather than only the facilities speciﬁed in this book. The
X3J13 vote simply legitimizes existing practice.
<!--l. 925--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-39100011.7"></a>
                                                                          

                                                                          
<!--l. 925--><p class="indent" >   </span>
   rationale
</div>
</div>
</div>
<div class=obsolete>
<div class=defun>
<!--l. 932--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-391001"></a><a 
 id="x79-391002r175"></a><b> in-package</b>  <i>package-name</i> &#x0026;key  <i>:nicknames</i> <i>:use</i>
<!--l. 934--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-392000175"></a></span>
   The <a 
href="#x79-277005r176">in-package</a> function is intended to be placed at the start of a ﬁle
containing a subsystem that is to be loaded into some package other than
user.
<!--l. 939--><p class="indent" >   If there is not already a package named package-name, this function is similar
to <a 
href="#x79-275004r174">make-package</a>, except that after the new package is created, *package* is set to
it. This binding will remain in force until changed by the user (perhaps with
another <a 
href="#x79-277005r176">in-package</a> call) or until the *package* variable reverts to its old value at
the completion of a <a 
href="clmse122.html#x150-745002r778">load</a> operation.
<!--l. 946--><p class="indent" >   If there is an existing package whose name is package-name, the assumption is
that the user is re-loading a ﬁle after making some changes. The existing package
is augmented to reﬂect any new nicknames or new packages in the :use
list (with the usual error checking), and *package* is then set to this
package.
</div>
</div>
<div class=new>
<!--l. 955--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-392001"></a>to specify that <a 
href="#x79-277005r176">in-package</a> returns the
new package, that is, the value of *package* after the operation has been
executed.
</div>
<div class=newer>
<!--l. 962--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx79-392002"></a>to specify that the forthcoming ANSI
Common Lisp will use the package name common-lisp-user instead of
user.
</div>
<div class=newer>
<!--l. 968--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx79-392003"></a>to restrict the functionality of <a 
href="#x79-277005r176">in-package</a> and to
                                                                          

                                                                          
make it a macro. This is an incompatible change.
<!--l. 972--><p class="indent" >   Making <a 
href="#x79-277005r176">in-package</a> a macro rather than a function means that there is no need
to require <a 
href="clmse127.html#x157-773003r799">compile-ﬁle</a> to handle it specially. Since <a 
href="#x79-297004r196">defpackage</a> is also deﬁned
to have side eﬀects on the compilation environment, there is no need
to require any of the package functions to be treated specially by the
compiler.
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> in-package </b><a 
 id="dx79-392004"></a><a 
 id="x79-392005r176"></a> name
</td></tr></table>
<!--l. 981--><p class="indent" >
</div>
<!--l. 981--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-39300011.7"></a></span>
   This macro causes *package* to be set to the package named name, which
must be a symbol or string. The name is not evaluated. An error is signaled if the
package does not already exist. Everything this macro does is also performed at
compile time if the call appears at top level.
</div>
</div>
<div class=defun>
<!--l. 991--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-393001"></a><a 
 id="x79-393002r177"></a><b> ﬁnd-package</b>  <i>name</i>
<!--l. 993--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-394000177"></a></span>
   The name must be a string that is the name or nickname for a package. This
argument may also be a symbol, in which case the symbol&#x2019;s print name is used.
The package with that name or nickname is returned; if no such package
exists, <a 
href="#x79-278002r177">ﬁnd-package</a> returns <a 
href="clmse31.html#x42-86002r19">nil</a>. The matching of names observes case (as in
string=).
<div class=new>
<!--l. 1001--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-394001"></a>to allow <a 
href="#x79-278002r177">ﬁnd-package</a> to accept a package object,
in which case the package is simply returned (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
                                                                          

                                                                          
</div>
<div class=defun>
<!--l. 1008--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-394002"></a><a 
 id="x79-394003r178"></a><b> package-name</b>  <i>package</i>
<!--l. 1010--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-395000178"></a></span>
   The argument must be a package. This function returns the string that names
that package.
<div class=new>
<!--l. 1015--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-395001"></a>to allow <a 
href="#x79-279003r178">package-name</a> to accept a package name
or nickname, in which case the primary name of the package so speciﬁed is
returned (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
<div class=new>
<!--l. 1023--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-395002"></a>to add a function to delete packages. One
consequence of this vote is that <a 
href="#x79-279003r178">package-name</a> will return <a 
href="clmse31.html#x42-86002r19">nil</a> instead of a package
name if applied to a deleted package object. See <a 
href="#x79-286002r185">delete-package</a>.
</div>
</div>
<div class=defun>
<!--l. 1032--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-395003"></a><a 
 id="x79-395004r179"></a><b> package-nicknames</b>  <i>package</i>
<!--l. 1034--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-396000179"></a></span>
   The argument must be a package. This function returns the list of nickname
strings for that package, not including the primary name.
<div class=new>
<!--l. 1039--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-396001"></a>to allow <a 
href="#x79-280004r179">package-nicknames</a> to accept a package
name or nickname, in which case the nicknames of the package so speciﬁed are
returned (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 1047--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-396002"></a><a 
 id="x79-396003r180"></a><b> rename-package</b>  <i>package</i> <i>new-name</i> &#x0026;optional  <i>new-nicknames</i>
<!--l. 1049--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-397000180"></a></span>
   The old name and all of the old nicknames of package are eliminated and are
replaced by new-name and new-nicknames. The new-name argument is a string or
symbol; the new-nicknames argument, which defaults to <a 
href="clmse31.html#x42-86002r19">nil</a>, is a list of strings or
                                                                          

                                                                          
symbols.
<div class=new>
<!--l. 1056--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-397001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
<div class=new>
<!--l. 1063--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-397002"></a>to specify that <a 
href="#x79-281003r180">rename-package</a> returns
package.
</div>
</div>
<div class=defun>
<!--l. 1069--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-397003"></a><a 
 id="x79-397004r181"></a><b> package-use-list</b>  <i>package</i>
<!--l. 1071--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-398000181"></a></span>
   A list of other packages used by the argument package is returned.
<div class=new>
<!--l. 1075--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-398001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 1082--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-398002"></a><a 
 id="x79-398003r182"></a><b> package-used-by-list</b>  <i>package</i>
<!--l. 1084--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-399000182"></a></span>
   A list of other packages that use the argument package is returned.
<div class=new>
<!--l. 1088--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-399001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 1095--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-399002"></a><a 
 id="x79-399003r183"></a><b> package-shadowing-symbols</b>  <i>package</i>
<!--l. 1097--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-400000183"></a></span>
   A list is returned of symbols that have been declared as shadowing symbols in
this package by <a 
href="#x79-294003r193">shadow</a> or <a 
href="#x79-293004r192">shadowing-import</a>. All symbols on this list are present
in the speciﬁed package.
                                                                          

                                                                          
<div class=new>
<!--l. 1103--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-400001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 1110--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-400002"></a><a 
 id="x79-400003r184"></a><b> list-all-packages</b>
<!--l. 1112--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-401000184"></a></span>
   This function returns a list of all packages that currently exist in the Lisp
system.
</div>
<div class=new>
<div class=defun>
<!--l. 1119--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-401001"></a><a 
 id="x79-401002r185"></a><b> delete-package</b>  <i>package</i>
<!--l. 1121--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-402000185"></a></span>
   X3J13 voted in January 1989 <a 
 id="dx79-402001"></a>to add the <a 
href="#x79-286002r185">delete-package</a> function, which deletes
the speciﬁed package from all package system data structures. The package
argument may be either a package or the name of a package.
<!--l. 1128--><p class="indent" >   If package is a name but there is currently no package of that name, a
correctable error is signaled. Continuing from the error makes no deletion attempt
but merely returns <a 
href="clmse31.html#x42-86002r19">nil</a> from the call to <a 
href="#x79-286002r185">delete-package</a>.
<!--l. 1133--><p class="indent" >   If package is a package object that has already been deleted, no error is
signaled and no deletion is attempted; instead, <a 
href="#x79-286002r185">delete-package</a> immediately returns
<a 
href="clmse31.html#x42-86002r19">nil</a>.
<!--l. 1137--><p class="indent" >   If the package speciﬁed for deletion is currently used by other packages, a
correctable error is signaled. Continuing from this error, the eﬀect of the function
<a 
href="#x79-296003r195">unuse-package</a> is performed on all such other packages so as to remove their
dependency on the speciﬁed package, after which <a 
href="#x79-286002r185">delete-package</a> proceeds
to delete the speciﬁed package as if no other package had been using
it.
<!--l. 1144--><p class="indent" >   If any symbol had the speciﬁed package as its home package before the call to
<a 
href="#x79-286002r185">delete-package</a>, then its home package is unspeciﬁed (that is, the contents of its
package cell are unspeciﬁed) after the <a 
href="#x79-286002r185">delete-package</a> operation has been
completed. Symbols in the deleted package are not modiﬁed in any other
way.
                                                                          

                                                                          
<!--l. 1150--><p class="indent" >   The name and nicknames of the package cease to be recognized package
names. The package object is still a package, but anonymous; <a 
href="clmse32.html#x43-112002r42">packagep</a> will be
true of it, but <a 
href="#x79-279003r178">package-name</a> applied to it will return <a 
href="clmse31.html#x42-86002r19">nil</a>.
<!--l. 1154--><p class="indent" >   The eﬀect of any other package operation on a deleted package object is
undeﬁned. In particular, an attempt to locate a symbol within a deleted
package (using <a 
href="#x79-287003r186">intern</a> or <a 
href="#x79-288004r187">ﬁnd-symbol</a>, for example) will have unspeciﬁed
results.
<!--l. 1159--><p class="indent" >   <a 
href="#x79-286002r185">delete-package</a> returns <a 
href="clmse31.html#x42-87002r20">t</a> if the deletion succeeds, and <a 
href="clmse31.html#x42-86002r19">nil</a> otherwise.
</div>
</div>
<div class=defun>
<!--l. 1164--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-402002"></a><a 
 id="x79-402003r186"></a><b> intern</b>  <i>string</i> &#x0026;optional  <i>package</i>
<!--l. 1166--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-403000186"></a></span>
   The package, which defaults to the current package, is searched for a symbol
with the name speciﬁed by the string argument. This search will include inherited
symbols, as described in section <a 
href="clmse60.html#x76-27100011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>. If a symbol with the speciﬁed name is
found, it is returned. If no such symbol is found, one is created and is installed in
the speciﬁed package as an internal symbol (as an external symbol if the package
is the keyword package); the speciﬁed package becomes the home package of the
created symbol.
<div class=newer>
<!--l. 1179--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx79-403001"></a>to specify that <a 
href="#x79-287003r186">intern</a> may in eﬀect perform the
search using a copy of the argument string in which some or all of the
implementation-deﬁned attributes have been removed from the characters of the
string. It is implementation-dependent which attributes are removed.
</div>
<!--l. 1187--><p class="indent" >   Two values are returned. The ﬁrst is the symbol that was found or created.
The second value is <a 
href="clmse31.html#x42-86002r19">nil</a> if no pre-existing symbol was found, and takes on one of
three values if a symbol was found: <div class=indentdesc>
              <div><br /><b>
:internal      </b>The symbol was directly present in the package as an internal
              symbol.
              <br /><b>
:external     </b>The symbol was directly present as an external symbol.
                                                                          

                                                                          
              <br /><b>
:inherited    </b>The symbol was inherited via <a 
href="#x79-295004r194">use-package</a> (which implies that
              the symbol is internal).</div>
</div>
<div class=new>
<!--l. 1203--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-403002"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
<div class=incompatibility>
<!--l. 1210--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-40400011.7"></a></span>
   <b>Compatibility note:</b> Conceptually, <a 
href="#x79-287003r186">intern</a> translates a string to a symbol. In
MacLisp and several other dialects of Lisp, <a 
href="#x79-287003r186">intern</a> can take either a string or a
symbol as its argument; in the latter case, the symbol&#x2019;s print name is extracted
and used as the string. However, this leads to some confusing issues about what
to do if <a 
href="#x79-287003r186">intern</a> ﬁnds a symbol that is not <a 
href="clmse33.html#x44-117002r46">eq</a> to the argument symbol.
To avoid such confusion, Common Lisp requires the argument to be a
string.
<!--l. 1218--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-40500011.7"></a>
<!--l. 1218--><p class="indent" >   </span>
   incompatibility
</div>
</div>
<div class=defun>
<!--l. 1222--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-405001"></a><a 
 id="x79-405002r187"></a><b> ﬁnd-symbol</b>  <i>string</i> &#x0026;optional  <i>package</i>
<!--l. 1224--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-406000187"></a></span>
   This is identical to <a 
href="#x79-287003r186">intern</a>, but it never creates a new symbol. If a symbol with
the speciﬁed name is found in the speciﬁed package, directly or by inheritance, the
symbol found is returned as the ﬁrst value and the second value is as speciﬁed for
<a 
href="#x79-287003r186">intern</a>. If the symbol is not accessible in the speciﬁed package, both values are
<a 
href="clmse31.html#x42-86002r19">nil</a>.
<div class=new>
<!--l. 1233--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-406001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
                                                                          

                                                                          
</div>
</div>
<div class=defun>
<!--l. 1240--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-406002"></a><a 
 id="x79-406003r188"></a><b> unintern</b>  <i>symbol</i> &#x0026;optional  <i>package</i>
<!--l. 1242--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-407000188"></a></span>
   If the speciﬁed symbol is present in the speciﬁed package, it is removed from
that package and also from the package&#x2019;s shadowing-symbols list if it is present
there. Moreover, if the package is the home package for the symbol, the
symbol is made to have no home package. Note that in some circumstances
the symbol may continue to be accessible in the speciﬁed package by
inheritance. <a 
href="#x79-289003r188">unintern</a> returns <a 
href="clmse31.html#x42-87002r20">t</a> if it actually removed a symbol, and <a 
href="clmse31.html#x42-86002r19">nil</a>
otherwise.
<!--l. 1252--><p class="indent" >   <a 
href="#x79-289003r188">unintern</a> should be used with caution. It changes the state of the package
system in such a way that the consistency rules do not hold across the
change.
<div class=new>
<!--l. 1257--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-407001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
<div class=incompatibility>
<!--l. 1264--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-40800011.7"></a></span>
   <b>Compatibility note:</b> The equivalent of this in MacLisp is remob.
<!--l. 1266--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-40900011.7"></a>
<!--l. 1266--><p class="indent" >   </span>
   incompatibility
</div>
</div>
<div class=defun>
<!--l. 1270--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-409001"></a><a 
 id="x79-409002r189"></a><b> export</b>  <i>symbols</i> &#x0026;optional  <i>package</i>
<!--l. 1272--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-410000189"></a></span>
   The symbols argument should be a list of symbols, or possibly a single symbol.
These symbols become accessible as external symbols in package (see
                                                                          

                                                                          
section <a 
href="clmse60.html#x76-27100011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). <a 
href="#x79-290003r189">export</a> returns <a 
href="clmse31.html#x42-87002r20">t</a>.
<!--l. 1278--><p class="indent" >   By convention, a call to <a 
href="#x79-290003r189">export</a> listing all exported symbols is placed near the
start of a ﬁle to advertise which of the symbols mentioned in the ﬁle are intended
to be used by other programs.
<div class=new>
<!--l. 1283--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-410001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 1290--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-410002"></a><a 
 id="x79-410003r190"></a><b> unexport</b>  <i>symbols</i> &#x0026;optional  <i>package</i>
<!--l. 1292--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-411000190"></a></span>
   The argument should be a list of symbols, or possibly a single symbol. These
symbols become internal symbols in package. It is an error to unexport a
symbol from the keyword package (see section <a 
href="clmse60.html#x76-27100011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). <a 
href="#x79-291003r190">unexport</a> returns
<a 
href="clmse31.html#x42-87002r20">t</a>.
<div class=new>
<!--l. 1300--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-411001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 1307--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-411002"></a><a 
 id="x79-411003r191"></a><b> import</b>  <i>symbols</i> &#x0026;optional  <i>package</i>
<!--l. 1309--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-412000191"></a></span>
   The argument should be a list of symbols, or possibly a single symbol. These
symbols become internal symbols in package and can therefore be referred to
without having to use qualiﬁed-name (colon) syntax. <a 
href="#x79-292003r191">import</a> signals a correctable
error if any of the imported symbols has the same name as some distinct
symbol already accessible in the package (see section <a 
href="clmse60.html#x76-27100011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). <a 
href="#x79-292003r191">import</a> returns
<a 
href="clmse31.html#x42-87002r20">t</a>.
<div class=newer>
<!--l. 1320--><p class="indent" >   X3J13 voted in June 1987 <a 
 id="dx79-412001"></a>to clarify that if any symbol to be imported has no
home package then <a 
href="#x79-292003r191">import</a> sets the home package of the symbol to the package to
which the symbol is being imported.
</div>
                                                                          

                                                                          
<div class=new>
<!--l. 1327--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-412002"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 1334--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-412003"></a><a 
 id="x79-412004r192"></a><b> shadowing-import</b>  <i>symbols</i> &#x0026;optional  <i>package</i>
<!--l. 1336--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-413000192"></a></span>
   This is like <a 
href="#x79-292003r191">import</a>, but it does not signal an error even if the importation of a
symbol would shadow some symbol already accessible in the package. In addition
to being imported, the symbol is placed on the shadowing-symbols list of package
(see section <a 
href="clmse61.html#x77-27200011.5">11.5<!--tex4ht:ref: NAME-CONFLICTS-SECTION --></a>). <a 
href="#x79-293004r192">shadowing-import</a> returns <a 
href="clmse31.html#x42-87002r20">t</a>.
<!--l. 1344--><p class="indent" >   <a 
href="#x79-293004r192">shadowing-import</a> should be used with caution. It changes the state of the
package system in such a way that the consistency rules do not hold across the
change.
<div class=new>
<!--l. 1349--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-413001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 1356--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-413002"></a><a 
 id="x79-413003r193"></a><b> shadow</b>  <i>symbols</i> &#x0026;optional  <i>package</i>
<!--l. 1358--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-414000193"></a></span>
   The argument should be a list of symbols, or possibly a single symbol. The
print name of each symbol is extracted, and the speciﬁed package is searched for a
symbol of that name. If such a symbol is present in this package (directly, not by
inheritance), then nothing is done. Otherwise, a new symbol is created with this
print name, and it is inserted in the package as an internal symbol. The symbol is
also placed on the shadowing-symbols list of the package (see section <a 
href="clmse61.html#x77-27200011.5">11.5<!--tex4ht:ref: NAME-CONFLICTS-SECTION --></a>).
<a 
href="#x79-294003r193">shadow</a> returns <a 
href="clmse31.html#x42-87002r20">t</a>.
<div class=newer>
<!--l. 1370--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx79-414001"></a>to change <a 
href="#x79-294003r193">shadow</a> to accept strings as well
as well as symbols (a string in the symbols list being treated as a print
name), and to clarify that if a symbol of speciﬁed name is already in the
package but is not yet on the shadowing-symbols list for that package, then
                                                                          

                                                                          
<a 
href="#x79-294003r193">shadow</a> does add it to the shadowing-symbols list rather than simply doing
nothing.
</div>
<!--l. 1379--><p class="indent" >   <a 
href="#x79-294003r193">shadow</a> should be used with caution. It changes the state of the package
system in such a way that the consistency rules do not hold across the
change.
<div class=new>
<!--l. 1384--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-414002"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 1391--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-414003"></a><a 
 id="x79-414004r194"></a><b> use-package</b>  <i>packages-to-use</i> &#x0026;optional  <i>package</i>
<!--l. 1393--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-415000194"></a></span>
   The packages-to-use argument should be a list of packages or package names,
or possibly a single package or package name. These packages are added to the
use-list of package if they are not there already. All external symbols in the
packages to use become accessible in package as internal symbols (see
section <a 
href="clmse60.html#x76-27100011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). It is an error to try to use the keyword package. <a 
href="#x79-295004r194">use-package</a> returns
<a 
href="clmse31.html#x42-87002r20">t</a>.
<div class=new>
<!--l. 1404--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-415001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
</div>
<div class=defun>
<!--l. 1411--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-415002"></a><a 
 id="x79-415003r195"></a><b> unuse-package</b>  <i>packages-to-unuse</i> &#x0026;optional  <i>package</i>
<!--l. 1413--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-416000195"></a></span>
   The packages-to-unuse argument should be a list of packages or package
names, or possibly a single package or package name. These packages are removed
from the use-list of package. <a 
href="#x79-296003r195">unuse-package</a> returns <a 
href="clmse31.html#x42-87002r20">t</a>.
<div class=new>
<!--l. 1420--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-416001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
                                                                          

                                                                          
</div>
<div class=new>
<!--l. 1428--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-416002"></a>to add a macro <a 
href="#x79-297004r196">defpackage</a> to the language
to make it easier to create new packages, alleviating the burden on the
programmer to perform the various setup operations in exactly the correct
sequence.
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> defpackage </b><a 
 id="dx79-416003"></a><a 
 id="x79-416004r196"></a> deﬁned-package-name  {option}*
</td></tr></table>
<!--l. 1437--><p class="indent" >
</div>
<!--l. 1437--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-41700011.7"></a></span>
   This creates a new package, or modiﬁes an existing one, whose name is
deﬁned-package-name. The deﬁned-package-name may be a string or a symbol; if
it is a symbol, only its print name matters, and not what package, if any, the
symbol happens to be in. The newly created or modiﬁed package is returned as
the value of the <a 
href="#x79-297004r196">defpackage</a> form.
<!--l. 1446--><p class="indent" >   Each standard option is a list of a keyword (the name of the option) and
associated arguments. No part of a <a 
href="#x79-297004r196">defpackage</a> form is evaluated. Except for the
:size option, more than one option of the same kind may occur within the same
<a 
href="#x79-297004r196">defpackage</a> form.
<!--l. 1451--><p class="indent" >   The standard options for <a 
href="#x79-297004r196">defpackage</a> are as follows. In every case, any option
argument called package-name or symbol-name may be a string or a symbol; if it
is a symbol, only its print name matters, and not what package, if any, the symbol
happens to be in.
<div class=flushdesc>
<!--l. 1459--><p class="indent" >
  <div><br /><b>
(:size integer)                                                             </b>
This speciﬁes approximately the number of symbols expected to be in the
                                                                          

                                                                          
package. This is purely an eﬃciency hint to the storage allocator, so that
implementations using hash tables as part of the package data structure (the
usual technique) will not have to incrementally expand the package as new
symbols are added to it (for example, as a large ﬁle is read while “in” that
package).
  <br /><b>
(:nicknames  {<i>package-name</i>}* )                                           </b>
The speciﬁed names become nicknames of the package being deﬁned. If any
of the speciﬁed nicknames already refers to an existing package, a continuable
error is signaled exactly as for the function <a 
href="#x79-275004r174">make-package</a>.
  <br /><b>
(:shadow  {<i>symbol-name</i>}* )                                               </b>
Symbols with the speciﬁed names are created as shadows in the package
being deﬁned, just as with the function <a 
href="#x79-294003r193">shadow</a>.
  <br /><b>
(:shadowing-import-from package-name {<i>symbol-name</i>}* )                 </b>
Symbols  with  the  speciﬁed  names  are  located  in  the  speciﬁed  package.
These symbols are imported into the package being deﬁned, shadowing other
symbols if necessary, just as with the function <a 
href="#x79-293004r192">shadowing-import</a>. In no case
will symbols be created in a package other than the one being deﬁned; a
continuable error is signaled if for any symbol-name there is no symbol of
that name accessible in the package named package-name.
  <br /><b>
(:use  {<i>package-name</i>}* )                                                  </b>
The  package  being  deﬁned  is  made  to  “use”  (inherit  from)  the  packages
speciﬁed by this option, just as with the function <a 
href="#x79-295004r194">use-package</a>. If no :use
option is supplied, then a default list is assumed as for <a 
href="#x79-275004r174">make-package</a>.
<!--l. 1493--><p class="indent" >  X3J13 voted in January 1989 <a 
 id="dx79-417001"></a>to change the speciﬁcation of <a 
href="#x79-275004r174">make-package</a>
so   that   the   default   value   for   the   :use   argument   is   unspeciﬁed.
This  change  aﬀects  <a 
href="#x79-297004r196">defpackage</a>  as  well.  Portable  code  should  specify
(:use &#x2019;(&#x0022;COMMON-LISP&#x0022;)) explicitly.
  <br /><b>
(:import-from package-name {<i>symbol-name</i>}* )                            </b>
                                                                          

                                                                          
Symbols with the speciﬁed names are located in the speciﬁed package. These
symbols are imported into the package being deﬁned, just as with the function
<a 
href="#x79-292003r191">import</a>. In no case will symbols be created in a package other than the one
being deﬁned; a continuable error is signaled if for any symbol-name there is
no symbol of that name accessible in the package named package-name.
  <br /><b>
(:intern  {<i>symbol-name</i>}* )                                                 </b>
Symbols with the speciﬁed names are located or created in the package being
deﬁned, just as with the function <a 
href="#x79-287003r186">intern</a>. Note that the action of this option
may be aﬀected by a :use option, because an inherited symbol will be used
in preference to creating a new one.
  <br /><b>
(:export  {<i>symbol-name</i>}* )                                                </b>
Symbols  with  the  speciﬁed  names  are  located  or  created  in  the  package
being deﬁned and then exported, just as with the function <a 
href="#x79-290003r189">export</a>. Note
that the action of this option may be aﬀected by a :use, :import-from, or
:shadowing-import-from option, because an inherited or imported symbol
will be used in preference to creating a new one.</div>
</div>
<!--l. 1525--><p class="indent" >   The order in which options appear in a <a 
href="#x79-297004r196">defpackage</a> form does not matter; part
of the convenience of <a 
href="#x79-297004r196">defpackage</a> is that it sorts out the options into the
correct order for processing. Options are processed in the following order:
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">1.  :shadow and :shadowing-import-from
</td></tr></table>
<!--l. 1530--><p class="indent" >                                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">2.  :use</td></tr></table>
<!--l. 1531--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">3.  :import-from and :intern</td></tr></table>
<!--l. 1532--><p class="indent" >                                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">4.  :export</td></tr></table>
<!--l. 1534--><p class="indent" >
</div>
<!--l. 1535--><p class="noindent" >Shadows are established ﬁrst in order to avoid spurious name conﬂicts when use links
are established. Use links must occur before importing and interning so that those
operations may refer to normally inherited symbols rather than creating new ones.
                                                                          

                                                                          
Exports are performed last so that symbols created by any of the other
options, in particular, shadows and imported symbols, may be exported.
Note that exporting an inherited symbol implicitly imports it ﬁrst (see
section <a 
href="clmse60.html#x76-27100011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>).
<!--l. 1544--><p class="indent" >   If no package named deﬁned-package-name already exists, <a 
href="#x79-297004r196">defpackage</a> creates
it. If such a package does already exist, then no new package is created. The
existing package is modiﬁed, if possible, to reﬂect the new deﬁnition. The results
are undeﬁned if the new deﬁnition is not consistent with the current state of the
package.
<!--l. 1551--><p class="indent" >   An error is signaled if more than one :size option appears.
<!--l. 1553--><p class="indent" >   An error is signaled if the same <a 
href="clmse55.html#x70-257002r165">symbol-name</a> argument (in the sense of
comparing names with string=) appears more than once among the arguments
to all the :shadow, :shadowing-import-from, :import-from, and :intern
options.
<!--l. 1558--><p class="indent" >   An error is signaled if the same <a 
href="clmse55.html#x70-257002r165">symbol-name</a> argument (in the sense of
comparing names with string=) appears more than once among the arguments to
all the :intern and :export options.
<!--l. 1562--><p class="indent" >   Other kinds of name conﬂicts are handled in the same manner that
the underlying operations <a 
href="#x79-295004r194">use-package</a>, <a 
href="#x79-292003r191">import</a>, and <a 
href="#x79-290003r189">export</a> would handle
them.
<!--l. 1566--><p class="indent" >   Implementations may support other <a 
href="#x79-297004r196">defpackage</a> options. Every implementation
should signal an error on encountering a <a 
href="#x79-297004r196">defpackage</a> option it does not
support.
<!--l. 1570--><p class="indent" >   The function <a 
href="clmse127.html#x157-773003r799">compile-ﬁle</a> should treat top-level <a 
href="#x79-297004r196">defpackage</a> forms in the same
way it would treat top-level calls to package-aﬀecting functions (as described at
the beginning of section <a 
href="#x79-27400011.7">11.7<!--tex4ht:ref: PACKAGE-FUNCTIONS-SECTION --></a>).
<!--l. 1575--><p class="indent" >   Here is an example of a call to <a 
href="#x79-297004r196">defpackage</a> that “plays it safe” by using only
strings as names. <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(cl:defpackage &#x0022;MY-VERY-OWN-PACKAGE&#x0022;
</td></tr></table>
<!--l. 1578--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:size 496)</td></tr></table>
<!--l. 1579--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:nicknames &#x0022;MY-PKG&#x0022; &#x0022;MYPKG&#x0022; &#x0022;MVOP&#x0022;)</td></tr></table>
<!--l. 1580--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:use &#x0022;COMMON-LISP&#x0022;)</td></tr></table>
<!--l. 1581--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:shadow &#x0022;CAR&#x0022; &#x0022;CDR&#x0022;)</td></tr></table>
<!--l. 1582--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:shadowing-import-from &#x0022;BRAND-X-LISP&#x0022; &#x0022;CONS&#x0022;)</td></tr></table>
<!--l. 1583--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:import-from &#x0022;BRAND-X-LISP&#x0022; &#x0022;GC&#x0022; &#x0022;BLINK-FRONT-PANEL-LIGHTS&#x0022;)</td></tr></table>
                                                                          

                                                                          
<!--l. 1584--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:export &#x0022;EQ&#x0022; &#x0022;CONS&#x0022; &#x0022;MY-VERY-OWN-FUNCTION&#x0022;))</td></tr></table>
<!--l. 1586--><p class="indent" >
</div>
</div>
<!--l. 1587--><p class="noindent" >The preceding <a 
href="#x79-297004r196">defpackage</a> example is designed to operate correctly even if the
package current when the form is read happens not to “use” the common-lisp
package. (Note the use in this example of the nickname cl for the common-lisp
package.) Moreover, neither reading in nor evaluating this <a 
href="#x79-297004r196">defpackage</a> form will
ever create any symbols in the current package. Note too the use of uppercase
letters in the strings.
<!--l. 1595--><p class="indent" >   Here, for the sake of contrast, is a rather similar use of <a 
href="#x79-297004r196">defpackage</a> that “plays
the whale” by using all sorts of permissible syntax. <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defpackage my-very-own-package
</td></tr></table>
<!--l. 1599--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:export :EQ common-lisp:cons my-very-own-function)</td></tr></table>
<!--l. 1600--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:nicknames &#x0022;MY-PKG&#x0022; #:MyPkg)</td></tr></table>
<!--l. 1601--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:use &#x0022;COMMON-LISP&#x0022;)</td></tr></table>
<!--l. 1602--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:shadow &#x0022;CAR&#x0022;)</td></tr></table>
<!--l. 1603--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:size 496)</td></tr></table>
<!--l. 1604--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:nicknames mvop)</td></tr></table>
<!--l. 1605--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:import-from &#x0022;BRAND-X-LISP&#x0022; &#x0022;GC&#x0022; Blink-Front-Panel-Lights)</td></tr></table>
<!--l. 1606--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:shadow common-lisp::cdr)</td></tr></table>
<!--l. 1607--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (:shadowing-import-from &#x0022;BRAND-X-LISP&#x0022; CONS))</td></tr></table>
<!--l. 1609--><p class="indent" >
</div>
</div>
<!--l. 1610--><p class="noindent" >This example has exactly the same eﬀect on the newly created package but may
create useless symbols in other packages. The use of explicit package tags is
particularly confusing; for example, this <a 
href="#x79-297004r196">defpackage</a> form will cause the symbol
<a 
href="clmse86.html#x106-459002r445">cdr</a> to be shadowed in the new package; it will not be shadowed in the
package common-lisp. The fact that the name “CDR” was speciﬁed by a
package-qualiﬁed reference to a symbol in the common-lisp package is a red
herring. The moral is that the syntactic ﬂexibility of <a 
href="#x79-297004r196">defpackage</a>, as in other
parts of Common Lisp, yields considerable convenience when used with
commonsense competence, but unutterable confusion when used with Malthusian
                                                                          

                                                                          
profusion.
<div class=implementation>
<!--l. 1624--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-41800011.7"></a></span>
   <b>Implementation note:</b> An implementation of <a 
href="#x79-297004r196">defpackage</a> might choose to
transform all the package-name and symbol-name arguments into strings at macro
expansion time, rather than at the time the resulting expansion is executed, so
that even if source code is expressed in terms of strange symbols in the <a 
href="#x79-297004r196">defpackage</a>
form, the binary ﬁle resulting from compiling the source code would contain
only strings. The purpose of this is simply to minimize the creation of
useless symbols in production code. This technique is permitted as an
implementation strategy but is not a behavior required by the speciﬁcation of
<a 
href="#x79-297004r196">defpackage</a>.
<!--l. 1635--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-41900011.7"></a>
<!--l. 1635--><p class="indent" >   </span>
   implementation
</div>
<!--l. 1638--><p class="indent" >   Note that <a 
href="#x79-297004r196">defpackage</a> is not capable by itself of deﬁning mutually recursive
packages, for example two packages each of which uses the other. However,
nothing prevents one from using <a 
href="#x79-297004r196">defpackage</a> to perform much of the initial setup
and then using functions such as <a 
href="#x79-295004r194">use-package</a>, <a 
href="#x79-292003r191">import</a>, and <a 
href="#x79-290003r189">export</a> to complete the
links.
<!--l. 1645--><p class="indent" >   The purpose of <a 
href="#x79-297004r196">defpackage</a> is to encourage the user to put the entire deﬁnition
of a package and its relationships to other packages in a single place. It may also
encourage the designer of a large system to place the deﬁnitions of all
relevant packages into a single ﬁle (say) that can be loaded before loading
or compiling any code that depends on those packages. Such a ﬁle, if
carefully constructed, can simply be loaded into the common-lisp-user
package.
<!--l. 1653--><p class="indent" >   Implementations and programming environments may also be better able to
support the programming process (if only by providing better error checking)
through global knowledge of the intended package setup.
</div>
</div>
<div class=defun>
                                                                          

                                                                          
<!--l. 1659--><p class="noindent" ><i>[Function]</i><a 
 id="dx79-419001"></a><a 
 id="x79-419002r197"></a><b> ﬁnd-all-symbols</b>  <i>string-or-symbol</i>
<!--l. 1661--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-420000197"></a></span>
   <a 
href="#x79-298003r197">ﬁnd-all-symbols</a> searches every package in the Lisp system to ﬁnd every
symbol whose print name is the speciﬁed string. A list of all such symbols found is
returned. This search is case-sensitive. If the argument is a symbol, its print name
supplies the string to be searched for.
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> do-symbols </b><a 
 id="dx79-420001"></a><a 
 id="x79-420002r198"></a> (var [package [result-form]])
</td></tr></table>
<!--l. 1673--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  {tag | statement}* </td></tr></table>
<!--l. 1674--><p class="indent" >
</div>
<!--l. 1674--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-42100011.7"></a></span>
   <a 
href="#x79-299002r198">do-symbols</a> provides straightforward iteration over the symbols of a
package. The body is performed once for each symbol accessible in the
package, in no particular order, with the variable var bound to the symbol.
Then result-form (a single form, not an implicit <a 
href="clmse38.html#x50-158002r80">progn</a>) is evaluated, and
the result is the value of the <a 
href="#x79-299002r198">do-symbols</a> form. (When the result-form
is evaluated, the control variable var is still bound and has the value
<a 
href="clmse31.html#x42-86002r19">nil</a>.) If the result-form is omitted, the result is <a 
href="clmse31.html#x42-86002r19">nil</a>. <a 
href="clmse142.html#x173-856002r883">return</a> may be used
to terminate the iteration prematurely. If execution of the body aﬀects
which symbols are contained in the package, other than possibly to remove
the symbol currently the value of var by using <a 
href="#x79-289003r188">unintern</a>, the eﬀects are
unpredictable.
<div class=new>
<!--l. 1689--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-421001"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
<div class=new>
                                                                          

                                                                          
<!--l. 1696--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx79-421002"></a>to specify that the body of a <a 
href="#x79-299002r198">do-symbols</a> form may
be executed more than once for the same accessible symbol, and users should take
care to allow for this possibility.
<!--l. 1702--><p class="indent" >   The point is that the same symbol might be accessible via more than one
chain of inheritance, and it is implementationally costly to eliminate such
duplicates. Here is an example: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq *a* (make-package &#x2019;a))      ;Implicitly uses package common-lisp
</td></tr></table>
<!--l. 1706--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq *b* (make-package &#x2019;b))      ;Implicitly uses package common-lisp</td></tr></table>
<!--l. 1707--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq *c* (make-package &#x2019;c :use &#x2019;(a b)))</td></tr></table>
<!--l. 1708--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 1709--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do-symbols (x *c*) (print x))    ;Symbols in package common-lisp</td></tr></table>
<!--l. 1710--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                  ; might be printed once or twice here</td></tr></table>
<!--l. 1712--><p class="indent" >
</div>
</div>
<!--l. 1714--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-421003"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-2000007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div> <div class=new> Note that the <a 
href="clmse42.html#x54-186002r106">loop</a> construct provides a kind of <a 
href="clmse137.html#x168-838002r854">for</a> clause that can iterate over
the symbols of a package (see chapter <a 
href="clmch26.html#x162-82300026">26<!--tex4ht:ref: LOOP --></a>).
</div>
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> do-external-symbols </b><a 
 id="dx79-421004"></a><a 
 id="x79-421005r199"></a> (var [package [result]])
</td></tr></table>
<!--l. 1726--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  {tag | statement}* </td></tr></table>
<!--l. 1727--><p class="indent" >
</div>
                                                                          

                                                                          
<!--l. 1727--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-42200011.7"></a></span>
   <a 
href="#x79-300005r199">do-external-symbols</a> is just like <a 
href="#x79-299002r198">do-symbols</a>, except that only the external
symbols of the speciﬁed package are scanned. <div class=new> The clariﬁcation voted by X3J13 in
March 1988 for <a 
href="#x79-299002r198">do-symbols</a> <a 
 id="dx79-422001"></a>, regarding redundant executions of the body for the
same symbol, applies also to <a 
href="#x79-300005r199">do-external-symbols</a>.
</div>
<div class=new>
<!--l. 1739--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-422002"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
<div class=new>
<!--l. 1746--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-422003"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-2000007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> do-all-symbols </b><a 
 id="dx79-422004"></a><a 
 id="x79-422005r200"></a> (var [result-form])
</td></tr></table>
<!--l. 1754--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  {tag | statement}* </td></tr></table>
<!--l. 1755--><p class="indent" >
</div>
<!--l. 1755--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-42300011.7"></a></span>
   This is similar to <a 
href="#x79-299002r198">do-symbols</a> but executes the body once for every symbol
contained in every package. (This will not process every symbol whatsoever,
because a symbol not accessible in any package will not be processed. Normally,
uninterned symbols are not accessible in any package.) It is not in general the case
that each symbol is processed only once, because a symbol may appear in many
packages.
<div class=new>
<!--l. 1765--><p class="indent" >   The clariﬁcation voted by X3J13 in March 1988 for <a 
href="#x79-299002r198">do-symbols</a> <a 
 id="dx79-423001"></a>, regarding
redundant executions of the body for the same symbol, applies also to
<a 
href="#x79-301005r200">do-all-symbols</a>.
</div>
                                                                          

                                                                          
<div class=new>
<!--l. 1773--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-423002"></a>to clarify that the package argument may be
either a package object or a package name (see section <a 
href="clmse58.html#x74-26900011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>).
</div>
<div class=new>
<!--l. 1780--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-423003"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-2000007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
</div>
<div class=new>
<!--l. 1787--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-423004"></a>to add a new macro <a 
href="#x79-302006r201">with-package-iterator</a> to the
language.
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> with-package-iterator </b><a 
 id="dx79-423005"></a><a 
 id="x79-423006r201"></a> (mname package-list  {symbol-type}+ )
</td></tr></table>
<!--l. 1793--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> { form}* </td></tr></table>
<!--l. 1794--><p class="indent" >
</div>
<!--l. 1794--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-42400011.7"></a></span>
   The name mname is bound and deﬁned as if by <a 
href="clmse39.html#x51-170010r95">macrolet</a>, with the body forms
as its lexical scope, to be a “generator macro” such that each invocation of
(mname) will return a symbol and that successive invocations will eventually
deliver, one by one, all the symbols from the packages that are elements of the list
that is the value of the expression package-list (which is evaluated exactly
once).
<!--l. 1803--><p class="indent" >   Each element of the package-list value may be either a package or the name of
a package. As a further convenience, if the package-list value is itself a package or
the name of a package, it is treated as if a singleton list containing that value had
been provided. If the package-list value is <a 
href="clmse31.html#x42-86002r19">nil</a>, it is considered to be an empty list
of packages.
<!--l. 1811--><p class="indent" >   At each invocation of the generator macro, there are two possibilities. If there
is yet another unprocessed symbol, then four values are returned: <a 
href="clmse31.html#x42-87002r20">t</a>, the symbol, a
                                                                          

                                                                          
keyword indicating the accessibility of the symbol within the package (see below),
and the package from which the symbol was accessed. If there are no more
unprocessed symbols in the list of packages, then one value is returned:
<a 
href="clmse31.html#x42-86002r19">nil</a>.
<!--l. 1820--><p class="indent" >   When the generator macro returns a symbol as its second value, the fourth
value is always one of the packages present or named in the package-list value, and
the third value is a keyword indicating accessibility: :internal means present in the
package and not exported; :external means present and exported; and :inherited
means not present (thus not shadowed) but inherited from some package used by
the package that is the fourth value.
<!--l. 1829--><p class="indent" >   Each symbol-type in an invocation of <a 
href="#x79-302006r201">with-package-iterator</a> is not evaluated.
More than one may be present; their order does not matter. They indicate the
accessibility types of interest. A symbol is not returned by the generator macro
unless its actual accessibility matches one of the symbol-type indicators. The
standard symbol-type indicators are :internal, :external, and :inherited, but
implementations are permitted to extend the syntax of <a 
href="#x79-302006r201">with-package-iterator</a> by
recognizing additional symbol accessibility types. An error is signaled if no
symbol-type is supplied, or if any supplied symbol-type is not recognized by the
implementation.
<!--l. 1841--><p class="indent" >   The order in which symbols are produced by successive invocations of the
generator macro is not necessarily correlated in any way with the order of the
packages in the package-list. When more than one package is in the package-list,
symbols accessible from more than one package may be produced once or more
than once. Even when only one package is speciﬁed, symbols inherited in
multiple ways via used packages may be produced once or more than
once.
<!--l. 1850--><p class="indent" >   The implicit interior state of the iteration over the list of packages and the
symbols within them has dynamic extent. It is an error to invoke the generator
macro once the <a 
href="#x79-302006r201">with-package-iterator</a> form has been exited.
<!--l. 1855--><p class="indent" >   Any number of invocations of <a 
href="#x79-302006r201">with-package-iterator</a> and related macros may
be nested, and the generator macro of an outer invocation may be called from
within an inner invocation (provided, of course, that its name is visible or
otherwise made available).
<!--l. 1860--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx79-424001"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-2000007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
<div class=rationale>
                                                                          

                                                                          
<!--l. 1865--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-42500011.7"></a></span>
   <b>Rationale:</b> This facility is a bit more ﬂexible in some ways than <a 
href="#x79-299002r198">do-symbols</a>
and friends. In particular, it makes it possible to implement <a 
href="clmse42.html#x54-186002r106">loop</a> clauses for
iterating over packages in a way that is both portable and eﬃcient (see
chapter <a 
href="clmch26.html#x162-82300026">26<!--tex4ht:ref: LOOP --></a>).
<!--l. 1871--><p class="noindent" ><span class="paragraphHead"><a 
 id="x79-42600011.7"></a>
<!--l. 1871--><p class="indent" >   </span>
   rationale
</div>
</div>
</div>
                                                                          

                                                                          
   <!--l. 1876--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse64.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse62.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse62.html#tailclmse62.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse63.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch11.html#clmse63.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 1876--><p class="indent" >   <a 
 id="tailclmse63.html"></a>  
</body></html> 
