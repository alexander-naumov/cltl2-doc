<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Синтаксис декларации</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-16 23:44:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 1097--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse52.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#tailclmch9.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse51.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#clmse51.html" >Наверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">9.1   </span> <a 
href="clm.html#QQ2-65-838" id="x65-8290009.1">Синтаксис
декларации</a></h3>
<!--l. 1100--><p class="noindent" >Конструкция <tt><a 
href="clmli7.html#x196-3479300r300">declare</a></tt> используется для встраивания деклараций внутрь
выполняемого кода. Глобальные декларации и декларации, вычисленные
программой, устанавливаются конструкцией <tt><a 
href="clmli7.html#x196-3479739r739">proclaim</a></tt>.
<!--l. 1104--><p class="indent" >   Макрос <tt><a 
href="clmli7.html#x196-3479298r298">declaim</a></tt>, который гарантированно распознаётся компилятором, и
часто более удобен, чем <tt><a 
href="clmli7.html#x196-3479739r739">proclaim</a></tt> для установки глобальных деклараций.
FIXME
<div class="defspec">
<div class="defmacheader">
<!--l. 1109--><p class="indent" >   <div class="tabbing">
 <i>[Специальный оператор]</i><b> declare </b> <a 
 id="dx65-829001"></a><a 
 id="x65-829002r140"></a> {decl-spec}*
                                                                          

                                                                          
   <br>
<!--l. 1110--><p class="noindent" ></div>
<!--l. 1110--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8300009.1" id="x65-8300009.1"></a></span>
</div>
<!--l. 1111--><p class="indent" >   Форма <tt><a 
href="clmli7.html#x196-3479300r300">declare</a></tt> известна как <i>декларация</i>. Декларации могут использоваться
только в начале тел соответствующих специальных форм. То есть
декларация может использоваться в этой специальной форме, как
выражение, и все предыдущие выражение (если есть) также должны быть
формами <tt><a 
href="clmli7.html#x196-3479300r300">declare</a></tt> (или, в некоторых случаях, строками документации).
Декларации могут использоваться в лямбда-выражениях и перечисленных
ниже формах. <div class="lisp"><div class="tabbing">
<tt><a 
href="clmli7.html#x196-3479311r311">define-setf-method</a></tt>     <tt><a 
href="clmli7.html#x196-3479496r496">labels</a></tt>
   <br>   <tt><a 
href="clmli7.html#x196-3479313r313">defmacro</a></tt>               <tt><a 
href="clmli7.html#x196-3479524r524">let</a></tt><br>   <tt><a 
href="clmli7.html#x196-3479317r317">defsetf</a></tt>                <tt><a 
href="clmli7.html#x196-3479525r525">let*</a></tt><br>
<tt><a 
href="clmli7.html#x196-3479319r319">deftype</a></tt>                <tt><a 
href="clmli7.html#x196-3479537r537">locally</a></tt><br>  <tt><a 
href="clmli7.html#x196-3479320r320">defun</a></tt>                  <tt><a 
href="clmli7.html#x196-3479568r568">macrolet</a></tt><br>
<tt><a 
href="clmli7.html#x196-3479339r339">do</a></tt>                     <tt><a 
href="clmli7.html#x196-3479634r634">multiple-value-bind</a></tt><br>
<tt><a 
href="clmli7.html#x196-3479340r340">do*</a></tt>                    <tt><a 
href="clmli7.html#x196-3479741r741">prog</a></tt><br>         <tt><a 
href="clmli7.html#x196-3479341r341">do-all-symbols</a></tt>         <tt><a 
href="clmli7.html#x196-3479742r742">prog*</a></tt><br>
<tt><a 
href="clmli7.html#x196-3479342r342">do-external-symbols</a></tt>    <tt><a 
href="clmli7.html#x196-3480003r1003">with-input-from-string</a></tt><br>
<tt><a 
href="clmli7.html#x196-3479343r343">do-symbols</a></tt>             <tt><a 
href="clmli7.html#x196-3480004r1004">with-open-file</a></tt><br>
<tt><a 
href="clmli7.html#x196-3479346r346">dolist</a></tt>                 <tt><a 
href="clmli7.html#x196-3480005r1005">with-open-stream</a></tt><br>
<tt><a 
href="clmli7.html#x196-3479347r347">dotimes</a></tt>                <tt><a 
href="clmli7.html#x196-3480006r1006">with-output-to-string</a></tt><br>
<tt><a 
href="clmli7.html#x196-3479410r410">flet</a></tt>                   <tt>with-conditions-restarts</tt><br>
<tt><a 
href="clmli7.html#x196-3479736r736">print-unreadable-object</a></tt><tt><a 
href="clmli7.html#x196-3480010r1010">with-standard-io-syntax</a></tt><br>
<!--l. 1133--><p class="noindent" ></div>
<!--l. 1133--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8310009.1" id="x65-8310009.1"></a></span>
<!--l. 1133--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8320009.1" id="x65-8320009.1"></a></span>
</div>
<div class="lisp">
<!--l. 1135--><p class="indent" >   <div class="tabbing">
                                                                          

                                                                          
<tt><a 
href="clmli7.html#x196-3479305r305">defgeneric</a></tt>             <tt><a 
href="clmli7.html#x196-3479440r440">generic-function</a></tt>
   <br>                       <tt><a 
href="clmli7.html#x196-3479309r309">define-method-combination</a></tt><tt><a 
href="clmli7.html#x196-3479441r441">generic-labels</a></tt><br>
<tt><a 
href="clmli7.html#x196-3479314r314">defmethod</a></tt>              <tt><a 
href="clmli7.html#x196-3479999r999">with-added-methods</a></tt><br>            <tt><a 
href="clmli7.html#x196-3479439r439">generic-flet</a></tt><br>
<!--l. 1141--><p class="noindent" ></div>
<!--l. 1141--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8330009.1" id="x65-8330009.1"></a></span>
<!--l. 1141--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8340009.1" id="x65-8340009.1"></a></span>
</div>
<div class="lisp">
<!--l. 1143--><p class="indent" >   <div class="tabbing">
<tt><a 
href="clmli7.html#x196-3479928r928">symbol-macrolet</a></tt>        <tt><a 
href="clmli7.html#x196-3480009r1009">with-slots</a></tt>
   <br>                                              <tt><a 
href="clmli7.html#x196-3479998r998">with-accessors</a></tt><br>
<!--l. 1147--><p class="noindent" ></div>
<!--l. 1147--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8350009.1" id="x65-8350009.1"></a></span>
<!--l. 1147--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8360009.1" id="x65-8360009.1"></a></span>
</div>
<!--l. 1149--><p class="indent" >   Вычисление декларации является ошибкой. Специальные формы,
которые позволяют использовать декларации, явно проверяют их
наличие.
<!--l. 1152--><p class="indent" >   Макровызовы могут раскрываться в декларации, при условии, что
макровызов указан в том месте, где могут быть указаны декларации.
(Однако, макровызов не может использоваться в форме declare на месте
<i>decl-spec</i>.)
<!--l. 1157--><p class="indent" >   Декларация может использовать только явно в теле соответсвтующего
специального оператора в виде списка, <i>car</i> которого равен символу
<tt><a 
href="clmli7.html#x196-3479300r300">declare</a></tt>.
                                                                          

                                                                          
<!--l. 1160--><p class="indent" >   Каждая форма <i>decl-spec</i> является списком, у которого <i>car</i> элемент это
символ, указывающий на тип декларации. Декларации могут быть разделены
на два класса: одни относятся к связыванию переменных, другие нет.
(Декларация <tt>special</tt> является исключением, она попадает в оба класса, это
будет описано ниже.) Те, которые касаются связываний переменных,
применяются только к связываниям, созданным в форме, в которой они
используются. Например, в <div class="lisp"><div class="tabbing">
(defun foo (x)
   <br>                    (declare (type ﬂoat x)) ...<br>                    (let ((x &#x2019;a)) ...)<br>
  ...)<br>
<!--l. 1172--><p class="noindent" ></div>
<!--l. 1172--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8370009.1" id="x65-8370009.1"></a></span>
<!--l. 1172--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8380009.1" id="x65-8380009.1"></a></span>
</div>
<!--l. 1173--><p class="indent" >   декларация <tt>type</tt> применяется только для внешнего связывания <tt>x</tt>, а не
для связывания, созданного в <tt><a 
href="clmli7.html#x196-3479524r524">let</a></tt>.
<!--l. 1176--><p class="indent" >   Декларации, которые не воздействуют на связывания переменных,
воздействуют на весь код тела в специальной форме. Например, <div class="lisp"><div class="tabbing">
(defun foo (x y) (declare (notinline ﬂoor)) ...)
   <br>
<!--l. 1181--><p class="noindent" ></div>
<!--l. 1181--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8390009.1" id="x65-8390009.1"></a></span>
                                                                          

                                                                          
<!--l. 1181--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8400009.1" id="x65-8400009.1"></a></span>
</div>
<!--l. 1182--><p class="indent" >   рекомендует, что везде внутри тела функции <tt>foo</tt>, <tt><a 
href="clmli7.html#x196-3479419r419">floor</a></tt> должна быть
вызвана как отдельная подпрограмма, а не встроена в код.
<!--l. 1185--><p class="indent" >   Некоторые специальные формы содержат части кода, которые,
правильнее говоря, на являются телом этой формы. Это например код
инициализации переменных и форма результата для циклов. Во всех
случаях, такой дополнительный код оказывается под воздействием
всеобъемлемых деклараций, которые указаны перед телом специальной
формы. Невсеобъемлемые декларации не оказывают воздействия на этот код,
за исключением (конечно) ситуаций, когда код находится в области
действия переменной, для которой использовалась декларация. Например:
<div class="lisp"><div class="tabbing">
(defun few (x <tt>&#x0026;optional</tt> (y *print-circle*))
   <br>                                                    (declare (special *print-circle*))<br>
  ...)<br>
<!--l. 1198--><p class="noindent" ></div>
<!--l. 1198--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8410009.1" id="x65-8410009.1"></a></span>
<!--l. 1198--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8420009.1" id="x65-8420009.1"></a></span>
</div>
<!--l. 1199--><p class="indent" >   Ссылка на <tt><a 
href="clmli7.html#x196-3479027r27">*print-circle*</a></tt> в первой строке примера является
специальной, так как указана соответствующая декларация. <div class="lisp"><div class="tabbing">
(defun nonsense (k x z)
   <br>                                 (foo z x)               ;Первый вызов <tt>foo</tt><br>
  (let ((j (foo k x))     ;Второй вызов <tt>foo</tt><br>
        (x (* k k)))<br>                    (declare (inline foo) (special x z))<br>
    (foo x j z)))         ;Третий вызов <tt>foo</tt><br>
<!--l. 1208--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 1208--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8430009.1" id="x65-8430009.1"></a></span>
<!--l. 1208--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8440009.1" id="x65-8440009.1"></a></span>
</div>
<!--l. 1209--><p class="indent" >   В этом примере, декларация <tt>inline</tt> применяется только ко второму и
третьему вызову <tt>foo</tt>. Декларация <tt>special</tt> для переменной <tt>x</tt> указывает, что
форма <tt><a 
href="clmli7.html#x196-3479524r524">let</a></tt> создаст специальное связывание для <tt>x</tt> и тем самым ссылки
в теле формы также будут специальными. Ссылка на <tt>x</tt> во втором
вызове <tt>foo</tt> является специальной. Ссылка на <tt>x</tt> в первом вызове <tt>foo</tt>
является локальной, а не специальной. Декларация <tt>special</tt> для <tt>z</tt>
указывает на то, что ссылка в вызове <tt>foo</tt> будет специальной. Это значит
ссылка не будет указывать на параметр функции <tt>nonsense</tt>, так как для
параметра декларации <tt>special</tt> не указано. (Декларация <tt>special</tt>
переменной <tt>z</tt> указывается не в теле <tt><a 
href="clmli7.html#x196-3479320r320">defun</a></tt>, а в теле внутренней конструкции
<tt><a 
href="clmli7.html#x196-3479524r524">let</a></tt>. Таким образом она не воздействует на связывание параметра
функции.) <div class="new"> X3J13 voted in January 1989 <a 
 id="dx65-844001"></a>to replace the rules concerning
the scope of declarations occurring at the head of a special operator or
lambda-expression:
      <ul class="itemize1">
      <li class="itemize">The scope of a declaration always includes the body forms, as well as
      any “stepper” or “result” forms (which are logically part of the body),
      of the special operator or lambda-expression.
      </li>
      <li class="itemize">If the declaration applies to a name binding, then the scope of the
      declaration also includes the scope of the name binding.</li></ul>
<!--l. 1236--><p class="noindent" >Note that the distinction between pervasive and non-pervasive declarations is
eliminated. An important change from the ﬁrst edition is that “initialization”
forms are speciﬁcally <i>not</i> included as part of the body under the ﬁrst rule; on the
other hand, in many cases initialization forms may fall within the scope of certain
declarations under the second rule.
</div>
<div class="new">
<!--l. 1246--><p class="indent" >   X3J13 also voted in January 1989 <a 
 id="dx65-844002"></a>to change the interpretation of <tt>type</tt>
declarations (see section <a 
href="clmse52.html#x66-8760009.2">9.2<!--tex4ht:ref: DECLARATION-SPECIFIERS-SECTION --></a>).
</div>
                                                                          

                                                                          
<div class="new">
<!--l. 1253--><p class="indent" >   These changes aﬀect the interpretation of some of the examples from the ﬁrst
edition. <div class="lisp"><div class="tabbing">
(defun foo (x)
   <br>                    (declare (type ﬂoat x)) ...<br>                    (let ((x &#x2019;a)) ...)<br>
  ...)<br>
<!--l. 1260--><p class="noindent" ></div>
<!--l. 1260--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8450009.1" id="x65-8450009.1"></a></span>
<!--l. 1260--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8460009.1" id="x65-8460009.1"></a></span>
</div>
<!--l. 1261--><p class="indent" >   Under the interpretation approved by X3J13, the type declaration applies to
<i>both</i> bindings of <tt>x</tt>. More accurately, the type declaration is considered to apply to
variable references rather than bindings, and the type declaration refers to every
reference in the body of <tt>foo</tt> to a variable named <tt>x</tt>, no matter to what binding it
may refer. <div class="lisp"><div class="tabbing">
(defun foo (x y) (declare (notinline ﬂoor)) ...)
   <br>
<!--l. 1269--><p class="noindent" ></div>
<!--l. 1269--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8470009.1" id="x65-8470009.1"></a></span>
<!--l. 1269--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8480009.1" id="x65-8480009.1"></a></span>
</div>
<!--l. 1270--><p class="indent" >   This example of the use of <tt>notinline</tt> stands unchanged, but the following
slight extension of it would change: <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(defun foo (x &#x0026;optional (y (ﬂoor x)))
   <br>                                                        (declare (notinline ﬂoor)) ...)<br>
<!--l. 1275--><p class="noindent" ></div>
<!--l. 1275--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8490009.1" id="x65-8490009.1"></a></span>
<!--l. 1275--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8500009.1" id="x65-8500009.1"></a></span>
</div>
<!--l. 1276--><p class="indent" >   Under ﬁrst edition rules, the <tt>notinline</tt> declaration would be considered
to apply to the call to <tt><a 
href="clmli7.html#x196-3479419r419">floor</a></tt> in the initialization form for <tt>y</tt>. Under the
interpretation approved by X3J13, the <tt>notinline</tt> would <i>not</i> apply to
that particular call to <tt><a 
href="clmli7.html#x196-3479419r419">floor</a></tt>. Instead the user must write something like
<div class="lisp"><div class="tabbing">
(defun foo (x &#x0026;optional (y (locally (declare (notinline ﬂoor))
   <br>                                                            (ﬂoor x))))<br>
  (declare (notinline ﬂoor)) ...)<br>
<!--l. 1285--><p class="noindent" ></div>
<!--l. 1285--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8510009.1" id="x65-8510009.1"></a></span>
<!--l. 1285--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8520009.1" id="x65-8520009.1"></a></span>
</div>
<!--l. 1286--><p class="indent" >   or perhaps <div class="lisp"><div class="tabbing">
(locally (declare (notinline ﬂoor))
   <br>                                       (defun foo (x &#x0026;optional (y (ﬂoor x))) ...))<br>
<!--l. 1290--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 1290--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8530009.1" id="x65-8530009.1"></a></span>
<!--l. 1290--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8540009.1" id="x65-8540009.1"></a></span>
</div>
<!--l. 1291--><p class="indent" >   Similarly, the <tt>special</tt> declaration in <div class="lisp"><div class="tabbing">
(defun few (x <tt>&#x0026;optional</tt> (y *print-circle*))
   <br>                                                    (declare (special *print-circle*))<br>
  ...)<br>
<!--l. 1296--><p class="noindent" ></div>
<!--l. 1296--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8550009.1" id="x65-8550009.1"></a></span>
<!--l. 1296--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8560009.1" id="x65-8560009.1"></a></span>
</div>
<!--l. 1297--><p class="indent" >   is not considered to apply to the reference in the initialization form for <tt>y</tt> in
<tt>few</tt>. As for the <tt>nonsense</tt> example, <div class="lisp"><div class="tabbing">
(defun nonsense (k x z)
   <br>                                     (foo z x)               ;First call to <tt>foo</tt><br>
  (let ((j (foo k x))     ;Second call to <tt>foo</tt><br>
        (x (* k k)))<br>                    (declare (inline foo) (special x z))<br>
    (foo x j z)))         ;Third call to <tt>foo</tt><br>
<!--l. 1306--><p class="noindent" ></div>
<!--l. 1306--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8570009.1" id="x65-8570009.1"></a></span>
                                                                          

                                                                          
<!--l. 1306--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8580009.1" id="x65-8580009.1"></a></span>
</div>
<!--l. 1307--><p class="indent" >   under the interpretation approved by X3J13, the <tt>inline</tt> declaration is no
longer considered to apply to the second call to <tt>foo</tt>, because it is in an
initialization form, which is no longer considered in the scope of the declaration.
Similarly, the reference to <tt>x</tt> in that second call to <tt>foo</tt> is no longer taken to
be a special reference, but a local reference to the second parameter of
<tt>nonsense</tt>.
</div>
</div>
<tt>
<!--l. 1317--><p class="indent" >   <a 
href="clmli7.html#x196-3479537r537">locally</a></tt> выполняет формы <i>form</i> как неявный <tt><a 
href="clmli7.html#x196-3479745r745">progn</a></tt> и возвращает одно
или несколько значений последней формы.
<div class="defspec">
<div class="defmacheader">
<!--l. 1321--><p class="indent" >   <div class="tabbing">
 <i>[Специальный оператор]</i><b> locally </b> <a 
 id="dx65-858001"></a><a 
 id="x65-858002r141"></a> {declaration}* {form}*
   <br>
<!--l. 1322--><p class="noindent" ></div>
<!--l. 1322--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8590009.1" id="x65-8590009.1"></a></span>
</div>
<!--l. 1323--><p class="indent" >   Когда оператор <tt><a 
href="clmli7.html#x196-3479537r537">locally</a></tt> используется на верхнем уровне, тогда формы в
его теле выполняются как формы верхнего уровня. Это означает что,
например, <tt><a 
href="clmli7.html#x196-3479537r537">locally</a></tt> можно использовать для оборачивания деклараций вокруг
форм <tt><a 
href="clmli7.html#x196-3479320r320">defun</a></tt> или <tt><a 
href="clmli7.html#x196-3479313r313">defmacro</a></tt>. <div class="lisp"><div class="tabbing">
(locally
   <br>               (declare (optimize (safety 3) (space 3) (debug 3) (speed 1)))<br>
  (defun foo (x &#x0026;optional (y (abs x)) (z (sqrt y)))<br>            (bar x y z)))<br>
<!--l. 1332--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 1332--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8600009.1" id="x65-8600009.1"></a></span>
<!--l. 1332--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8610009.1" id="x65-8610009.1"></a></span>
</div>
<!--l. 1333--><p class="indent" >   Без уверенности, что это работает, можно записать что-то вроде этого:
<div class="lisp"><div class="tabbing">
   <br>                                                  (defun foo (x &#x0026;optional (y (locally<br>
                              (declare (optimize (safety 3)<br>
                                                 (space 3)<br>
                                                 (debug 3)<br>
                                                 (speed 1)))<br>
                              (abs x)))<br>                         (z (locally<br>
                              (declare (optimize (safety 3)<br>
                                                 (space 3)<br>
                                                 (debug 3)<br>
                                                 (speed 1)))<br>
                              (sqrt y))))<br>                     (locally<br>
    (declare (optimize (safety 3) (space 3) (debug 3) (speed 1)))<br>
    (bar x y z)))<br>
<!--l. 1351--><p class="noindent" ></div>
<!--l. 1351--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8620009.1" id="x65-8620009.1"></a></span>
<!--l. 1351--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8630009.1" id="x65-8630009.1"></a></span>
</div>
</div>
<div class="defun">
<!--l. 1354--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx65-863001"></a><a 
 id="x65-863002r142"></a><b> proclaim</b>  <i>decl-spec</i>
</div>
                                                                          

                                                                          
<!--l. 1356--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8640009.1" id="x65-8640009.1"></a></span>
   Функция <tt><a 
href="clmli7.html#x196-3479739r739">proclaim</a></tt> в качестве аргумента принимает <i>decl-spec</i>, и
применяет указания в глобальном пространстве. (Такие глобальные
декларации называются <i>прокламации</i>.) Так как <tt><a 
href="clmli7.html#x196-3479739r739">proclaim</a></tt> является
функцией, то её аргумент вычисляется всегда. Это позволяет программам
вычислять декларацию и затем для применения помещать её в вызов
<tt><a 
href="clmli7.html#x196-3479739r739">proclaim</a></tt>.
<!--l. 1364--><p class="indent" >   Любые упоминаемые имена переменных указывают на значения
динамических переменных. Например, выполненная прокламация
<div class="lisp"><div class="tabbing">
(proclaim &#x2019;(type ﬂoat tolerance))
   <br>
<!--l. 1368--><p class="noindent" ></div>
<!--l. 1368--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8650009.1" id="x65-8650009.1"></a></span>
<!--l. 1368--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8660009.1" id="x65-8660009.1"></a></span>
</div>
<!--l. 1369--><p class="indent" >   указывает на то, что динамическое значение <tt>tolerance</tt> должно
быть всегда числом с плавающей точкой. Подобным образом, любые
упоминаемые имена функций указывают на глобальные определения
функций.
<!--l. 1374--><p class="indent" >   Прокламации содержат универсальные декларации, которые всегда
действуют, кроме случаев сокрытия их локальными декларациями.
Например, <div class="lisp"><div class="tabbing">
(proclaim &#x2019;(inline ﬂoor))
   <br>
<!--l. 1378--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 1378--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8670009.1" id="x65-8670009.1"></a></span>
<!--l. 1378--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8680009.1" id="x65-8680009.1"></a></span>
</div>
<!--l. 1379--><p class="indent" >   рекомендует то, что <tt><a 
href="clmli7.html#x196-3479419r419">floor</a></tt> должна быть встроена в места её вызова. Но в
ситуации <div class="lisp"><div class="tabbing">
(defun foo (x y) (declare (notinline ﬂoor)) ...)
   <br>
<!--l. 1383--><p class="noindent" ></div>
<!--l. 1383--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8690009.1" id="x65-8690009.1"></a></span>
<!--l. 1383--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8700009.1" id="x65-8700009.1"></a></span>
</div>
<tt>
<!--l. 1384--><p class="indent" >   <a 
href="clmli7.html#x196-3479419r419">floor</a></tt> будет вызываться как отдельная функция, так как локальная
декларация скрыла прокламацию.
<div class="newer">
<!--l. 1388--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx65-870001"></a>to clarify that such shadowing does not occur in
the case of type declarations. If there is a local type declaration for a special
variable and there is also a global proclamation for that same variable, then the
value of the variable within the scope of the local declaration must be a member
of the intersection of the two declared types. This is consistent with the treatment
of nested local type declarations on which X3J13 also voted in January 1989
<a 
 id="dx65-870002"></a>.
</div>
<!--l. 1398--><p class="indent" >   Специальный случай, когда <tt><a 
href="clmli7.html#x196-3479739r739">proclaim</a></tt> обрабатывает <tt>special</tt>, то <i>decl-spec</i>
применяется ко всем связываниям и ссылкам на упомянутую переменную.
Например, после <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(proclaim &#x2019;(special x))
   <br>
<!--l. 1404--><p class="noindent" ></div>
<!--l. 1404--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8710009.1" id="x65-8710009.1"></a></span>
<!--l. 1404--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8720009.1" id="x65-8720009.1"></a></span>
</div>
<!--l. 1405--><p class="indent" >   в определении функции <div class="lisp"><div class="tabbing">
(defun example (x) ...)
   <br>
<!--l. 1408--><p class="noindent" ></div>
<!--l. 1408--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8730009.1" id="x65-8730009.1"></a></span>
<!--l. 1408--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8740009.1" id="x65-8740009.1"></a></span>
</div>
<!--l. 1409--><p class="indent" >   параметр <tt>x</tt> будет связан, как специальная (динамическая) переменная, а
не лексическая (статическая). Такой приём должен использоваться
аккуратно. Обычный способ определить глобальную специальную
переменную это использовать <tt><a 
href="clmli7.html#x196-3479321r321">defvar</a></tt> или <tt><a 
href="clmli7.html#x196-3479316r316">defparameter</a></tt>.
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 1416--><p class="indent" >   <div class="tabbing">
 <i>[Макрос]</i><b> declaim </b> <a 
 id="dx65-874001"></a><a 
 id="x65-874002r143"></a> {decl-spec}*
   <br>
<!--l. 1417--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 1417--><p class="noindent" ><span class="paragraphHead"><a 
href="#x65-8750009.1" id="x65-8750009.1"></a></span>
</div>
<!--l. 1418--><p class="indent" >   Этот макрос синтаксически похож на <tt><a 
href="clmli7.html#x196-3479300r300">declare</a></tt> и семантически на
<tt><a 
href="clmli7.html#x196-3479739r739">proclaim</a></tt>. Это выполняемая форма и она может использоваться везде, где
может <tt><a 
href="clmli7.html#x196-3479739r739">proclaim</a></tt>. Однако, формы <i>decl-spec</i> не вычисляются.
<!--l. 1422--><p class="indent" >   Если вызов этого макроса произошёл на верхнем уровне в файле,
обрабатываемом компилятором, то прокламации также будут выполнены во
время компиляции. As with other deﬁning macros, it is unspeciﬁed whether or
not the compile-time side eﬀects of a <tt><a 
href="clmli7.html#x196-3479298r298">declaim</a></tt> persist after the ﬁle has been
compiled (see section <a 
href="clmse121.html#x150-237500024.1">24.1<!--tex4ht:ref: COMPILER-SECTION --></a>). FIXME
</div>
                                                                          

                                                                          
<!--l. 1430--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse52.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#tailclmch9.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse51.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#clmse51.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse51.html"></a>  </div> </div> 
</body></html> 
