<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Declaration Syntax Синтаксис декларации</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-10 00:01:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
                                                                          

                                                                          
   <!--l. 41--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse52.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#tailclmch9.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse51.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#clmse51.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">9.1   </span> <a 
 id="x65-1670009.1"></a>Declaration Syntax Синтаксис декларации</h3>
<!--l. 44--><p class="noindent" >The <a 
href="#x65-167003r153">declare</a> construct is used for embedding declarations within executable code.
Global declarations and declarations that are computed by a program are
established by the <a 
href="#x65-170002r156">proclaim</a> construct.
<!--l. 48--><p class="indent" >   Конструкция <a 
href="#x65-167003r153">declare</a> используется для встраивания деклараций внутрь
выполняемого кода. Глобальные декларации и декларации, вычисленные
программой, устанавливаются конструкцией <a 
href="#x65-170002r156">proclaim</a>.
<div class=newer>
<!--l. 53--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx65-167001"></a>to introduce the new macro <a 
href="#x65-170007r157">declaim</a>, which is
guaranteed to be recognized appropriately by the compiler and is often more
convenient than <a 
href="#x65-170002r156">proclaim</a> for establishing global declarations.
<!--l. 58--><p class="indent" >   Добавлен новый макрос <a 
href="#x65-170007r157">declaim</a>, который гарантированно распознается
компилятором, и часто более удобен, чем <a 
href="#x65-170002r156">proclaim</a> для установки глобальных
деклараций. FIXME
</div>
<div class=defspec>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> declare </b><a 
 id="dx65-167002"></a><a 
 id="x65-167003r153"></a> {decl-spec}*
</td></tr></table>
<!--l. 65--><p class="indent" >
</div>
<!--l. 65--><p class="noindent" ><span class="paragraphHead"><a 
 id="x65-1680009.1"></a></span>
   A <a 
href="#x65-167003r153">declare</a> form is known as a <i>declaration</i>. Declarations may occur only at the
beginning of the bodies of certain special forms; that is, a declaration may occur
only as a statement of such a special form, and all statements preceding it (if any)
must also be <a 
href="#x65-167003r153">declare</a> forms (or possibly documentation strings, in some cases).
Declarations may occur in lambda-expressions and in the forms listed here. <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse36.html#x48-99005r72">deﬁne-setf-method</a>             </td><td  
class="tabbing"><a 
href="clmse39.html#x51-114008r94">labels</a>
</td></tr></table>
                                                                          

                                                                          
<!--l. 75--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse46.html#x59-157007r137">defmacro</a>                         </td><td  
class="tabbing"><a 
href="clmse39.html#x51-107003r84">let</a></td></tr></table>
<!--l. 76--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse36.html#x48-98003r71">defsetf</a>                            </td><td  
class="tabbing"><a 
href="clmse39.html#x51-109003r86">let*</a></td></tr></table>
<!--l. 77--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse24.html#x33-53002r6">deftype</a>                           </td><td  
class="tabbing"><a 
href="#x65-169004r155">locally</a></td></tr></table>
<!--l. 78--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse30.html#x40-69002r13">defun</a>                              </td><td  
class="tabbing"><a 
href="clmse39.html#x51-114010r95">macrolet</a></td></tr></table>
<!--l. 79--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse142.html#x173-366002r881">do</a>                                  </td><td  
class="tabbing"><a 
href="clmse44.html#x56-147002r129">multiple-value-bind</a></td></tr></table>
<!--l. 80--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse42.html#x54-132005r110">do*</a>                                </td><td  
class="tabbing"><a 
href="clmse42.html#x54-139002r120">prog</a></td></tr></table>
<!--l. 81--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse63.html#x79-191005r200">do-all-symbols</a>                  </td><td  
class="tabbing"><a 
href="clmse42.html#x54-139004r121">prog*</a></td></tr></table>
<!--l. 82--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse63.html#x79-190005r199">do-external-symbols</a>           </td><td  
class="tabbing"><a 
href="clmse113.html#x139-266003r653">with-input-from-string</a></td></tr></table>
<!--l. 83--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse63.html#x79-189005r198">do-symbols</a>                      </td><td  
class="tabbing"><a 
href="clmse120.html#x148-302012r769">with-open-ﬁle</a></td></tr></table>
<!--l. 84--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse42.html#x54-134002r111">dolist</a>                              </td><td  
class="tabbing"><a 
href="clmse113.html#x139-265029r652">with-open-stream</a></td></tr></table>
<!--l. 85--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse42.html#x54-135003r112">dotimes</a>                           </td><td  
class="tabbing"><a 
href="clmse113.html#x139-268003r655">with-output-to-string</a></td></tr></table>
<!--l. 86--><p class="indent" >                                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><a 
href="clmse39.html#x51-114006r93">ﬂet</a></td></tr></table>
<!--l. 88--><p class="indent" >
</div>
</div>
<div class=new>
<i>
<!--l. 90--><p class="noindent" >Notice of correction.</i> In the ﬁrst edition, the above list failed to mention the forms
<a 
href="clmse36.html#x48-99005r72">deﬁne-setf-method</a>, <a 
href="clmse113.html#x139-266003r653">with-input-from-string</a>, <a 
href="clmse120.html#x148-302012r769">with-open-ﬁle</a>, <a 
href="clmse113.html#x139-265029r652">with-open-stream</a>, and
<a 
href="clmse113.html#x139-268003r655">with-output-to-string</a>, even though their individual descriptions in the ﬁrst edition
speciﬁed that declarations may appear in those forms.
</div>
<!--l. 98--><p class="indent" >   Форма <a 
href="#x65-167003r153">declare</a> известна как <i>декларация</i>. Декларации могут использоваться
только в начале тел соотвествующих специальных форм. То есть декларация
может использоваться в этой специальной форме, как выражение, и все
предыдущие выражение (если есть) также должны быть формами <a 
href="#x65-167003r153">declare</a>
(или, в некоторых случаях, строками документации). Декларации могут
использоваться в лямбда-выражениях и нижеперечисленных формах. <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse36.html#x48-99005r72">deﬁne-setf-method</a>             </td><td  
class="tabbing"><a 
href="clmse39.html#x51-114008r94">labels</a>
</td></tr></table>
<!--l. 106--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse46.html#x59-157007r137">defmacro</a>                         </td><td  
class="tabbing"><a 
href="clmse39.html#x51-107003r84">let</a></td></tr></table>
<!--l. 107--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse36.html#x48-98003r71">defsetf</a>                            </td><td  
class="tabbing"><a 
href="clmse39.html#x51-109003r86">let*</a></td></tr></table>
<!--l. 108--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse24.html#x33-53002r6">deftype</a>                           </td><td  
class="tabbing"><a 
href="#x65-169004r155">locally</a></td></tr></table>
<!--l. 109--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse30.html#x40-69002r13">defun</a>                              </td><td  
class="tabbing"><a 
href="clmse39.html#x51-114010r95">macrolet</a></td></tr></table>
                                                                          

                                                                          
<!--l. 110--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse142.html#x173-366002r881">do</a>                                  </td><td  
class="tabbing"><a 
href="clmse44.html#x56-147002r129">multiple-value-bind</a></td></tr></table>
<!--l. 111--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse42.html#x54-132005r110">do*</a>                                </td><td  
class="tabbing"><a 
href="clmse42.html#x54-139002r120">prog</a></td></tr></table>
<!--l. 112--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse63.html#x79-191005r200">do-all-symbols</a>                  </td><td  
class="tabbing"><a 
href="clmse42.html#x54-139004r121">prog*</a></td></tr></table>
<!--l. 113--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse63.html#x79-190005r199">do-external-symbols</a>           </td><td  
class="tabbing"><a 
href="clmse113.html#x139-266003r653">with-input-from-string</a></td></tr></table>
<!--l. 114--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse63.html#x79-189005r198">do-symbols</a>                      </td><td  
class="tabbing"><a 
href="clmse120.html#x148-302012r769">with-open-ﬁle</a></td></tr></table>
<!--l. 115--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse42.html#x54-134002r111">dolist</a>                              </td><td  
class="tabbing"><a 
href="clmse113.html#x139-265029r652">with-open-stream</a></td></tr></table>
<!--l. 116--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse42.html#x54-135003r112">dotimes</a>                           </td><td  
class="tabbing"><a 
href="clmse113.html#x139-268003r655">with-output-to-string</a></td></tr></table>
<!--l. 117--><p class="indent" >                                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><a 
href="clmse39.html#x51-114006r93">ﬂet</a></td></tr></table>
<!--l. 119--><p class="indent" >
</div>
</div>
<!--l. 121--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx65-168001"></a>to add <a 
href="clmse155.html#x189-490002r1008">with-condition-restarts</a> and also <a 
 id="dx65-168002"></a>to add
<a 
href="clmse117.html#x144-284044r728">print-unreadable-object</a> and <a 
href="clmse115.html#x142-278061r695">with-standard-io-syntax</a>. The X3J13 vote left
it unclear whether these macros permit declarations to appear at the
heads of their bodies. I believe that was the intent, but this is only my
interpretation.
<div class=new>
<!--l. 130--><p class="indent" >   X3J13 voted in June 1988 <a 
 id="dx65-168003"></a>to adopt the Common Lisp Object System, which
includes the following additional forms in which declarations may occur: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse151.html#x184-438002r921">defgeneric</a>                        </td><td  
class="tabbing"><a 
href="clmse151.html#x184-442002r948">generic-function</a>
</td></tr></table>
<!--l. 137--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse151.html#x184-439005r923">deﬁne-method-combination</a> </td><td  
class="tabbing"><a 
href="clmse151.html#x184-443002r949">generic-labels</a></td></tr></table>
<!--l. 138--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse151.html#x184-440002r924">defmethod</a>                       </td><td  
class="tabbing"><a 
href="clmse151.html#x184-445004r988">with-added-methods</a></td></tr></table>
<!--l. 139--><p class="indent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><a 
href="clmse151.html#x184-441048r947">generic-ﬂet</a></td></tr></table>
<!--l. 141--><p class="indent" >
</div>
</div>
<!--l. 142--><p class="noindent" >Furthermore X3J13 voted in January 1989 <a 
 id="dx65-168004"></a>to allow declarations to occur before the
bodies of these forms: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:216;" 
class="tabbing"><a 
href="clmse39.html#x51-115002r96">symbol-macrolet</a>               </td><td  
class="tabbing"><a 
href="clmse151.html#x184-446002r989">with-slots</a>
</td></tr></table>
<!--l. 148--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><a 
href="clmse151.html#x184-444077r987">with-accessors</a></td></tr></table>
<!--l. 150--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 151--><p class="noindent" >There are certain aspects peculiar to <a 
href="clmse39.html#x51-115002r96">symbol-macrolet</a> (and therefore also to
<a 
href="clmse151.html#x184-444077r987">with-accessors</a> and <a 
href="clmse151.html#x184-446002r989">with-slots</a>, which expand into uses of <a 
href="clmse39.html#x51-115002r96">symbol-macrolet</a>). An
error is signaled if a name deﬁned by <a 
href="clmse39.html#x51-115002r96">symbol-macrolet</a> is declared special, and a
type declaration of a name deﬁned by <a 
href="clmse39.html#x51-115002r96">symbol-macrolet</a> is equivalent in eﬀect to
wrapping a <a 
href="clmse53.html#x67-173002r158">the</a> form mentioning that type around the expansion of the deﬁned
symbol.
</div>
<!--l. 161--><p class="indent" >   It is an error to attempt to evaluate a declaration. Those special forms that
permit declarations to appear perform explicit checks for their presence.
<!--l. 165--><p class="indent" >   Вычисление декларации является ошибкой. Эти специальные формы,
которые позволяют использовать декларации, явно проверяют их
наличие.
<div class=incompatibility>
<!--l. 169--><p class="noindent" ><b>Compatibility note:</b> In MacLisp, <a 
href="#x65-167003r153">declare</a> is a special form that does nothing but
return the symbol <a 
href="#x65-167003r153">declare</a> as its result. The MacLisp interpreter knows nothing about
declarations but just blindly evaluates them, eﬀectively ignoring them. The MacLisp
compiler recognizes declarations but processes them simply by evaluating the subforms
of the declaration in the compilation context. In Common Lisp it is important that
both the interpreter and compiler recognize declarations (especially special
declarations) and treat them consistently, and so the rules about the structure
and use of declarations have been made considerably more stringent. The odd
tricks played in MacLisp by writing arbitrary forms to be evaluated within a
<a 
href="#x65-167003r153">declare</a> form are better done in both MacLisp and Common Lisp by using
<a 
href="clmse30.html#x40-74003r18">eval-when</a>.
</div>
<!--l. 188--><p class="indent" >   It is permissible for a macro call to expand into a declaration and be
recognized as such, provided that the macro call appears where a declaration may
legitimately appear. (However, a macro call may not appear in place of a
<i>decl-spec</i>.)
<!--l. 193--><p class="indent" >   Макровызовы могут раскрываться в декларации, при условии, что
макровызов указан в том месте, где могут быть указаны декларации.
(Однако, макровызов не может использоваться в форме declare на месте
<i>decl-spec</i>.)
<div class=new>
<!--l. 198--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx65-168005"></a>to eliminate the recognition of a declaration
resulting from the expansion of a macro call. This feature proved to be seldom
                                                                          

                                                                          
used and awkward to implement in interpreters, compilers, and other
code-analyzing programs.
<!--l. 205--><p class="indent" >   Under this change, a declaration is recognized only as such if it appears
explicitly, as a list whose <i>car</i> is the symbol <a 
href="#x65-167003r153">declare</a>, in the body of a relevant
special form. (Note, however, that it is still possible for a macro to expand into a
call to the <a 
href="#x65-170002r156">proclaim</a> function.)
</div>
<!--l. 212--><p class="indent" >   Each <i>decl-spec</i> is a list whose <i>car</i> is a symbol specifying the kind of declaration
to be made. Declarations may be divided into two classes: those that concern the
bindings of variables, and those that do not. (The special declaration is the
sole exception: it eﬀectively falls into both classes, as explained below.)
Those that concern variable bindings apply only to the bindings made
by the form at the head of whose body they appear. For example, in <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x)
</td></tr></table>
<!--l. 221--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (type ﬂoat x)) ...</td></tr></table>
<!--l. 222--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((x &#x2019;a)) ...)</td></tr></table>
<!--l. 223--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 225--><p class="indent" >
</div>
</div>
<!--l. 226--><p class="noindent" >the type declaration applies only to the outer binding of x, and not to the binding
made in the <a 
href="clmse39.html#x51-107003r84">let</a>.
<!--l. 229--><p class="indent" >   Каждая форма <i>decl-spec</i> является списком, у которого <i>car</i> элемент это
символ, указывающий на тип декларации. Декларации могут быть разделены
на два класса: одни относятся к связыванию переменных, другие нет.
(Декларация special является исключением, она попадает в оба класса, это
будет описано ниже.) Те, которые касаются связываний переменных,
применяются только к связываниям, созданным в форме, в которой они
используются. Например, в <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x)
</td></tr></table>
<!--l. 237--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (type ﬂoat x)) ...</td></tr></table>
                                                                          

                                                                          
<!--l. 238--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((x &#x2019;a)) ...)</td></tr></table>
<!--l. 239--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 241--><p class="indent" >
</div>
</div>
<!--l. 242--><p class="noindent" >декларация type применяется только для внешнего связывания x, а не для
связывания, созданного в <a 
href="clmse39.html#x51-107003r84">let</a>.
<div class=incompatibility>
<!--l. 246--><p class="noindent" ><b>Compatibility note:</b> This represents a diﬀerence from MacLisp, in which type
declarations are pervasive.
</div>
<!--l. 252--><p class="indent" >   Declarations that do not concern themselves with variable bindings are
pervasive, aﬀecting all code in the body of the special form. As an example of a
pervasive declaration, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x y) (declare (notinline ﬂoor)) ...)
</td></tr></table>
<!--l. 257--><p class="indent" >
</div>
</div>
<!--l. 258--><p class="noindent" >advises that everywhere within the body of foo the function <a 
href="clmse71.html#x88-206012r256">ﬂoor</a> should not be
open-coded but called as an out-of-line subroutine.
<!--l. 261--><p class="indent" >   Декларации, которые не воздействуют на связывания переменных,
воздействуют на весь код тела в специальной форме. Например, <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x y) (declare (notinline ﬂoor)) ...)
</td></tr></table>
<!--l. 266--><p class="indent" >
</div>
</div>
<!--l. 267--><p class="noindent" >рекомендует, что везде внутри тела функции foo, <a 
href="clmse71.html#x88-206012r256">ﬂoor</a> должна быть вызвана как
отдельная подпрограмма, а не встроена в код.
                                                                          

                                                                          
<!--l. 270--><p class="indent" >   Some special forms contain pieces of code that, properly speaking, are not part
of the body of the special form. Examples of this are initialization forms
that provide values for bound variables, and the result forms of iteration
constructs. In all cases such additional code is within the scope of any
pervasive declarations appearing before the body of the special form.
Non-pervasive declarations have no eﬀect on such code, except (of course)
in those situations where the code is deﬁned to be within the scope of
the variables aﬀected by such non-pervasive declarations. For example: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun few (x &#x0026;optional (y *print-circle*))
</td></tr></table>
<!--l. 281--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (special *print-circle*))</td></tr></table>
<!--l. 282--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 284--><p class="indent" >
</div>
</div>
<!--l. 285--><p class="noindent" >The reference to *print-circle* in the ﬁrst line of this example is special because of
the declaration in the second line. <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun nonsense (k x z)
</td></tr></table>
<!--l. 288--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (foo z x)               ;First call to foo</td></tr></table>
<!--l. 289--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((j (foo k x))     ;Second call to foo</td></tr></table>
<!--l. 290--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (x (* k k)))</td></tr></table>
<!--l. 291--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (declare (inline foo) (special x z))</td></tr></table>
<!--l. 292--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (foo x j z)))         ;Third call to foo</td></tr></table>
<!--l. 294--><p class="indent" >
</div>
</div>
<!--l. 295--><p class="noindent" >In this rather nonsensical example, the inline declaration applies to the second
and third calls to foo, but not to the ﬁrst one. The special declaration
of x causes the <a 
href="clmse39.html#x51-107003r84">let</a> form to make a special binding for x and causes the
reference to x in the body of the <a 
href="clmse39.html#x51-107003r84">let</a> to be a special reference. The reference
to x in the second call to foo is also a special reference. The reference
                                                                          

                                                                          
to x in the ﬁrst call to foo is a local reference, not a special one. The
special declaration of z causes the reference to z in the call to foo to be a
special reference; it will not refer to the parameter to nonsense named z,
because that parameter binding has not been declared to be special. (The
special declaration of z does not appear in the body of the <a 
href="clmse30.html#x40-69002r13">defun</a>, but
in an inner construct, and therefore does not aﬀect the binding of the
parameter.)
<!--l. 313--><p class="indent" >   Некоторые специальные формы содержат части кода, которые,
правильнее говоря, на являются телом этой формы. Это например код
инициализации перменных и форма результата для циклов. Во всех
случаях, такой дополнительный код оказывается под воздействием
всеобъемлемых деклараций, которые указаны перед телом специальной
формы. Невсеобъемлемые декларации не оказывают воздействия на этот код,
за исключением (конечно) ситуаций, когда код находится в области действия
переменной, для которой использовалась декларация. Например: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun few (x &#x0026;optional (y *print-circle*))
</td></tr></table>
<!--l. 323--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (special *print-circle*))</td></tr></table>
<!--l. 324--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 326--><p class="indent" >
</div>
</div>
<!--l. 327--><p class="noindent" >Ссылка на *print-circle* в первой строке примера является специальной, так как
указана соответствующая декларация. <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun nonsense (k x z)
</td></tr></table>
<!--l. 330--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (foo z x)               ;Первый вызов foo</td></tr></table>
<!--l. 331--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((j (foo k x))     ;Второй вызов foo</td></tr></table>
<!--l. 332--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (x (* k k)))</td></tr></table>
<!--l. 333--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (declare (inline foo) (special x z))</td></tr></table>
<!--l. 334--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (foo x j z)))         ;Третий вызов foo</td></tr></table>
<!--l. 336--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 337--><p class="noindent" >В этом примере, декларация inline применяется только ко второму и
третьему вызову foo. Декларация special для переменной x указывает,
что форма <a 
href="clmse39.html#x51-107003r84">let</a> создаст специальное связывание для x и тем самым
ссылки в теле формы также будут специальными. Ссылка на x во
втором вызове foo является специальной. Ссылка на x в первом вызове
foo является локальной, а не специальной. Декларация special для z
указывает на то, что ссылка в вызове foo будет специальной. Это значит
ссылка не будет указывать на параметр функции nonsense, так как
для параметра декларации special не указано. (Декларация special
переменной z указывается не в теле <a 
href="clmse30.html#x40-69002r13">defun</a>, а в теле внутренней конструкции
<a 
href="clmse39.html#x51-107003r84">let</a>. Таким образом она не воздействует на связывание параметра
функции.)
<div class=new>
<!--l. 354--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx65-168006"></a>to replace the rules concerning the scope of
declarations occurring at the head of a special form or lambda-expression:
      <ul class="itemize1">
      <li class="itemize">The scope of a declaration always includes the body forms, as well as
      any “stepper” or “result” forms (which are logically part of the body),
      of the special form or lambda-expression.
      </li>
      <li class="itemize">If the declaration applies to a name binding, then the scope of the
      declaration also includes the scope of the name binding.</li></ul>
<!--l. 366--><p class="noindent" >Note that the distinction between pervasive and non-pervasive declarations is
eliminated. An important change from the ﬁrst edition is that “initialization”
forms are speciﬁcally <i>not</i> included as part of the body under the ﬁrst rule; on the
other hand, in many cases initialization forms may fall within the scope of certain
declarations under the second rule.
</div>
<div class=new>
<!--l. 376--><p class="indent" >   X3J13 also voted in January 1989 <a 
 id="dx65-168007"></a>to change the interpretation of type
declarations (see section <a 
href="clmse52.html#x66-1720009.2">9.2<!--tex4ht:ref: DECLARATION-SPECIFIERS-SECTION --></a>).
</div>
<div class=new>
                                                                          

                                                                          
<!--l. 383--><p class="indent" >   These changes aﬀect the interpretation of some of the examples from the ﬁrst
edition. <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x)
</td></tr></table>
<!--l. 386--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (type ﬂoat x)) ...</td></tr></table>
<!--l. 387--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((x &#x2019;a)) ...)</td></tr></table>
<!--l. 388--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 390--><p class="indent" >
</div>
</div>
<!--l. 391--><p class="noindent" >Under the interpretation approved by X3J13, the type declaration applies to <i>both</i>
bindings of x. More accurately, the type declaration is considered to apply to
variable references rather than bindings, and the type declaration refers to every
reference in the body of foo to a variable named x, no matter to what binding it
may refer. <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x y) (declare (notinline ﬂoor)) ...)
</td></tr></table>
<!--l. 399--><p class="indent" >
</div>
</div>
<!--l. 400--><p class="noindent" >This example of the use of notinline stands unchanged, but the following slight
extension of it would change: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x &#x0026;optional (y (ﬂoor x)))
</td></tr></table>
<!--l. 403--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (notinline ﬂoor)) ...)</td></tr></table>
<!--l. 405--><p class="indent" >
</div>
</div>
<!--l. 406--><p class="noindent" >Under ﬁrst edition rules, the notinline declaration would be considered to apply to
the call to <a 
href="clmse71.html#x88-206012r256">ﬂoor</a> in the initialization form for y. Under the interpretation approved
by X3J13, the notinline would <i>not</i> apply to that particular call to <a 
href="clmse71.html#x88-206012r256">ﬂoor</a>. Instead
the user must write something like <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x &#x0026;optional (y (locally (declare (notinline ﬂoor))
</td></tr></table>
<!--l. 412--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                    (ﬂoor x))))</td></tr></table>
<!--l. 413--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (notinline ﬂoor)) ...)</td></tr></table>
<!--l. 415--><p class="indent" >
</div>
</div>
<!--l. 416--><p class="noindent" >or perhaps <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(locally (declare (notinline ﬂoor))
</td></tr></table>
<!--l. 418--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (defun foo (x &#x0026;optional (y (ﬂoor x))) ...))</td></tr></table>
<!--l. 420--><p class="indent" >
</div>
</div>
<!--l. 421--><p class="noindent" >Similarly, the special declaration in <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun few (x &#x0026;optional (y *print-circle*))
</td></tr></table>
<!--l. 423--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (special *print-circle*))</td></tr></table>
<!--l. 424--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 426--><p class="indent" >
</div>
</div>
<!--l. 427--><p class="noindent" >is not considered to apply to the reference in the initialization form for y in few. As
for the nonsense example, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun nonsense (k x z)
</td></tr></table>
<!--l. 430--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (foo z x)               ;First call to foo</td></tr></table>
<!--l. 431--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((j (foo k x))     ;Second call to foo</td></tr></table>
<!--l. 432--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (x (* k k)))</td></tr></table>
<!--l. 433--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (declare (inline foo) (special x z))</td></tr></table>
                                                                          

                                                                          
<!--l. 434--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (foo x j z)))         ;Third call to foo</td></tr></table>
<!--l. 436--><p class="indent" >
</div>
</div>
<!--l. 437--><p class="noindent" >under the interpretation approved by X3J13, the inline declaration is no
longer considered to apply to the second call to foo, because it is in an
initialization form, which is no longer considered in the scope of the declaration.
Similarly, the reference to x in that second call to foo is no longer taken to
be a special reference, but a local reference to the second parameter of
nonsense.
</div>
</div>
<div class=obsolete>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> locally </b><a 
 id="dx65-168008"></a><a 
 id="x65-168009r154"></a> {declaration}*  { form}*
</td></tr></table>
<!--l. 450--><p class="indent" >
</div>
<!--l. 450--><p class="noindent" ><span class="paragraphHead"><a 
 id="x65-1690009.1"></a></span>
   This macro may be used to make local pervasive declarations where desired. It
does not bind any variables and therefore cannot be used meaningfully for
declarations of variable bindings. (Note that the special declaration may be used
with <a 
href="#x65-169004r155">locally</a> to pervasively aﬀect references to, rather than bindings of, variables.)
For example: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(locally (declare (inline ﬂoor) (notinline car cdr))
</td></tr></table>
<!--l. 458--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (declare (optimize space))</td></tr></table>
<!--l. 459--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (ﬂoor (car x) (cdr y)))</td></tr></table>
<!--l. 461--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
</div>
</div>
<div class=new>
<!--l. 466--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx65-169001"></a>to specify that <a 
href="#x65-169004r155">locally</a> executes the <i>form</i>s as an
implicit <a 
href="clmse38.html#x50-102002r80">progn</a> and returns the value(s) of the last <i>form</i>.
</div>
<div class=newer>
<!--l. 473--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx65-169002"></a>to make <a 
href="#x65-169004r155">locally</a> be a special form rather than a
macro. It still has the same syntax.
<div class=defspec>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> locally </b><a 
 id="dx65-169003"></a><a 
 id="x65-169004r155"></a> {declaration}*  { form}*
</td></tr></table>
<!--l. 478--><p class="indent" >
</div>
<!--l. 478--><p class="noindent" ><span class="paragraphHead"><a 
 id="x65-1700009.1"></a></span>
   This change was made to accommodate the new compilation model for
top-level forms in a ﬁle (see section <a 
href="clmse127.html#x157-31800025.1">25.1<!--tex4ht:ref: COMPILER-SECTION --></a>). When a <a 
href="#x65-169004r155">locally</a> form appears at top
level, the forms in its body are processed as top-level forms. This means that one
may, for example, meaningfully use <a 
href="#x65-169004r155">locally</a> to wrap declarations around a <a 
href="clmse30.html#x40-69002r13">defun</a> or
<a 
href="clmse46.html#x59-157007r137">defmacro</a> form: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(locally
</td></tr></table>
<!--l. 485--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (optimize (safety 3) (space 3) (debug 3) (speed 1)))</td></tr></table>
<!--l. 486--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (defun foo (x &#x0026;optional (y (abs x)) (z (sqrt y)))</td></tr></table>
<!--l. 487--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (bar x y z)))</td></tr></table>
<!--l. 489--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 490--><p class="noindent" >Without assurance that this works one must write something cumbersome such as <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">
</td></tr></table>
<!--l. 493--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x &#x0026;optional (y (locally</td></tr></table>
<!--l. 494--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (declare (optimize (safety 3)</td></tr></table>
<!--l. 495--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 (space 3)</td></tr></table>
<!--l. 496--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 (debug 3)</td></tr></table>
<!--l. 497--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 (speed 1)))</td></tr></table>
<!--l. 498--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (abs x)))</td></tr></table>
<!--l. 499--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         (z (locally</td></tr></table>
<!--l. 500--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (declare (optimize (safety 3)</td></tr></table>
<!--l. 501--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 (space 3)</td></tr></table>
<!--l. 502--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 (debug 3)</td></tr></table>
<!--l. 503--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                                 (speed 1)))</td></tr></table>
<!--l. 504--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (sqrt y))))</td></tr></table>
<!--l. 505--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (locally</td></tr></table>
<!--l. 506--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (declare (optimize (safety 3) (space 3) (debug 3) (speed 1)))</td></tr></table>
<!--l. 507--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (bar x y z)))</td></tr></table>
<!--l. 509--><p class="indent" >
</div>
</div>
</div>
</div>
<!--l. 513--><p class="indent" >
                                                                          

                                                                          
<div class=defun>
<!--l. 515--><p class="noindent" ><i>[Function]</i><a 
 id="dx65-170001"></a><a 
 id="x65-170002r156"></a><b> proclaim</b>  <i>decl-spec</i>
<!--l. 517--><p class="noindent" >The function <a 
href="#x65-170002r156">proclaim</a> takes a <i>decl-spec</i> as its argument and puts it into eﬀect
globally. (Such a global declaration is called a <i>proclamation</i>.) Because
<a 
href="#x65-170002r156">proclaim</a> is a function, its argument is always evaluated. This allows a
program to compute a declaration and then put it into eﬀect by calling
<a 
href="#x65-170002r156">proclaim</a>.
<!--l. 525--><p class="indent" >   Функция <a 
href="#x65-170002r156">proclaim</a> в качестве аргумета принимает <i>decl-spec</i>, и применяет
указания в глобальном пространстве. (Такие глобальные декларации
называются <i>прокламации</i>.) Так как <a 
href="#x65-170002r156">proclaim</a> является функцией, то ее
аргумент вычисляется всегда. Это позволяет программам вычислять
декларацию и затем для применения помещать ее в вызов <a 
href="#x65-170002r156">proclaim</a>.
<!--l. 532--><p class="indent" >   Any variable names mentioned are assumed to refer to the dynamic values of
the variable. For example, the proclamation <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(proclaim &#x2019;(type ﬂoat tolerance))
</td></tr></table>
<!--l. 537--><p class="indent" >
</div>
</div>
<!--l. 538--><p class="noindent" >once executed, speciﬁes that the dynamic value of tolerance should always be a
ﬂoating-point number. Similarly, any function-names mentioned are assumed to
refer to the global function deﬁnition.
<!--l. 544--><p class="indent" >   Любые упоминаемые имена переменных указывают на значения
динамических переменных. Например, выполненная прокламация <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(proclaim &#x2019;(type ﬂoat tolerance))
</td></tr></table>
<!--l. 548--><p class="indent" >
</div>
</div>
<!--l. 549--><p class="noindent" >указывает на то, что динамическое значение tolerance должно быть всегда
числом с плавающей точкой. Подобным образом, любые упоминаемые имена
функций указывают на глобальные определения функций.
                                                                          

                                                                          
<!--l. 554--><p class="indent" >   A proclamation constitutes a universal declaration, always in force unless
locally shadowed. For example, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(proclaim &#x2019;(inline ﬂoor))
</td></tr></table>
<!--l. 558--><p class="indent" >
</div>
</div>
<!--l. 559--><p class="noindent" >advises that <a 
href="clmse71.html#x88-206012r256">ﬂoor</a> should normally be open-coded in-line by the compiler (but in the
situation <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x y) (declare (notinline ﬂoor)) ...)
</td></tr></table>
<!--l. 563--><p class="indent" >
</div>
</div>
<!--l. 564--><p class="noindent" >it will be compiled out-of-line anyway in the body of foo, because of the shadowing
local declaration to that eﬀect).
<!--l. 567--><p class="indent" >   Прокламации содержат универсальные декларации, которые всегда
действуют, кроме случаев сокрытия их локальными декларациями.
Например, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(proclaim &#x2019;(inline ﬂoor))
</td></tr></table>
<!--l. 571--><p class="indent" >
</div>
</div>
<!--l. 572--><p class="noindent" >рекомендует то, что <a 
href="clmse71.html#x88-206012r256">ﬂoor</a> должна быть встроена в места ее вызова. Но в
ситуации <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun foo (x y) (declare (notinline ﬂoor)) ...)
</td></tr></table>
<!--l. 576--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 577--><p class="noindent" ><a 
href="clmse71.html#x88-206012r256">ﬂoor</a> будет вызываться как отдельная функция, так как локальная декларация
скрыла прокламацию.
<div class=newer>
<!--l. 581--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx65-170003"></a>to clarify that such shadowing does not occur in
the case of type declarations. If there is a local type declaration for a special
variable and there is also a global proclamation for that same variable, then the
value of the variable within the scope of the local declaration must be a member
of the intersection of the two declared types. This is consistent with the treatment
of nested local type declarations on which X3J13 also voted in January 1989
<a 
 id="dx65-170004"></a>.
</div>
<!--l. 591--><p class="indent" >   As a special case (so to speak), <a 
href="#x65-170002r156">proclaim</a> treats a special <i>decl-spec</i> as applying
to all bindings as well as to all references of the mentioned variables.
<div class=new><i>Notice of correction.</i> In the ﬁrst edition, this sentence referred to a “special
<i>declaration-form</i>.” That was incorrect; <a 
href="#x65-170002r156">proclaim</a> accepts only a <i>decl-spec</i>, not a
<i>declaration-form</i>.
</div>
<!--l. 601--><p class="indent" >   For example, after <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(proclaim &#x2019;(special x))
</td></tr></table>
<!--l. 604--><p class="indent" >
</div>
</div>
<!--l. 605--><p class="noindent" >in a function deﬁnition such as <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun example (x) ...)
</td></tr></table>
<!--l. 608--><p class="indent" >
</div>
</div>
<!--l. 609--><p class="noindent" >the parameter x will be bound as a special (dynamic) variable rather than as a lexical
(static) variable. This facility should be used with caution. The usual way to
deﬁne a globally special variable is with <a 
href="clmse30.html#x40-71002r14">defvar</a> or <a 
href="clmse30.html#x40-71004r15">defparameter</a>.
                                                                          

                                                                          
</div>
<!--l. 615--><p class="indent" >   Специальный случай, когда <a 
href="#x65-170002r156">proclaim</a> обрабатывает special, то <i>decl-spec</i>
применяется ко всем связываниям и ссылкам на упомянутую переменную.
Например, после <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(proclaim &#x2019;(special x))
</td></tr></table>
<!--l. 621--><p class="indent" >
</div>
</div>
<!--l. 622--><p class="noindent" >в определении функции <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun example (x) ...)
</td></tr></table>
<!--l. 625--><p class="indent" >
</div>
</div>
<!--l. 626--><p class="noindent" >параметр x будет связан, как специальная (динамическая) переменная, а не
лексическая (статическая). Такой прием должен использоваться аккуратно.
Обычный способ определить глобальную специальную переменную это
использовать <a 
href="clmse30.html#x40-71002r14">defvar</a> или <a 
href="clmse30.html#x40-71004r15">defparameter</a>.
<div class=newer>
<!--l. 632--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx65-170005"></a>to clarify that the compiler is not required to treat
calls to <a 
href="#x65-170002r156">proclaim</a> any diﬀerently from the way it treats any other function call. If a
top-level call to <a 
href="#x65-170002r156">proclaim</a> is to take eﬀect at compile time, it should be surrounded
by an appropriate <a 
href="clmse30.html#x40-74003r18">eval-when</a> form. Better yet, the new macro <a 
href="#x65-170007r157">declaim</a> may be
used instead.
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> declaim </b><a 
 id="dx65-170006"></a><a 
 id="x65-170007r157"></a> {decl-spec}*
</td></tr></table>
<!--l. 642--><p class="indent" >
</div>
                                                                          

                                                                          
<!--l. 642--><p class="noindent" ><span class="paragraphHead"><a 
 id="x65-1710009.1"></a></span>
   This macro is syntactically like <a 
href="#x65-167003r153">declare</a> and semantically like <a 
href="#x65-170002r156">proclaim</a>. It is an
executable form and may be used anywhere <a 
href="#x65-170002r156">proclaim</a> may be called. However,
each <i>decl-spec</i> is not evaluated.
<!--l. 648--><p class="indent" >   If a call to this macro appears at top level in a ﬁle being processed by the ﬁle
compiler, the proclamations are also made at compile time. As with other deﬁning
macros, it is unspeciﬁed whether or not the compile-time side eﬀects of a <a 
href="#x65-170007r157">declaim</a>
persist after the ﬁle has been compiled (see section <a 
href="clmse127.html#x157-31800025.1">25.1<!--tex4ht:ref: COMPILER-SECTION --></a>).
<!--l. 655--><p class="indent" >   Этот макрос синтаксически похож на <a 
href="#x65-167003r153">declare</a> и семантически на <a 
href="#x65-170002r156">proclaim</a>.
Это выполняемая форма и она может использоваться везде, где может
<a 
href="#x65-170002r156">proclaim</a>. Однако, формы <i>decl-spec</i> не вычисляются.
<!--l. 659--><p class="indent" >   Если вызов этого макроса произошел на верхнем уровне в файле,
обрабатываемом компилятором, то прокламации также будут выполнены во
время компиляции. As with other deﬁning macros, it is unspeciﬁed whether or
not the compile-time side eﬀects of a <a 
href="#x65-170007r157">declaim</a> persist after the ﬁle has been
compiled (see section <a 
href="clmse127.html#x157-31800025.1">25.1<!--tex4ht:ref: COMPILER-SECTION --></a>). FIXME
</div>
</div>
                                                                          

                                                                          
   <!--l. 668--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse52.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#tailclmch9.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse51.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#clmse51.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 668--><p class="indent" >   <a 
 id="tailclmse51.html"></a>  
</body></html> 
