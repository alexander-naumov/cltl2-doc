<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Renaming, Deleting, and Other File Operations</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-16 23:44:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 2302--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse119.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse117.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse117.html#tailclmse117.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse118.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch23.html#clmse118.html" >Наверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">23.3   </span> <a 
href="clm.html#QQ2-146-2383" id="x146-234000023.3">Renaming,
Deleting, and Other File Operations</a></h3>
<!--l. 2304--><p class="noindent" >These functions provide a standard interface to operations provided in some form
by most ﬁle systems. It may be that some implementations of Common Lisp
cannot support them all completely.
<div class="defun">
<!--l. 2308--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx146-2340001"></a><a 
 id="x146-2340002r725"></a><b> rename-ﬁle</b>  <i>ﬁle</i> <i>new-name</i>
</div>
<!--l. 2310--><p class="noindent" ><span class="paragraphHead"><a 
href="#x146-234100023.3" id="x146-234100023.3"></a></span>
   The speciﬁed <i>ﬁle</i> is renamed to <i>new-name</i> (which must be a ﬁle name). The
<i>ﬁle</i> may be a string, a pathname, or a stream. If it is an open stream associated
with a ﬁle, then the stream itself and the ﬁle associated with it are aﬀected (if the
ﬁle system permits).
<div class="new">
<!--l. 2317--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx146-2341001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse116.html#x144-231000023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<tt>
<!--l. 2323--><p class="indent" >   <a 
href="clmli7.html#x196-3479788r788">rename-file</a></tt> returns three values if successful. The ﬁrst value is the <i>new-name</i>
with any missing components ﬁlled in by performing a <tt><a 
href="clmli7.html#x196-3479612r612">merge-pathnames</a></tt>
operation using <i>ﬁle</i> as the defaults. The second value is the <tt><a 
href="clmli7.html#x196-3479953r953">truename</a></tt> of the ﬁle
before it was renamed. The third value is the <tt><a 
href="clmli7.html#x196-3479953r953">truename</a></tt> of the ﬁle after it was
renamed.
<!--l. 2329--><p class="indent" >   If the renaming operation is not successful, an error is signaled.
<div class="newer">
<!--l. 2332--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx146-2341002"></a>to require <tt><a 
href="clmli7.html#x196-3479788r788">rename-file</a></tt> to accept logical pathnames
(see section <a 
href="clmse116.html#x144-228200023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>).
</div>
</div>
<div class="defun">
<!--l. 2337--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx146-2341003"></a><a 
 id="x146-2341004r726"></a><b> delete-ﬁle</b>  <i>ﬁle</i>
</div>
                                                                          

                                                                          
<!--l. 2339--><p class="noindent" ><span class="paragraphHead"><a 
href="#x146-234200023.3" id="x146-234200023.3"></a></span>
   The speciﬁed <i>ﬁle</i> is deleted. The <i>ﬁle</i> may be a string, a pathname, or a stream.
If it is an open stream associated with a ﬁle, then the stream itself and the ﬁle
associated with it are aﬀected (if the ﬁle system permits), in which case the
stream may or may not be closed immediately, and the deletion may be
immediate or delayed until the stream is explicitly closed, depending on the
requirements of the ﬁle system.
<div class="new">
<!--l. 2349--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx146-2342001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse116.html#x144-231000023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<tt>
<!--l. 2355--><p class="indent" >   <a 
href="clmli7.html#x196-3479324r324">delete-file</a></tt> returns a non-<tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> value if successful. It is left to the discretion of
the implementation whether an attempt to delete a non-existent ﬁle is considered
to be successful. If the deleting operation is not successful, an error is
signaled.
<div class="newer">
<!--l. 2361--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx146-2342002"></a>to require <tt><a 
href="clmli7.html#x196-3479324r324">delete-file</a></tt> to accept logical pathnames
(see section <a 
href="clmse116.html#x144-228200023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>).
</div>
</div>
<div class="defun">
<!--l. 2366--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx146-2342003"></a><a 
 id="x146-2342004r727"></a><b> probe-ﬁle</b>  <i>ﬁle</i>
</div>
<!--l. 2368--><p class="noindent" ><span class="paragraphHead"><a 
href="#x146-234300023.3" id="x146-234300023.3"></a></span>
   This predicate is false if there is no ﬁle named <i>ﬁle</i>, and otherwise returns a
pathname that is the true name of the ﬁle (which may be diﬀerent from <i>ﬁle</i>
because of ﬁle links, version numbers, or other artifacts of the ﬁle system). Note
that if the <i>ﬁle</i> is an open stream associated with a ﬁle, then <tt><a 
href="clmli7.html#x196-3479738r738">probe-file</a></tt>
cannot return <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> but will produce the true name of the associated ﬁle.
See <tt><a 
href="clmli7.html#x196-3479953r953">truename</a></tt> and the <tt>:probe</tt> value for the <tt>:direction</tt> argument to
<tt><a 
href="clmli7.html#x196-3479682r682">open</a></tt>.
<div class="new">
<!--l. 2380--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx146-2343001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse116.html#x144-231000023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
                                                                          

                                                                          
<div class="newer">
<!--l. 2387--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx146-2343002"></a>to clarify that <tt><a 
href="clmli7.html#x196-3479738r738">probe-file</a></tt> accepts only non-wild
pathnames; an error is signaled if <tt><a 
href="clmli7.html#x196-3479996r996">wild-pathname-p</a></tt> would be true of the <i>ﬁle</i>
argument.
</div>
<div class="newer">
<!--l. 2394--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx146-2343003"></a>to require <tt><a 
href="clmli7.html#x196-3479738r738">probe-file</a></tt> to accept logical
pathnames (see section <a 
href="clmse116.html#x144-228200023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>). However, <tt><a 
href="clmli7.html#x196-3479738r738">probe-file</a></tt> never returns a logical
pathname.
</div>
<div class="new">
<!--l. 2400--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx146-2343004"></a>to specify that <tt><a 
href="clmli7.html#x196-3479738r738">probe-file</a></tt> is unaﬀected by
whether the ﬁrst argument, if a stream, is open or closed. If the ﬁrst
argument is a stream, <tt><a 
href="clmli7.html#x196-3479738r738">probe-file</a></tt> behaves as if the function <tt><a 
href="clmli7.html#x196-3479700r700">pathname</a></tt>
were applied to the stream and the resulting pathname used instead.
However, X3J13 further commented that the treatment of open streams may
diﬀer considerably from one implementation to another; for example,
in some operating systems open ﬁles are written under a temporary or
invisible name and later renamed when closed. In general, programmers
writing code intended to be portable should be very careful when using
<tt><a 
href="clmli7.html#x196-3479738r738">probe-file</a></tt>.
</div>
</div>
<div class="defun">
<!--l. 2414--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx146-2343005"></a><a 
 id="x146-2343006r728"></a><b> ﬁle-write-date</b>  <i>ﬁle</i>
</div>
<!--l. 2416--><p class="noindent" ><span class="paragraphHead"><a 
href="#x146-234400023.3" id="x146-234400023.3"></a></span>
<i>
   ﬁle</i> can be a ﬁle name or a stream that is open to a ﬁle. This returns the time
at which the ﬁle was created or last written as an integer in universal time format
(see section <a 
href="clmse123.html#x152-242100024.3.1">24.3.1<!--tex4ht:ref: TIME-SECTION --></a>), or <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> if this cannot be determined.
<div class="new">
<!--l. 2424--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx146-2344001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse116.html#x144-231000023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<div class="newer">
                                                                          

                                                                          
<!--l. 2431--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx146-2344002"></a>to clarify that <tt><a 
href="clmli7.html#x196-3479395r395">file-write-date</a></tt> accepts only
non-wild pathnames; an error is signaled if <tt><a 
href="clmli7.html#x196-3479996r996">wild-pathname-p</a></tt> would be true of the
<i>ﬁle</i> argument.
</div>
<div class="newer">
<!--l. 2438--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx146-2344003"></a>to require <tt><a 
href="clmli7.html#x196-3479395r395">file-write-date</a></tt> to accept logical
pathnames (see section <a 
href="clmse116.html#x144-228200023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>).
</div>
</div>
<div class="defun">
<!--l. 2443--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx146-2344004"></a><a 
 id="x146-2344005r729"></a><b> ﬁle-author</b>  <i>ﬁle</i>
</div>
<!--l. 2445--><p class="noindent" ><span class="paragraphHead"><a 
href="#x146-234500023.3" id="x146-234500023.3"></a></span>
<i>
   ﬁle</i> can be a ﬁle name or a stream that is open to a ﬁle. This returns
the name of the author of the ﬁle as a string, or <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> if this cannot be
determined.
<div class="new">
<!--l. 2451--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx146-2345001"></a>to specify exactly which streams may be used as
pathnames. See section <a 
href="clmse116.html#x144-231000023.1.6">23.1.6<!--tex4ht:ref: PATHNAME-FUNCTIONS --></a>.
</div>
<div class="newer">
<!--l. 2458--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx146-2345002"></a>to clarify that <tt><a 
href="clmli7.html#x196-3479388r388">file-author</a></tt> accepts only non-wild
pathnames; an error is signaled if <tt><a 
href="clmli7.html#x196-3479996r996">wild-pathname-p</a></tt> would be true of the <i>ﬁle</i>
argument.
</div>
<div class="newer">
<!--l. 2465--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx146-2345003"></a>to require <tt><a 
href="clmli7.html#x196-3479388r388">file-author</a></tt> to accept logical pathnames
(see section <a 
href="clmse116.html#x144-228200023.1.5">23.1.5<!--tex4ht:ref: LOGICAL-PATHNAMES-SECTION --></a>).
</div>
</div>
<div class="defun">
<!--l. 2470--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx146-2345004"></a><a 
 id="x146-2345005r730"></a><b> ﬁle-position</b>  <i>ﬁle-stream</i> &#x0026;optional  <i>position</i>
</div>
<!--l. 2472--><p class="noindent" ><span class="paragraphHead"><a 
href="#x146-234600023.3" id="x146-234600023.3"></a></span>
                                                                          

                                                                          
<tt>
   <a 
href="clmli7.html#x196-3479393r393">file-position</a></tt> returns or sets the current position within a random-access
ﬁle.
<tt>
<!--l. 2476--><p class="indent" >   (file-position <i>file-stream</i>)</tt> returns a non-negative integer indicating the
current position within the <i>ﬁle-stream</i>, or <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> if this cannot be determined.
The ﬁle position at the start of a ﬁle will be zero. The value returned by
<tt><a 
href="clmli7.html#x196-3479393r393">file-position</a></tt> increases monotonically as input or output operations are
performed. For a character ﬁle, performing a single <tt><a 
href="clmli7.html#x196-3479765r765">read-char</a></tt> or <tt><a 
href="clmli7.html#x196-3480013r1013">write-char</a></tt>
operation may cause the ﬁle position to be increased by more than 1 because of
character-set translations (such as translating between the Common Lisp
<tt>#\Newline</tt> character and an external ASCII carriage-return/line-feed
sequence) and other aspects of the implementation. For a binary ﬁle,
every <tt><a 
href="clmli7.html#x196-3479764r764">read-byte</a></tt> or <tt><a 
href="clmli7.html#x196-3480012r1012">write-byte</a></tt> operation increases the ﬁle position by
1.
<tt>
<!--l. 2489--><p class="indent" >   (file-position <i>file-stream</i> <i>position</i>)</tt> sets the position within
<i>ﬁle-stream</i> to be <i>position</i>. The <i>position</i> may be an integer, or <tt>:start</tt> for the
beginning of the stream, or <tt>:end</tt> for the end of the stream. If the integer is too
large or otherwise inappropriate, an error is signaled (the <tt><a 
href="clmli7.html#x196-3479391r391">file-length</a></tt> function
returns the length beyond which <tt><a 
href="clmli7.html#x196-3479393r393">file-position</a></tt> may not access). An
integer returned by <tt><a 
href="clmli7.html#x196-3479393r393">file-position</a></tt> of one argument should, in general, be
acceptable as a second argument for use with the same ﬁle. With two
arguments, <tt><a 
href="clmli7.html#x196-3479393r393">file-position</a></tt> returns <tt><a 
href="clmli7.html#x196-3479935r935">t</a></tt> if the repositioning was performed
successfully, or <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> if it was not (for example, because the ﬁle was not
random-access).
<div class="implementation">
<!--l. 2503--><p class="noindent" ><b>Заметка для реализации:</b> Implementations that have character ﬁles represented as a
sequence of records of bounded size might choose to encode the ﬁle position as, for
example, <i>record-number</i>*256+<i>character-within-record</i>. This is a valid encoding because it
increases monotonically as each character is read or written, though not necessarily by 1
at each step. An integer might then be considered “inappropriate” as a second argument
to <tt><a 
href="clmli7.html#x196-3479393r393">file-position</a></tt> if, when decoded into record number and character number, it
turned out that the speciﬁed record was too short for the speciﬁed character
number.
</div>
</div>
<div class="defun">
                                                                          

                                                                          
<!--l. 2517--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx146-2346001"></a><a 
 id="x146-2346002r731"></a><b> ﬁle-length</b>  <i>ﬁle-stream</i>
</div>
<!--l. 2519--><p class="noindent" ><span class="paragraphHead"><a 
href="#x146-234700023.3" id="x146-234700023.3"></a></span>
<i>
   ﬁle-stream</i> must be a stream that is open to a ﬁle. The length of the ﬁle is
returned as a non-negative integer, or <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> if the length cannot be determined. For
a binary ﬁle, the length is speciﬁcally measured in units of the <tt>:element-type</tt>
speciﬁed when the ﬁle was opened (see <tt><a 
href="clmli7.html#x196-3479682r682">open</a></tt>).
</div>
<div class="newer">
<div class="defun">
<!--l. 2531--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx146-2347001"></a><a 
 id="x146-2347002r732"></a><b> ﬁle-string-length</b>  <i>ﬁle-stream</i> <i>object</i>
</div>
<!--l. 2533--><p class="noindent" ><span class="paragraphHead"><a 
href="#x146-234800023.3" id="x146-234800023.3"></a></span>
   X3J13 voted in June 1989 <a 
 id="dx146-2348001"></a>to add the function <tt><a 
href="clmli7.html#x196-3479394r394">file-string-length</a></tt>. The
<i>object</i> must be a string or a character. The function <tt><a 
href="clmli7.html#x196-3479394r394">file-string-length</a></tt> returns
a non-negative integer that is the diﬀerence between what the <tt><a 
href="clmli7.html#x196-3479393r393">file-position</a></tt> of
the <i>ﬁle-stream</i> would be after and before writing the <i>object</i> to the <i>ﬁle-stream</i>, or
<tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> if this diﬀerence cannot be determined. The value returned may depend on
the current state of the <i>ﬁle-stream</i>; that is, calling <tt><a 
href="clmli7.html#x196-3479394r394">file-string-length</a></tt> on the
same arguments twice may in certain circumstances produce two diﬀerent
integers.
</div>
</div>
                                                                          

                                                                          
<!--l. 2548--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse119.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse117.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse117.html#tailclmse117.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse118.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch23.html#clmse118.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse118.html"></a>   </div> </div> 
</body></html> 
