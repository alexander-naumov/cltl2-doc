<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>How the Loop Facility Works</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-09 00:03:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 46--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse134.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse132.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse132.html#tailclmse132.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse133.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch26.html#clmse133.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">26.2   </span> <a 
 id="x164-33600026.2"></a>How the Loop Facility Works</h3>
<!--l. 48--><p class="noindent" >The driving element of the Loop Facility is the <a 
href="clmse42.html#x54-129002r106">loop</a> macro. When Lisp encounters
a <a 
href="clmse42.html#x54-129002r106">loop</a> macro call form, it invokes the Loop Facility and passes to it the loop
clauses as a list of unevaluated forms, as with any macro. The loop clauses contain
Common Lisp forms and loop keywords. The loop keywords are recognized by
their symbol name, regardless of the packages that contain them. The <a 
href="clmse42.html#x54-129002r106">loop</a> macro
translates the given form into Common Lisp code and returns the expanded
form.
<!--l. 57--><p class="indent" >   The expanded loop form is one or more lambda-expressions for the local
binding of loop variables and a block and a tagbody that express a looping control
structure. The variables established in the loop construct are bound as if
by using <a 
href="clmse39.html#x51-107003r84">let</a> or lambda. Implementations can interleave the setting of
initial values with the bindings. However, the assignment of the initial
values is always calculated in the order speciﬁed by the user. A variable
is thus sometimes bound to a harmless value of the correct data type,
and then later in the prologue it is set to the true initial value by using
<a 
href="clmse35.html#x47-90002r61">setq</a>.
<!--l. 68--><p class="indent" >   The expanded form consists of three basic parts in the tagbody:
      <ul class="itemize1">
      <li class="itemize">The loop prologue  contains forms that are executed before iteration
      begins, such as initial settings of loop variables and possibly an initial
      termination test.
      </li>
      <li class="itemize">The loop body contains those forms that are executed during iteration,
      including  application-speciﬁc  calculations,  termination  tests,  and
      variable stepping. Stepping is the process of assigning a variable the
      next item in a series of items.
      </li>
                                                                          

                                                                          
      <li class="itemize">The  loop  epilogue  contains  forms  that  are  executed  after  iteration
      terminates, such as code to return values from the loop.</li></ul>
<!--l. 89--><p class="indent" >   Expansion of the <a 
href="clmse42.html#x54-129002r106">loop</a> macro produces an implicit block (named <a 
href="clmse31.html#x42-77002r19">nil</a>). Thus, the
Common Lisp macro <a 
href="clmse142.html#x173-367002r883">return</a> and the special form <a 
href="clmse41.html#x53-125002r104">return-from</a> can be used to
return values from a loop or to exit a loop.
<!--l. 95--><p class="indent" >   Within the executable parts of loop clauses and around the entire loop
form, you can still bind variables by using the Common Lisp special form
<a 
href="clmse39.html#x51-107003r84">let</a>.
                                                                          

                                                                          
   <!--l. 101--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse134.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse132.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse132.html#tailclmse132.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse133.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch26.html#clmse133.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 101--><p class="indent" >   <a 
 id="tailclmse133.html"></a>  
</body></html> 
