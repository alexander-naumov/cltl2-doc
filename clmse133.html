<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Conditional Execution</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-16 00:55:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 1650--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse134.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse132.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse132.html#tailclmse132.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse133.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch25.html#clmse133.html" >Наверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">25.10   </span> <a 
href="clm.html#QQ2-163-2416" id="x163-239400025.10">Conditional
Execution</a></h3>
<!--l. 1653--><p class="noindent" >The loop keywords <tt><a 
href="#x163-2394002r817">if</a></tt>, <tt><a 
href="#x163-2395002r818">when</a></tt>, and <tt><a 
href="#x163-2396002r819">unless</a></tt> designate constructs that are useful
when you want some loop clauses to operate under a speciﬁed condition.
<!--l. 1657--><p class="indent" >   If the speciﬁed condition is true, the succeeding loop clause is executed. If the
speciﬁed condition is not true, the succeeding clause is skipped, and program
control moves to the clause that follows the loop keyword <tt>else</tt>. If the speciﬁed
condition is not true and no <tt>else</tt> clause is speciﬁed, the entire conditional
construct is skipped. Several clauses can be connected into one compound clause
with the loop keyword <tt><a 
href="clmse34.html#x45-413002r49">and</a></tt>. The end of the conditional clause can be marked with
the keyword <tt>end</tt>.
<div class="defmacheader">
<!--l. 1667--><p class="indent" >   <div class="tabbing">
 <i>[Выражение цикла]</i><b> if </b><a 
 id="dx163-2394001"></a><a 
 id="x163-2394002r817"></a> expr clause {<span class="math">and!clause}∗</span>
   <br>                         [<span class="math">else!clause{ and!clause}∗][end!]</span><br>
<!--l. 1668--><p class="noindent" ></div>
<!--l. 1668--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-239500025.10" id="x163-239500025.10"></a></span>
</div>
<div class="defmacheader">
<!--l. 1668--><p class="indent" >   <div class="tabbing">
 <i>[Выражение цикла]</i><b> when </b><a 
 id="dx163-2395001"></a><a 
 id="x163-2395002r818"></a> expr clause {<span class="math">and!clause}∗</span>
   <br>                         [<span class="math">else!clause{ and!clause}∗][end!]</span><br>
<!--l. 1670--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 1670--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-239600025.10" id="x163-239600025.10"></a></span>
</div>
<div class="defmacheader">
<!--l. 1670--><p class="indent" >   <div class="tabbing">
 <i>[Выражение цикла]</i><b> unless </b><a 
 id="dx163-2396001"></a><a 
 id="x163-2396002r819"></a> expr clause {<span class="math">and!clause}∗</span>
   <br>                         [<span class="math">else!clause{ and!clause}∗][end!]</span><br>
<!--l. 1673--><p class="noindent" ></div>
<!--l. 1673--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-239700025.10" id="x163-239700025.10"></a></span>
</div>
<!--l. 1674--><p class="indent" >   The constructs <tt><a 
href="#x163-2395002r818">when</a></tt> and <tt><a 
href="#x163-2394002r817">if</a></tt> allow conditional execution of loop clauses. These
constructs are synonyms and can be used interchangeably. [Compare this to the
<i>macro</i> <tt><a 
href="#x163-2395002r818">when</a></tt>, which does not allow an “else” part.—GLS]
<!--l. 1679--><p class="indent" >   If the value of the test expression <i>expr</i> is non-<tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt>, the expression <i>clause1</i> is
evaluated. If the test expression evaluates to <tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt> and an <tt>else</tt> construct is
speciﬁed, the statements that follow the <tt>else</tt> are evaluated; otherwise, control
passes to the next clause.
<!--l. 1684--><p class="indent" >   The <tt><a 
href="#x163-2396002r819">unless</a></tt> construct is equivalent to <tt><a 
href="#x163-2395002r818">when</a></tt> (<tt><a 
href="clmse34.html#x45-412002r48">not</a></tt> <i>expr</i>) and <tt><a 
href="#x163-2394002r817">if</a></tt> (<tt><a 
href="clmse34.html#x45-412002r48">not</a></tt> <i>expr</i>). If
the value of the test expression <i>expr</i> is <tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt>, the expression <i>clause1</i> is evaluated. If
the test expression evaluates to non-<tt><a 
href="clmse31.html#x42-312002r18">nil</a></tt> and an <tt>else</tt> construct is speciﬁed, the
statements that follow the <tt>else</tt> are evaluated; otherwise, control passes to the
next clause. [Compare this to the <i>macro</i> <tt><a 
href="#x163-2396002r819">unless</a></tt>, which does not allow an “else”
part—or do I mean a “then” part?! Ugh. To prevent confusion, I strongly
recommend as a matter of style that <tt>else</tt> not be used with <tt><a 
href="#x163-2396002r819">unless</a></tt> loop
clauses.—GLS]
<!--l. 1696--><p class="indent" >   The <i>clause</i> arguments must be either accumulation, unconditional, or
conditional clauses (see section <a 
href="clmse126.html#x156-225800025.3.2">25.3.2<!--tex4ht:ref: LOOP-KINDS-SECTION --></a>). Clauses that follow the test expression
can be grouped by using the loop keyword <tt><a 
href="clmse34.html#x45-413002r49">and</a></tt> to produce a compound
clause.
<!--l. 1702--><p class="indent" >   The loop keyword <tt>it</tt> can be used to refer to the result of the test expression in
a clause. If multiple clauses are connected with <tt><a 
href="clmse34.html#x45-413002r49">and</a></tt>, the <tt>it</tt> construct must be
used in the ﬁrst clause in the block. Since <tt>it</tt> is a loop keyword, <tt>it</tt> may not be
used as a local variable within a loop.
<!--l. 1708--><p class="indent" >   If <tt><a 
href="#x163-2395002r818">when</a></tt> or <tt><a 
href="#x163-2394002r817">if</a></tt> clauses are nested, each <tt>else</tt> is paired with the closest preceding
<tt><a 
href="#x163-2395002r818">when</a></tt> or <tt><a 
href="#x163-2394002r817">if</a></tt> construct that has no associated <tt>else</tt>.
                                                                          

                                                                          
<!--l. 1712--><p class="indent" >   The optional loop keyword <tt>end</tt> marks the end of the clause. If this keyword is
not speciﬁed, the next loop keyword marks the end. You can use <tt>end</tt> to
distinguish the scoping of compound clauses. <div class="lisp"><div class="tabbing">
;;; Group conditional clauses into a block.
   <br>                 (loop for i in numbers-list<br>                       when (oddp i)<br>
        do (print i)<br>                      and collect i into odd-numbers<br>
        and do (terpri)<br>                               else     ;<tt>I</tt> is even<br>
        collect i into even-numbers<br>                               ﬁnally<br>
        (return (values odd-numbers even-numbers)))<br>
<!--l. 1726--><p class="noindent" ></div>
<!--l. 1726--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-239800025.10" id="x163-239800025.10"></a></span>
<!--l. 1726--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-239900025.10" id="x163-239900025.10"></a></span>
</div>
<div class="lisp">
<!--l. 1727--><p class="indent" >   <div class="tabbing">
;;; Collect numbers larger than 3.
   <br>            (loop for i in &#x2019;(1 2 3 4 5 6)<br>                  when (and (&#x003E; i 3) i)<br>
      collect it)     ;<tt>it</tt> refers to <tt>(and (&#x003E; i 3) i)</tt><br>           <span class="math"> ⇒</span> (4 5 6)<br>
<!--l. 1733--><p class="noindent" ></div>
<!--l. 1733--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-240000025.10" id="x163-240000025.10"></a></span>
<!--l. 1733--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-240100025.10" id="x163-240100025.10"></a></span>
</div>
<div class="lisp">
<!--l. 1734--><p class="indent" >   <div class="tabbing">
                                                                          

                                                                          
;;; Find a number in a list.
   <br>                                                            (loop for i in &#x2019;(1 2 3 4 5 6)<br>
      when (and (&#x003E; i 3) i)<br>                                     return it)<br>
   <span class="math"> ⇒</span> 4<br>
<!--l. 1740--><p class="noindent" ></div>
<!--l. 1740--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-240200025.10" id="x163-240200025.10"></a></span>
<!--l. 1740--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-240300025.10" id="x163-240300025.10"></a></span>
</div>
<div class="lisp">
<!--l. 1741--><p class="indent" >   <div class="tabbing">
;;; The preceding example is similar to the following one.
   <br>          (loop for i in &#x2019;(1 2 3 4 5 6)<br>                thereis (and (&#x003E; i 3) i))<br>
   <span class="math"> ⇒</span> 4<br>
<!--l. 1746--><p class="noindent" ></div>
<!--l. 1746--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-240400025.10" id="x163-240400025.10"></a></span>
<!--l. 1746--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-240500025.10" id="x163-240500025.10"></a></span>
</div>
<div class="lisp">
<!--l. 1747--><p class="indent" >   <div class="tabbing">
;;; An example of using UNLESS with ELSE (yuk).                  —GLS
                                                                          

                                                                          
   <br>                             (loop for turtle in teenage-mutant-ninja-turtles do<br>
  (loop for x in &#x2019;(joker brainiac shredder krazy-kat)<br>
        unless (evil x)<br>                do (eat (make-pizza :anchovies t))<br>
        else unless (and (eq x &#x2019;shredder) (attacking-p x))<br>
               do (cut turtle slack) ;When the evil Shredder attacks,<br>
             else (ﬁght turtle x))) ; those turtle boys don&#x2019;t cut no slack<br>
<!--l. 1756--><p class="noindent" ></div>
<!--l. 1756--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-240600025.10" id="x163-240600025.10"></a></span>
<!--l. 1756--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-240700025.10" id="x163-240700025.10"></a></span>
</div>
<div class="lisp">
<!--l. 1758--><p class="indent" >   <div class="tabbing">
;;; Nest conditional clauses.
   <br>                                                                         (loop for i in list<br>
      when (numberp i)<br>                               when (bignump i)<br>
          collect i into big-numbers<br>         else     ;Not <tt>(bignump i)</tt><br>
          collect i into other-numbers<br>
      else     ;Not <tt>(numberp i)</tt><br>                     when (symbolp i)<br>
          collect i into symbol-list<br>          else     ;Not <tt>(symbolp i)</tt><br>
          (error &#x0022;found a funny value in list ~S, value ~S~%&#x0022;<br>
                &#x0022;list i))<br>
<br>             ;;; Without the END marker, the last AND would apply to the<br>
;;; inner IF rather than the outer one.<br>               (loop for x from 0 to 3<br>
      do (print x)<br>                                   if (zerop (mod x 2))<br>
        do (princ &#x0022; a&#x0022;)<br>                        and if (zerop (ﬂoor x 2))<br>
                do (princ &#x0022; b&#x0022;)<br>                                   end<br>
          and do (princ &#x0022; c&#x0022;))<br>
<!--l. 1783--><p class="noindent" ></div>
<!--l. 1783--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-240800025.10" id="x163-240800025.10"></a></span>
                                                                          

                                                                          
<!--l. 1783--><p class="noindent" ><span class="paragraphHead"><a 
href="#x163-240900025.10" id="x163-240900025.10"></a></span>
</div>
                                                                          

                                                                          
<!--l. 1787--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse134.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse132.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse132.html#tailclmse132.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse133.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch25.html#clmse133.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse133.html"></a>   </div> </div> 
</body></html> 
