<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Стандартные потоки</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-16 23:44:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 667--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse110.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch21.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch21.html#tailclmch21.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse109.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch21.html#clmse109.html" >Наверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">21.1   </span> <a 
href="clm.html#QQ2-135-1879" id="x135-184900021.1">Стандартные
потоки</a></h3>
<!--l. 669--><p class="noindent" >В Lisp системе есть несколько переменных, значения которых является
потоками, используемыми большим количеством функций. Эти переменные и
их использование описаны ниже. По соглашению, переменные, которые
содержат поток для чтения, имеют имена заканчивающиеся на <tt>-input</tt>,
и переменные, которые содержат поток для записи, имеют имена,
заканчивающиеся на <tt>-output</tt>. Имена переменных, содержащих потоки и для
чтения, и для записи, заканчиваются на <tt>-io</tt>.
<div class="defun">
<!--l. 677--><p class="noindent" ><div class="defunheader"> <i>[Переменная]</i><a 
 id="dx135-1849001"></a><a 
 id="x135-1849002r600"></a><b> *standard-input*</b>
</div>
                                                                          

                                                                          
<!--l. 679--><p class="noindent" ><span class="paragraphHead"><a 
href="#x135-185000021.1" id="x135-185000021.1"></a></span>
   В обычном Lisp&#x2019;овом цикле взаимодействия с пользователем, входные
данные читаются из <tt><a 
href="clmli7.html#x196-3479047r47">*standard-input*</a></tt> (то есть, из потока, который является
значением глобальной переменной <tt><a 
href="clmli7.html#x196-3479047r47">*standard-input*</a></tt>). Большинство
функций, включая <tt><a 
href="clmli7.html#x196-3479763r763">read</a></tt> и <tt><a 
href="clmli7.html#x196-3479765r765">read-char</a></tt>, принимают аргумент — поток, который
по-умолчанию <tt><a 
href="clmli7.html#x196-3479047r47">*standard-input*</a></tt>.
</div>
<div class="defun">
<!--l. 687--><p class="noindent" ><div class="defunheader"> <i>[Переменная]</i><a 
 id="dx135-1850001"></a><a 
 id="x135-1850002r601"></a><b> *standard-output*</b>
</div>
<!--l. 689--><p class="noindent" ><span class="paragraphHead"><a 
href="#x135-185100021.1" id="x135-185100021.1"></a></span>
   В обычном Lisp&#x2019;овом цикле взаимодействия с пользователем, выходные
данные посылаются в <tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt> (то есть, в поток, который является
значением глобальной переменной <tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt>). Большинство
функций, включая <tt><a 
href="clmli7.html#x196-3479734r734">print</a></tt> и <tt><a 
href="clmli7.html#x196-3480013r1013">write-char</a></tt>, принимают аргумент – поток,
который по-умолчанию <tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt>.
</div>
<div class="defun">
<!--l. 697--><p class="noindent" ><div class="defunheader"> <i>[Переменная]</i><a 
 id="dx135-1851001"></a><a 
 id="x135-1851002r602"></a><b> *error-output*</b>
</div>
<!--l. 699--><p class="noindent" ><span class="paragraphHead"><a 
href="#x135-185200021.1" id="x135-185200021.1"></a></span>
   Значение <tt><a 
href="clmli7.html#x196-3479014r14">*error-output*</a></tt> является потоком, в который должны
посылаться сообщения об ошибках. Обычно значение совпадает с
<tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt>, но <tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt> может быть связан с файлов и
<tt><a 
href="clmli7.html#x196-3479014r14">*error-output*</a></tt> остаётся направленной на терминал или отдельный файл
для сообщений об ошибках.
</div>
<div class="defun">
<!--l. 706--><p class="noindent" ><div class="defunheader"> <i>[Переменная]</i><a 
 id="dx135-1852001"></a><a 
 id="x135-1852002r603"></a><b> *query-io*</b>
</div>
<!--l. 708--><p class="noindent" ><span class="paragraphHead"><a 
href="#x135-185300021.1" id="x135-185300021.1"></a></span>
   Значение <tt><a 
href="clmli7.html#x196-3479039r39">*query-io*</a></tt> является потоком, используемым, когда необходимо
получить от пользователя ответ на некоторый вопрос. Вопрос должен быть
выведен в этот поток, и ответ из него прочитан. Когда входной поток для
                                                                          

                                                                          
программы может производится из файла, вопрос «Вы действительно хотите
удалить все файлы в вашей директории?» никогда не должен посылаться
напрямую к пользователю. И ответ должен прийти от пользователя, а не из
данных файла. Поэтому в этих целях, вместо <tt><a 
href="clmli7.html#x196-3479047r47">*standard-input*</a></tt> и
<tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt>, должен использоваться <tt><a 
href="clmli7.html#x196-3479039r39">*query-io*</a></tt> с помощью функции
<tt><a 
href="clmli7.html#x196-3480019r1019">yes-or-no-p</a></tt>.
</div>
<div class="defun">
<!--l. 719--><p class="noindent" ><div class="defunheader"> <i>[Переменная]</i><a 
 id="dx135-1853001"></a><a 
 id="x135-1853002r604"></a><b> *debug-io*</b>
</div>
<!--l. 721--><p class="noindent" ><span class="paragraphHead"><a 
href="#x135-185400021.1" id="x135-185400021.1"></a></span>
   Значение <tt><a 
href="clmli7.html#x196-3479011r11">*debug-io*</a></tt> является потоком, используемым для
интерактивной отладки. Часто может совпадать с <tt><a 
href="clmli7.html#x196-3479039r39">*query-io*</a></tt>, но это
необязательно.
</div>
<div class="defun">
<!--l. 726--><p class="noindent" ><div class="defunheader"> <i>[Переменная]</i><a 
 id="dx135-1854001"></a><a 
 id="x135-1854002r605"></a><b> *terminal-io*</b>
</div>
<!--l. 728--><p class="noindent" ><span class="paragraphHead"><a 
href="#x135-185500021.1" id="x135-185500021.1"></a></span>
   Значение <tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt> является потоком, который соединён с
пользовательской консолью. Обычно, запись в этот поток выводит данные на
экран, например, а чтение из потока осуществляет чтение ввода с
клавиатуры.
<!--l. 733--><p class="indent" >   Когда стандартные функции, такие как <tt><a 
href="clmli7.html#x196-3479763r763">read</a></tt> и <tt><a 
href="clmli7.html#x196-3479765r765">read-char</a></tt> используются с
этим потоком, то происходит копирование входных данных обратно в поток
или «эхо». (Способ, с помощью которого это происходит, зависит от
реализации.)
</div>
<div class="defun">
<!--l. 738--><p class="noindent" ><div class="defunheader"> <i>[Переменная]</i><a 
 id="dx135-1855001"></a><a 
 id="x135-1855002r606"></a><b> *trace-output*</b>
</div>
<!--l. 740--><p class="noindent" ><span class="paragraphHead"><a 
href="#x135-185600021.1" id="x135-185600021.1"></a></span>
   Значение <tt><a 
href="clmli7.html#x196-3479051r51">*trace-output*</a></tt> является потоком, в который функция <tt><a 
href="clmli7.html#x196-3479949r949">trace</a></tt>
выводит информацию.
                                                                          

                                                                          
</div>
<!--l. 745--><p class="indent" >   Переменные <tt><a 
href="clmli7.html#x196-3479047r47">*standard-input*</a></tt>, <tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt>, <tt><a 
href="clmli7.html#x196-3479014r14">*error-output*</a></tt>,
<tt><a 
href="clmli7.html#x196-3479051r51">*trace-output*</a></tt>, <tt><a 
href="clmli7.html#x196-3479039r39">*query-io*</a></tt> и <tt><a 
href="clmli7.html#x196-3479011r11">*debug-io*</a></tt> первоначально связаны с
потоками-синонимами, которые направляют все операции в поток
<tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt>. (Смотрите <tt><a 
href="clmli7.html#x196-3479589r589">make-synonym-stream</a></tt>.) Таким образом все
проделанные операции на этих потоках отобразятся на терминале.
<div class="new">
<!--l. 755--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx135-1856001"></a>to replace the requirements of the preceding
paragraph with the following new requirements:
<!--l. 760--><p class="indent" >   The seven standard stream variables, <tt><a 
href="clmli7.html#x196-3479047r47">*standard-input*</a></tt>, <tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt>,
<tt><a 
href="clmli7.html#x196-3479039r39">*query-io*</a></tt>, <tt><a 
href="clmli7.html#x196-3479011r11">*debug-io*</a></tt>, <tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt>, <tt><a 
href="clmli7.html#x196-3479014r14">*error-output*</a></tt>, and <tt><a 
href="clmli7.html#x196-3479051r51">*trace-output*</a></tt>,
are initially bound to open streams. (These will be called <i>the standard initial
streams</i>.)
<!--l. 768--><p class="indent" >   The streams that are the initial values of <tt><a 
href="clmli7.html#x196-3479047r47">*standard-input*</a></tt>, <tt><a 
href="clmli7.html#x196-3479039r39">*query-io*</a></tt>,
<tt><a 
href="clmli7.html#x196-3479011r11">*debug-io*</a></tt>, and <tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt> must support input.
<!--l. 772--><p class="indent" >   The streams that are the initial values of <tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt>, <tt><a 
href="clmli7.html#x196-3479014r14">*error-output*</a></tt>,
<tt><a 
href="clmli7.html#x196-3479051r51">*trace-output*</a></tt>, <tt><a 
href="clmli7.html#x196-3479039r39">*query-io*</a></tt>, <tt><a 
href="clmli7.html#x196-3479011r11">*debug-io*</a></tt>, and <tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt> must support
output.
<!--l. 778--><p class="indent" >   None of the standard initial streams (including the one to which
<tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt> is initially bound) may be a synonym, either directly or
indirectly, for any of the standard stream variables except <tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt>. For
example, the initial value of <tt><a 
href="clmli7.html#x196-3479051r51">*trace-output*</a></tt> may be a synonym stream for
<tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt> but not a synonym stream for <tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt> or
<tt><a 
href="clmli7.html#x196-3479039r39">*query-io*</a></tt>. (These are examples of direct synonyms.) As another example,
<tt><a 
href="clmli7.html#x196-3479039r39">*query-io*</a></tt> may be a two-way stream or echo stream whose input component is a
synonym for <tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt>, but its input component may not be a synonym
for <tt><a 
href="clmli7.html#x196-3479047r47">*standard-input*</a></tt> or <tt><a 
href="clmli7.html#x196-3479011r11">*debug-io*</a></tt>. (These are examples of indirect
synonyms.)
<!--l. 790--><p class="indent" >   Any or all of the standard initial streams may be direct or indirect
synonyms for one or more common implementation-dependent streams. For
example, the standard initial streams might all be synonym streams (or
two-way or echo streams whose components are synonym streams) to
a pair of hidden terminal input and output streams maintained by the
implementation.
<!--l. 797--><p class="indent" >   Part of the intent of these rules is to ensure that it is always safe to bind any
standard stream variable to the value of any other standard stream variable
(that is, unworkable circularities are avoided) without unduly restricting
implementation ﬂexibility.
                                                                          

                                                                          
</div>
<!--l. 803--><p class="indent" >   Пользовательская программа не должна изменять значение
<tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt>. Программа, которая, например, хочет перенаправить вывод в
файл, должна изменить значение переменной <tt><a 
href="clmli7.html#x196-3479048r48">*standard-output*</a></tt>. В
таком случае, сообщения об ошибках будут продолжать посылаться в
<tt><a 
href="clmli7.html#x196-3479014r14">*error-output*</a></tt>, а следовательно в <tt><a 
href="clmli7.html#x196-3479050r50">*terminal-io*</a></tt>, и пользователи сможет их
увидеть.
                                                                          

                                                                          
<!--l. 809--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse110.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch21.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch21.html#tailclmch21.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse109.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch21.html#clmse109.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse109.html"></a>   </div> </div> 
</body></html> 
