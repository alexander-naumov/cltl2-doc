<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Ассоциативные списки</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-16 23:44:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 2433--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmch16.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse87.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse87.html#tailclmse87.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse88.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch15.html#clmse88.html" >Наверх</a><tt>&#x003E;</tt></div><h3 class="sectionHead"><span class="titlemark">15.6   </span> <a 
href="clm.html#QQ2-108-1602" id="x108-157200015.6">Ассоциативные
списки</a></h3>
<i>
<!--l. 2435--><p class="noindent" >Ассоциативный список</i>, или <i>a-list</i>, является структурой данных, часто
используемой в Lisp&#x2019;е. a-list является списком пар (cons-ячеек). Каждая пара
является ассоциацией. <i>car</i> элемент пары называется <i>key</i>, и <i>cdr</i> элемент
<i>datum</i>.
<!--l. 2440--><p class="indent" >   Преимущество a-list представления данных в том, что a-list может быть
постепенно увеличен путём простого добавления в начало новых записей.
Кроме того, поскольку функция поиска <tt><a 
href="clmli7.html#x196-3479115r115">assoc</a></tt> по порядку проходит элементы
a-list, то новые записи могут «скрыть» старые. Если a-list рассматривать как
отображение ключей в значения, то отображение может быть не только
увеличено, но также изменено с помощью добавления новых записей в начало
a-list.
<!--l. 2448--><p class="indent" >   Иногда a-list представляет биективное (bijective) отображение, и
бывает нужно получить ключ для некоторого значения. Для этих целей
используется функция «реверсивного» поиска <tt><a 
href="clmli7.html#x196-3479756r756">rassoc</a></tt>. Другие варианты
поиска в a-list могут быть созданы с помощью функции <tt><a 
href="clmli7.html#x196-3479399r399">find</a></tt> или
<tt><a 
href="clmli7.html#x196-3479608r608">member</a></tt>.
<!--l. 2453--><p class="indent" >   Допустимо, чтобы <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> был элемент a-list вместо пары ключ-значение.
Такой элемент не считается парой и просто пропускается при использовании
функции <tt><a 
href="clmli7.html#x196-3479115r115">assoc</a></tt>.
<div class="defun">
<!--l. 2457--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx108-1572001"></a><a 
 id="x108-1572002r501"></a><b> acons</b>  <i>key</i> <i>datum</i> <i>a-list</i>
</div>
<!--l. 2459--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-157300015.6" id="x108-157300015.6"></a></span>
<tt>
   <a 
href="clmli7.html#x196-3479074r74">acons</a></tt> создаёт новый ассоциативный список, с помощью добавления пары
<tt>(<i>key</i> . <i>datum</i>)</tt> к старому <i>a-list</i>. <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(acons x y a) <span class="math"> ≡</span> (cons (cons x y) a)
   <br>
<!--l. 2464--><p class="noindent" ></div>
<!--l. 2464--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-157400015.6" id="x108-157400015.6"></a></span>
<!--l. 2464--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-157500015.6" id="x108-157500015.6"></a></span>
</div>
</div>
<div class="defun">
<!--l. 2467--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx108-1575001"></a><a 
 id="x108-1575002r502"></a><b> pairlis</b>  <i>keys</i> <i>data</i> &#x0026;optional  <i>a-list</i>
</div>
<!--l. 2469--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-157600015.6" id="x108-157600015.6"></a></span>
<tt>
   <a 
href="clmli7.html#x196-3479695r695">pairlis</a></tt> принимает два списка и создаёт ассоциативный список, который
связывает элементы первого списка с соответствующими элементами второго.
Если списки не одинаковой длины, это является ошибкой. Если указан
необязательный аргумент <i>a-list</i>, тогда новые пары добавляются к нему в
начало.
<!--l. 2475--><p class="indent" >   Новые пары могут быть расположены в итоговом списке a-list в любом
порядке. Например: <div class="lisp"><div class="tabbing">
(pairlis &#x2019;(one two) &#x2019;(1 2) &#x2019;((three . 3) (four . 19)))
   <br>
<!--l. 2479--><p class="noindent" ></div>
<!--l. 2479--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-157700015.6" id="x108-157700015.6"></a></span>
                                                                          

                                                                          
<!--l. 2479--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-157800015.6" id="x108-157800015.6"></a></span>
</div>
<!--l. 2480--><p class="indent" >   может быть <div class="lisp"><div class="tabbing">
((one . 1) (two . 2) (three . 3) (four . 19))
   <br>
<!--l. 2483--><p class="noindent" ></div>
<!--l. 2483--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-157900015.6" id="x108-157900015.6"></a></span>
<!--l. 2483--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-158000015.6" id="x108-158000015.6"></a></span>
</div>
<!--l. 2484--><p class="indent" >   или может быть так <div class="lisp"><div class="tabbing">
((two . 2) (one . 1) (three . 3) (four . 19))
   <br>
<!--l. 2487--><p class="noindent" ></div>
<!--l. 2487--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-158100015.6" id="x108-158100015.6"></a></span>
<!--l. 2487--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-158200015.6" id="x108-158200015.6"></a></span>
</div>
</div>
<div class="defun">
<!--l. 2490--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx108-1582001"></a><a 
 id="x108-1582002r503"></a><b> assoc</b>  <i>item</i> <i>a-list</i> &#x0026;key  <i>:test</i> <i>:test-not</i> <i>:key</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx108-1582003"></a><a 
 id="x108-1582004r504"></a><b> assoc-if</b>  <i>predicate</i> <i>a-list</i> &#x0026;key  <i>:key</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx108-1582005"></a><a 
 id="x108-1582006r505"></a><b> assoc-if-not</b>  <i>predicate</i> <i>a-list</i> &#x0026;key  <i>:key</i>
</div>
                                                                          

                                                                          
<!--l. 2494--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-158300015.6" id="x108-158300015.6"></a></span>
   Каждая из этих функций осуществляет поиск в ассоциативном списке
<i>a-list</i>. Функция возвращает первую пару, удовлетворяющую условию, или
<tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>, если такой пары не было найдено. Например: <div class="lisp"><div class="tabbing">
(assoc &#x2019;r &#x2019;((a . b) (c . d) (r . x) (s . y) (r . z)))
   <br>             <span class="math"> ⇒</span> (r . x)<br>     (assoc &#x2019;goo &#x2019;((foo . bar) (zoo . goo))) <span class="math"> ⇒</span> <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt><br>
(assoc &#x2019;2 &#x2019;((1 a b c) (2 b c d) (-7 x y z))) <span class="math"> ⇒</span> (2 b c d)<br>
<!--l. 2504--><p class="noindent" ></div>
<!--l. 2504--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-158400015.6" id="x108-158400015.6"></a></span>
<!--l. 2504--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-158500015.6" id="x108-158500015.6"></a></span>
</div>
<!--l. 2505--><p class="indent" >   Если функция вернула пару, можно изменить её значение с помощью
<tt><a 
href="clmli7.html#x196-3479807r807">rplacd</a></tt>. (Однако лучше будет добавить новую «затеняющую» пару в начало,
чем модифицировать старую.) Например: <div class="lisp"><div class="tabbing">
(setq values &#x2019;((x . 100) (y . 200) (z . 50)))
   <br>         (assoc &#x2019;y values) <span class="math"> ⇒</span> (y . 200)<br>         (rplacd (assoc &#x2019;y values) 201)<br>
(assoc &#x2019;y values) <span class="math"> ⇒</span> (y . 201) теперь<br>
<!--l. 2514--><p class="noindent" ></div>
<!--l. 2514--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-158600015.6" id="x108-158600015.6"></a></span>
<!--l. 2514--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-158700015.6" id="x108-158700015.6"></a></span>
</div>
<!--l. 2515--><p class="indent" >   Типичный приём использования <tt>(cdr (assoc x y))</tt>. Так как <i>cdr</i> от <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>
гарантировано вычисляется в <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>, то в случае отсутствия нужной пары,
будет возвращено значение <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>. <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> также будет возвращено, если значение
для ключа равно <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>. Такое поведение удобно, если <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt> несёт смысл
«значения по-умолчанию».
                                                                          

                                                                          
<!--l. 2521--><p class="indent" >   Два выражения <div class="lisp"><div class="tabbing">
(assoc <i>item</i> <i>list</i> :test <i>fn</i>)
   <br>
<!--l. 2524--><p class="noindent" ></div>
<!--l. 2524--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-158800015.6" id="x108-158800015.6"></a></span>
<!--l. 2524--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-158900015.6" id="x108-158900015.6"></a></span>
</div>
<!--l. 2525--><p class="indent" >   и <div class="lisp"><div class="tabbing">
(ﬁnd <i>item</i> <i>list</i> :test <i>fn</i> :key #&#x2019;car)
   <br>
<!--l. 2528--><p class="noindent" ></div>
<!--l. 2528--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-159000015.6" id="x108-159000015.6"></a></span>
<!--l. 2528--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-159100015.6" id="x108-159100015.6"></a></span>
</div>
<!--l. 2529--><p class="indent" >   эквивалентны за исключением, того что <tt><a 
href="clmli7.html#x196-3479115r115">assoc</a></tt> игнорирует значения <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>
на месте пар.
<!--l. 2532--><p class="indent" >   Смотрите также <tt><a 
href="clmli7.html#x196-3479399r399">find</a></tt> и <tt><a 
href="clmli7.html#x196-3479714r714">position</a></tt>.
<div class="new">
<!--l. 2535--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx108-1591001"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-7040007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
</div>
<div class="defun">
<!--l. 2541--><p class="noindent" ><div class="defunheader"> <i>[Функция]</i><a 
 id="dx108-1591002"></a><a 
 id="x108-1591003r506"></a><b> rassoc</b>  <i>item</i> <i>a-list</i> &#x0026;key  <i>:test</i> <i>:test-not</i> <i>:key</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx108-1591004"></a><a 
 id="x108-1591005r507"></a><b> rassoc-if</b>  <i>predicate</i> <i>a-list</i> &#x0026;key  <i>:key</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx108-1591006"></a><a 
 id="x108-1591007r508"></a><b> rassoc-if-not</b>  <i>predicate</i> <i>a-list</i> &#x0026;key  <i>:key</i>
</div>
                                                                          

                                                                          
<!--l. 2545--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-159200015.6" id="x108-159200015.6"></a></span>
<tt>
   <a 
href="clmli7.html#x196-3479756r756">rassoc</a></tt> является реверсивной формой для <tt><a 
href="clmli7.html#x196-3479115r115">assoc</a></tt>. Функция ищет пары, у
которых <i>cdr</i> элемент удовлетворяет заданному условию. Если <i>a-list</i>
рассматривается как отображение, то <tt><a 
href="clmli7.html#x196-3479756r756">rassoc</a></tt> обрабатывает <i>a-list</i> как
представление инверсного отображения. Например: <div class="lisp"><div class="tabbing">
(rassoc &#x2019;a &#x2019;((a . b) (b . c) (c . a) (z . a))) <span class="math"> ⇒</span> (c . a)
   <br>
<!--l. 2553--><p class="noindent" ></div>
<!--l. 2553--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-159300015.6" id="x108-159300015.6"></a></span>
<!--l. 2553--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-159400015.6" id="x108-159400015.6"></a></span>
</div>
<!--l. 2555--><p class="indent" >   Выражения <div class="lisp"><div class="tabbing">
(rassoc <i>item</i> <i>list</i> :test <i>fn</i>)
   <br>
<!--l. 2558--><p class="noindent" ></div>
<!--l. 2558--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-159500015.6" id="x108-159500015.6"></a></span>
<!--l. 2558--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-159600015.6" id="x108-159600015.6"></a></span>
</div>
<!--l. 2559--><p class="indent" >   и <div class="lisp"><div class="tabbing">
(ﬁnd <i>item</i> <i>list</i> :test <i>fn</i> :key #&#x2019;cdr)
   <br>
<!--l. 2562--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 2562--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-159700015.6" id="x108-159700015.6"></a></span>
<!--l. 2562--><p class="noindent" ><span class="paragraphHead"><a 
href="#x108-159800015.6" id="x108-159800015.6"></a></span>
</div>
<!--l. 2563--><p class="indent" >   эквивалентны за исключением, того что <tt><a 
href="clmli7.html#x196-3479756r756">rassoc</a></tt> игнорирует значения <tt><a 
href="clmli7.html#x196-3479650r650">nil</a></tt>
на месте пар.
<div class="new">
<!--l. 2567--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx108-1598001"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-7040007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
<!--l. 371--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmch16.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse87.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse87.html#tailclmse87.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse88.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch15.html#clmse88.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse88.html"></a>   </div> </div> 
</body></html> 
