<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Printed Representation of Lisp Objects</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-20 16:17:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
<!--l. 26--><p class="noindent" > <div id="main_container"> <div id="content"> <div id="toplinks"><tt>&#x003C;</tt><a 
href="clmse113.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="io.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="io.html#tailio.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse112.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="io.html#clmse112.html" >Наверх</a><tt>&#x003E;</tt>&lt;<a href="../index.html">Main Page</a>&gt;</div><h3 class="sectionHead"><span class="titlemark">22.1   </span> <a 
href="clm.html#QQ2-139-1579" id="x139-154900022.1">Printed
Representation of Lisp Objects</a></h3>
<!--l. 28--><p class="noindent" >Lisp objects in general are not text strings but complex data structures. They
have very diﬀerent properties from text strings as a consequence of their internal
                                                                          

                                                                          
representation. However, to make it possible to get at and talk about Lisp objects,
Lisp provides a representation of most objects in the form of printed text; this is
called the <i>printed representation</i>, which is used for input/output purposes and in
the examples throughout this book. Functions such as <tt><a 
href="symbols.html#x187-2604688r688">print</a></tt> take a Lisp
object and send the characters of its printed representation to a stream.
The collection of routines that does this is known as the (Lisp) <i>printer</i>.
The <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> function takes characters from a stream, interprets them as a
printed representation of a Lisp object, builds that object, and returns
it; the collection of routines that does this is called the (Lisp) <i>reader</i>.
<a 
 id="dx139-1549001"></a><a 
 id="dx139-1549002"></a>
<!--l. 45--><p class="indent" >   Ideally, one could print a Lisp object and then read the printed representation
back in, and so obtain the same identical object. In practice this is diﬃcult and
for some purposes not even desirable. Instead, reading a printed representation
produces an object that is (with obscure technical exceptions) <tt><a 
href="symbols.html#x187-2604339r339">equal</a></tt> to the
originally printed object.
<!--l. 52--><p class="indent" >   Most Lisp objects have more than one possible printed representation. For
example, the integer twenty-seven can be written in any of these ways:
<div class="lisp"><div class="tabbing">
27    27.    #o33    #x1B    #b11011    #.(* 3 3 3)    81/3
   <br>
<!--l. 56--><p class="noindent" ></div>
<!--l. 56--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-155000022.1" id="x139-155000022.1"></a></span>
<!--l. 56--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-155100022.1" id="x139-155100022.1"></a></span>
</div>
<!--l. 57--><p class="indent" >   A list of two symbols <tt>A</tt> and <tt>B</tt> can be printed in many ways: <div class="lisp"><div class="tabbing">
    (A B)    (a b)    (  a  b )    (\A |B|)
   <br>                                          (|\A|<br>                                        B<br>
)<br>
<!--l. 63--><p class="noindent" ></div>
                                                                          

                                                                          
<!--l. 63--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-155200022.1" id="x139-155200022.1"></a></span>
<!--l. 63--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-155300022.1" id="x139-155300022.1"></a></span>
</div>
<!--l. 64--><p class="indent" >   The last example, which is spread over three lines, may be ugly, but it is
legitimate. In general, wherever whitespace is permissible in a printed
representation, any number of spaces and newlines may appear.
<!--l. 68--><p class="indent" >   When <tt><a 
href="symbols.html#x187-2604688r688">print</a></tt> produces a printed representation, it must choose arbitrarily
from among many possible printed representations. It attempts to choose
one that is readable. There are a number of global variables that can be
used to control the actions of <tt><a 
href="symbols.html#x187-2604688r688">print</a></tt>, and a number of diﬀerent printing
functions.
<!--l. 74--><p class="indent" >   This section describes in detail what is the standard printed representation for
any Lisp object and also describes how <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> operates.
<!--l. 77--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">22.1.1   </span> <a 
href="frontmatter.html#QQ2-139-1584" id="x139-155400022.1.1">What the Read Function Accepts</a></h4>
<a 
 id="dx139-1554001"></a>
<!--l. 80--><p class="noindent" >The purpose of the Lisp reader is to accept characters, interpret them as the
printed representation of a Lisp object, and construct and return such an object.
The reader cannot accept everything that the printer produces; for example, the
printed representations of compiled code objects cannot be read in. However, the
reader has many features that are not used by the output of the printer at all,
such as comments, alternative representations, and convenient abbreviations for
frequently used but unwieldy constructs. The reader is also parameterized in such
a way that it can be used as a lexical analyzer for a more general user-written
parser.
<!--l. 91--><p class="indent" >   The reader is organized as a recursive-descent parser. Broadly speaking, the
reader operates by reading a character from the input stream and treating it
in one of three ways. Whitespace characters serve as separators but are
otherwise ignored. Constituent and escape characters are accumulated to
make a <i>token</i>, which is then interpreted as a number or symbol. Macro
characters trigger the invocation of functions (possibly user-supplied) that can
perform arbitrary parsing actions, including recursive invocation of the
reader.
                                                                          

                                                                          
<!--l. 102--><p class="indent" >   More precisely, when the reader is invoked, it reads a single character from the
input stream and dispatches according to the syntactic type of that character.
Every character that can appear in the input stream must be of exactly one of the
following kinds: <i>illegal</i>, <i>whitespace</i>, <i>constituent</i>, <i>single escape</i>, <i>multiple escape</i>, or
<i>macro</i>. Macro characters are further divided into the types <i>terminating</i> and
<i>non-terminating</i> (of tokens). (Note that macro characters have nothing whatever
to do with macros in their operation. There is a superﬁcial similarity in that
macros allow the user to extend the syntax of Common Lisp at the level of forms,
while macro characters allow the user to extend the syntax at the level of
characters.) Constituents additionally have one or more attributes, the most
important of which is <i>alphabetic</i>; these attributes are discussed further in
section <a 
href="#x139-155500022.1.2">22.1.2<!--tex4ht:ref: PARSE-TOKENS-SECTION --></a>.
<!--l. 124--><p class="indent" >   The parsing of Common Lisp expressions is discussed in terms of these
syntactic character types because the types of individual characters are not
ﬁxed but may be altered by the user (see <tt><a 
href="symbols.html#x187-2604775r775">set-syntax-from-char</a></tt> and
<tt><a 
href="symbols.html#x187-2604773r773">set-macro-character</a></tt>). The characters of the standard character set initially
have the syntactic types shown in table <a 
href="#x139-15540021">22.1<!--tex4ht:ref: Standard-Character-Syntax-Table --></a>. Note that the brackets, braces,
question mark, and exclamation point (that is, <tt>[</tt>, <tt>]</tt>, <tt>{</tt>, <tt>}</tt>, <tt>?</tt>, and <tt>!</tt>) are normally
deﬁned to be constituents, but they are not used for any purpose in standard
Common Lisp syntax and do not occur in the names of built-in Common Lisp
functions or variables. These characters are explicitly reserved to the user. The
primary intent is that they be used as macro characters; but a user might choose,
for example, to make <tt>!</tt> be a <i>single escape</i> character (as it is in Portable Standard
Lisp).
   <div class="table">
                                                                          

                                                                          
<!--l. 145--><p class="indent" >   <a 
 id="x139-15540021"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
 <div class="caption" 
><span class="id">Таблица 22.1: </span><span  
class="content">Standard Character Syntax Types</span></div><!--tex4ht:label?: x139-15540021 -->
<div class="tabular"><table width="100%" class="tabular"><tr><td align="left" ><span class="math">⟨</span>tab<span class="math">⟩</span><tt>  </tt><i>whitespace</i>            </td><td align="left" ><span class="math">⟨</span>page<span class="math">⟩</span><tt>  </tt><i>whitespace</i>  </td><td align="left" ><span class="math">⟨</span>newline<span class="math">⟩</span><tt>  </tt><i>whitespace</i></td>
</tr><tr><td align="left" ><span class="math">⟨</span>space<span class="math">⟩</span><tt>  </tt><i>whitespace</i>         </td><td align="left" ><tt>@  </tt><i>constituent</i>        </td><td align="left" ><tt>‘  </tt><i>terminating macro</i></td>
</tr><tr><td align="left" ><tt>!  </tt><i>constituent</i> *              </td><td align="left" ><tt>A  </tt><i>constituent</i>        </td><td align="left" ><tt>a  </tt><i>constituent</i>         </td></tr><tr><td align="left" ><tt>&#x0022;  </tt><i>terminating macro</i>  </td><td align="left" ><tt>B  </tt><i>constituent</i> </td><td align="left" ><tt>b  </tt><i>constituent</i></td>
</tr><tr><td align="left" ><tt>#  </tt><i>non-terminating macro</i> </td><td align="left" ><tt>C  </tt><i>constituent</i>        </td><td align="left" ><tt>c  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>$  </tt><i>constituent</i>                </td><td align="left" ><tt>D  </tt><i>constituent</i>        </td><td align="left" ><tt>d  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>%  </tt><i>constituent</i>                </td><td align="left" ><tt>E  </tt><i>constituent</i>        </td><td align="left" ><tt>e  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>&#x0026;  </tt><i>constituent</i>                </td><td align="left" ><tt>F  </tt><i>constituent</i>        </td><td align="left" ><tt>f  </tt><i>constituent</i>         </td></tr><tr><td align="left" ><tt>&#x2019;  </tt><i>terminating macro</i>  </td><td align="left" ><tt>G  </tt><i>constituent</i> </td><td align="left" ><tt>g  </tt><i>constituent</i></td>
</tr><tr><td align="left" ><tt>(  </tt><i>terminating macro</i>       </td><td align="left" ><tt>H  </tt><i>constituent</i>        </td><td align="left" ><tt>h  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>)  </tt><i>terminating macro</i>       </td><td align="left" ><tt>I  </tt><i>constituent</i>        </td><td align="left" ><tt>i  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>*  </tt><i>constituent</i>                </td><td align="left" ><tt>J  </tt><i>constituent</i>        </td><td align="left" ><tt>j  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>+  </tt><i>constituent</i>                </td><td align="left" ><tt>K  </tt><i>constituent</i>        </td><td align="left" ><tt>k  </tt><i>constituent</i>         </td></tr><tr><td align="left" ><tt>,  </tt><i>terminating macro</i>  </td><td align="left" ><tt>L  </tt><i>constituent</i> </td><td align="left" ><tt>l  </tt><i>constituent</i></td>
</tr><tr><td align="left" ><tt>-  </tt><i>constituent</i>                </td><td align="left" ><tt>M  </tt><i>constituent</i>        </td><td align="left" ><tt>m  </tt><i>constituent</i>         </td></tr><tr><td align="left" ><tt>.  </tt><i>constituent</i>  </td><td align="left" ><tt>N  </tt><i>constituent</i> </td><td align="left" ><tt>n  </tt><i>constituent</i></td>
</tr><tr><td align="left" ><tt>/  </tt><i>constituent</i>                </td><td align="left" ><tt>O  </tt><i>constituent</i>        </td><td align="left" ><tt>o  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>0  </tt><i>constituent</i>                </td><td align="left" ><tt>P  </tt><i>constituent</i>        </td><td align="left" ><tt>p  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>1  </tt><i>constituent</i>                </td><td align="left" ><tt>Q  </tt><i>constituent</i>        </td><td align="left" ><tt>q  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>2  </tt><i>constituent</i>                </td><td align="left" ><tt>R  </tt><i>constituent</i>        </td><td align="left" ><tt>r  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>3  </tt><i>constituent</i>                </td><td align="left" ><tt>S  </tt><i>constituent</i>        </td><td align="left" ><tt>s  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>4  </tt><i>constituent</i>                </td><td align="left" ><tt>T  </tt><i>constituent</i>        </td><td align="left" ><tt>t  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>5  </tt><i>constituent</i>                </td><td align="left" ><tt>U  </tt><i>constituent</i>        </td><td align="left" ><tt>u  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>6  </tt><i>constituent</i>                </td><td align="left" ><tt>V  </tt><i>constituent</i>        </td><td align="left" ><tt>v  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>7  </tt><i>constituent</i>                </td><td align="left" ><tt>W  </tt><i>constituent</i>        </td><td align="left" ><tt>w  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>8  </tt><i>constituent</i>                </td><td align="left" ><tt>X  </tt><i>constituent</i>        </td><td align="left" ><tt>x  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>9  </tt><i>constituent</i>                </td><td align="left" ><tt>Y  </tt><i>constituent</i>        </td><td align="left" ><tt>y  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>:  </tt><i>constituent</i>                </td><td align="left" ><tt>Z  </tt><i>constituent</i>        </td><td align="left" ><tt>z  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>;  </tt><i>terminating macro</i>       </td><td align="left" ><tt>[  </tt><i>constituent</i> *      </td><td align="left" ><tt>{  </tt><i>constituent</i> *       </td>
</tr><tr><td align="left" ><tt>&#x003C;  </tt><i>constituent</i>                </td><td align="left" ><tt>\  </tt><i>single escape</i>      </td><td align="left" ><tt>|  </tt><i>multiple escape</i>    </td>
</tr><tr><td align="left" ><tt>=  </tt><i>constituent</i>                </td><td align="left" ><tt>]  </tt><i>constituent</i> *      </td><td align="left" ><tt>}  </tt><i>constituent</i> *       </td>
</tr><tr><td align="left" ><tt>&#x003E;  </tt><i>constituent</i>                </td><td align="left" ><tt>̂  </tt><i>constituent</i>        </td><td align="left" ><tt>~  </tt><i>constituent</i>         </td>
</tr><tr><td align="left" ><tt>?  </tt><i>constituent</i> *              </td><td align="left" ><tt>_  </tt><i>constituent</i>        </td><td align="left" ><span class="math">⟨</span>rubout<span class="math">⟩</span><tt>  </tt><i>constituent</i></td>
</tr><tr><td align="left" ><span class="math">⟨</span>backspace<span class="math">⟩</span><tt>  </tt><i>constituent</i>   </td><td align="left" ><span class="math">⟨</span>return<span class="math">⟩</span><tt>  </tt><i>whitespace</i></td><td align="left" ><span class="math">⟨</span>linefeed<span class="math">⟩</span><tt>  </tt><i>whitespace</i></td></tr></table>
</div>
<!--l. 187--><p class="noindent" >The characters marked with an asterisk are initially constituents but are reserved to the
user for use as macro characters or for any other desired purpose.
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
<!--l. 194--><p class="indent" >   The algorithm performed by the Common Lisp reader is roughly as
follows:
   <ol  class="enumerate1" >
   <li 
  class="enumerate" id="x139-1554004x1">If at end of ﬁle, perform end-of-ﬁle processing (as speciﬁed by the caller of
   the <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> function). Otherwise, read one character from the input stream,
   call it <i>x</i>, and dispatch according to the syntactic type of <i>x</i> to one of
   steps <a 
href="#x139-15540052">2<!--tex4ht:ref: READER-ILLEGAL --></a> to <a 
href="#x139-15540157">7<!--tex4ht:ref: READER-CONSTITUENT --></a>. <a 
 id="x139-15540031"></a>
   </li>
   <li 
  class="enumerate" id="x139-1554006x2">If <i>x</i> is an <i>illegal</i> character, signal an error. <a 
 id="x139-15540052"></a>
   </li>
   <li 
  class="enumerate" id="x139-1554008x3">If <i>x</i> is a <i>whitespace</i> character, then discard it and go back to step <a 
href="#x139-15540031">1<!--tex4ht:ref: READER-START --></a>. <a 
 id="x139-15540073"></a>
   </li>
   <li 
  class="enumerate" id="x139-1554010x4">If  <i>x</i>  is  a  <i>macro</i>  character  (at  this  point  the  distinction  between
   <i>terminating</i> and  <i>non-terminating</i> macro  characters  does  not  matter),
   then execute the function associated with that character. The function
   may return zero values or one value (see <tt><a 
href="symbols.html#x187-2604914r914">values</a></tt>).
   <!--l. 222--><p class="noindent" >The macro-character function may of course read characters from the
   input stream; if it does, it will see those characters following the macro
   character.  The  function  may  even  invoke  the  reader  recursively.  This
   is how the macro character <tt>(</tt> constructs a list: by invoking the reader
   recursively to read the elements of the list.
   <!--l. 228--><p class="noindent" >If one value is returned, then return that value as the result of the read
   operation; the algorithm is done. If zero values are returned, then go back
   to step <a 
href="#x139-15540031">1<!--tex4ht:ref: READER-START --></a>.
   </li>
   <li 
  class="enumerate" id="x139-1554012x5">If <i>x</i> is a <i>single escape</i> character (normally <tt>\</tt>), then read the next character and
   call it <i>y</i> (but if at end of ﬁle, signal an error instead). Ignore the usual syntax
   of <i>y</i> and pretend it is a <i>constituent</i> whose only attribute is <i>alphabetic</i>. <div class="obsolete"> (If <i>y</i> is
   a lowercase character, leave it alone; do not replace it with the corresponding
   uppercase character.)
   </div> <div class="newer"> For the purposes of <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt>, <i>y</i> is not replaceable.
   </div> Use <i>y</i> to begin a token, and go to step <a 
href="#x139-15540188">8<!--tex4ht:ref: READER-PLAIN-TOKEN --></a>.
                                                                          

                                                                          
   </li>
   <li 
  class="enumerate" id="x139-1554014x6">If <i>x</i> is a <i>multiple escape</i> character (normally <tt>|</tt>), then begin a token (initially
   containing no characters) and go to step <a 
href="#x139-15540219">9<!--tex4ht:ref: READER-MULTI-TOKEN --></a>.
   </li>
   <li 
  class="enumerate" id="x139-1554016x7">If <i>x</i> is a <i>constituent</i> character, then it begins an extended token. <a 
 id="x139-15540157"></a>After the
   entire token is read in, it will be interpreted either as representing a Lisp
   object such as a symbol or number (in which case that object is returned as
   the result of the read operation), or as being of illegal syntax (in which case an
   error is signaled). <div class="obsolete"> If <i>x</i> is a lowercase character, replace it with the
   corresponding uppercase character.
   </div> <div class="newer"> X3J13 voted in June 1989 <a 
 id="dx139-1554017"></a>to introduce <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt>. Consequently, the
   preceding sentence should be ignored. The case of <i>x</i> should not be altered;
   instead, <i>x</i> should be regarded as replaceable.
   </div> Use <i>x</i> to begin a token, and go on to step <a 
href="#x139-15540188">8<!--tex4ht:ref: READER-PLAIN-TOKEN --></a>.
   </li>
   <li 
  class="enumerate" id="x139-1554019x8">(At this point a token is being accumulated, and an even number of <i>multiple
   escape</i> characters have been encountered.) If at end of ﬁle, go to step <a 
href="#x139-155402310">10<!--tex4ht:ref: READER-TOKEN-END --></a>.
   Otherwise, read a character (call it <i>y</i>), and perform one of the following
   actions according to its syntactic type: <a 
 id="x139-15540188"></a>
        <ul class="itemize1">
        <li class="itemize">If <i>y</i> is a <i>constituent</i> or <i>non-terminating macro</i>, then do the following. <div class="obsolete"> If
        <i>y</i> is a lowercase character, replace it with the corresponding uppercase
        character.
        </div> <div class="newer"> X3J13 voted in June 1989 <a 
 id="dx139-1554020"></a>to introduce <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt>. Consequently,
        the preceding sentence should be ignored. The case of <i>y</i> should not be
        altered; instead, <i>y</i> should be regarded as replaceable.
        </div> Append <i>y</i> to the token being built, and repeat step <a 
href="#x139-15540188">8<!--tex4ht:ref: READER-PLAIN-TOKEN --></a>.
        </li>
        <li class="itemize">If <i>y</i> is a <i>single escape</i> character, then read the next character and call it <i>z</i>
        (but if at end of ﬁle, signal an error instead). Ignore the usual syntax of <i>z</i>
        and pretend it is a <i>constituent</i> whose only attribute is <i>alphabetic</i>. <div class="obsolete"> (If <i>z</i> is
        a lowercase character, leave it alone; do not replace it with the
        corresponding uppercase character.)
        </div> <div class="newer"> For the purposes of <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt>, <i>z</i> is not replaceable.
        </div> Append <i>z</i> to the token being built, and repeat step <a 
href="#x139-15540188">8<!--tex4ht:ref: READER-PLAIN-TOKEN --></a>.
                                                                          

                                                                          
        </li>
        <li class="itemize">If <i>y</i> is a <i>multiple escape</i> character, then go to step <a 
href="#x139-15540219">9<!--tex4ht:ref: READER-MULTI-TOKEN --></a>.
        </li>
        <li class="itemize">If <i>y</i> is an <i>illegal</i> character, signal an error.
        </li>
        <li class="itemize">If <i>y</i> is a <i>terminating macro</i> character, it terminates the token.
        First “unread” the character <i>y</i> (see <tt><a 
href="symbols.html#x187-2604900r900">unread-char</a></tt>), then go to
        step <a 
href="#x139-155402310">10<!--tex4ht:ref: READER-TOKEN-END --></a>.
        </li>
        <li class="itemize">If <i>y</i> is a <i>whitespace</i> character, it terminates the token. First “unread” <i>y</i> if
        appropriate (see <tt><a 
href="symbols.html#x187-2604722r722">read-preserving-whitespace</a></tt>), then go to
        step <a 
href="#x139-155402310">10<!--tex4ht:ref: READER-TOKEN-END --></a>.</li></ul>
   </li>
   <li 
  class="enumerate" id="x139-1554022x9">(At this point a token is being accumulated, and an odd number of <i>multiple
   escape</i> characters have been encountered.) If at end of ﬁle, signal an error.
   Otherwise, read a character (call it <i>y</i>), and perform one of the following
   actions according to its syntactic type: <a 
 id="x139-15540219"></a>
        <ul class="itemize1">
        <li class="itemize">If <i>y</i> is a <i>constituent</i>, <i>macro</i>, or <i>whitespace</i> character, then ignore the
        usual syntax of that character and pretend it is a <i>constituent</i>
        whose only attribute is <i>alphabetic</i>. <div class="obsolete"> (If <i>y</i> is a lowercase character,
        leave it alone; do not replace it with the corresponding uppercase
        character.)
        </div> <div class="newer"> For the purposes of <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt>, <i>y</i> is not replaceable.
        </div> Append <i>y</i> to the token being built, and repeat step <a 
href="#x139-15540219">9<!--tex4ht:ref: READER-MULTI-TOKEN --></a>.
        </li>
        <li class="itemize">If <i>y</i> is a <i>single escape</i> character, then read the next character and call it <i>z</i>
        (but if at end of ﬁle, signal an error instead). Ignore the usual syntax of <i>z</i>
        and pretend it is a <i>constituent</i> whose only attribute is <i>alphabetic</i>. <div class="obsolete"> (If <i>z</i> is
        a lowercase character, leave it alone; do not replace it with the
        corresponding uppercase character.)
        </div> <div class="newer"> For the purposes of <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt>, <i>z</i> is not replaceable.
        </div> Append <i>z</i> to the token being built, and repeat step <a 
href="#x139-15540219">9<!--tex4ht:ref: READER-MULTI-TOKEN --></a>.
        </li>
        <li class="itemize">If <i>y</i> is a <i>multiple escape</i> character, then go to step <a 
href="#x139-15540188">8<!--tex4ht:ref: READER-PLAIN-TOKEN --></a>.
                                                                          

                                                                          
        </li>
        <li class="itemize">If <i>y</i> is an <i>illegal</i> character, signal an error.</li></ul>
   </li>
   <li 
  class="enumerate" id="x139-1554024x10">An entire token has been accumulated. <div class="newer"> X3J13 voted in June 1989 <a 
 id="dx139-1554025"></a>to introduce
   <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt>. If the accumulated token is to be interpreted as a symbol,
   any case conversion of replaceable characters should be performed at this point
   according to the value of the <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> slot of the current readtable
   (the value of <tt>*readtable*</tt>).
   </div> Interpret the token as representing a Lisp object and return that object as the
   result of the read operation, or signal an error if the token is not of legal
   syntax. <div class="newer"> X3J13 voted in March 1989 <a 
 id="dx139-1554026"></a>to specify that implementation-deﬁned
   attributes may be removed from the characters of a symbol token when
   constructing the print name. It is implementation-dependent which attributes
   are removed.
   </div> <a 
 id="x139-155402310"></a></li></ol>
<!--l. 405--><p class="indent" >   As a rule, a <i>single escape</i> character never stands for itself but always serves to
cause the following character to be treated as a simple alphabetic character. A
<i>single escape</i> character can be included in a token only if preceded by another
<i>single escape</i> character.
<!--l. 410--><p class="indent" >   A <i>multiple escape</i> character also never stands for itself. The characters between
a pair of <i>multiple escape</i> characters are all treated as simple alphabetic characters,
except that <i>single escape</i> and <i>multiple escape</i> characters must nevertheless be
preceded by a <i>single escape</i> character to be included.
   <h4 class="subsectionHead"><span class="titlemark">22.1.2   </span> <a 
href="frontmatter.html#QQ2-139-1586" id="x139-155500022.1.2">Parsing of Numbers and Symbols</a></h4>
<!--l. 419--><p class="noindent" >When an extended token is read, it is interpreted as a number or symbol. In
general, the token is interpreted as a number if it satisﬁes the syntax for numbers
speciﬁed in table <a 
href="#x139-15550012">22.2<!--tex4ht:ref: NUMBER-SYNTAX-TABLE --></a>; this is discussed in more detail below.
<!--l. 424--><p class="indent" >   The characters of the extended token may serve various syntactic functions as
shown in table <a 
href="#x139-15560024">22.4<!--tex4ht:ref: Standard-Readtable-Attributes-Table --></a>, but it must be remembered that any character included in a
token under the control of an escape character is treated as <i>alphabetic</i> rather than
according to the attributes shown in the table. One consequence of this rule is
that a whitespace, macro, or escape character will always be treated as
alphabetic within an extended token because such a character cannot
be included in an extended token except under the control of an escape
                                                                          

                                                                          
character.
<!--l. 435--><p class="indent" >   To allow for extensions to the syntax of numbers, a syntax for <i>potential
numbers</i> is deﬁned in Common Lisp that is more general than the actual syntax
for numbers. Any token that is not a potential number and does not consist
entirely of dots will always be taken to be a symbol, now and in the future;
programs may rely on this fact. Any token that is a potential number but does
not ﬁt the actual number syntax deﬁned below is a <i>reserved token</i> and has an
implementation-dependent interpretation; an implementation may signal an error,
quietly treat the token as a symbol, or take some other action. Programmers
should avoid the use of such reserved tokens. (A symbol whose name looks
like a reserved token can always be written using one or more escape
characters.)
<div class="new">
<!--l. 450--><p class="indent" >   Just as <i>bignum</i> is the standard term used by Lisp implementors for very large
integers, and <i>ﬂonum</i> (rhymes with “low hum”) refers to a ﬂoating-point number,
the term <i>potnum</i> has been used widely as an abbreviation for “potential number.”
“Potnum” rhymes with “hot rum.”
</div>
<!--l. 458--><p class="indent" >   A token is a potential number if it satisﬁes the following requirements:
   <div class="table">
                                                                          

                                                                          
<!--l. 461--><p class="indent" >   <a 
 id="x139-15550012"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
 <div class="caption" 
><span class="id">Таблица 22.2: </span><span  
class="content">Actual Syntax of Numbers</span></div><!--tex4ht:label?: x139-15550012 -->
<div class="tabbing">
<i>number</i> ::= <i>integer</i> | <i>ratio</i> | <i>ﬂoating-point-number</i>
<br>                               <i>integer</i> ::=  [<i><i>sign</i></i>]  {<i><i>digit</i></i>}+  [<i><i>decimal-point</i></i>] <br>
<i>ratio</i> ::=  [<i><i>sign</i></i>]  {<i><i>digit</i></i>}+  <tt><a 
href="symbols.html#x187-2604055r55">/</a></tt> {<i><i>digit</i></i>}+ <br><i>ﬂoating-point-number</i> ::= [<i><i>sign</i></i>]  {<i><i>digit</i></i>}*  <i>decimal-point</i> {<i><i>digit</i></i>}+  [<i><i>exponent</i></i>] <br>
                       | [<i><i>sign</i></i>]  {<i><i>digit</i></i>}+  [<i><i>decimal-point</i>  {<i><i>digit</i></i>}*</i>]  <i>exponent</i><br>
<i>sign</i> ::= <tt><a 
href="symbols.html#x187-2604051r51">+</a></tt> | <tt><a 
href="symbols.html#x187-2604054r54">-</a></tt><br> <i>decimal-point</i> ::= <tt>.</tt><br> <i>digit</i> ::= <tt>0</tt> | <tt>1</tt> | <tt>2</tt> | <tt>3</tt> | <tt>4</tt> | <tt>5</tt> | <tt>6</tt> | <tt>7</tt> | <tt>8</tt> | <tt>9</tt><br>
<i>exponent</i> ::= <i>exponent-marker</i> [<i><i>sign</i></i>]  {<i><i>digit</i></i>}+ <br>
<i>exponent-marker</i> ::= <tt>e</tt> | <tt>s</tt> | <tt><a 
href="symbols.html#x187-2604351r351">f</a></tt> | <tt>d</tt> | <tt>l</tt> | <tt>E</tt> | <tt>S</tt> | <tt>F</tt> | <tt>D</tt> | <tt>L</tt><br>
</div>
<!--l. 479--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-15560002" id="x139-15560002"></a></span>
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
      <ul class="itemize1">
      <li class="itemize">It consists entirely of digits, signs (<tt><a 
href="symbols.html#x187-2604051r51">+</a></tt> or <tt><a 
href="symbols.html#x187-2604054r54">-</a></tt>), ratio markers (<tt><a 
href="symbols.html#x187-2604055r55">/</a></tt>), decimal
      points  (<tt>.</tt>),  extension  characters  (<tt>̂</tt> or  <tt>_</tt>),  and  number  markers.  (A
      number marker is a letter. Whether a letter may be treated as a number
      marker depends on context, but no letter that is adjacent to another
      letter may ever be treated as a number marker. Floating-point exponent
      markers are instances of number markers.)
      </li>
      <li class="itemize">It contains at least one digit. (Letters may be considered to be digits,
      depending on the value of <tt>*read-base*</tt>, but only in tokens containing
      no decimal points.)
      </li>
      <li class="itemize">It begins with a digit, sign, decimal point, or extension character.
      </li>
      <li class="itemize">It does not end with a sign.</li></ul>
<!--l. 503--><p class="noindent" >As examples, the following tokens are potential numbers, but they are <i>not</i> actually
numbers as deﬁned below, and so are reserved tokens. (They do indicate some
interesting possibilities for future extensions.)
   <div class="table">
                                                                          

                                                                          
<!--l. 509--><p class="indent" >   <a 
 id="x139-15560013"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
 <div class="caption" 
><span class="id">Таблица 22.3: </span><span  
class="content">Standard Constituent Character Attributes</span></div><!--tex4ht:label?: x139-15560013 -->
<div class="tabular"><table width="100%" class="tabular"><tr><td align="left" > <tt>!</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><span class="math">⟨</span>page<span class="math">⟩</span> </td><td align="left" ><i>illegal</i>     </td><td align="left" ><span class="math">⟨</span>backspace<span class="math">⟩</span></td><td align="left" ><i>illegal</i>                </td>
</tr><tr><td align="left" > <tt>&#x0022;</tt> </td><td align="left" ><i>alphabetic</i> *               </td><td align="left" ><span class="math">⟨</span>return<span class="math">⟩</span></td><td align="left" ><i>illegal</i> *   </td><td align="left" ><span class="math">⟨</span>tab<span class="math">⟩</span>    </td><td align="left" ><i>illegal</i> *              </td>
</tr><tr><td align="left" > <tt>#</tt> </td><td align="left" ><i>alphabetic</i> *               </td><td align="left" ><span class="math">⟨</span>space<span class="math">⟩</span> </td><td align="left" ><i>illegal</i> *   </td><td align="left" ><span class="math">⟨</span>newline<span class="math">⟩</span> </td><td align="left" ><i>illegal</i> *              </td>
</tr><tr><td align="left" > <tt>$</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><span class="math">⟨</span>rubout<span class="math">⟩</span></td><td align="left" ><i>illegal</i>     </td><td align="left" ><span class="math">⟨</span>linefeed<span class="math">⟩</span> </td><td align="left" ><i>illegal</i> *              </td>
</tr><tr><td align="left" > <tt>%</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>.</tt>      </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>alphabetic</i>, <i>dot</i>, <i>decimal point</i></div>
</td></tr><tr><td align="left" > <tt>&#x0026;</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt><a 
href="symbols.html#x187-2604051r51">+</a></tt>      </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>alphabetic</i>, <i>plus sign</i></div>
</td></tr><tr><td align="left" > <tt>&#x2019;</tt> </td><td align="left" ><i>alphabetic</i> *               </td><td align="left" ><tt><a 
href="symbols.html#x187-2604054r54">-</a></tt>      </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>alphabetic</i>, <i>minus sign</i></div>
</td></tr><tr><td align="left" > <tt>(</tt> </td><td align="left" ><i>alphabetic</i> *               </td><td align="left" ><tt><a 
href="symbols.html#x187-2604002r2">*</a></tt>      </td><td align="left" ><i>alphabetic</i></td>
</tr><tr><td align="left" > <tt>)</tt> </td><td align="left" ><i>alphabetic</i> *               </td><td align="left" ><tt><a 
href="symbols.html#x187-2604055r55">/</a></tt>      </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>alphabetic</i>, <i>ratio marker</i></div>
</td></tr><tr><td align="left" > <tt>,</tt> </td><td align="left" ><i>alphabetic</i> *               </td><td align="left" ><tt>@</tt>      </td><td align="left" ><i>alphabetic</i></td>
</tr><tr><td align="left" > <tt>0</tt> </td><td align="left" ><i>alphadigit</i>                </td><td align="left" ><tt>A</tt>, <tt>a</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>1</tt> </td><td align="left" ><i>alphadigit</i>                </td><td align="left" ><tt>B</tt>, <tt>b</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>2</tt> </td><td align="left" ><i>alphadigit</i>                </td><td align="left" ><tt>C</tt>, <tt>c</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>3</tt> </td><td align="left" ><i>alphadigit</i>                </td><td align="left" ><tt>D</tt>, <tt>d</tt>    </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>alphadigit</i>, <i>double-ﬂoat exponent marker</i></div>
</td></tr><tr><td align="left" > <tt>4</tt> </td><td align="left" ><i>alphadigit</i>                </td><td align="left" ><tt>E</tt>, <tt>e</tt>    </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>alphadigit</i>, <i>ﬂoat exponent marker</i></div>
</td></tr><tr><td align="left" > <tt>5</tt> </td><td align="left" ><i>alphadigit</i>                </td><td align="left" ><tt>F</tt>, <tt><a 
href="symbols.html#x187-2604351r351">f</a></tt>    </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>alphadigit</i>, <i>single-ﬂoat exponent marker</i></div>
</td></tr><tr><td align="left" > <tt>6</tt> </td><td align="left" ><i>alphadigit</i>                </td><td align="left" ><tt>G</tt>, <tt>g</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>7</tt> </td><td align="left" ><i>alphadigit</i>                </td><td align="left" ><tt>H</tt>, <tt>h</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>8</tt> </td><td align="left" ><i>alphadigit</i>                </td><td align="left" ><tt>I</tt>, <tt>i</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>9</tt> </td><td align="left" ><i>alphadigit</i>                </td><td align="left" ><tt>J</tt>, <tt>j</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>:</tt> </td><td align="left" ><i>package marker</i>      </td><td align="left" ><tt>K</tt>, <tt>k</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>;</tt> </td><td align="left" ><i>alphabetic</i> *               </td><td align="left" ><tt>L</tt>, <tt>l</tt>    </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>alphadigit</i>, <i>long-ﬂoat exponent marker</i></div>
</td></tr><tr><td align="left" > <tt><a 
href="symbols.html#x187-2604059r59">&#x003C;</a></tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>M</tt>, <tt>m</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt><a 
href="symbols.html#x187-2604061r61">=</a></tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>N</tt>, <tt>n</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt><a 
href="symbols.html#x187-2604062r62">&#x003E;</a></tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>O</tt>, <tt>o</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>?</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>P</tt>, <tt>p</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>[</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>Q</tt>, <tt>q</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>\</tt> </td><td align="left" ><i>alphabetic</i> *               </td><td align="left" ><tt>R</tt>, <tt>r</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>]</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>S</tt>, <tt>s</tt>    </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>alphadigit</i>, <i>short-ﬂoat exponent marker</i></div>
</td></tr><tr><td align="left" > <tt>̂</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>T</tt>, <tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>_</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>U</tt>, <tt>u</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>‘</tt> </td><td align="left" ><i>alphabetic</i> *               </td><td align="left" ><tt>V</tt>, <tt>v</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>{</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>W</tt>, <tt>w</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>|</tt> </td><td align="left" ><i>alphabetic</i> *               </td><td align="left" ><tt>X</tt>, <tt>x</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>}</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>Y</tt>, <tt>y</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" > <tt>~</tt> </td><td align="left" ><i>alphabetic</i>                </td><td align="left" ><tt>Z</tt>, <tt>z</tt>    </td><td align="left" ><i>alphadigit</i></td>
</tr><tr><td align="left" >    </td></tr></table></div>
<!--l. 553--><p class="noindent" >These interpretations apply only to characters whose syntactic type is <i>constituent</i>. Entries
marked with an asterisk are normally shadowed because the characters are of syntactic type
<i>whitespace</i>, <i>macro</i>, <i>single escape</i>, or <i>multiple escape</i>. An <i>alphadigit</i> character is interpreted as a
digit if it is a valid digit in the radix speciﬁed by <tt>*read-base*</tt>; otherwise it is alphabetic.
Characters with an <i>illegal</i> attribute can never appear in a token except under the control of an
escape character.
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
   <div class="table">
                                                                          

                                                                          
<!--l. 568--><p class="indent" >   <a 
 id="x139-15560024"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
 <div class="caption" 
><span class="id">Таблица 22.4: </span><span  
class="content">Свойства стандартных символов</span></div><!--tex4ht:label?: x139-15560024 -->
<div class="tabular"><table width="100%" class="tabular"><tr><td align="left" > <tt>!</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><span class="math">⟨</span>page<span class="math">⟩</span> </td><td align="left" ><i>недопустимый</i>        </td><td align="left" ><span class="math">⟨</span>backspace<span class="math">⟩</span></td><td align="left" ><i>недопустимый</i>                                          </td>
</tr><tr><td align="left" > <tt>&#x0022;</tt> </td><td align="left" ><i>алфавитный</i> *          </td><td align="left" ><span class="math">⟨</span>return<span class="math">⟩</span></td><td align="left" ><i>недопустимый</i> *      </td><td align="left" ><span class="math">⟨</span>tab<span class="math">⟩</span>    </td><td align="left" ><i>недопустимый</i> *                                          </td>
</tr><tr><td align="left" > <tt>#</tt> </td><td align="left" ><i>алфавитный</i> *          </td><td align="left" ><span class="math">⟨</span>space<span class="math">⟩</span> </td><td align="left" ><i>недопустимый</i> *      </td><td align="left" ><span class="math">⟨</span>newline<span class="math">⟩</span> </td><td align="left" ><i>недопустимый</i> *                                          </td>
</tr><tr><td align="left" > <tt>$</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><span class="math">⟨</span>rubout<span class="math">⟩</span></td><td align="left" ><i>недопустимый</i>        </td><td align="left" ><span class="math">⟨</span>linefeed<span class="math">⟩</span> </td><td align="left" ><i>недопустимый</i> *                                          </td>
</tr><tr><td align="left" > <tt>%</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>.</tt>      </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>алфавитный</i>, <i>точка</i>, <i>разделитель десятичной части</i></div>
</td></tr><tr><td align="left" > <tt>&#x0026;</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt><a 
href="symbols.html#x187-2604051r51">+</a></tt>      </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>алфавитный</i>, <i>знак плюс</i></div>
</td></tr><tr><td align="left" > <tt>&#x2019;</tt> </td><td align="left" ><i>алфавитный</i> *          </td><td align="left" ><tt><a 
href="symbols.html#x187-2604054r54">-</a></tt>      </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>алфавитный</i>, <i>знак минус</i></div>
</td></tr><tr><td align="left" > <tt>(</tt> </td><td align="left" ><i>алфавитный</i> *          </td><td align="left" ><tt><a 
href="symbols.html#x187-2604002r2">*</a></tt>      </td><td align="left" ><i>алфавитный</i>           </td>
</tr><tr><td align="left" > <tt>)</tt> </td><td align="left" ><i>алфавитный</i> *          </td><td align="left" ><tt><a 
href="symbols.html#x187-2604055r55">/</a></tt>      </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>алфавитный</i>, <i>маркер дроби</i></div>
</td></tr><tr><td align="left" > <tt>,</tt> </td><td align="left" ><i>алфавитный</i> *          </td><td align="left" ><tt>@</tt>      </td><td align="left" ><i>алфавитный</i>           </td>
</tr><tr><td align="left" > <tt>0</tt> </td><td align="left" ><i>алфавитно-цифровой</i> </td><td align="left" ><tt>A</tt>, <tt>a</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>1</tt> </td><td align="left" ><i>алфавитно-цифровой</i> </td><td align="left" ><tt>B</tt>, <tt>b</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>2</tt> </td><td align="left" ><i>алфавитно-цифровой</i> </td><td align="left" ><tt>C</tt>, <tt>c</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>3</tt> </td><td align="left" ><i>алфавитно-цифровой</i> </td><td align="left" ><tt>D</tt>, <tt>d</tt>    </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>алфавитно-цифровой</i>, <i>маркер экспоненты для двойного с плавающей точкой</i></div>
</td></tr><tr><td align="left" > <tt>4</tt> </td><td align="left" ><i>алфавитно-цифровой</i> </td><td align="left" ><tt>E</tt>, <tt>e</tt>    </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>алфавитно-цифровой</i>, <i>маркер экспоненты для числа с плавающей точкой</i></div>
</td></tr><tr><td align="left" > <tt>5</tt> </td><td align="left" ><i>алфавитно-цифровой</i> </td><td align="left" ><tt>F</tt>, <tt><a 
href="symbols.html#x187-2604351r351">f</a></tt>    </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>алфавитно-цифровой</i>, <i>маркер экспоненты для одинарного с плавающей точкой</i></div>
</td></tr><tr><td align="left" > <tt>6</tt> </td><td align="left" ><i>алфавитно-цифровой</i> </td><td align="left" ><tt>G</tt>, <tt>g</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>7</tt> </td><td align="left" ><i>алфавитно-цифровой</i> </td><td align="left" ><tt>H</tt>, <tt>h</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>8</tt> </td><td align="left" ><i>алфавитно-цифровой</i> </td><td align="left" ><tt>I</tt>, <tt>i</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>9</tt> </td><td align="left" ><i>алфавитно-цифровой</i> </td><td align="left" ><tt>J</tt>, <tt>j</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>:</tt> </td><td align="left" ><i>package marker</i>      </td><td align="left" ><tt>K</tt>, <tt>k</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>;</tt> </td><td align="left" ><i>алфавитный</i> *          </td><td align="left" ><tt>L</tt>, <tt>l</tt>    </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>алфавитно-цифровой</i>, <i>маркер экспоненты для длинного с плавающей точкой</i></div>
</td></tr><tr><td align="left" > <tt><a 
href="symbols.html#x187-2604059r59">&#x003C;</a></tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>M</tt>, <tt>m</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt><a 
href="symbols.html#x187-2604061r61">=</a></tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>N</tt>, <tt>n</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt><a 
href="symbols.html#x187-2604062r62">&#x003E;</a></tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>O</tt>, <tt>o</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>?</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>P</tt>, <tt>p</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>[</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>Q</tt>, <tt>q</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>\</tt> </td><td align="left" ><i>алфавитный</i> *          </td><td align="left" ><tt>R</tt>, <tt>r</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>]</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>S</tt>, <tt>s</tt>    </td><td align="left" colspan="3"><div class="multicolumn"  style="white-space:nowrap; text-align:left;"><i>алфавитно-цифровой</i>, <i>маркер экспоненты для короткого с плавающей точкой</i></div>
</td></tr><tr><td align="left" > <tt>̂</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>T</tt>, <tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>_</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>U</tt>, <tt>u</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>‘</tt> </td><td align="left" ><i>алфавитный</i> *          </td><td align="left" ><tt>V</tt>, <tt>v</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>{</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>W</tt>, <tt>w</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>|</tt> </td><td align="left" ><i>алфавитный</i> *          </td><td align="left" ><tt>X</tt>, <tt>x</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>}</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>Y</tt>, <tt>y</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" > <tt>~</tt> </td><td align="left" ><i>алфавитный</i>           </td><td align="left" ><tt>Z</tt>, <tt>z</tt>    </td><td align="left" ><i>алфавитно-цифровой</i></td>
</tr><tr><td align="left" >    </td></tr></table>
</div>
<!--l. 622--><p class="noindent" >These interpretations apply only to characters whose syntactic type is <i>constituent</i>. Entries
marked with an asterisk are normally shadowed because the characters are of syntactic type
<i>whitespace</i>, <i>macro</i>, <i>single escape</i>, or <i>multiple escape</i>. An <i>alphadigit</i> character is interpreted as a
digit if it is a valid digit in the radix speciﬁed by <tt>*read-base*</tt>; otherwise it is alphabetic.
Characters with an <i>illegal</i> attribute can never appear in a token except under the control of an
escape character.
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
<div class="lisp">
<!--l. 636--><p class="indent" >   <div class="tabbing">
1b5000           777777q         1.7J               -3/4+6.7J       12/25/83
   <br>        27̂19            3̂4/5            6//7              3.1.2.6           ̂-43̂<br>
3.141_592_653_589_793_238_4               -3.7+2.6i-6.17j+19.6k<br>
<!--l. 641--><p class="noindent" ></div>
<!--l. 641--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-155700022.1.2" id="x139-155700022.1.2"></a></span>
<!--l. 641--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-155800022.1.2" id="x139-155800022.1.2"></a></span>
</div>
<!--l. 642--><p class="indent" >   The following tokens are <i>not</i> potential numbers but are always treated as
symbols: <div class="lisp"><div class="tabbing">
/                  /5                 +                  1+                1-
   <br>           foo+              ab.cd             _                  ̂                  ̂/-<br>
<!--l. 648--><p class="noindent" ></div>
<!--l. 648--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-155900022.1.2" id="x139-155900022.1.2"></a></span>
<!--l. 648--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-156000022.1.2" id="x139-156000022.1.2"></a></span>
</div>
<!--l. 649--><p class="indent" >   The following tokens are potential numbers if the value of <tt>*read-base*</tt> is <tt>16</tt>
(an abnormal situation), but they are always treated as symbols if the value of
<tt>*read-base*</tt> is <tt>10</tt> (the usual value): <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
bad-face         25-dec-83        a/b               fad_cafe        f̂
   <br>
<!--l. 656--><p class="noindent" ></div>
<!--l. 656--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-156100022.1.2" id="x139-156100022.1.2"></a></span>
<!--l. 656--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-156200022.1.2" id="x139-156200022.1.2"></a></span>
</div>
<!--l. 657--><p class="indent" >   It is possible for there to be an ambiguity as to whether a letter should be
treated as a digit or as a number marker. In such a case, the letter is always
treated as a digit rather than as a number marker.
<!--l. 662--><p class="indent" >   Note that the printed representation for a potential number may not
contain any escape characters. An escape character robs the following
character of all syntactic qualities, forcing it to be strictly alphabetic and
therefore unsuitable for use in a potential number. For example, all of
the following representations are interpreted as symbols, not numbers:
<div class="lisp"><div class="tabbing">
\256   25\64   1.0\E6   |100|   3\.14159   |3/4|   3\/4   5||
   <br>
<!--l. 670--><p class="noindent" ></div>
<!--l. 670--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-156300022.1.2" id="x139-156300022.1.2"></a></span>
<!--l. 670--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-156400022.1.2" id="x139-156400022.1.2"></a></span>
</div>
<!--l. 671--><p class="indent" >   In each case, removing the escape character(s) would allow the token to be
treated as a number.
                                                                          

                                                                          
<!--l. 674--><p class="indent" >   If a potential number can in fact be interpreted as a number according to the
BNF syntax in table <a 
href="#x139-15550012">22.2<!--tex4ht:ref: NUMBER-SYNTAX-TABLE --></a>, then a number object of the appropriate type is
constructed and returned. It should be noted that in a given implementation it
may be that not all tokens conforming to the actual syntax for numbers can
actually be converted into number objects. For example, specifying too large or
too small an exponent for a ﬂoating-point number may make the number
impossible to represent in the implementation. Similarly, a ratio with denominator
zero (such as <tt>-35/000</tt>) cannot be represented in <i>any</i> implementation. In any such
circumstance where a token with the syntax of a number cannot be converted to
an internal number object, an error is signaled. (On the other hand, an
error must not be signaled for specifying too many signiﬁcant digits for a
ﬂoating-point number; an appropriately truncated or rounded value should be
produced.)
<!--l. 691--><p class="indent" >   There is an omission in the syntax of numbers as described in table <a 
href="#x139-15550012">22.2<!--tex4ht:ref: NUMBER-SYNTAX-TABLE --></a>, in
that the syntax does not account for the possible use of letters as digits. The radix
used for reading integers and ratios is normally decimal. However, this radix is
actually determined by the value of the variable <tt>*read-base*</tt>, whose initial value
is <tt>10</tt>. <tt>*read-base*</tt> may take on any integral value between <tt>2</tt> and <tt>36</tt>; let this
value be <i>n</i>. Then a token <i>x</i> is interpreted as an integer or ratio in base <i>n</i> if it
could be properly so interpreted in the syntax <tt>#<i>n</i>R<i>x</i></tt> (see section <a 
href="#x139-160700022.1.4">22.1.4<!--tex4ht:ref: SHARP-SIGN-MACRO-CHARACTER-SECTION --></a>). So, for
example, if the value of <tt>*read-base*</tt> is <tt>16</tt>, then the printed representation
<div class="lisp"><div class="tabbing">
(a small face in a bad place)
   <br>
<!--l. 707--><p class="noindent" ></div>
<!--l. 707--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-156500022.1.2" id="x139-156500022.1.2"></a></span>
<!--l. 707--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-156600022.1.2" id="x139-156600022.1.2"></a></span>
</div>
<!--l. 708--><p class="indent" >   would be interpreted as if the following representation had been read with
<tt>*read-base*</tt> set to <tt>10</tt>: <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(10 small 64206 in 10 2989 place)
   <br>
<!--l. 712--><p class="noindent" ></div>
<!--l. 712--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-156700022.1.2" id="x139-156700022.1.2"></a></span>
<!--l. 712--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-156800022.1.2" id="x139-156800022.1.2"></a></span>
</div>
<!--l. 713--><p class="indent" >   because four of the seven tokens in the list can be interpreted as hexadecimal
numbers. This facility is intended to be used in reading ﬁles of data that for some
reason contain numbers not in decimal radix; it may also be used for reading
programs written in Lisp dialects (such as MacLisp) whose default number
radix is not decimal. Non-decimal constants in Common Lisp programs or
portable Common Lisp data ﬁles should be written using <tt>#O</tt>, <tt>#X</tt>, <tt>#B</tt>, or <tt>#<i>n</i>R</tt>
syntax.
<!--l. 722--><p class="indent" >   When <tt>*read-base*</tt> has a value greater than <tt>10</tt>, an ambiguity is introduced
into the actual syntax for numbers because a letter can serve as either a digit or
an exponent marker; a simple example is <tt>1E0</tt> when the value of <tt>*read-base*</tt> is
<tt>16</tt>. The ambiguity is resolved in accordance with the general principle
that interpretation as a digit is preferred to interpretation as a number
marker. The consequence in this case is that if a token can be interpreted as
either an integer or a ﬂoating-point number, then it is taken to be an
integer.
<!--l. 732--><p class="indent" >   If a token consists solely of dots (with no escape characters), then an error is
signaled, except in one circumstance: if the token is a single dot and occurs in a
situation appropriate to “dotted list” syntax, then it is accepted as a part
of such syntax. Signaling an error catches not only misplaced dots in
dotted list syntax but also lists that were truncated by <tt>*print-length*</tt>
cutoﬀ, because such lists end with a three-dot sequence (<tt>...</tt>). Examples:
<div class="lisp"><div class="tabbing">
(a . b)                 ;A dotted pair of <tt>a</tt> and <tt>b</tt>
                                                                          

                                                                          
   <br>      (a.b)                   ;A list of one element, the symbol named <tt>a.b</tt><br>
(a. b)                  ;A list of two elements <tt>a.</tt> and <tt>b</tt><br>
(a .b)                  ;A list of two elements <tt>a</tt> and <tt>.b</tt><br>
(a \. b)               ;A list of three elements <tt>a</tt>, <tt>.</tt>, and <tt>b</tt><br>
(a |.| b)               ;A list of three elements <tt>a</tt>, <tt>.</tt>, and <tt>b</tt><br>
(a \... b)              ;A list of three elements <tt>a</tt>, <tt>...</tt>, and <tt>b</tt><br>
(a |...| b)              ;A list of three elements <tt>a</tt>, <tt>...</tt>, and <tt>b</tt><br>
(a b . c)               ;A dotted list of <tt>a</tt> and <tt>b</tt> with <tt>c</tt> at the end<br>
.iot                     ;The symbol whose name is <tt>.iot</tt><br>
(. b)                   ;Illegal; an error is signaled<br>
(a .)                    ;Illegal; an error is signaled<br>
(a .. b)                ;Illegal; an error is signaled<br>
(a . . b)               ;Illegal; an error is signaled<br>
(a b c ...)             ;Illegal; an error is signaled<br>
<!--l. 757--><p class="noindent" ></div>
<!--l. 757--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-156900022.1.2" id="x139-156900022.1.2"></a></span>
<!--l. 757--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-157000022.1.2" id="x139-157000022.1.2"></a></span>
</div>
<!--l. 759--><p class="indent" >   In all other cases, the token is construed to be the name of a symbol. If there
are any package markers (colons) in the token, they divide the token into pieces
used to control the lookup and creation of the symbol.
<div class="obsolete">
<!--l. 765--><p class="indent" >   If there is a single package marker, and it occurs at the beginning of the token,
then the token is interpreted as a keyword, that is, a symbol in the <tt>keyword</tt>
package. The part of the token after the package marker must not have the syntax
of a number.
<!--l. 770--><p class="indent" >   If there is a single package marker not at the beginning or end of the token,
then it divides the token into two parts. The ﬁrst part speciﬁes a package; the
second part is the name of an external symbol available in that package. Neither
of the two parts may have the syntax of a number.
<!--l. 776--><p class="indent" >   If there are two adjacent package markers not at the beginning or end of the
token, then they divide the token into two parts. The ﬁrst part speciﬁes a
package; the second part is the name of a symbol within that package (possibly
an internal symbol). Neither of the two parts may have the syntax of a
                                                                          

                                                                          
number.
</div>
<div class="new">
<!--l. 784--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx139-1570001"></a>to clarify that, in the situations described in the
preceding three paragraphs, the restriction on the syntax of the parts should be
strengthened: none of the parts may have the syntax of even a <i>potential</i> number.
Tokens such as <tt>:3600</tt>, <tt>:1/2</tt>, and <tt>editor:3.14159</tt> were already ruled out; this
clariﬁcation further declares that such tokens as <tt>:2̂ 3</tt>, <tt>compiler:1.7J</tt>, and
<tt>Christmas:12/25/83</tt> are also in error and therefore should not be used in
portable programs. Implementations may diﬀer in their treatment of such
package-marked potential numbers.
</div>
<!--l. 797--><p class="indent" >   If a symbol token contains no package markers, then the entire token is the
name of the symbol. The symbol is looked up in the default package, which is the
value of the variable <tt><a 
href="symbols.html#x187-2604023r23">*package*</a></tt>.
<!--l. 802--><p class="indent" >   All other patterns of package markers, including the cases where there are
more than two package markers or where a package marker appears at the end of
the token, at present do not mean anything in Common Lisp (see chapter <a 
href="xpack.html#x72-89900011">11<!--tex4ht:ref: XPACK --></a>). It
is therefore currently an error to use such patterns in a Common Lisp
program. The valid patterns for tokens may be summarized as follows:
<div class="tabbing">
<i>nnnnn</i>               a number
   <br>                             <i>xxxxx</i>                a symbol in the current package<br>
<tt>:<i>xxxxx</i></tt>         a symbol in the keyword package<br>
<tt><i>ppppp</i>:<i>xxxxx</i></tt>    an external symbol in the <i>ppppp</i> package<br>
<tt><i>ppppp</i>::<i>xxxxx</i></tt>   a (possibly internal) symbol in the <i>ppppp</i> package<br>
<!--l. 815--><p class="noindent" ></div>
<!--l. 815--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-157100022.1.2" id="x139-157100022.1.2"></a></span>
   where <i>nnnnn</i> has the syntax of a number, and <i>xxxxx</i> and <i>ppppp</i> do not have
the syntax of a number.
<div class="new">
<!--l. 820--><p class="indent" >   In accordance with the X3J13 decision noted above <a 
 id="dx139-1571001"></a>, <i>xxxxx</i> and <i>ppppp</i> may not
have the syntax of even a potential number.
</div>
                                                                          

                                                                          
<div class="defun">
<!--l. 825--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1571002"></a><a 
 id="x139-1571003r633"></a> <b>*read-base*</b>
</div>
<!--l. 828--><p class="indent" >   The value of <tt>*read-base*</tt> controls the interpretation of tokens by <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> as
being integers or ratios. Its value is the radix in which integers and ratios are to
be read; the value may be any integer from <tt>2</tt> to <tt>36</tt> (inclusive) and is normally <tt>10</tt>
(decimal radix). Its value aﬀects only the reading of integers and ratios. In
particular, ﬂoating-point numbers are always read in decimal radix. The value of
<tt>*read-base*</tt> does not aﬀect the radix for rational numbers whose radix is
explicitly indicated by <tt>#O</tt>, <tt>#X</tt>, <tt>#B</tt>, or <tt>#<i>n</i>R</tt> syntax or by a trailing decimal
point.
<!--l. 839--><p class="indent" >   Care should be taken when setting <tt>*read-base*</tt> to a value larger than <tt>10</tt>,
because tokens that would normally be interpreted as symbols may be
interpreted as numbers instead. For example, with <tt>*read-base*</tt> set to <tt>16</tt>
(hexadecimal radix), variables with names such as <tt>a</tt>, <tt>b</tt>, <tt><a 
href="symbols.html#x187-2604351r351">f</a></tt>, <tt>bad</tt>, and <tt>face</tt>
will be treated by the reader as numbers (with decimal values 10, 11,
15, 2989, and 64206, respectively). The ability to alter the input radix
is provided in Common Lisp primarily for the purpose of reading data
ﬁles in special operatorats, rather than for the purpose of altering the
default radix in which to read programs. The user is strongly encouraged to
use <tt>#O</tt>, <tt>#X</tt>, <tt>#B</tt>, or <tt>#<i>n</i>R</tt> syntax when notating non-decimal constants in
programs.
</div>
<div class="defun">
<!--l. 853--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1571004"></a><a 
 id="x139-1571005r634"></a> <b>*read-suppress*</b>
</div>
<!--l. 856--><p class="indent" >   When the value of <tt>*read-suppress*</tt> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, the Lisp reader operates
normally. When it is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, then most of the interesting operations of the reader
are suppressed; input characters are parsed, but much of what is read is not
interpreted.
<!--l. 861--><p class="indent" >   The primary purpose of <tt>*read-suppress*</tt> is to support the operation of the
read-time conditional constructs <tt>#+</tt> and <tt>#-</tt> (see section <a 
href="#x139-160700022.1.4">22.1.4<!--tex4ht:ref: SHARP-SIGN-MACRO-CHARACTER-SECTION --></a>). It is important
for these constructs to be able to skip over the printed representation of a Lisp
expression despite the possibility that the syntax of the skipped expression may
                                                                          

                                                                          
not be entirely legal for the current implementation; this is because a
primary application of <tt>#+</tt> and <tt>#-</tt> is to allow the same program to be shared
among several Lisp implementations despite small incompatibilities of
syntax.
<!--l. 871--><p class="indent" >   A non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> value of <tt>*read-suppress*</tt> has the following speciﬁc eﬀects on the
Common Lisp reader:
      <ul class="itemize1">
      <li class="itemize">All  extended  tokens  are  completely  uninterpreted.  It  matters  not
      whether the token looks like a number, much less like a valid number;
      the pattern of package markers also does not matter. An extended
      token is simply discarded and treated as if it were <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>; that is, reading
      an extended token when <tt>*read-suppress*</tt> is non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> simply returns
      <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>. (One consequence of this is that the error concerning improper
      dotted-list syntax will not be signaled.)
      </li>
      <li class="itemize">Any standard <tt>#</tt> macro-character construction that requires, permits,
      or disallows an inﬁx numerical argument, such as <tt>#<i>n</i>R</tt>, will not enforce
      any constraint on the presence, absence, or value of such an argument.
      </li>
      <li class="itemize">The <tt>#\</tt> construction always produces the value <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>. It will not signal
      an error even if an unknown character name is seen.
      </li>
      <li class="itemize">Each  of  the  <tt>#B</tt>,  <tt>#O</tt>,  <tt>#X</tt>,  and  <tt>#R</tt> constructions  always  scans  over  a
      following token and produces the value <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>. It will not signal an error
      even if the token does not have the syntax of a rational number.
      </li>
      <li class="itemize">The <tt>#*</tt> construction always scans over a following token and produces
      the value <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>. It will not signal an error even if the token does not
      consist solely of the characters <tt>0</tt> and <tt>1</tt>.</li></ul>
      <ul class="itemize1">
      <li class="itemize">The <tt>#.</tt> construction reads the following form (in suppressed mode, of
      course) but does not evaluate it. The form is discarded and <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> is
      produced.</li></ul>
                                                                          

                                                                          
      <ul class="itemize1">
      <li class="itemize">Each of the <tt>#A</tt>, <tt>#S</tt>, and <tt>#:</tt> constructions reads the following form (in
      suppressed mode, of course) but does not interpret it in any way; it
      need not even be a list in the case of <tt>#S</tt>, or a symbol in the case of <tt>#:</tt>.
      The form is discarded and <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> is produced.
      </li>
      <li class="itemize">The <tt>#=</tt> construction is totally ignored. It does not read a following
      form. It produces no object, but is treated as whitespace.
      </li>
      <li class="itemize">The <tt>##</tt> construction always produces <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>.</li></ul>
<!--l. 929--><p class="noindent" >Note that, no matter what the value of <tt>*read-suppress*</tt>, parentheses still continue
to delimit (and construct) lists; the <tt>#(</tt> construction continues to delimit vectors;
and comments, strings, and the quote and backquote constructions continue to be
interpreted properly. Furthermore, such situations as <tt>&#x2019;)</tt>, <tt>#&#x003C;</tt>, <tt>#)</tt>, and <tt>#<span class="math">⟨</span>space<span class="math">⟩</span></tt>
continue to signal errors.
<!--l. 937--><p class="indent" >   In some cases, it may be appropriate for a user-written macro-character
deﬁnition to check the value of <tt>*read-suppress*</tt> and to avoid certain
computations or side eﬀects if its value is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>.
</div>
<div class="defun">
<!--l. 942--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1571006"></a><a 
 id="x139-1571007r635"></a> <b>*read-eval*</b>
</div>
<!--l. 945--><p class="indent" >   Default value of <tt>*read-eval*</tt> is <tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>. If <tt>*read-eval*</tt> is false, the <tt>#.</tt> reader
macro signals an error.
<!--l. 948--><p class="indent" >   Printing is also aﬀected. If <tt>*read-eval*</tt> is false and <tt>*print-readably*</tt> is
true, any <tt><a 
href="symbols.html#x187-2604689r689">print-object</a></tt> method that would otherwise output a <tt>#.</tt> reader
macro must either output something diﬀerent or signal an error of type
<tt>print-not-readable</tt>.
<!--l. 953--><p class="indent" >   Binding <tt>*read-eval*</tt> to <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> is useful when reading data that came from an
untrusted source, such as a network or a user-supplied data ﬁle; it prevents the <tt>#.</tt>
reader macro from being exploited as a “Trojan horse” to cause arbitrary forms to
be evaluated.
</div>
                                                                          

                                                                          
<!--l. 959--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">22.1.3   </span> <a 
href="frontmatter.html#QQ2-139-1606" id="x139-157200022.1.3">Macro Characters</a></h4>
<a 
 id="dx139-1572001"></a>
<a 
 id="dx139-1572002"></a>
<!--l. 963--><p class="noindent" >If the reader encounters a macro character, then the function associated
with that macro character is invoked and may produce an object to be
returned. This function may read following characters in the stream in
whatever syntax it likes (it may even call <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> recursively) and return the
object represented by that syntax. Macro characters may or may not be
recognized, of course, when read as part of other special syntaxes (such as for
strings).
<!--l. 971--><p class="indent" >   The reader is therefore organized into two parts: the basic dispatch loop, which
also distinguishes symbols and numbers, and the collection of macro characters.
Any character can be reprogrammed as a macro character; this is a means by
which the reader can be extended. The macro characters normally deﬁned are as
follows: <div class="flushdesc">
      <ul><li><b>
<tt>(</tt> </b></li>The left-parenthesis character initiates reading of a pair or list. The
      function <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> is called recursively to read successive objects until a right
      parenthesis is found to be next in the input stream. A list of the objects
      read is returned. Thus the input sequence <div class="lisp"><div class="tabbing">
      (a b c)
      <br>
      <!--l. 984--><p class="noindent" ></div>
      <!--l. 984--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-157300022.1.3" id="x139-157300022.1.3"></a></span>
      <!--l. 984--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-157400022.1.3" id="x139-157400022.1.3"></a></span>
</div>
                                                                          

                                                                          
      <!--l. 985--><p class="noindent" >is read as a list of three objects (the symbols <tt>a</tt>, <tt>b</tt>, and <tt>c</tt>). The right
      parenthesis need not immediately follow the printed representation of the
      last object; whitespace characters and comments may precede it. This can
      be useful for putting one object on each line and making it easy to add new
      objects: <div class="lisp"><div class="tabbing">
      (defun traﬃc-light (color)
      <br>                                                                             (case color<br>
               (green)<br>                                       (red (stop))<br>
               (amber (accelerate))     ;Insert more colors after this line<br>
               ))<br>
      <!--l. 998--><p class="noindent" ></div>
      <!--l. 998--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-157500022.1.3" id="x139-157500022.1.3"></a></span>
      <!--l. 998--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-157600022.1.3" id="x139-157600022.1.3"></a></span>
</div>
      <!--l. 1000--><p class="noindent" >It may be that <i>no</i> objects precede the right parenthesis, as in <tt>()</tt> or <tt>( )</tt>; this
      reads as a list of zero objects (the empty list).
      <!--l. 1003--><p class="noindent" >If a token that is just a dot, not preceded by an escape character, is read
      after some object, then exactly one more object must follow the dot,
      possibly followed by whitespace, followed by the right parenthesis:
      <div class="lisp"><div class="tabbing">
      (a b c . d)
      <br>
      <!--l. 1011--><p class="noindent" ></div>
                                                                          

                                                                          
      <!--l. 1011--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-157700022.1.3" id="x139-157700022.1.3"></a></span>
      <!--l. 1011--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-157800022.1.3" id="x139-157800022.1.3"></a></span>
</div>
      <!--l. 1012--><p class="noindent" >This means that the <i>cdr</i> of the last pair in the list is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, but rather the
      object whose representation followed the dot. The above example might
      have been the result of evaluating <div class="lisp"><div class="tabbing">
      (cons &#x2019;a (cons &#x2019;b (cons &#x2019;c &#x2019;d))) <span class="math"> ⇒</span> (a b c . d)
      <br>
      <!--l. 1017--><p class="noindent" ></div>
      <!--l. 1017--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-157900022.1.3" id="x139-157900022.1.3"></a></span>
      <!--l. 1017--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-158000022.1.3" id="x139-158000022.1.3"></a></span>
</div>
      <!--l. 1018--><p class="noindent" >Similarly, we have <div class="lisp"><div class="tabbing">
      (cons &#x2019;znets &#x2019;wolq-zorbitan) <span class="math"> ⇒</span> (znets . wolq-zorbitan)
      <br>
      <!--l. 1021--><p class="noindent" ></div>
      <!--l. 1021--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-158100022.1.3" id="x139-158100022.1.3"></a></span>
                                                                          

                                                                          
      <!--l. 1021--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-158200022.1.3" id="x139-158200022.1.3"></a></span>
</div>
      <!--l. 1022--><p class="noindent" >It is permissible for the object following the dot to be a list: <div class="lisp"><div class="tabbing">
      (a b c d . (e f . (g)))
      <br>
      <!--l. 1025--><p class="noindent" ></div>
      <!--l. 1025--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-158300022.1.3" id="x139-158300022.1.3"></a></span>
      <!--l. 1025--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-158400022.1.3" id="x139-158400022.1.3"></a></span>
</div>
      <!--l. 1026--><p class="noindent" >is the same as <div class="lisp"><div class="tabbing">
      (a b c d e f g)
      <br>
      <!--l. 1029--><p class="noindent" ></div>
      <!--l. 1029--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-158500022.1.3" id="x139-158500022.1.3"></a></span>
      <!--l. 1029--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-158600022.1.3" id="x139-158600022.1.3"></a></span>
</div>
      <!--l. 1030--><p class="noindent" >but a list following a dot is a non-standard form that <tt><a 
href="symbols.html#x187-2604688r688">print</a></tt> will never
      produce.
                                                                          

                                                                          
      <li><b>
<tt>)</tt> </b></li>The right-parenthesis character is part of various constructs (such as the syntax
      for lists) using the left-parenthesis character and is invalid except when used
      in such a construct.
      <!--l. 1040--><p class="noindent" >
                                                                          

                                                                          
      <li><b>
<tt>&#x2019;</tt> </b></li>The single-quote (accent acute) character provides an abbreviation
      to make it easier to put constants in programs. The form <tt>&#x2019;<i>foo</i></tt>
      reads the same as <tt>(quote <i>foo</i>)</tt>: a list of the symbol <tt><a 
href="symbols.html#x187-2604705r705">quote</a></tt> and
      <i>foo</i>.
      <li><b>
<tt>;</tt> </b></li>Semicolon is used to write comments. <a 
 id="dx139-1586001"></a>The semicolon and all characters up to
      and including the next newline are ignored. Thus a comment can be put
      at the end of any line without aﬀecting the reader. (A comment
      will terminate a token, but a newline would terminate the token
      anyway.)
      <!--l. 1061--><p class="noindent" >There is no functional diﬀerence between using one semicolon and using
      more than one, but the conventions shown here are in common
      use.
<div class="lisp">
      <!--l. 1065--><p class="noindent" ><div class="tabbing">
      ;;;; COMMENT-EXAMPLE function.
      <br>             ;;; This function is useless except to demonstrate comments.<br>
           ;;; (Actually, this example is much too cluttered with them.)<br>
           <br>        (defun comment-example (x y)      ;X is anything; Y is an a-list.<br>
             (cond ((listp x) x)             ;If X is a list, use that.<br>
                   ;; X is now not a list. There are two other cases.<br>
                   ((symbolp x)<br>               ;; Look up a symbol in the a-list.<br>
                    (cdr (assoc x y)))       ;Remember, (cdr <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>) is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>.<br>
                   ;; Do this when all else fails:<br>
                   (t (cons x                ;Add x to a default list.<br>
                            &#x2019;((lisp t)       ;LISP is okay.<br>
                              (fortran nil)  ;FORTRAN is not.<br>
                              (pl/i -500)    ;Note that you can put comments in<br>
                              (ada .001)     ; &#x0022;data&#x0022; as well as in &#x0022;programs&#x0022;.<br>
                              ;; COBOL??<br>
                              (teco -1.0e9))))))<br>
      <!--l. 1084--><p class="noindent" ></div>
                                                                          

                                                                          
      <!--l. 1084--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-158700022.1.3" id="x139-158700022.1.3"></a></span>
      <!--l. 1084--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-158800022.1.3" id="x139-158800022.1.3"></a></span>
</div>
      <!--l. 1085--><p class="noindent" >In this example, comments may begin with one to four semicolons.
           <ul class="itemize1">
           <li class="itemize">Single-semicolon comments are all aligned to the same column at
           the right; usually each comment concerns only the code it is next
           to. Occasionally a comment is long enough to occupy two or three
           lines; in this case, it is conventional to indent the continued lines
           of the comment one space (after the semicolon).
           </li>
           <li class="itemize">Double-semicolon comments are aligned to the level of indentation
           of the code. A space conventionally follows the two semicolons.
           Such comments usually describe the state of the program at that
           point or the code section that follows the comment.
           </li>
           <li class="itemize">Triple-semicolon comments are aligned to the left margin. They
           usually document whole programs or large code blocks.
           </li>
           <li class="itemize">Quadruple-semicolon comments usually indicate titles of whole
           programs or large code blocks.</li></ul>
      <li><b>
<tt>&#x0022;</tt> </b></li>The double quote character begins the printed representation of a string.
      Successive characters are read from the input stream and accumulated until
      another double quote is encountered. An exception to this occurs if a <i>single
      escape</i> character is seen; the escape character is discarded, the next
      character is accumulated, and accumulation continues. When a matching
      double quote is seen, all the accumulated characters up to but not
      including the matching double quote are made into a simple string and
      returned.
      <li><b>
<tt>‘</tt> </b></li>The backquote (accent grave) character makes it easier to write programs to
                                                                          

                                                                          
      construct complex data structures by using a template.  <div class="new"><i>Notice of
      correction.</i> In the ﬁrst edition, the backquote character <span class="math">⟨</span><tt>‘</tt><span class="math">⟩</span> appearing at the
      left margin above was inadvertently omitted.
      </div> As an example, writing <div class="lisp"><div class="tabbing">
      ‘(cond ((numberp ,x) ,@y) (t (print ,x) ,@y))
      <br>
      <!--l. 1134--><p class="noindent" ></div>
      <!--l. 1134--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-158900022.1.3" id="x139-158900022.1.3"></a></span>
      <!--l. 1134--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-159000022.1.3" id="x139-159000022.1.3"></a></span>
</div>
      <!--l. 1135--><p class="noindent" >is roughly equivalent to writing <div class="lisp"><div class="tabbing">
      (list &#x2019;cond
      <br>                                                       (cons (list &#x2019;numberp x) y)<br>
                 (list* &#x2019;t (list &#x2019;print x) y))<br>
      <!--l. 1140--><p class="noindent" ></div>
      <!--l. 1140--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-159100022.1.3" id="x139-159100022.1.3"></a></span>
                                                                          

                                                                          
      <!--l. 1140--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-159200022.1.3" id="x139-159200022.1.3"></a></span>
</div>
      <!--l. 1141--><p class="noindent" >The general idea is that the backquote is followed by a template, a picture
      of a data structure to be built. This template is copied, except that within
      the template commas can appear. Where a comma occurs, the form
      following the comma is to be evaluated to produce an object to be inserted
      at that point. Assume <tt>b</tt> has the value <tt>3</tt>; then evaluating the form
      denoted by <tt>‘(a b ,b ,(+ b 1) b)</tt> produces the result <tt>(a b 3 4
      b)</tt>.
      <!--l. 1149--><p class="noindent" >If a comma is immediately followed by an at-sign (<tt>@</tt>), then the form
      following the at-sign is evaluated to produce a <i>list</i> of objects. These objects
      are then “spliced” into place in the template. For example, if <tt>x</tt> has the value
      <tt>(a b c)</tt>, then <div class="lisp"><div class="tabbing">
      ‘(x ,x ,@x foo ,(cadr x) bar ,(cdr x) baz ,@(cdr x))
      <br>                                 <span class="math"> ⇒</span> (x (a b c) a b c foo b bar (b c) baz b c)<br>
      <!--l. 1156--><p class="noindent" ></div>
      <!--l. 1156--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-159300022.1.3" id="x139-159300022.1.3"></a></span>
      <!--l. 1156--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-159400022.1.3" id="x139-159400022.1.3"></a></span>
</div>
      <!--l. 1158--><p class="noindent" >The backquote syntax can be summarized formally as follows. For each
      of several situations in which backquote can be used, a possible
      interpretation of that situation as an equivalent form is given. Note that the
      form is equivalent only in the sense that when it is evaluated it will
      calculate the correct result. An implementation is quite free to interpret
      backquote in any way such that a backquoted form, when evaluated, will
      produce a result <tt><a 
href="symbols.html#x187-2604339r339">equal</a></tt> to that produced by the interpretation shown
      here.
                                                                          

                                                                          
           <ul class="itemize1">
           <li class="itemize"><tt>‘<i>basic</i></tt> is the same as <tt>&#x2019;<i>basic</i></tt>, that is, <tt>(quote <i>basic</i>)</tt>, for any
           form <i>basic</i> that is not a list or a general vector.
           </li>
           <li class="itemize"><tt>‘,<i>form</i></tt> is the same as <i>form</i>, for any <i>form</i>, provided that the
           representation of <i>form</i> does not begin with “<tt>@</tt>” or “<tt>.</tt>”. (A similar
           caveat holds for all occurrences of a form after a comma.)
           </li>
           <li class="itemize"><tt>‘,@<i>form</i></tt> is an error.
           </li>
           <li class="itemize"><tt>‘(<i>x1</i> <i>x2</i> <i>x3</i> ... <i>xn</i> . <i>atom</i>)</tt> may be interpreted to mean
           <div class="lisp"><div class="tabbing">
           (append [<i>x1</i>] [<i>x2</i>] [<i>x3</i>] ... [<i>xn</i>] (quote <i>atom</i>))
           <br>
           <!--l. 1187--><p class="noindent" ></div>
           <!--l. 1187--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-159500022.1.3" id="x139-159500022.1.3"></a></span>
           <!--l. 1187--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-159600022.1.3" id="x139-159600022.1.3"></a></span>
</div>
           <!--l. 1188--><p class="noindent" >where the brackets are used to indicate a transformation of an <i>xj</i> as
           follows:
               <ul class="itemize2">
               <li class="itemize">[<i>form</i>]  is  interpreted  as  <tt>(list ‘<i>form</i>)</tt>,  which  contains  a
               backquoted form that must then be further interpreted.
               </li>
               <li class="itemize">[<tt>,<i>form</i></tt>] is interpreted as <tt>(list <i>form</i>)</tt>.
               </li>
               <li class="itemize">[<tt>,@<i>form</i></tt>] is interpreted simply as <i>form</i>.</li></ul>
                                                                          

                                                                          
           </li>
           <li class="itemize"><tt>‘(<i>x1</i> <i>x2</i> <i>x3</i> ... <i>xn</i>)</tt> may be interpreted to mean the same as the
           backquoted form <tt>‘(<i>x1</i> <i>x2</i> <i>x3</i> ... <i>xn</i> . <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>)</tt>, thereby reducing it to
           the previous case.
           </li>
           <li class="itemize"><tt>‘(<i>x1</i> <i>x2</i> <i>x3</i> ... <i>xn</i> . ,<i>form</i>)</tt> may be interpreted to mean
           <div class="lisp"><div class="tabbing">
           (append [<i>x1</i>] [<i>x2</i>] [<i>x3</i>] ... [<i>xn</i>] <i>form</i>)
           <br>
           <!--l. 1213--><p class="noindent" ></div>
           <!--l. 1213--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-159700022.1.3" id="x139-159700022.1.3"></a></span>
           <!--l. 1213--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-159800022.1.3" id="x139-159800022.1.3"></a></span>
</div>
           <!--l. 1214--><p class="noindent" >where the brackets indicate a transformation of an <i>xj</i> as described
           above.
           </li>
           <li class="itemize"><tt>‘(<i>x1</i> <i>x2</i> <i>x3</i> ... <i>xn</i> . ,@<i>form</i>)</tt> is an error.
           </li>
           <li class="itemize"><tt>‘#(<i>x1</i> <i>x2</i> <i>x3</i> ... <i>xn</i>)</tt> may be interpreted to mean <div class="lisp"><div class="tabbing">
           (apply #&#x2019;vector ‘(<i>x1</i> <i>x2</i> <i>x3</i> ... <i>xn</i>))
           <br>
           <!--l. 1223--><p class="noindent" ></div>
           <!--l. 1223--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-159900022.1.3" id="x139-159900022.1.3"></a></span>
                                                                          

                                                                          
           <!--l. 1223--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-160000022.1.3" id="x139-160000022.1.3"></a></span>
</div>
           </li></ul>
      <!--l. 1226--><p class="noindent" >No other uses of comma are permitted; in particular, it may not appear
      within the <tt>#A</tt> or <tt>#S</tt> syntax.
      <!--l. 1229--><p class="noindent" >Anywhere “<tt>,@</tt>” may be used, the syntax “<tt>,.</tt>” may be used instead to
      indicate that it is permissible to destroy the list produced by the form
      following the “<tt>,.</tt>”; this may permit more eﬃcient code, using <tt><a 
href="symbols.html#x187-2604604r604">nconc</a></tt> instead
      of <tt><a 
href="symbols.html#x187-2604079r79">append</a></tt>, for example.
      <!--l. 1234--><p class="noindent" >If the backquote syntax is nested, the innermost backquoted form should be
      expanded ﬁrst. This means that if several commas occur in a row, the
      leftmost one belongs to the innermost backquote.
      <!--l. 1238--><p class="noindent" >Once again, it is emphasized that an implementation is free to interpret a
      backquoted form as any form that, when evaluated, will produce a
      result that is <tt><a 
href="symbols.html#x187-2604339r339">equal</a></tt> to the result implied by the above deﬁnition. In
      particular, no guarantees are made as to whether the constructed
      copy of the template will or will not share list structure with the
      template itself. As an example, the above deﬁnition implies that
      <div class="lisp"><div class="tabbing">
      ‘((,a b) ,c ,@d)
      <br>
      <!--l. 1246--><p class="noindent" ></div>
      <!--l. 1246--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-160100022.1.3" id="x139-160100022.1.3"></a></span>
      <!--l. 1246--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-160200022.1.3" id="x139-160200022.1.3"></a></span>
</div>
      <!--l. 1247--><p class="noindent" >will be interpreted as if it were <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
      (append (list (append (list a) (list &#x2019;b) &#x2019;<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>)) (list c) d &#x2019;<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>)
      <br>
      <!--l. 1250--><p class="noindent" ></div>
      <!--l. 1250--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-160300022.1.3" id="x139-160300022.1.3"></a></span>
      <!--l. 1250--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-160400022.1.3" id="x139-160400022.1.3"></a></span>
</div>
      <!--l. 1251--><p class="noindent" >but it could also be legitimately interpreted to mean any of the following.
      <div class="lisp"><div class="tabbing">
      (append (list (append (list a) (list &#x2019;b))) (list c) d)
      <br>                                (append (list (append (list a) &#x2019;(b))) (list c) d)<br>
           (append (list (cons a &#x2019;(b))) (list c) d)<br>
           (list* (cons a &#x2019;(b)) c d)<br>              (list* (cons a (list &#x2019;b)) c d)<br>
           (list* (cons a &#x2019;(b)) c (copy-list d))<br>
      <!--l. 1259--><p class="noindent" ></div>
      <!--l. 1259--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-160500022.1.3" id="x139-160500022.1.3"></a></span>
      <!--l. 1259--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-160600022.1.3" id="x139-160600022.1.3"></a></span>
</div>
      <!--l. 1260--><p class="noindent" >(There is no good reason why <tt><a 
href="symbols.html#x187-2604255r255">copy-list</a></tt> should be performed, but it is not
      prohibited.)
                                                                          

                                                                          
<div class="new">
      <!--l. 1266--><p class="noindent" >Some users complain that backquote syntax is diﬃcult to read, especially
      when it is nested. I agree that it can get complicated, but in some
      situations (such as writing macros that expand into deﬁnitions for other
      macros) such complexity is to be expected, and the alternative is much
      worse.
      <!--l. 1272--><p class="noindent" >After I gained some experience in writing nested backquote forms, I found
      that I was not stopping to analyze the various patterns of nested backquotes
      and interleaved commas and quotes; instead, I was recognizing standard
      idioms wholesale, in the same manner that I recognize <tt><a 
href="symbols.html#x187-2604163r163">cadar</a></tt> as the
      primitive for “extract the lambda-list from the form <tt>((lambda ...) ...)</tt>)”
      without stopping to analyze it into “<tt><a 
href="symbols.html#x187-2604171r171">car</a></tt> of <tt><a 
href="symbols.html#x187-2604189r189">cdr</a></tt> of <tt><a 
href="symbols.html#x187-2604171r171">car</a></tt>.” For example, <tt>,x</tt>
      within a doubly-nested backquote form means “the value of <tt>x</tt> available
      during the second evaluation will appear here once the form has been twice
      evaluated,” whereas <tt>,&#x2019;,x</tt> means “the value of <tt>x</tt> available during
      the ﬁrst evaluation will appear here once the form has been twice
      evaluated” and <tt>„x</tt> means “the value of the value of <tt>x</tt> will appear
      here.”
      <!--l. 1286--><p class="noindent" >See appendix ?? for a systematic set of examples of the use of nested
      backquotes.
      </div>
      <li><b>
<tt>,</tt> </b></li>The comma character is part of the backquote syntax and is invalid if used
      other than inside the body of a backquote construction as described
      above.
      <li><b>
<tt>#</tt> </b></li>This is a <i>dispatching</i> macro character. It reads an optional digit string and then
      one more character, and uses that character to select a function to run as a
      macro-character function.
      <!--l. 1303--><p class="noindent" >The <tt>#</tt> character also happens to be a non-terminating macro character. This
      is completely independent of the fact that it is a dispatching macro
      character; it is a coincidence that the only standard dispatching macro
      character in Common Lisp is also the only standard non-terminating macro
      character.
      <!--l. 1309--><p class="noindent" >See the next section for predeﬁned <tt>#</tt> macro-character constructions.</ul>
                                                                          

                                                                          
</div>
<!--l. 1312--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">22.1.4   </span> <a 
href="frontmatter.html#QQ2-139-1641" id="x139-160700022.1.4">Standard Dispatching Macro Character Syntax</a></h4>
<!--l. 1317--><p class="noindent" >The standard syntax includes forms introduced by the <tt>#</tt> character. These take the
general form of a <tt>#</tt>, a second character that identiﬁes the syntax, and
following arguments in some form. If the second character is a letter,
then case is not important; <tt>#O</tt> and <tt>#o</tt> are considered to be equivalent, for
example.
<!--l. 1324--><p class="indent" >   Certain <tt>#</tt> forms allow an unsigned decimal number to appear between the <tt>#</tt>
and the second character; some other forms even require it. Those forms that do
not explicitly permit such a number to appear forbid it.
   <div class="table">
                                                                          

                                                                          
<!--l. 1330--><p class="indent" >   <a 
 id="x139-16070015"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
 <div class="caption" 
><span class="id">Таблица 22.5: </span><span  
class="content">Standard # Macro Character Syntax</span></div><!--tex4ht:label?: x139-16070015 -->
<div class="tabular"><table width="100%" class="tabular"><tr><td align="left" > <tt>#!</tt> </td><td align="left" ><i>undeﬁned</i> *                          </td><td align="left" ><tt>#</tt><span class="math">⟨</span>backspace<span class="math">⟩</span></td><td align="left" ><i>signals error</i>          </td>
</tr><tr><td align="left" > <tt>#&#x0022;</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#</tt><span class="math">⟨</span>tab<span class="math">⟩</span>    </td><td align="left" ><i>signals error</i>          </td>
</tr><tr><td align="left" > <tt>##</tt> </td><td align="left" ><i>reference to <tt>#=</tt> label</i>              </td><td align="left" ><tt>#</tt><span class="math">⟨</span>newline<span class="math">⟩</span> </td><td align="left" ><i>signals error</i>          </td>
</tr><tr><td align="left" > <tt>#$</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#</tt><span class="math">⟨</span>linefeed<span class="math">⟩</span> </td><td align="left" ><i>signals error</i>          </td>
</tr><tr><td align="left" > <tt>#%</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#</tt><span class="math">⟨</span>page<span class="math">⟩</span>   </td><td align="left" ><i>signals error</i>          </td>
</tr><tr><td align="left" > <tt>#&#x0026;</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#</tt><span class="math">⟨</span>return<span class="math">⟩</span>  </td><td align="left" ><i>signals error</i>          </td>
</tr><tr><td align="left" > <tt>#&#x2019;</tt> </td><td align="left" ><i><tt><a 
href="symbols.html#x187-2604399r399">function</a></tt> abbreviation</i>           </td><td align="left" ><tt>#</tt><span class="math">⟨</span>space<span class="math">⟩</span>   </td><td align="left" ><i>signals error</i>          </td>
</tr><tr><td align="left" > <tt>#(</tt> </td><td align="left" ><i>simple vector</i>                      </td><td align="left" ><tt>#+</tt>         </td><td align="left" ><i>read-time conditional</i></td>
</tr><tr><td align="left" > <tt>#)</tt> </td><td align="left" ><i>signals error</i>                       </td><td align="left" ><tt>#-</tt>         </td><td align="left" ><i>read-time conditional</i></td>
</tr><tr><td align="left" > <tt>#*</tt> </td><td align="left" ><i>bit-vector</i>                           </td><td align="left" ><tt>#.</tt>         </td><td align="left" ><i>read-time evaluation</i> </td></tr><tr><td align="left" > <tt>#,</tt> </td><td align="left" ><i>load-time evaluation</i> </td><td align="left" ><tt>#/</tt> </td><td align="left" ><i>undeﬁned</i></td>
</tr><tr><td align="left" > <tt>#0</tt> </td><td align="left" ><i>used for inﬁx arguments</i>      </td><td align="left" ><tt>#A</tt>, <tt>#a</tt>      </td><td align="left" ><i>array</i>                   </td>
</tr><tr><td align="left" > <tt>#1</tt> </td><td align="left" ><i>used for inﬁx arguments</i>         </td><td align="left" ><tt>#B</tt>, <tt>#b</tt>      </td><td align="left" ><i>binary rational</i>        </td>
</tr><tr><td align="left" > <tt>#2</tt> </td><td align="left" ><i>used for inﬁx arguments</i>         </td><td align="left" ><tt>#C</tt>, <tt>#c</tt>      </td><td align="left" ><i>complex number</i>      </td>
</tr><tr><td align="left" > <tt>#3</tt> </td><td align="left" ><i>used for inﬁx arguments</i>         </td><td align="left" ><tt>#D</tt>, <tt>#d</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#4</tt> </td><td align="left" ><i>used for inﬁx arguments</i>         </td><td align="left" ><tt>#E</tt>, <tt>#e</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#5</tt> </td><td align="left" ><i>used for inﬁx arguments</i>         </td><td align="left" ><tt>#F</tt>, <tt>#f</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#6</tt> </td><td align="left" ><i>used for inﬁx arguments</i>         </td><td align="left" ><tt>#G</tt>, <tt>#g</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#7</tt> </td><td align="left" ><i>used for inﬁx arguments</i>         </td><td align="left" ><tt>#H</tt>, <tt>#h</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#8</tt> </td><td align="left" ><i>used for inﬁx arguments</i>         </td><td align="left" ><tt>#I</tt>, <tt>#i</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#9</tt> </td><td align="left" ><i>used for inﬁx arguments</i>         </td><td align="left" ><tt>#J</tt>, <tt>#j</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#:</tt> </td><td align="left" ><i>uninterned symbol</i>                </td><td align="left" ><tt>#K</tt>, <tt>#k</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#;</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#L</tt>, <tt>#l</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#&#x003C;</tt> </td><td align="left" ><i>signals error</i>                       </td><td align="left" ><tt>#M</tt>, <tt>#m</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#=</tt> </td><td align="left" ><i>label following object</i>             </td><td align="left" ><tt>#N</tt>, <tt>#n</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#&#x003E;</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#O</tt>, <tt>#o</tt>      </td><td align="left" ><i>octal rational</i>          </td>
</tr><tr><td align="left" > <tt>#?</tt> </td><td align="left" ><i>undeﬁned</i> *                          </td><td align="left" ><tt>#P</tt>, <tt>#p</tt>      </td><td align="left" ><i>pathname</i>              </td>
</tr><tr><td align="left" > <tt>#@</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#Q</tt>, <tt>#q</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#[</tt> </td><td align="left" ><i>undeﬁned</i> *                          </td><td align="left" ><tt>#R</tt>, <tt>#r</tt>      </td><td align="left" ><i>radix-n rational</i>       </td>
</tr><tr><td align="left" > <tt>#\</tt> </td><td align="left" ><i>character object</i>                   </td><td align="left" ><tt>#S</tt>, <tt>#s</tt>      </td><td align="left" ><i>structure</i>               </td>
</tr><tr><td align="left" > <tt>#]</tt> </td><td align="left" ><i>undeﬁned</i> *                          </td><td align="left" ><tt>#T</tt>, <tt>#t</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#̂</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#U</tt>, <tt>#u</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#_</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#V</tt>, <tt>#v</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#‘</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#W</tt>, <tt>#w</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#{</tt> </td><td align="left" ><i>undeﬁned</i> *                          </td><td align="left" ><tt>#X</tt>, <tt>#x</tt>      </td><td align="left" ><i>hexadecimal rational</i> </td>
</tr><tr><td align="left" > <tt>#|</tt> </td><td align="left" ><i>balanced comment</i>                </td><td align="left" ><tt>#Y</tt>, <tt>#y</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#}</tt> </td><td align="left" ><i>undeﬁned</i> *                          </td><td align="left" ><tt>#Z</tt>, <tt>#z</tt>      </td><td align="left" ><i>undeﬁned</i>              </td>
</tr><tr><td align="left" > <tt>#~</tt> </td><td align="left" ><i>undeﬁned</i>                           </td><td align="left" ><tt>#</tt><span class="math">⟨</span>rubout<span class="math">⟩</span>  </td><td align="left" ><i>undeﬁned</i>              </td></tr></table>
</div>
<!--l. 1376--><p class="noindent" >The combinations marked by an asterisk are explicitly reserved to the user and will
never be deﬁned by Common Lisp.
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
<!--l. 1382--><p class="indent" >   The currently deﬁned <tt>#</tt> constructs are described below and summarized in
table <a 
href="#x139-16070015">22.5<!--tex4ht:ref: Standard-Sharp-Macro-Definitions-Table --></a>; more are likely to be added in the future. However, the constructs <tt>#!</tt>,
<tt>#?</tt>, <tt>#[</tt>, <tt>#]</tt>, <tt>#{</tt>, and <tt>#}</tt> are explicitly reserved for the user and will never be deﬁned
by the Common Lisp standard. <div class="flushdesc">
      <ul><li><b>
<tt>#\</tt> </b></li><tt>#\<i>x</i></tt> reads in as a character object that represents the character <i>x</i>. Also,
      <tt>#\<i>name</i></tt> reads in as the character object whose name is <i>name</i>. Note that
      the backslash <tt>\</tt> allows this construct to be parsed easily by EMACS-like
      editors.
      <!--l. 1398--><p class="noindent" >In the single-character case, the character <i>x</i> must be followed by a
      non-constituent character, lest a <i>name</i> appear to follow the <tt>#\</tt>. A good
      model of what happens is that after <tt>#\</tt> is read, the reader backs up over
      the <tt>\</tt> and then reads an extended token, treating the initial <tt>\</tt> as an
      escape character (whether it really is or not in the current readtable).
      <!--l. 1405--><p class="noindent" >Uppercase and lowercase letters are distinguished after <tt>#\</tt>; <tt>#\A</tt> and
      <tt>#\a</tt> denote diﬀerent character objects. Any character works after <tt>#\</tt>,
      even  those  that  are  normally  special  to  <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt>,  such  as  parentheses.
      Non-printing characters may be used after <tt>#\</tt>, although for them names
      are generally preferred.
<tt>
      <!--l. 1411--><p class="noindent" >#\<i>name</i></tt> reads in as a character object whose name is <i>name</i> (actually, whose
      name is <tt>(string-upcase <i>name</i>)</tt>; therefore the syntax is case-insensitive).
      The <i>name</i> should have the syntax of a symbol. The following names are
      standard across all implementations: <div class="tabbing">
      <tt>newline</tt>       The character that represents the division between lines
      <br>                                <tt>space</tt>         The space or blank character<br>
      <!--l. 1420--><p class="noindent" ></div>
                                                                          

                                                                          
      <!--l. 1420--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-160800022.1.4" id="x139-160800022.1.4"></a></span>
      The following names are semi-standard; if an implementation supports
      them, they should be used for the described characters and no others.
      <div class="tabbing">
      <tt>rubout</tt>        The rubout or delete character.
      <br>               <tt>page</tt>          The form-feed or page-separator character<br>
           <tt>tab</tt>           The tabulate character<br>
           <tt>backspace</tt>     The backspace character<br>
           <tt><a 
href="symbols.html#x187-2604749r749">return</a></tt>        The carriage return character<br>
           <tt>linefeed</tt>      The line-feed character<br>
      <!--l. 1431--><p class="noindent" ></div>
      <!--l. 1431--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-160900022.1.4" id="x139-160900022.1.4"></a></span>
      In some implementations, one or more of these characters might be a
      synonym for a standard character; the <tt>#\Linefeed</tt> character might be the
      same as <tt>#\Newline</tt>, for example.
      <!--l. 1436--><p class="noindent" >When the Lisp printer types out the name of a special character, it
      uses the same table as the <tt>#\</tt> reader; therefore any character name
      you see typed out is acceptable as input (in that implementation).
      Standard names are always preferred over non-standard names for
      printing.
      <!--l. 1441--><p class="noindent" >The following convention is used in implementations that support non-zero
      bits attributes for character objects. If a name after <tt>#\</tt> is longer than one
      character and has a hyphen in it, then it may be split into the two parts
      preceding and following the ﬁrst hyphen; the ﬁrst part (actually,
      <tt><a 
href="symbols.html#x187-2604837r837">string-upcase</a></tt> of the ﬁrst part) may then be interpreted as the name or
      initial of a bit, and the second part as the name of the character (which may
      in turn contain a hyphen and be subject to further splitting). For example:
      <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
      #\Control-Space        #\Control-Meta-Tab
      <br>                                   #\C-M-Return           #\H-S-M-C-Rubout<br>
      <!--l. 1455--><p class="noindent" ></div>
      <!--l. 1455--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-161000022.1.4" id="x139-161000022.1.4"></a></span>
      <!--l. 1455--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-161100022.1.4" id="x139-161100022.1.4"></a></span>
</div>
      <!--l. 1456--><p class="noindent" >If the character name consists of a single character, then that character is
      used. Another <tt>\</tt> may be necessary to quote the character. <div class="lisp"><div class="tabbing">
      #\Control-%             #\Control-Meta-\&#x0022;
      <br>                                               #\Control-\a             #\Meta-&#x003E;<br>
      <!--l. 1462--><p class="noindent" ></div>
      <!--l. 1462--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-161200022.1.4" id="x139-161200022.1.4"></a></span>
      <!--l. 1462--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-161300022.1.4" id="x139-161300022.1.4"></a></span>
</div>
<div class="obsolete">
      <!--l. 1465--><p class="noindent" >If an unsigned decimal integer appears between the <tt>#</tt> and <tt>\</tt>, it is interpreted
      as a font number, to become the font attribute of the character object (see
      <tt>char-font</tt>).
      </div>
<div class="newer">
                                                                          

                                                                          
      <!--l. 1471--><p class="noindent" >X3J13 voted in March 1989 <a 
 id="dx139-1613001"></a>to replace the notion of bits and font attributes
      with that of implementation-deﬁned attributes. Presumably this eliminates
      the portable use of this syntax for font information, although the vote did
      not address this question directly.
      </div>
      <li><b>
<tt>#&#x2019;</tt> </b></li><tt>#&#x2019;<i>foo</i></tt> is an abbreviation for <tt>(function <i>foo</i>)</tt>. <i>foo</i> may be the printed
      representation of any Lisp object. This abbreviation may be remembered by
      analogy with the <tt>&#x2019;</tt> macro character, since the <tt><a 
href="symbols.html#x187-2604399r399">function</a></tt> and <tt><a 
href="symbols.html#x187-2604705r705">quote</a></tt> special
      operators are similar in form.
      <li><b>
<tt>#(</tt> </b></li>A series of representations of objects enclosed by <tt>#(</tt> and <tt>)</tt> is read as a
      simple vector of those objects. This is analogous to the notation for
      lists.
      <!--l. 1490--><p class="noindent" >If an unsigned decimal integer appears between the <tt>#</tt> and <tt>(</tt>, it speciﬁes
      explicitly the length of the vector. In that case, it is an error if too
      many objects are speciﬁed before the closing <tt>)</tt>, and if too few are
      speciﬁed, the last object (it is an error if there are none in this case)
      is used to ﬁll all remaining elements of the vector. For example,
      <div class="lisp"><div class="tabbing">
      #(a b c c c c)     #6(a b c c c c)     #6(a b c)     #6(a b c c)
      <br>
      <!--l. 1500--><p class="noindent" ></div>
      <!--l. 1500--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-161400022.1.4" id="x139-161400022.1.4"></a></span>
      <!--l. 1500--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-161500022.1.4" id="x139-161500022.1.4"></a></span>
</div>
                                                                          

                                                                          
      <!--l. 1501--><p class="noindent" >all mean the same thing: a vector of length 6 with elements <tt>a</tt>, <tt>b</tt>, and four
      instances of <tt>c</tt>. The notation <tt>#()</tt> denotes an empty vector, as does <tt>#0()</tt>
      (which is legitimate because it is not the case that too few elements are
      speciﬁed).
      <li><b>
<tt>#*</tt> </b></li>A series of binary digits (<tt>0</tt> and <tt>1</tt>) preceded by <tt>#*</tt> is read as a simple bit-vector
      containing those bits, the leftmost bit in the series being bit 0 of the
      bit-vector.
      <!--l. 1512--><p class="noindent" >If an unsigned decimal integer appears between the <tt>#</tt> and <tt><a 
href="symbols.html#x187-2604002r2">*</a></tt>, it speciﬁes
      explicitly the length of the vector. In that case, it is an error if too many
      bits are speciﬁed, and if too few are speciﬁed the last one (it is an error if
      there are none in this case) is used to ﬁll all remaining elements of the
      bit-vector. For example, <div class="lisp"><div class="tabbing">
      #*101111     #6*101111     #6*101     #6*1011
      <br>
      <!--l. 1521--><p class="noindent" ></div>
      <!--l. 1521--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-161600022.1.4" id="x139-161600022.1.4"></a></span>
      <!--l. 1521--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-161700022.1.4" id="x139-161700022.1.4"></a></span>
</div>
      <!--l. 1522--><p class="noindent" >all mean the same thing: a vector of length 6 with elements <tt>1</tt>, <tt>0</tt>, <tt>1</tt>, <tt>1</tt>, <tt>1</tt>, and
      <tt>1</tt>. The notation <tt>#*</tt> denotes an empty bit-vector, as does <tt>#0*</tt> (which
      is legitimate because it is not the case that too few elements are
      speciﬁed). <div class="new"> Compare this to <tt>#B</tt>, used for expressing integers in binary
      notation.
      </div>
                                                                          

                                                                          
      <li><b>
<tt>#:</tt> </b></li><tt>#:<i>foo</i></tt> requires <i>foo</i> to have the syntax of an unqualiﬁed symbol name (no
      embedded colons). It denotes an <i>uninterned</i> symbol whose name is
      <i>foo</i>. Every time this syntax is encountered, a diﬀerent uninterned
      symbol is created. If it is necessary to refer to the same uninterned
      symbol more than once in the same expression, the <tt>#=</tt> syntax may be
      useful.
      <li><b>
<tt>#.</tt> </b></li><tt>#.<i>foo</i></tt> is read as the object resulting from the evaluation of the Lisp object
      represented by <i>foo</i>, which may be the printed representation of any Lisp
      object. The evaluation is done during the <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> process, when the <tt>#.</tt>
      construct is encountered.
<div class="newer">
      <!--l. 1547--><p class="noindent" >X3J13 voted in June 1989 <a 
 id="dx139-1617001"></a>to add a new reader control variable,
      <tt>*read-eval*</tt>. If it is true, the <tt>#.</tt> reader macro behaves as described above;
      if it is false, the <tt>#.</tt> reader macro signals an error.
      </div>
      <!--l. 1553--><p class="noindent" >The <tt>#.</tt> syntax therefore performs a read-time evaluation of <i>foo</i>. By contrast,
      <tt>#,</tt> (see below) performs a load-time evaluation.
      <!--l. 1556--><p class="noindent" >Both <tt>#.</tt> and <tt>#,</tt> allow you to include, in an expression being read, an object
      that does not have a convenient printed representation; instead of writing a
      representation for the object, you write an expression that will <i>compute</i> the
      object.</ul>
</div>
<div class="flushdesc">
      <ul><li><b>
<tt>#B</tt> </b></li><tt>#b<i>rational</i></tt> reads <i>rational</i> in binary (radix 2). For example, <tt>#B1101</tt> <span class="math"> ≡</span> <tt>13</tt>,
      and <tt>#b101/11</tt> <span class="math"> ≡</span> <tt>5/3</tt>. <div class="new"> Compare this to <tt>#*</tt>, used for expressing bit-vectors
      in binary notation.
      </div>
      <li><b>
<tt>#O</tt> </b></li><tt>#o<i>rational</i></tt> reads <i>rational</i> in octal (radix 8). For example, <tt>#o37/15</tt>
      <span class="math"> ≡</span> <tt>31/13</tt>, and <tt>#o777</tt> <span class="math"> ≡</span> <tt>511</tt>.
                                                                          

                                                                          
      <li><b>
<tt>#X</tt> </b></li><tt>#x<i>rational</i></tt> reads <i>rational</i> in hexadecimal (radix 16). The digits above <tt>9</tt> are
      the letters <tt>A</tt> through <tt>F</tt> (the lowercase letters <tt>a</tt> through <tt><a 
href="symbols.html#x187-2604351r351">f</a></tt> are also
      acceptable). For example, <tt>#xF00</tt> <span class="math"> ≡</span> <tt>3840</tt>.
      <li><b>
<tt>#<i>n</i>R</tt> </b></li><tt>#<i>radix</i>r<i>rational</i></tt> reads <i>rational</i> in radix <i>radix</i>. <i>radix</i> must consist of only
      digits, and it is read in decimal; its value must be between 2 and 36
      (inclusive).
                                                                          

                                                                          
      <!--l. 1587--><p class="noindent" >For example, <tt>#3r102</tt> is another way of writing <tt>11</tt>, and <tt>#11R32</tt> is another
      way of writing <tt>35</tt>. For radices larger than 10, letters of the alphabet are
      used in order for the digits after <tt>9</tt>.
      <li><b>
<tt>#<i>n</i>A</tt> </b></li>The syntax <tt>#<i>n</i>A<i>object</i></tt> constructs an <i>n</i>-dimensional array, using <i>object</i> as
      the value of the <tt>:initial-contents</tt> argument to <tt><a 
href="symbols.html#x187-2604532r532">make-array</a></tt>.
      <!--l. 1596--><p class="noindent" >The value of <i>n</i> makes a diﬀerence: <tt>#2A((0 1 5) (foo 2 (hot dog)))</tt>, for
      example, represents a 2-by-3 matrix: <div class="lisp"><div class="tabbing">
      0       1       5
      <br>                                                       foo     2       (hot dog)<br>
      <!--l. 1601--><p class="noindent" ></div>
      <!--l. 1601--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-161800022.1.4" id="x139-161800022.1.4"></a></span>
      <!--l. 1601--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-161900022.1.4" id="x139-161900022.1.4"></a></span>
</div>
      <!--l. 1602--><p class="noindent" >In contrast, <tt>#1A((0 1 5) (foo 2 (hot dog)))</tt> represents a length-2 array
      whose elements are lists: <div class="lisp"><div class="tabbing">
      (0 1 5)    (foo 2 (hot dog))
      <br>
      <!--l. 1606--><p class="noindent" ></div>
      <!--l. 1606--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-162000022.1.4" id="x139-162000022.1.4"></a></span>
                                                                          

                                                                          
      <!--l. 1606--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-162100022.1.4" id="x139-162100022.1.4"></a></span>
</div>
      <!--l. 1607--><p class="noindent" >Furthermore, <tt>#0A((0 1 5) (foo 2 (hot dog)))</tt> represents a
      zero-dimensional array whose sole element is a list: <div class="lisp"><div class="tabbing">
      ((0 1 5) (foo 2 (hot dog)))
      <br>
      <!--l. 1611--><p class="noindent" ></div>
      <!--l. 1611--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-162200022.1.4" id="x139-162200022.1.4"></a></span>
      <!--l. 1611--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-162300022.1.4" id="x139-162300022.1.4"></a></span>
</div>
      <!--l. 1612--><p class="noindent" >Similarly, <tt>#0Afoo</tt> (or, more readably, <tt>#0A foo</tt>) represents a zero-dimensional
      array whose sole element is the symbol <tt>foo</tt>. The expression <tt>#1Afoo</tt> would
      not be legal because <tt>foo</tt> is not a sequence.
      <li><b>
<tt>#S</tt> </b></li>The syntax <tt>#s(<i>name</i> <i>slot1</i> <i>value1</i> <i>slot2</i> <i>value2</i> ...)</tt> denotes
      a structure. This is legal only if <i>name</i> is the name of a structure
      already deﬁned by <tt><a 
href="symbols.html#x187-2604289r289">defstruct</a></tt> and if the structure has a standard
      constructor macro, which it normally will. Let <i>cm</i> stand for the
      name of this constructor macro; then this syntax is equivalent to
      <div class="lisp"><div class="tabbing">
      #.(<i>cm</i> <i>keyword1</i> &#x2019;<i>value1</i> <i>keyword2</i> &#x2019;<i>value2</i> ...)
      <br>
      <!--l. 1626--><p class="noindent" ></div>
                                                                          

                                                                          
      <!--l. 1626--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-162400022.1.4" id="x139-162400022.1.4"></a></span>
      <!--l. 1626--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-162500022.1.4" id="x139-162500022.1.4"></a></span>
</div>
      <!--l. 1627--><p class="noindent" >where each <i>keywordj</i> is the result of computing <div class="lisp"><div class="tabbing">
      (intern (string <i>slotj</i>) &#x2019;keyword)
      <br>
      <!--l. 1630--><p class="noindent" ></div>
      <!--l. 1630--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-162600022.1.4" id="x139-162600022.1.4"></a></span>
      <!--l. 1630--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-162700022.1.4" id="x139-162700022.1.4"></a></span>
</div>
      <!--l. 1631--><p class="noindent" >(This computation is made so that one need not write a colon in front of
      every slot name.) The net eﬀect is that the constructor macro is called with
      the speciﬁed slots having the speciﬁed values (note that one does not write
      quote marks in the <tt>#S</tt> syntax). Whatever object the constructor macro
      returns is returned by the <tt>#S</tt> syntax.</ul>
</div>
<div class="newer">
<div class="flushdesc">
      <ul><li><b>
<tt>#P</tt> </b></li>X3J13  voted  in  June  1989  <a 
 id="dx139-1627001"></a>to  deﬁne  the  reader  syntax  <tt>#p&#x0022;...&#x0022;</tt> to
      be equivalent to <tt>#.(parse-namestring &#x0022;...&#x0022;)</tt>. Presumably this was
      meant to be taken descriptively and not literally. I would think, for
      example, that the committee did not wish to quibble over the package in
                                                                          

                                                                          
      which the name <tt><a 
href="symbols.html#x187-2604654r654">parse-namestring</a></tt> was to be read. Similarly, I would
      presume that the <tt>#p</tt> syntax operates normally rather than signaling an
      error when <tt>*read-eval*</tt> is false. I interpret the intent of the vote to be
      that <tt>#p</tt> reads a following form, which should be a string, that is then
      converted to a pathname as if by application of the standard function
      <tt><a 
href="symbols.html#x187-2604654r654">parse-namestring</a></tt>.</ul>
</div>
</div>
<div class="flushdesc">
      <ul><li><b>
<tt>#<i>n</i>=</tt> </b></li>The syntax <tt>#<i>n</i>=<i>object</i></tt> reads as whatever Lisp object has <i>object</i> as
      its  printed  representation.  However,  that  object  is  labelled  by  <i>n</i>,  a
      required unsigned decimal integer, for possible reference by the syntax
      <tt>#<i>n</i>#</tt> (below). The scope of the label is the expression being read by the
      outermost call to <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt>. Within this expression the same label may not
      appear twice.
      <li><b>
<tt>#<i>n</i>#</tt> </b></li>The syntax <tt>#<i>n</i>#</tt>, where <i>n</i> is a required unsigned decimal integer, serves as a
      reference to some object labelled by <tt>#<i>n</i>=</tt>; that is, <tt>#<i>n</i>#</tt> represents
      a pointer to the same identical (<tt><a 
href="symbols.html#x187-2604337r337">eq</a></tt>) object labelled by <tt>#<i>n</i>=</tt>. This
      permits notation of structures with shared or circular substructure.
      For example, a structure created in the variable <tt>y</tt> by this code:
      <div class="lisp"><div class="tabbing">
      (setq x (list &#x2019;p &#x2019;q))
      <br>                                                 (setq y (list (list &#x2019;a &#x2019;b) x &#x2019;foo x))<br>
           (rplacd (last y) (cdr y))<br>
      <!--l. 1678--><p class="noindent" ></div>
      <!--l. 1678--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-162800022.1.4" id="x139-162800022.1.4"></a></span>
                                                                          

                                                                          
      <!--l. 1678--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-162900022.1.4" id="x139-162900022.1.4"></a></span>
</div>
      <!--l. 1679--><p class="noindent" >could be represented in this way: <div class="lisp"><div class="tabbing">
      ((a b) . #1=(#2=(p q) foo #2# . #1#))
      <br>
      <!--l. 1682--><p class="noindent" ></div>
      <!--l. 1682--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-163000022.1.4" id="x139-163000022.1.4"></a></span>
      <!--l. 1682--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-163100022.1.4" id="x139-163100022.1.4"></a></span>
</div>
      <!--l. 1683--><p class="noindent" >Without this notation, but with <tt>*print-length*</tt> set to <tt>10</tt>, the structure
      would print in this way: <div class="lisp"><div class="tabbing">
      ((a b) (p q) foo (p q) (p q) foo (p q) (p q) foo (p q) ...)
      <br>
      <!--l. 1687--><p class="noindent" ></div>
      <!--l. 1687--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-163200022.1.4" id="x139-163200022.1.4"></a></span>
                                                                          

                                                                          
      <!--l. 1687--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-163300022.1.4" id="x139-163300022.1.4"></a></span>
</div>
      <!--l. 1688--><p class="noindent" >A reference <tt>#<i>n</i>#</tt> may occur only after a label <tt>#<i>n</i>=</tt>; forward references are not
      permitted. In addition, the reference may not appear as the labelled object
      itself (that is, one may not write <tt>#<i>n</i>= #<i>n</i>#</tt>), because the object labelled by
      <tt>#<i>n</i>=</tt> is not well deﬁned in this case.
      <li><b>
<tt>#+</tt> </b></li> The <tt>#+</tt> syntax provides a read-time conditionalization facility; the syntax is
      <div class="lisp"><div class="tabbing">
      #+<i>feature</i> <i>form</i>
      <br>
      <!--l. 1700--><p class="noindent" ></div>
      <!--l. 1700--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-163400022.1.4" id="x139-163400022.1.4"></a></span>
      <!--l. 1700--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-163500022.1.4" id="x139-163500022.1.4"></a></span>
</div>
      <!--l. 1701--><p class="noindent" >If <i>feature</i> is “true,” then this syntax represents a Lisp object whose printed
      representation is <i>form</i>. If <i>feature</i> is “false,” then this syntax is eﬀectively
      whitespace; it is as if it did not appear.
      <!--l. 1705--><p class="noindent" >The <i>feature</i> should be the printed representation of a symbol or list. If
      <i>feature</i> is a symbol, then it is true if and only if it is a member of the list
      that is the value of the global variable <tt><a 
href="symbols.html#x187-2604016r16">*features*</a></tt>.
      <!--l. 1710--><p class="noindent" >Otherwise, <i>feature</i> should be a Boolean expression composed of <tt><a 
href="symbols.html#x187-2604078r78">and</a></tt>, <tt><a 
href="symbols.html#x187-2604641r641">or</a></tt>, and
      <tt><a 
href="symbols.html#x187-2604614r614">not</a></tt> operators on (recursive) <i>feature</i> expressions.
      <!--l. 1714--><p class="noindent" >For example, suppose that in implementation A the features <tt>spice</tt> and
      <tt>perq</tt> are true, and in implementation B the feature <tt>lispm</tt> is true. Then the
      expressions on the left below are read the same as those on the right in
      implementation A: <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
      (cons #+spice &#x0022;Spice&#x0022; #+lispm &#x0022;Lispm&#x0022; x)      (cons &#x0022;Spice&#x0022; x)
      <br>        (setq a &#x2019;(1 2 #+perq 43 #+(not perq) 27))     (setq a &#x2019;(1 2 43))<br>
           (let ((a 3) #+(or spice lispm) (b 3))         (let ((a 3) (b 3))<br>
             (foo a))                                      (foo a))<br>
           (cons a #+perq #-perq b c)                    (cons a c)<br>
      <!--l. 1724--><p class="noindent" ></div>
      <!--l. 1724--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-163600022.1.4" id="x139-163600022.1.4"></a></span>
      <!--l. 1724--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-163700022.1.4" id="x139-163700022.1.4"></a></span>
</div>
      <!--l. 1725--><p class="noindent" >In implementation B, however, they are read in this way: <div class="lisp"><div class="tabbing">
      (cons #+spice &#x0022;Spice&#x0022; #+lispm &#x0022;Lispm&#x0022; x)      (cons &#x0022;Lispm&#x0022; x)
      <br>        (setq a &#x2019;(1 2 #+perq 43 #+(not perq) 27))     (setq a &#x2019;(1 2 27))<br>
           (let ((a 3) #+(or spice lispm) (b 3))         (let ((a 3) (b 3))<br>
             (foo a))                                      (foo a))<br>
           (cons a #+perq #-perq b c)                    (cons a c)<br>
      <!--l. 1732--><p class="noindent" ></div>
      <!--l. 1732--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-163800022.1.4" id="x139-163800022.1.4"></a></span>
      <!--l. 1732--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-163900022.1.4" id="x139-163900022.1.4"></a></span>
</div>
      <!--l. 1734--><p class="noindent" >
                                                                          

                                                                          
      <!--l. 1736--><p class="noindent" >The <tt>#+</tt> construction must be used judiciously if unreadable code is not to
      result. The user should make a careful choice between read-time
      conditionalization and run-time conditionalization.
      <!--l. 1740--><p class="noindent" >The <tt>#+</tt> syntax operates by ﬁrst reading the <i>feature</i> speciﬁcation and then
      skipping over the <i>form</i> if the <i>feature</i> is “false.” This skipping of a form is a
      bit tricky because of the possibility of user-deﬁned macro characters and
      side eﬀects caused by the <tt>#.</tt> construction. It is accomplished by binding the
      variable <tt>*read-suppress*</tt> to a non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> value and then calling the <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt>
      function. See the description of <tt>*read-suppress*</tt> for the details of this
      operation.
<div class="newer">
      <!--l. 1750--><p class="noindent" >X3J13 voted in March 1988 <a 
 id="dx139-1639001"></a>to specify that the <tt>keyword</tt> package is the
      default package during the reading of a feature speciﬁcation. Thus <tt>#+spice</tt>
      means the same thing as <tt>#+:spice</tt>, and <tt>#+(or spice lispm)</tt> means the
      same thing as <tt>#+(or :spice :lispm)</tt>. Symbols in other packages may be
      used as feature names, but one must use an explicit package preﬁx to cite
      one after <tt>#+</tt>.
      </div>
      <li><b>
<tt>#-</tt> </b></li><tt>#-<i>feature</i> <i>form</i></tt> is equivalent to <tt>#+(not <i>feature</i>) <i>form</i></tt>.
      <li><b>
<tt>#|</tt> </b></li><tt>#|...|#</tt> is treated as a comment by the reader, just as everything from a
      semicolon to the next newline is treated as a comment. Anything may
      appear in the comment, except that it must be balanced with respect to
      other occurrences of <tt>#|</tt> and <tt>|#</tt>. Except for this nesting rule, the comment
      may contain any characters whatsoever.
      <!--l. 1771--><p class="noindent" >The main purpose of this construct is to allow “commenting out” of blocks of
      code or data. The balancing rule allows such blocks to contain pieces already
      so commented out. In this respect the <tt>#|...|#</tt> syntax of Common
      Lisp diﬀers from the <tt>/*...*/</tt> comment syntax used by PL/I and
      C.
      <li><b>
<tt>#&#x003C;</tt> </b></li>This is not legal reader syntax. It is conventionally used in the printed
      representation of objects that cannot be read back in. Attempting to read a
      <tt>#&#x003C;</tt> will cause an error. (More precisely, it <i>is</i> legal syntax, but the
                                                                          

                                                                          
      macro-character function for <tt>#&#x003C;</tt> signals an error.)
<div class="newer">
      <!--l. 1785--><p class="noindent" >The usual convention for printing unreadable data objects is to print some
      identifying information (the internal machine address of the object, if
      nothing else) preceded by <tt>#&#x003C;</tt> and followed by <tt><a 
href="symbols.html#x187-2604062r62">&#x003E;</a></tt>.
      <!--l. 1789--><p class="noindent" >X3J13 voted in June 1989 <a 
 id="dx139-1639002"></a>to add <tt><a 
href="symbols.html#x187-2604690r690">print-unreadable-object</a></tt>, a macro that
      prints an object using <tt>#&#x003C;...&#x003E;</tt> syntax and also takes care of checking the
      variable <tt>*print-readably*</tt>.
      </div>
      <li><b>
<tt>#</tt><span class="math">⟨</span>space<span class="math">⟩</span>, <tt> #</tt><span class="math">⟨</span>tab<span class="math">⟩</span>, <tt> #</tt><span class="math">⟨</span>newline<span class="math">⟩</span>, <tt> #</tt><span class="math">⟨</span>page<span class="math">⟩</span>, <tt> #</tt><span class="math">⟨</span>return<span class="math">⟩</span> </b></li>A <tt>#</tt> followed by
      a whitespace character is not legal reader syntax. This prevents
      abbreviated forms produced via <tt>*print-level*</tt> cutoﬀ from reading in
      again, as a safeguard against losing information. (More precisely, this
      <i>is</i> legal syntax, but the macro-character function for it signals an
      error.)
      <li><b>
<tt>#)</tt> </b></li>This is not legal reader syntax. This prevents abbreviated forms produced via
      <tt>*print-level*</tt> cutoﬀ from reading in again, as a safeguard against losing
      information. (More precisely, this <i>is</i> legal syntax, but the macro-character
      function for it signals an error.)</ul>
</div>
   <h4 class="subsectionHead"><span class="titlemark">22.1.5   </span> <a 
href="frontmatter.html#QQ2-139-1675" id="x139-164000022.1.5">The Readtable</a></h4>
<!--l. 1816--><p class="noindent" >Previous sections describe the standard syntax accepted by the <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> function.
This section discusses the advanced topic of altering the standard syntax either to
provide extended syntax for Lisp objects or to aid the writing of other
parsers.
<!--l. 1821--><p class="indent" >   There is a data structure called the <i>readtable</i> that is used to control
the reader. It contains information about the syntax of each character
equivalent to that in table <a 
href="#x139-15540021">22.1<!--tex4ht:ref: Standard-Character-Syntax-Table --></a>. It is set up exactly as in table <a 
href="#x139-15540021">22.1<!--tex4ht:ref: Standard-Character-Syntax-Table --></a> to
give the standard Common Lisp meanings to all the characters, but the
user can change the meanings of characters to alter and customize the
syntax of characters. It is also possible to have several readtables describing
                                                                          

                                                                          
diﬀerent syntaxes and to switch from one to another by binding the variable
<tt>*readtable*</tt>.
<div class="defun">
<!--l. 1831--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1640001"></a><a 
 id="x139-1640002r636"></a> <b>*readtable*</b>
</div>
<!--l. 1834--><p class="indent" >   The value of <tt>*readtable*</tt> is the current readtable. The initial value of this is
a readtable set up for standard Common Lisp syntax. You can bind this variable
to temporarily change the readtable being used.
</div>
<!--l. 1839--><p class="indent" >   To program the reader for a diﬀerent syntax, a set of functions are provided
for manipulating readtables. Normally, you should begin with a copy of the
standard Common Lisp readtable and then customize the individual characters
within that copy.
<div class="defun">
<!--l. 1844--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx139-1640003"></a><a 
 id="x139-1640004r637"></a> <b>copy-readtable</b>  <b>&#x0026;optional</b>  <i>from-readtable</i> <i>to-readtable</i>
</div>
<!--l. 1847--><p class="indent" >   A copy is made of <i>from-readtable</i>, which defaults to the current readtable
(the value of the global variable <tt>*readtable*</tt>). If <i>from-readtable</i> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>,
then a copy of a standard Common Lisp readtable is made. For example,
<div class="lisp"><div class="tabbing">
(setq *readtable* (copy-readtable nil))
   <br>
<!--l. 1853--><p class="noindent" ></div>
<!--l. 1853--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-164100022.1.5" id="x139-164100022.1.5"></a></span>
<!--l. 1853--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-164200022.1.5" id="x139-164200022.1.5"></a></span>
</div>
                                                                          

                                                                          
<!--l. 1854--><p class="indent" >   will restore the input syntax to standard Common Lisp syntax, even if
the original readtable has been clobbered (assuming it is not so badly
clobbered that you cannot type in the above expression!). On the other hand,
<div class="lisp"><div class="tabbing">
(setq *readtable* (copy-readtable))
   <br>
<!--l. 1860--><p class="noindent" ></div>
<!--l. 1860--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-164300022.1.5" id="x139-164300022.1.5"></a></span>
<!--l. 1860--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-164400022.1.5" id="x139-164400022.1.5"></a></span>
</div>
<!--l. 1861--><p class="indent" >   will merely replace the current readtable with a copy of itself.
<!--l. 1863--><p class="indent" >   If <i>to-readtable</i> is unsupplied or <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, a fresh copy is made. Otherwise,
<i>to-readtable</i> must be a readtable, which is destructively copied into.
</div>
<div class="defun">
<!--l. 1867--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx139-1644001"></a><a 
 id="x139-1644002r638"></a> <b>readtablep</b>  <i>object</i>
</div>
<tt>
<!--l. 1870--><p class="indent" >   <a 
href="symbols.html#x187-2604726r726">readtablep</a></tt> is true if its argument is a readtable, and otherwise is false.
<div class="lisp"><div class="tabbing">
(readtablep x) <span class="math"> ≡</span> (typep x &#x2019;readtable)
   <br>
<!--l. 1874--><p class="noindent" ></div>
<!--l. 1874--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-164500022.1.5" id="x139-164500022.1.5"></a></span>
                                                                          

                                                                          
<!--l. 1874--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-164600022.1.5" id="x139-164600022.1.5"></a></span>
</div>
</div>
<div class="defun">
<!--l. 1877--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx139-1646001"></a><a 
 id="x139-1646002r639"></a> <b>set-syntax-from-char</b>  <i>to-char</i> <i>from-char</i> <b>&#x0026;optional</b>  <i>to-readtable</i>
<i>from-readtable</i>
</div>
<!--l. 1880--><p class="indent" >   This makes the syntax of <i>to-char</i> in <i>to-readtable</i> be the same as the syntax of
<i>from-char</i> in <i>from-readtable</i>. The <i>to-readtable</i> defaults to the current readtable
(the value of the global variable <tt>*readtable*</tt>), and <i>from-readtable</i> defaults to
<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, meaning to use the syntaxes from the standard Lisp readtable. <div class="new"> X3J13 voted
in January 1989 <a 
 id="dx139-1646003"></a>to clarify that the <i>to-char</i> and <i>from-char</i> must each be a
character.
</div>
<!--l. 1892--><p class="indent" >   Only attributes as shown in table <a 
href="#x139-15540021">22.1<!--tex4ht:ref: Standard-Character-Syntax-Table --></a> are copied; moreover, if a <i>macro
character</i> is copied, the macro deﬁnition function is copied also. However,
attributes as shown in table <a 
href="#x139-15560024">22.4<!--tex4ht:ref: Standard-Readtable-Attributes-Table --></a> are not copied; they are “hard-wired” into
the extended-token parser. For example, if the deﬁnition of <tt>S</tt> is copied
to <tt><a 
href="symbols.html#x187-2604002r2">*</a></tt>, then <tt><a 
href="symbols.html#x187-2604002r2">*</a></tt> will become a <i>constituent</i> that is <i>alphabetic</i> but cannot be
used as an exponent indicator for short-format ﬂoating-point number
syntax.
<!--l. 1904--><p class="indent" >   It works to copy a macro deﬁnition from a character such as <tt>&#x0022;</tt> to another
character; the standard deﬁnition for <tt>&#x0022;</tt> looks for another character that is the
same as the character that invoked it. It doesn&#x2019;t work to copy the deﬁnition of <tt>(</tt>
to <tt>{</tt>, for example; it can be done, but it lets one write lists in the form <tt>{a b c)</tt>,
not <tt>{a b c}</tt>, because the deﬁnition always looks for a closing parenthesis, not a
closing brace. See the function <tt><a 
href="symbols.html#x187-2604719r719">read-delimited-list</a></tt>, which is useful in this
connection.
<!--l. 1914--><p class="indent" >   The <tt><a 
href="symbols.html#x187-2604775r775">set-syntax-from-char</a></tt> function returns <tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>.
</div>
<div class="defun">
<!--l. 1917--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx139-1646004"></a><a 
 id="x139-1646005r640"></a> <b>set-macro-character</b>  <i>char</i> <i>function</i> <b>&#x0026;optional</b>  <i>non-terminating-p</i>
<i>readtable</i><br />
<i>
                                                                          

                                                                          
[Function]</i><a 
 id="dx139-1646006"></a><a 
 id="x139-1646007r641"></a> <b>get-macro-character</b>  <i>char</i> <b>&#x0026;optional</b>  <i>readtable</i>
</div>
<tt>
<!--l. 1921--><p class="indent" >   <a 
href="symbols.html#x187-2604773r773">set-macro-character</a></tt> causes <i>char</i> to be a macro character that when seen by
<tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> causes <i>function</i> to be called. If <i>non-terminating-p</i> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> (it
defaults to <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>), then it will be a non-terminating macro character: it may
be embedded within extended tokens. <tt><a 
href="symbols.html#x187-2604773r773">set-macro-character</a></tt> returns
<tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>.
<tt>
<!--l. 1928--><p class="indent" >   <a 
href="symbols.html#x187-2604415r415">get-macro-character</a></tt> returns the function associated with <i>char</i> and, as a
second value, returns the <i>non-terminating-p</i> ﬂag; it returns <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> if <i>char</i> does not
have macro-character syntax. In each case, <i>readtable</i> defaults to the current
readtable.
<!--l. 1933--><p class="indent" >   If <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> is explicitly passed as the second argument to <tt><a 
href="symbols.html#x187-2604415r415">get-macro-character</a></tt>,
then the standard readtable is used. This is consistent with the behavior of
<tt><a 
href="symbols.html#x187-2604257r257">copy-readtable</a></tt>.
<!--l. 1937--><p class="indent" >   The <i>function</i> is called with two arguments, <i>stream</i> and <i>char</i>. The <i>stream</i> is the
input stream, and <i>char</i> is the macro character itself. In the simplest case, <i>function</i>
may return a Lisp object. This object is taken to be that whose printed
representation was the macro character and any following characters read by the
<i>function</i>. As an example, a plausible deﬁnition of the standard single quote
character is: <div class="lisp"><div class="tabbing">
(defun single-quote-reader (stream char)
   <br>                                                                 (declare (ignore char))<br>
  (list &#x2019;quote (read stream t nil t)))<br>                                       <br>
(set-macro-character #\&#x2019; #&#x2019;single-quote-reader)<br>
<!--l. 1952--><p class="noindent" ></div>
<!--l. 1952--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-164700022.1.5" id="x139-164700022.1.5"></a></span>
<!--l. 1952--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-164800022.1.5" id="x139-164800022.1.5"></a></span>
</div>
                                                                          

                                                                          
<!--l. 1953--><p class="indent" >   (Note that <tt><a 
href="symbols.html#x187-2604868r868">t</a></tt> is speciﬁed for the <i>recursive-p</i> argument to <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt>; see
section <a 
href="clmse113.html#x140-171200022.2.1">22.2.1<!--tex4ht:ref: CHARACTER-INPUT-SECTION --></a>.) The function reads an object following the single-quote and
returns a list of the symbol <tt><a 
href="symbols.html#x187-2604705r705">quote</a></tt> and that object. The <i>char</i> argument is
ignored.
                                                                          

                                                                          
<!--l. 1961--><p class="indent" >   The function may choose instead to return <i>zero</i> values (for example, by using
<tt>(values)</tt> as the return expression). In this case, the macro character and
whatever it may have read contribute nothing to the object being read. As an
example, here is a plausible deﬁnition for the standard semicolon (comment)
character: <div class="lisp"><div class="tabbing">
(defun semicolon-reader (stream char)
   <br>                                                                 (declare (ignore char))<br>
  ;; First swallow the rest of the current input line.<br>
  ;; End-of-ﬁle is acceptable for terminating the comment.<br>
  (do () ((char= (read-char stream nil #\Newline t) #\Newline)))<br>
  ;; Return zero values.<br>                      (values))<br>                    <br>
(set-macro-character #\; #&#x2019;semicolon-reader)<br>
<!--l. 1977--><p class="noindent" ></div>
<!--l. 1977--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-164900022.1.5" id="x139-164900022.1.5"></a></span>
<!--l. 1977--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-165000022.1.5" id="x139-165000022.1.5"></a></span>
</div>
<!--l. 1978--><p class="indent" >   (Note that <tt><a 
href="symbols.html#x187-2604868r868">t</a></tt> is speciﬁed for the <i>recursive-p</i> argument to <tt><a 
href="symbols.html#x187-2604717r717">read-char</a></tt>; see
section <a 
href="clmse113.html#x140-171200022.2.1">22.2.1<!--tex4ht:ref: CHARACTER-INPUT-SECTION --></a>.)
<!--l. 1981--><p class="indent" >   The <i>function</i> should not have any side eﬀects other than on the <i>stream</i>.
Because of backtracking and restarting of the <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> operation, front ends (such as
editors and rubout handlers) to the reader may cause <i>function</i> to be called
repeatedly during the reading of a single expression in which the macro character
only appears once.
<div class="new">
<!--l. 1991--><p class="indent" >   Here is an example of a more elaborate set of read-macro characters that I
used in the implementation of the original simulator for Connection Machine Lisp
<span class="cite">[<a 
href="bib.html#XCONNECTION-MACHINE-LISP">44</a>, <a 
href="bib.html#XCMLISP-IMPLEMENTATION">57</a>]</span>, a parallel dialect of Common Lisp. This simulator was used to
gain experience with the language before freezing its design for full-scale
implementation on a Connection Machine computer system. This example
illustrates the typical manner in which a language designer can embed a new
language within the syntactic and semantic framework of Lisp, saving the eﬀort of
designing an implementation from scratch.
                                                                          

                                                                          
<!--l. 2002--><p class="indent" >   Connection Machine Lisp introduces a new data type called a <i>xapping</i>,
which is simply an unordered set of ordered pairs of Lisp objects. The
ﬁrst element of each pair is called the <i>index</i> and the second element the
<i>value</i>. We say that the xapping maps each index to its corresponding
value. No two pairs of the same xapping may have the same (that is, <tt><a 
href="symbols.html#x187-2604338r338">eql</a></tt>)
index. Xappings may be ﬁnite or inﬁnite sets of pairs; only certain kinds of
inﬁnite xappings are required, and special representations are used for
them.
<!--l. 2010--><p class="indent" >   A ﬁnite xapping is notated by writing the pairs between braces, separated by
whitespace. A pair is notated by writing the index and the value, separated by a
right arrow (or an exclamation point if the host Common Lisp has no right-arrow
character).________________________________________________________________
<!--l. 2015--><p class="noindent" ><b>Примечание:</b> The original language design used the right arrow; the exclamation point
was chosen to replace it on ASCII-only terminals because it is one of the six characters
<tt>[ ] { } ! ?</tt> reserved by Common Lisp to the user.
<!--l. 2020--><p class="indent" >     While preparing the <span class="TEX">T<span 
class="E">E</span>X</span> manuscript for this book I made a mistake in font
selection and discovered that by an absolutely incredible coincidence the right arrow has
the same numerical code (octal 41) within <span class="TEX">T<span 
class="E">E</span>X</span> fonts as the ASCII exclamation
point. The result was that although the manuscript called for right arrows,
exclamation points came out in the printed copy. Imagine my astonishment!_______
<!--l. 2029--><p class="indent" >     Here is an example of a xapping that maps three symbols to strings:
<div class="lisp"><div class="tabbing">
{moe<span class="math"> ⇒</span>&#x0022;Oh, a wise guy, eh?&#x0022; larry<span class="math"> ⇒</span>&#x0022;Hey, what&#x2019;s the idea?&#x0022;
     <br>                                                       curly<span class="math"> ⇒</span>&#x0022;Nyuk, nyuk, nyuk!&#x0022;}<br>
<!--l. 2034--><p class="noindent" ></div>
<!--l. 2034--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-165100022.1.5" id="x139-165100022.1.5"></a></span>
<!--l. 2034--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-165200022.1.5" id="x139-165200022.1.5"></a></span>
</div>
                                                                          

                                                                          
<!--l. 2035--><p class="indent" >   For convenience there are certain abbreviated notations. If the index and value
for a pair are the same object <i>x</i>, then instead of having to write “<i>x</i><span class="math"> ⇒</span><i>x</i>” (or,
worse yet, “<tt>#43=<i>x</i><span class="math"> ⇒</span>#43#</tt>”) we may write simply <i>x</i> for the pair. If all pairs of a
xapping are of this form, we call the xapping a <i>xet</i>. For example, the notation
<div class="lisp"><div class="tabbing">
{baseball chess cricket curling bocce 43-man-squamish}
   <br>
<!--l. 2044--><p class="noindent" ></div>
<!--l. 2044--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-165300022.1.5" id="x139-165300022.1.5"></a></span>
<!--l. 2044--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-165400022.1.5" id="x139-165400022.1.5"></a></span>
</div>
<!--l. 2045--><p class="indent" >   is entirely equivalent in meaning to <div class="lisp"><div class="tabbing">
{baseball<span class="math"> ⇒</span>baseball curling<span class="math"> ⇒</span>curling cricket<span class="math"> ⇒</span>cricket
   <br>      chess<span class="math"> ⇒</span>chess bocce<span class="math"> ⇒</span>bocce 43-man-squamish<span class="math"> ⇒</span>43-man-squamish}<br>
<!--l. 2049--><p class="noindent" ></div>
<!--l. 2049--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-165500022.1.5" id="x139-165500022.1.5"></a></span>
<!--l. 2049--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-165600022.1.5" id="x139-165600022.1.5"></a></span>
</div>
<!--l. 2050--><p class="indent" >   namely a xet of symbols naming six sports.
<!--l. 2052--><p class="indent" >   Another useful abbreviation covers the situation where the <i>n</i> pairs of a ﬁnite
xapping are integers, collectively covering a range from zero to <span class="math"><i>n</i> − 1</span>.
This kind of xapping is called a <i>xector</i> and may be notated by writing
the values between brackets in ascending order of their indices. Thus
<div class="lisp"><div class="tabbing">
                                                                          

                                                                          
[tinker evers chance]
   <br>
<!--l. 2059--><p class="noindent" ></div>
<!--l. 2059--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-165700022.1.5" id="x139-165700022.1.5"></a></span>
<!--l. 2059--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-165800022.1.5" id="x139-165800022.1.5"></a></span>
</div>
<!--l. 2060--><p class="indent" >   is merely an abbreviation for <div class="lisp"><div class="tabbing">
{tinker<span class="math"> ⇒</span>0 evers<span class="math"> ⇒</span>1 chance<span class="math"> ⇒</span>2}
   <br>
<!--l. 2063--><p class="noindent" ></div>
<!--l. 2063--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-165900022.1.5" id="x139-165900022.1.5"></a></span>
<!--l. 2063--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-166000022.1.5" id="x139-166000022.1.5"></a></span>
</div>
<!--l. 2065--><p class="indent" >   There are two kinds of inﬁnite xapping: constant and universal. A
constant xapping <tt>{<span class="math"> ⇒</span><i>z</i>}</tt> maps every object to the same value <i>z</i>. The
universal xapping <tt>{<span class="math"> ⇒</span>}</tt> maps every object to itself and is therefore the xet
of all Lisp objects, sometimes called simply the universe. Both kinds of
inﬁnite xet may be modiﬁed by explicitly writing exceptions. One kind
of exception is simply a pair, which speciﬁes the value for a particular
index; the other kind of exception is simply  <i>k</i><span class="math"> ⇒</span> indicating that the
xapping does <i>not</i> have a pair with index <i>k</i> after all. Thus the notation
<div class="lisp"><div class="tabbing">
{sky<span class="math"> ⇒</span>blue grass<span class="math"> ⇒</span>green idea<span class="math"> ⇒</span> glass<span class="math"> ⇒</span><span class="math">⇒</span>red}
   <br>
                                                                          

                                                                          
<!--l. 2075--><p class="noindent" ></div>
<!--l. 2075--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-166100022.1.5" id="x139-166100022.1.5"></a></span>
<!--l. 2075--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-166200022.1.5" id="x139-166200022.1.5"></a></span>
</div>
<!--l. 2076--><p class="indent" >   indicates a xapping that maps <tt>sky</tt> to <tt>blue</tt>, <tt>grass</tt> to <tt>green</tt>, and every other
object except <tt>idea</tt> and <tt>glass</tt> to <tt>red</tt>. Note well that the presence or absence of
whitespace on either side of an arrow is crucial to the correct interpretation of the
notation.
<!--l. 2082--><p class="indent" >   Here is the representation of a xapping as a structure: <div class="lisp"><div class="tabbing">
(defstruct
   <br>                                         (xapping (:print-function print-xapping)<br>
           (:constructor xap<br>                 (domain range &#x0026;optional<br>
              (default &#x2019;:unknown defaultp)<br>
              (inﬁnite (and defaultp :constant))<br>
              (exceptions &#x2019;()))))<br>             domain<br>             range<br>
  default<br>               (inﬁnite nil :type (member nil :constant :universal)<br>
  exceptions)<br>
<!--l. 2096--><p class="noindent" ></div>
<!--l. 2096--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-166300022.1.5" id="x139-166300022.1.5"></a></span>
<!--l. 2096--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-166400022.1.5" id="x139-166400022.1.5"></a></span>
</div>
<!--l. 2097--><p class="indent" >   The explicit pairs are represented as two parallel lists, one of indexes (<tt>domain</tt>)
and one of values (<tt>range</tt>). The <tt>default</tt> slot is the default value, relevant only if
the <tt>infinite</tt> slot is <tt>:constant</tt>. The <tt>exceptions</tt> slot is a list of indices for which
there are no values. (See the end of section <a 
href="clmse114.html#x141-174800022.3.3">22.3.3<!--tex4ht:ref: FORMAT-SECTION --></a> for the deﬁnition of
<tt>print-xapping</tt>.)
<!--l. 2103--><p class="indent" >   Here, then, is the code for reading xectors in bracket notation: <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(defun open-bracket-macro-char (stream macro-char)
   <br>                                                        (declare (ignore macro-char))<br>
  (let ((range (read-delimited-list #\] stream t)))<br>
    (xap (iota-list (length range)) range)))<br>
<br>                      (set-macro-character #\[ #&#x2019;open-bracket-macro-char)<br>
(set-macro-character #\] (get-macro-character #\) ))<br>
<br>            (defun iota-list (n)     ;Return list of integers from <span class="math">0</span> to <span class="math"><i>n</i> − 1</span><br>
  (do ((j (- n 1) (- j 1))<br>                                 (z &#x2019;() (cons j z)))<br>
      ((&#x003C; j 0) z)))<br>
<!--l. 2117--><p class="noindent" ></div>
<!--l. 2117--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-166500022.1.5" id="x139-166500022.1.5"></a></span>
<!--l. 2117--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-166600022.1.5" id="x139-166600022.1.5"></a></span>
</div>
<!--l. 2118--><p class="indent" >   The code for reading xappings in the more general brace notation, with all the
possibilities for xets (or individual xet pairs), inﬁnite xappings, and exceptions, is
a bit more complicated; it is shown in table <a 
href="#x139-16680016">22.6<!--tex4ht:ref: XAPPING-MACRO-CHAR-TABLE --></a>. That code is used in
conjunction with the initializations <div class="lisp"><div class="tabbing">
(set-macro-character #\{ #&#x2019;open-brace-macro-char)
   <br>                        (set-macro-character #\} (get-macro-character #\) ))<br>
<!--l. 2125--><p class="noindent" ></div>
<!--l. 2125--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-166700022.1.5" id="x139-166700022.1.5"></a></span>
<!--l. 2125--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-166800022.1.5" id="x139-166800022.1.5"></a></span>
</div>
</div>
</div>
   <div class="table">
                                                                          

                                                                          
<!--l. 2131--><p class="indent" >   <a 
 id="x139-16680016"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
<div class="new">
 <div class="caption" 
><span class="id">Таблица 22.6: </span><span  
class="content">Macro Character Deﬁnition for Xapping Syntax</span></div><!--tex4ht:label?: x139-16680016 -->
<div class="lisp">
<div class="tabbing">
(defun open-brace-macro-char (s macro-char)
<br>                                             (declare (ignore macro-char))<br>
  (do ((ch (peek-char t s t nil t) (peek-char t s t nil t))<br>
       (domain &#x2019;())  (range &#x2019;())  (exceptions &#x2019;()))<br>
      ((char= ch #\})<br>                               (read-char s t nil t)<br>
       (construct-xapping (reverse domain) (reverse range)))<br>
    (cond ((char= ch #\<span class="math"> ⇒</span>)<br>                        (read-char s t nil t)<br>
           (let ((nextch (peek-char nil s t nil t)))<br>
             (cond ((char= nextch #\})<br>                    (read-char s t nil t)<br>
                    (return (xap (reverse domain)<br>
                                 (reverse range)<br>
                                 nil :universal exceptions)))<br>
                   (t (let ((item (read s t nil t)))<br>
                        (cond ((char= (peek-char t s t nil t) #\})<br>
                               (read-char s t nil t)<br>
                               (return (xap (reverse domain)<br>
                                            (reverse range)<br>
                                            item :constant<br>
                                            exceptions)))<br>
                              (t (reader-error s<br>
                                   &#x0022;Default <span class="math"> ⇒</span> item must be last&#x0022;))))))))<br>
          (t (let ((item (read-preserving-whitespace s t nil t))<br>
                   (nextch (peek-char nil s t nil t)))<br>
               (cond ((char= nextch #\<span class="math"> ⇒</span>)<br>
                      (read-char s t nil t)<br>                      (cond ((member (peek-char nil s t nil t)<br>
                                     &#x2019;(#\Space #\Tab #\Newline))<br>
                             (push item exceptions))<br>
                            (t (push item domain)<br>
                               (push (read s t nil t) range))))<br>
                     ((char= nch #\})<br>                      (read-char s t nil t)<br>
                      (push item domain)<br>
                                                                          

                                                                          
                      (push item range)<br>                      (return (xap (reverse domain) (reverse range))))<br>
                     (t (push item domain)<br>
                        (push item range))))))))<br>
</div>
<!--l. 2175--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-16690006" id="x139-16690006"></a></span>
<!--l. 2175--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-16700006" id="x139-16700006"></a></span>
</div>
</div>
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
<div class="defun">
<!--l. 2179--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx139-1670001"></a><a 
 id="x139-1670002r642"></a> <b>make-dispatch-macro-character</b>  <i>char</i> <b>&#x0026;optional</b>
<i>non-terminating-p</i> <i>readtable</i>
</div>
<!--l. 2182--><p class="indent" >   This causes the character <i>char</i> to be a dispatching macro character in
<i>readtable</i> (which defaults to the current readtable). If <i>non-terminating-p</i> is not
<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> (it defaults to <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>), then it will be a non-terminating macro character: it may
be embedded within extended tokens. <tt><a 
href="symbols.html#x187-2604536r536">make-dispatch-macro-character</a></tt> returns
<tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>.
<!--l. 2189--><p class="indent" >   Initially every character in the dispatch table has a character-macro function
that signals an error. Use <tt><a 
href="symbols.html#x187-2604771r771">set-dispatch-macro-character</a></tt> to deﬁne entries in
the dispatch table. <div class="new"> X3J13 voted in January 1989 <a 
 id="dx139-1670003"></a>to clarify that <i>char</i> must be a
character.
</div>
</div>
<div class="defun">
<!--l. 2200--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx139-1670004"></a><a 
 id="x139-1670005r643"></a> <b>set-dispatch-macro-character</b>  <i>disp-char</i> <i>sub-char</i> <i>function</i>
<b>&#x0026;optional</b>  <i>readtable</i><br />
<i>
[Function]</i><a 
 id="dx139-1670006"></a><a 
 id="x139-1670007r644"></a> <b>get-dispatch-macro-character</b>  <i>disp-char</i> <i>sub-char</i> <i>    </i>
<b>&#x0026;optional</b>  <i>readtable</i>
</div>
<tt>
<!--l. 2204--><p class="indent" >   <a 
href="symbols.html#x187-2604771r771">set-dispatch-macro-character</a></tt> causes <i>function</i> to be called when the
<i>disp-char</i> followed by <i>sub-char</i> is read. The <i>readtable</i> defaults to the current
readtable. The arguments and return values for <i>function</i> are the same
as for normal macro characters except that <i>function</i> gets <i>sub-char</i>, not
<i>disp-char</i>, as its second argument and also receives a third argument
that is the non-negative integer whose decimal representation appeared
between <i>disp-char</i> and <i>sub-char</i>, or <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> if no decimal integer appeared
there.
<!--l. 2216--><p class="indent" >   The <i>sub-char</i> may not be one of the ten decimal digits; they are always
                                                                          

                                                                          
reserved for specifying an inﬁx integer argument. Moreover, if <i>sub-char</i> is a
lowercase character (see <tt><a 
href="symbols.html#x187-2604523r523">lower-case-p</a></tt>), its uppercase equivalent is used instead.
(This is how the rule is enforced that the case of a dispatch sub-character doesn&#x2019;t
matter.)
<tt>
<!--l. 2223--><p class="indent" >   <a 
href="symbols.html#x187-2604771r771">set-dispatch-macro-character</a></tt> returns <tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>.
<tt>
<!--l. 2225--><p class="indent" >   <a 
href="symbols.html#x187-2604412r412">get-dispatch-macro-character</a></tt> returns the macro-character function for
<i>sub-char</i> under <i>disp-char</i>, or <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> if there is no function associated with
<i>sub-char</i>.
<!--l. 2229--><p class="indent" >   If the <i>sub-char</i> is one of the ten decimal digits <tt>0 1 2 3 4 5 6 7 8 9</tt>,
<tt><a 
href="symbols.html#x187-2604412r412">get-dispatch-macro-character</a></tt> always returns <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>. If <i>sub-char</i> is a lowercase
character, its uppercase equivalent is used instead.
<div class="new">
<!--l. 2235--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx139-1670008"></a>to specify that if <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> is explicitly passed as the
second argument to <tt><a 
href="symbols.html#x187-2604412r412">get-dispatch-macro-character</a></tt>, then the standard
readtable is used. This is consistent with the behavior of <tt><a 
href="symbols.html#x187-2604257r257">copy-readtable</a></tt>.
</div>
<!--l. 2242--><p class="indent" >   For either function, an error is signaled if the speciﬁed <i>disp-char</i> is not in
fact a dispatch character in the speciﬁed readtable. It is necessary to use
<tt><a 
href="symbols.html#x187-2604536r536">make-dispatch-macro-character</a></tt> to set up the dispatch character before
specifying its sub-characters.
<!--l. 2248--><p class="indent" >   As an example, suppose one would like <tt>#$<i>foo</i></tt> to be read as if it were
<tt>(dollars <i>foo</i>)</tt>. One might say: <div class="lisp"><div class="tabbing">
(defun |#$-reader| (stream subchar arg)
   <br>                                                       (declare (ignore subchar arg))<br>
  (list &#x2019;dollars (read stream t nil t)))<br>                                      <br>
(set-dispatch-macro-character #\# #\$ #&#x2019;|#$-reader|)<br>
<!--l. 2256--><p class="noindent" ></div>
<!--l. 2256--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-167100022.1.5" id="x139-167100022.1.5"></a></span>
                                                                          

                                                                          
<!--l. 2256--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-167200022.1.5" id="x139-167200022.1.5"></a></span>
</div>
</div>
<div class="newer">
<div class="defun">
<!--l. 2260--><p class="noindent" ><div class="defunheader"> <i>[Function]</i><a 
 id="dx139-1672001"></a><a 
 id="x139-1672002r645"></a> <b>readtable-case</b>  <i>readtable</i>
</div>
<!--l. 2263--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx139-1672003"></a>to introduce the function <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> to
control the reader&#x2019;s interpretation of case. It provides access to a slot in a
readtable, and may be used with <tt><a 
href="symbols.html#x187-2604776r776">setf</a></tt> to alter the state of that slot. The possible
values for the slot are <tt>:upcase</tt>, <tt>:downcase</tt>, <tt>:preserve</tt>, and <tt>:invert</tt>;
the <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> for the standard readtable is <tt>:upcase</tt>. Note that
<tt><a 
href="symbols.html#x187-2604257r257">copy-readtable</a></tt> is required to copy the <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> slot along with all other
readtable information.
<!--l. 2274--><p class="indent" >   Once the reader has accumulated a token as described in section <a 
href="#x139-155400022.1.1">22.1.1<!--tex4ht:ref: READER --></a>, if the
token is a symbol, “replaceable” characters (unescaped uppercase or lowercase
constituent characters) may be modiﬁed under the control of the <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt>
of the current readtable:
      <ul class="itemize1">
      <li class="itemize">For <tt>:upcase</tt>, replaceable characters are converted to uppercase. (This
      was the behavior speciﬁed by the ﬁrst edition.)
      </li>
      <li class="itemize">For <tt>:downcase</tt>, replaceable characters are converted to lowercase.
      </li>
      <li class="itemize">For <tt>:preserve</tt>, the cases of all characters remain unchanged.
      </li>
      <li class="itemize">For <tt>:invert</tt>, if all of the replaceable letters in the extended token are
      of the same case, they are all converted to the opposite case; otherwise
      the cases of all characters in that token remain unchanged.</li></ul>
<!--l. 2290--><p class="noindent" >As an illustration, consider the following code. <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(let ((*readtable* (copy-readtable nil)))
   <br>                (format t &#x0022;READTABLE-CASE  Input   Symbol-name~<br>
           ~%——————                  —————–~<br>                  ~%&#x0022;)<br>
  (dolist (readtable-case &#x2019;(:upcase :downcase :preserve :invert))<br>
    (setf (readtable-case *readtable*) readtable-case)<br>
    (dolist (input &#x2019;(&#x0022;ZEBRA&#x0022; &#x0022;Zebra&#x0022; &#x0022;zebra&#x0022;))<br>
      (format t &#x0022;:~A~16T~A~24T~A~%&#x0022;<br>
                (string-upcase readtable-case)<br>                  input<br>
                (symbol-name (read-from-string input)))))))<br>
<!--l. 2303--><p class="noindent" ></div>
<!--l. 2303--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-167300022.1.5" id="x139-167300022.1.5"></a></span>
<!--l. 2303--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-167400022.1.5" id="x139-167400022.1.5"></a></span>
</div>
<!--l. 2304--><p class="indent" >   The output from this test code should be <div class="lisp"><div class="tabbing">
READTABLE-CASE  Input   Symbol-name
   <br>       ———————————–<br>       :UPCASE         ZEBRA   ZEBRA<br>
:UPCASE         Zebra   ZEBRA<br>
:UPCASE         zebra   ZEBRA<br>
:DOWNCASE       ZEBRA   zebra<br>
:DOWNCASE       Zebra   zebra<br> :DOWNCASE       zebra   zebra<br>
:PRESERVE       ZEBRA   ZEBRA<br>
:PRESERVE       Zebra   Zebra<br>    :PRESERVE       zebra   zebra<br>
:INVERT         ZEBRA   zebra<br>   :INVERT         Zebra   Zebra<br>
:INVERT         zebra   ZEBRA<br>
<!--l. 2320--><p class="noindent" ></div>
<!--l. 2320--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-167500022.1.5" id="x139-167500022.1.5"></a></span>
                                                                          

                                                                          
<!--l. 2320--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-167600022.1.5" id="x139-167600022.1.5"></a></span>
</div>
</div>
<!--l. 2322--><p class="indent" >   The <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> of the current readtable also aﬀects the printing of
symbols (see <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt> and <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt>).
</div>
<!--l. 2326--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">22.1.6   </span> <a 
href="frontmatter.html#QQ2-139-1713" id="x139-167700022.1.6">What the Print Function Produces</a></h4>
<!--l. 2329--><p class="noindent" >The Common Lisp printer is controlled by a number of special variables. These
are referred to in the following discussion and are fully documented at the end of
this section.
<!--l. 2333--><p class="indent" >   How an expression is printed depends on its data type, as described in the
following paragraphs.
<div class="flushdesc">
      <ul><li><b>
<i>Integers</i> </b></li>If appropriate, a radix speciﬁer may be printed; see the variable
      <tt>*print-radix*</tt>. If an integer is negative, a minus sign is printed and
      then the absolute value of the integer is printed. Integers are printed in
      the radix speciﬁed by the variable <tt>*print-base*</tt> in the usual positional
      notation, most signiﬁcant digit ﬁrst. The number zero is represented
      by the single digit <tt>0</tt> and never has a sign. A decimal point may then
      be printed, depending on the value of <tt>*print-radix*</tt>.
      <li><b>
<i>Ratios</i> </b></li>If appropriate, a radix speciﬁer may be printed; see the variable
      <tt>*print-radix*</tt>. If the ratio is negative, a minus sign is printed. Then
      the absolute value of the numerator is printed, as for an integer; then
      a <tt><a 
href="symbols.html#x187-2604055r55">/</a></tt>; then the denominator. The numerator and denominator are both
      printed in the radix speciﬁed by the variable <tt>*print-base*</tt>; they are
      obtained as if by the <tt><a 
href="symbols.html#x187-2604636r636">numerator</a></tt> and <tt><a 
href="symbols.html#x187-2604299r299">denominator</a></tt> functions, and so
      ratios are always printed in reduced form (lowest terms).
      <li><b>
<i>Floating-point numbers</i> </b></li>If the sign of the number (as determined by the
                                                                          

                                                                          
      function <tt><a 
href="symbols.html#x187-2604384r384">float-sign</a></tt>) is negative, then a minus sign is printed. Then
      the magnitude is printed in one of two ways. If the magnitude of the
      ﬂoating-point number is either zero or between <span class="math">10<sup>−3</sup></span>  (inclusive) and
      <span class="math">10<sup>7</sup></span>  (exclusive), it may be printed as the integer part of the number,
      then a decimal point, followed by the fractional part of the number;
      there is always at least one digit on each side of the decimal point. If
      the format of the number does not match that speciﬁed by the variable
      <tt><a 
href="symbols.html#x187-2604042r42">*read-default-float-format*</a></tt>, then the exponent marker for that
      format and the digit <tt>0</tt> are also printed. For example, the base of the
      natural logarithms as a short-format ﬂoating-point number might be
      printed as <tt>2.71828S0</tt>.
      <!--l. 2376--><p class="noindent" >For  non-zero  magnitudes  outside  of  the  range  <span class="math">10<sup>−3</sup></span>   to  <span class="math">10<sup>7</sup></span>,  a
      ﬂoating-point  number  will  be  printed  in  “computerized  scientiﬁc
      notation.” The representation of the number is scaled to be between 1
      (inclusive) and 10 (exclusive) and then printed, with one digit before
      the  decimal  point  and  at  least  one  digit  after  the  decimal  point.
      Next  the  exponent  marker  for  the  format  is  printed,  except  that
      if the format of the number matches that speciﬁed by the variable
      <tt><a 
href="symbols.html#x187-2604042r42">*read-default-float-format*</a></tt>, then the exponent marker <tt>E</tt> is used.
      Finally, the power of 10 by which the fraction must be multiplied to
      equal the original number is printed as a decimal integer. For example,
      Avogadro&#x2019;s number as a short-format ﬂoating-point number might be
      printed as <tt>6.02S23</tt>.
      <li><b>
<i>Complex numbers</i> </b></li>A   complex   number   is   printed   as   <tt>#C</tt>,   an   open
      parenthesis,  the  printed  representation  of  its  real  part,  a  space,
      the printed representation of its imaginary part, and ﬁnally a close
      parenthesis.
<div class="obsolete">
<i>Characters</i> When <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, a character prints as itself; it is sent
      directly to the output stream. When <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, then <tt>#\</tt>
      syntax is used. For example, the printed representation of the character <tt>#\A</tt>
      with control and meta bits on would be <tt>#\CONTROL-META-A</tt>, and that of <tt>#\a</tt>
      with control and meta bits on would be <tt>#\CONTROL-META-\a</tt>.
      </div> <div class="newer"> X3J13 voted in June 1989 <a 
 id="dx139-1677001"></a>to specify that if <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>
                                                                          

                                                                          
      then every object must be printed in a readable form, regardless of other
      printer control variables. For characters, the simplest approach is always to
      use <tt>#\</tt> syntax when <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, regardless of the value of
      <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt>.
      </div>
<div class="obsolete">
<i>Symbols</i>
      <!--l. 2423--><p class="noindent" >When <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, only the characters of the print name of the
      symbol are output (but the case in which to print any uppercase characters
      in the print name is controlled by the variable <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt>).
      </div>
<div class="newer">
      <!--l. 2430--><p class="noindent" >X3J13 voted in June 1989 <a 
 id="dx139-1677002"></a>to specify that the new <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> slot of
      the current readtable also controls the case in which letters (whether
      uppercase or lowercase) in the print name of a symbol are output, no matter
      what the value of <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt>.
      </div>
<div class="obsolete">
      <!--l. 2437--><p class="noindent" >The remaining paragraphs describing the printing of symbols cover the
      situation when <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>.
      </div>
<div class="newer">
      <!--l. 2442--><p class="noindent" >X3J13 voted in June 1989 <a 
 id="dx139-1677003"></a>to specify that if <tt>*print-readably*</tt>
      is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> then every object must be printed in a readable form,
      regardless of other printer control variables. For symbols, the simplest
      approach is to print them, when <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, as if
      <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> were not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, regardless of the actual value of
      <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt>.
      </div>
      <!--l. 2450--><p class="noindent" >Backslashes <tt>\</tt> and vertical bars <tt>|</tt> are included as required. In particular,
      backslash or vertical-bar syntax is used when the name of the symbol
      would be otherwise treated by the reader as a potential number (see
      section <a 
href="#x139-155500022.1.2">22.1.2<!--tex4ht:ref: PARSE-TOKENS-SECTION --></a>). In making this decision, it is assumed that the value of
      <tt>*print-base*</tt> being used for printing would be used as the value of
                                                                          

                                                                          
      <tt>*read-base*</tt> used for reading; the value of <tt>*read-base*</tt> at the time of
      printing is irrelevant. For example, if the value of <tt>*print-base*</tt> were <tt>16</tt>
      when printing the symbol <tt>face</tt>, it would have to be printed as <tt>\FACE</tt>
      or <tt>\Face</tt> or <tt>|FACE|</tt>, because the token <tt>face</tt> would be read as a
      hexadecimal number (decimal value 64206) if <tt>*read-base*</tt> were
      <tt>16</tt>.
<div class="obsolete">
      <!--l. 2465--><p class="noindent" >The case in which to print any uppercase characters in the print name is
      controlled by the variable <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt>.
      </div> <div class="newer"> X3J13 voted in June 1989 <a 
 id="dx139-1677004"></a>to clarify the interaction of <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt> with
      <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt>; see <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt>.
      </div> As a special case [no pun intended], <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> may sometimes be printed as <tt>()</tt>
      instead, when <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> and <tt><a 
href="symbols.html#x187-2604035r35">*print-pretty*</a></tt> are both not
      <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>.
      <!--l. 2477--><p class="noindent" >Package preﬁxes may be printed (using colon syntax) if necessary. The rules
      for package qualiﬁers are as follows. When the symbol is printed, if it is in
      the keyword package, then it is printed with a preceding colon;
      otherwise, if it is accessible in the current package, it is printed without
      any qualiﬁcation; otherwise, it is printed with qualiﬁcation. See
      chapter <a 
href="xpack.html#x72-89900011">11<!--tex4ht:ref: XPACK --></a>.
<div class="obsolete">
      <!--l. 2487--><p class="noindent" >A symbol that is uninterned (has no home package) is printed preceded by
      <tt>#:</tt> if the variables <tt>*print-gensym*</tt> and <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> are both non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>;
      if either is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, then the symbol is printed without a preﬁx, as if it were in
      the current package.
      </div> <div class="newer"> X3J13 voted in June 1989 <a 
 id="dx139-1677005"></a>to specify that if <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>
      then every object must be printed in a readable form, regardless of
      other printer control variables. For uninterned symbols, the simplest
      approach is to print them, when <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, as if
      <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> and <tt>*print-gensym*</tt> were not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, regardless of their
      actual values.
      </div>_____________________________________________________________________<div class="implementation">
        <!--l. 2503--><p class="noindent" ><b>Заметка для реализации:</b> Because the <tt>#:</tt> syntax does not intern the following
        symbol, it is necessary to use circular-list syntax if <tt><a 
href="symbols.html#x187-2604027r27">*print-circle*</a></tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> and
        the same uninterned symbol appears several times in an expression to be printed.
        For example, the result of <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
      (let ((x (make-symbol &#x0022;FOO&#x0022;))) (list x x))
      <br>
      <!--l. 2511--><p class="noindent" ></div>
      <!--l. 2511--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-167800022.1.6" id="x139-167800022.1.6"></a></span>
      <!--l. 2511--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-167900022.1.6" id="x139-167900022.1.6"></a></span>
</div>
      <!--l. 2512--><p class="noindent" >would be printed as <div class="lisp"><div class="tabbing">
      <tt>(#:foo #:foo)</tt>
      <br>
      <!--l. 2515--><p class="noindent" ></div>
      <!--l. 2515--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-168000022.1.6" id="x139-168000022.1.6"></a></span>
      <!--l. 2515--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-168100022.1.6" id="x139-168100022.1.6"></a></span>
</div>
      <!--l. 2516--><p class="noindent" >if <tt><a 
href="symbols.html#x187-2604027r27">*print-circle*</a></tt> were <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, but as <div class="lisp"><div class="tabbing">
      <tt>(#1=#:foo #1#)</tt>
      <br>
      <!--l. 2520--><p class="noindent" ></div>
                                                                          

                                                                          
      <!--l. 2520--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-168200022.1.6" id="x139-168200022.1.6"></a></span>
      <!--l. 2520--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-168300022.1.6" id="x139-168300022.1.6"></a></span>
</div>
      <!--l. 2521--><p class="noindent" >if <tt><a 
href="symbols.html#x187-2604027r27">*print-circle*</a></tt> were not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>.
      </div>
_____________________________________________________________________
<div class="obsolete">
        <!--l. 2527--><p class="noindent" >The case in which symbols are to be printed is controlled by the variable
        <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt>.
        </div> <div class="newer"> It is also controlled by <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> and the <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> slot of
        the current readtable (the value of <tt>*readtable*</tt>).
        </div> <div class="obsolete">
<i>Strings</i> The characters of the string are output in order. If <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is
        not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, a double quote is output before and after, and all double
        quotes and single escape characters are preceded by backslash. The
        printing of strings is not aﬀected by <tt>*print-array*</tt>. If the string has a
        ﬁll pointer, then only those characters below the ﬁll pointer are
        printed.
        </div>
<div class="newer">
        <!--l. 2546--><p class="noindent" >X3J13 voted in June 1989 <a 
 id="dx139-1683001"></a>to specify that if <tt>*print-readably*</tt>
     is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> then every object must be printed in a readable form,
        regardless of other printer control variables. For strings, the simplest
        approach is to print them, when <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, as if
        <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> were not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, regardless of the actual value of
        <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt>.
        </div>
        <li><b>
<i>Conses</i> </b></li>Wherever possible, list notation is preferred over dot notation. Therefore
        the following algorithm is used:
              <ol  class="enumerate1" >
              <li 
  class="enumerate" id="x139-1683003x1">Print an open parenthesis, <tt>(</tt>.
                                                                          

                                                                          
           </li>
           <li 
  class="enumerate" id="x139-1683005x2">Print the <i>car</i> of the cons.
           </li>
           <li 
  class="enumerate" id="x139-1683007x3">If the <i>cdr</i> is a cons, make it the current cons, print a space, and
           go to step 2.
           </li>
           <li 
  class="enumerate" id="x139-1683009x4">If the <i>cdr</i> is not null, print a space, a dot, a space, and the <i>cdr</i>.
           </li>
           <li 
  class="enumerate" id="x139-1683011x5">Print a close parenthesis, <tt>)</tt>.</li></ol>
      <!--l. 2564--><p class="noindent" >This form of printing is clearer than showing each individual cons cell.
      Although the two expressions below are equivalent, and the reader
      will accept either one and produce the same data structure, the
      printer will always print such a data structure in the second form.
      <div class="lisp"><div class="tabbing">
      (a . (b . ((c . (d . <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>)) . (e . <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>))))
      <br>                                                                                            <br>
           (a b (c d) e)<br>
      <!--l. 2573--><p class="noindent" ></div>
      <!--l. 2573--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-168400022.1.6" id="x139-168400022.1.6"></a></span>
      <!--l. 2573--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-168500022.1.6" id="x139-168500022.1.6"></a></span>
</div>
<div class="obsolete">
      <!--l. 2575--><p class="noindent" >The printing of conses is aﬀected by the variables <tt>*print-level*</tt> and
      <tt>*print-length*</tt>.
      </div>
<div class="newer">
                                                                          

                                                                          
      <!--l. 2580--><p class="noindent" >X3J13 voted in June 1989 <a 
 id="dx139-1685001"></a>to specify that if <tt>*print-readably*</tt>
      is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> then every object must be printed in a readable form,
      regardless of other printer control variables. For conses, the simplest
      approach is to print them, when <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, as if
      <tt>*print-level*</tt> and <tt>*print-length*</tt> were <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, regardless of their actual
      values.
      </div>
<div class="obsolete">
<i>Bit-vectors</i> A bit-vector is printed as <tt>#*</tt> followed by the bits of the bit-vector in
      order. If <tt>*print-array*</tt> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, however, then the bit-vector is printed in a
      format (using <tt>#&#x003C;</tt>) that is concise but not readable. If the bit-vector
      has a ﬁll pointer, then only those bits below the ﬁll pointer are
      printed.
      </div> <div class="newer"> X3J13 voted in June 1989 <a 
 id="dx139-1685002"></a>to specify that if <tt>*print-readably*</tt>
      is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> then every object must be printed in a readable form,
      regardless of other printer control variables. For bit-vectors, the simplest
      approach is to print them, when <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, as
      if <tt>*print-array*</tt> were not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, regardless of the actual value of
      <tt>*print-array*</tt>.
      </div>
      <li><b>
<i>Vectors</i> </b></li>Any vector other than a string or bit-vector is printed using
      general-vector syntax; this means that information about specialized vector
      representations will be lost. The printed representation of a zero-length
      vector is <tt>#()</tt>. The printed representation of a non-zero-length vector begins
      with <tt>#(</tt>. Following that, the ﬁrst element of the vector is printed. If there
      are any other elements, they are printed in turn, with a space printed before
      each additional element. A close parenthesis after the last element
      terminates the printed representation of the vector. <div class="obsolete"> The printing of vectors
      is aﬀected by the variables <tt>*print-level*</tt> and <tt>*print-length*</tt>. If the
      vector has a ﬁll pointer, then only those elements below the ﬁll pointer are
      printed.
      <!--l. 2621--><p class="noindent" >If <tt>*print-array*</tt> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, however, then the vector is not printed as
      described above, but in a format (using <tt>#&#x003C;</tt>) that is concise but not
      readable.
                                                                          

                                                                          
      </div> <div class="newer"> X3J13 voted in June 1989 <a 
 id="dx139-1685003"></a>to specify that if <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>
      then every object must be printed in a readable form, regardless of other
      printer control variables. For vectors, the simplest approach is to print
      them, when <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, as if <tt>*print-level*</tt> and
      <tt>*print-length*</tt> were <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> and <tt>*print-array*</tt> were not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, regardless of
      their actual values.
      </div>
      <li><b>
<i>Arrays</i> </b></li>Normally any array other than a vector is printed using <tt>#<i>n</i>A</tt> format. Let
      <i>n</i> be the rank of the array. Then <tt>#</tt> is printed, then <i>n</i> as a decimal integer,
      then <tt>A</tt>, then <i>n</i> open parentheses. Next the elements are scanned in
      row-major order. Imagine the array indices being enumerated in odometer
      fashion, recalling that the dimensions are numbered from 0 to <span class="math"><i>n</i> − 1</span>. Every
      time the index for dimension <i>j</i> is incremented, the following actions are
      taken:
           <ol  class="enumerate1" >
           <li 
  class="enumerate" id="x139-1685005x1">If <span class="math"><i>j</i> &#x003C; <i>n</i> − 1</span>, then print a close parenthesis.
           </li>
           <li 
  class="enumerate" id="x139-1685007x2">If  incrementing  the  index  for  dimension  <i>j</i>  caused  it  to  equal
           dimension <i>j</i>, reset that index to zero and increment dimension <span class="math"><i>j</i>−1</span>
           (thereby performing these three steps recursively), unless <span class="math"><i>j</i> = 0</span>, in
           which case simply terminate the entire algorithm. If incrementing
           the index for dimension <i>j</i> did not cause it to equal dimension <i>j</i>,
           then print a space.
           </li>
           <li 
  class="enumerate" id="x139-1685009x3">If <span class="math"><i>j</i> &#x003C; <i>n</i> − 1</span>, then print an open parenthesis.</li></ol>
      <!--l. 2658--><p class="noindent" >This causes the contents to be printed in a format suitable for use as the
      <tt>:initial-contents</tt> argument to <tt><a 
href="symbols.html#x187-2604532r532">make-array</a></tt>. <div class="obsolete"> The lists eﬀectively printed
      by this procedure are subject to truncation by <tt>*print-level*</tt> and
      <tt>*print-length*</tt>.
      </div>
      <!--l. 2665--><p class="noindent" >If the array is of a specialized type, containing bits or string-characters, then
      the innermost lists generated by the algorithm given above may instead be
      printed using bit-vector or string syntax, provided that these innermost lists
      would not be subject to truncation by <tt>*print-length*</tt>. For example, a
                                                                          

                                                                          
      3-by-2-by-4 array of string-characters that would ordinarily be printed as
      <div class="lisp"><div class="tabbing">
      #3A(((#\s #\t #\o #\p) (#\s #\p #\o #\t))
      <br>                                 ((#\p #\o #\s #\t) (#\p #\o #\t #\s))<br>
               ((#\t #\o #\p #\s) (#\o #\p #\t #\s)))<br>
      <!--l. 2674--><p class="noindent" ></div>
      <!--l. 2674--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-168600022.1.6" id="x139-168600022.1.6"></a></span>
      <!--l. 2674--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-168700022.1.6" id="x139-168700022.1.6"></a></span>
</div>
      <!--l. 2675--><p class="noindent" >may instead be printed more concisely as <div class="lisp"><div class="tabbing">
      #3A((&#x0022;stop&#x0022; &#x0022;spot&#x0022;) (&#x0022;post&#x0022; &#x0022;pots&#x0022;) (&#x0022;tops&#x0022; &#x0022;opts&#x0022;))
      <br>
      <!--l. 2678--><p class="noindent" ></div>
      <!--l. 2678--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-168800022.1.6" id="x139-168800022.1.6"></a></span>
      <!--l. 2678--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-168900022.1.6" id="x139-168900022.1.6"></a></span>
</div>
<div class="obsolete">
                                                                          

                                                                          
      <!--l. 2681--><p class="noindent" >If <tt>*print-array*</tt> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, then the array is printed in a format (using <tt>#&#x003C;</tt>)
      that is concise but not readable.
      </div> <div class="newer"> X3J13 voted in June 1989 <a 
 id="dx139-1689001"></a>to specify that if <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>
      then every object must be printed in a readable form, regardless of other
      printer control variables. For arrays, the simplest approach is to print
      them, when <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, as if <tt>*print-level*</tt> and
      <tt>*print-length*</tt> were <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> and <tt>*print-array*</tt> were not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, regardless of
      their actual values.
      </div>
      <li><b>
<i>Random-states</i> </b></li>Common Lisp does not specify a speciﬁc syntax for printing
      objects of type <tt>random-state</tt>. However, every implementation must arrange
      to print a random-state object in such a way that, within the same
      implementation of Common Lisp, the function <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> can construct from the
      printed representation a copy of the random-state object as if the copy had
      been made by <tt><a 
href="symbols.html#x187-2604546r546">make-random-state</a></tt>.
      <li><b>
<i>Pathnames</i> </b></li>If <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is true, a pathname should be printed by <tt><a 
href="symbols.html#x187-2604941r941">write</a></tt>
      as <tt>#P&#x0022;...&#x0022;</tt> where <tt>&#x0022;...&#x0022;</tt> is the namestring representation of the pathname.
      If <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is false, <tt><a 
href="symbols.html#x187-2604941r941">write</a></tt> prints a pathname by printing its
      namestring (presumably without escape characters or surrounding double
      quotes).
      <!--l. 2708--><p class="noindent" >If <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> then every object must be printed in a
      readable form, regardless of other printer control variables. For pathnames,
      the simplest approach is to print them, when <tt>*print-readably*</tt> is
      not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, as if <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> were <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, regardless of its actual
      value.</ul>
</div>
<!--l. 2716--><p class="indent" >   Structures deﬁned by <tt><a 
href="symbols.html#x187-2604289r289">defstruct</a></tt> are printed under the control of the
user-speciﬁed <tt>:print-function</tt> option to <tt><a 
href="symbols.html#x187-2604289r289">defstruct</a></tt>. If the user does not provide
a printing function explicitly, then a default printing function is supplied that
prints the structure using <tt>#S</tt> syntax (see section <a 
href="#x139-160700022.1.4">22.1.4<!--tex4ht:ref: SHARP-SIGN-MACRO-CHARACTER-SECTION --></a>).
<!--l. 2722--><p class="indent" >   If <tt>*print-readably*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> then every object must be printed in a
readable form, regardless of the values of other printer control variables; if this is
not possible, then an error of type <tt>print-not-readable</tt> must be signaled to
avoid printing an unreadable syntax such as <tt>#&#x003C;...&#x003E;</tt>.
                                                                          

                                                                          
<!--l. 2728--><p class="indent" >   Macro <tt><a 
href="symbols.html#x187-2604690r690">print-unreadable-object</a></tt> prints an object using <tt>#&#x003C;...&#x003E;</tt> syntax and
also takes care of checking the variable <tt>*print-readably*</tt>.
<!--l. 2731--><p class="indent" >   When debugging or when frequently dealing with large or deep objects at
top level, the user may wish to restrict the printer from printing large
amounts of information. The variables <tt>*print-level*</tt> and <tt>*print-length*</tt>
allow the user to control how deep the printer will print and how many
elements at a given level the printer will print. Thus the user can see enough
of the object to identify it without having to wade through the entire
expression.
<div class="defun">
<!--l. 2739--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1689002"></a><a 
 id="x139-1689003r646"></a> <b>*print-readably*</b>
</div>
<!--l. 2742--><p class="indent" >   The default value of <tt>*print-readably*</tt> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>. If <tt>*print-readably*</tt> is true,
then printing any object must either produce a printed representation
that the reader will accept or signal an error. If printing is successful,
the reader will, on reading the printed representation, produce an object
that is “similar as a constant” (see section <a 
href="clmse122.html#x151-196600024.2.4">24.2.4<!--tex4ht:ref: SIMILAR-AS-A-CONSTANT-SECTION --></a>) to the object that was
printed.
<!--l. 2750--><p class="indent" >   If <tt>*print-readably*</tt> is true and printing a readable printed representation is
not possible, the printer signals an error of type <tt>print-not-readable</tt> rather
than using an unreadable syntax such as <tt>#&#x003C;</tt>. The printed representation
produced when <tt>*print-readably*</tt> is true might or might not be the
same as the printed representation produced when <tt>*print-readably*</tt> is
false.
<!--l. 2757--><p class="indent" >   If <tt>*print-readably*</tt> is true and another printer control variable (such as
<tt>*print-length*</tt>, <tt>*print-level*</tt>, <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt>, <tt>*print-gensym*</tt>,
<tt>*print-array*</tt>, or an implementation-deﬁned printer control variable) would
cause the preceding requirements to be violated, that other printer control
variable is ignored.
<!--l. 2763--><p class="indent" >   The printing of interned symbols is not aﬀected by <tt>*print-readably*</tt>.
<!--l. 2765--><p class="indent" >   Note that the “similar as a constant” rule for readable printing implies that <tt>#A</tt>
or <tt>#(</tt> syntax cannot be used for arrays of element-type other than <tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>. An
implementation will have to use another syntax or signal a <tt>print-not-readable</tt>
error. A <tt>print-not-readable</tt> error will not be signaled for strings or
bit-vectors.
<!--l. 2771--><p class="indent" >   All methods for <tt><a 
href="symbols.html#x187-2604689r689">print-object</a></tt> must obey <tt>*print-readably*</tt>. This
                                                                          

                                                                          
rule applies to both user-deﬁned methods and implementation-deﬁned
methods.
<!--l. 2774--><p class="indent" >   The reader control variable <tt>*read-eval*</tt> also aﬀects printing. If <tt>*read-eval*</tt>
is false and <tt>*print-readably*</tt> is true, any <tt><a 
href="symbols.html#x187-2604689r689">print-object</a></tt> method that would
otherwise output a <tt>#.</tt> reader macro must either output something diﬀerent or
signal an error of type <tt>print-not-readable</tt>.
<!--l. 2779--><p class="indent" >   Readable printing of structures and objects of type <tt>standard-object</tt> is
controlled by their <tt><a 
href="symbols.html#x187-2604689r689">print-object</a></tt> methods, not by their <tt><a 
href="symbols.html#x187-2604542r542">make-load-form</a></tt>
methods. “Similarity as a constant” for these objects is application-dependent and
hence is deﬁned to be whatever these methods do.
<tt>
<!--l. 2785--><p class="indent" >   *print-readably*</tt> allows errors involving data with no readable printed
representation to be detected when writing the ﬁle rather than later on when the
ﬁle is read.
<tt>
<!--l. 2789--><p class="indent" >   *print-readably*</tt> is more rigorous than <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt>; output printed
with escapes must be merely generally recognizable by humans, with a good
chance of being recognizable by computers, whereas output printed readably must
be reliably recognizable by computers.
</div>
<div class="defun">
<!--l. 2795--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1689004"></a><a 
 id="x139-1689005r647"></a> <b>*print-escape*</b>
</div>
<!--l. 2798--><p class="indent" >   When this ﬂag is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, then escape characters are not output when an
expression is printed. In particular, a symbol is printed by simply printing
the characters of its print name. The function <tt><a 
href="symbols.html#x187-2604686r686">princ</a></tt> eﬀectively binds
<tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> to <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>.
<!--l. 2803--><p class="indent" >   When this ﬂag is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, then an attempt is made to print an expression in
such a way that it can be read again to produce an <tt><a 
href="symbols.html#x187-2604339r339">equal</a></tt> structure. The function
<tt>prin1</tt> eﬀectively binds <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> to <tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>. The initial value of this variable is
<tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>.
</div>
<div class="defun">
<!--l. 2810--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1689006"></a><a 
 id="x139-1689007r648"></a> <b>*print-pretty*</b>
                                                                          

                                                                          
</div>
<!--l. 2813--><p class="indent" >   When this ﬂag is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, then only a small amount of whitespace is output when
printing an expression.
<!--l. 2816--><p class="indent" >   When this ﬂag is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, then the printer will endeavor to insert extra
whitespace where appropriate to make the expression more readable. A few other
simple changes may be made, such as printing <tt>&#x2019;foo</tt> instead of <tt>(quote
foo)</tt>.
<!--l. 2821--><p class="indent" >   The initial value of <tt><a 
href="symbols.html#x187-2604035r35">*print-pretty*</a></tt> is implementation-dependent.
<div class="new">
<!--l. 2824--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx139-1689008"></a>to adopt a facility for user-controlled pretty
printing in Common Lisp (see chapter <a 
href="pprint.html#x169-218100026">26<!--tex4ht:ref: PPRINT --></a>).
</div>
</div>
<div class="defun">
<!--l. 2832--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1689009"></a><a 
 id="x139-1689010r649"></a> <b>*print-circle*</b>
</div>
<!--l. 2835--><p class="indent" >   When this ﬂag is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> (the default), then the printing process proceeds by
recursive descent; an attempt to print a circular structure may lead to looping
behavior and failure to terminate.
<!--l. 2839--><p class="indent" >   If <tt><a 
href="symbols.html#x187-2604027r27">*print-circle*</a></tt> is true, the printer is required to detect not only cycles
but shared substructure, indicating both through the use of <tt>#<i>n</i>=</tt> and
<tt>#<i>n</i>#</tt> syntax. As an example, under the speciﬁcation of the ﬁrst edition
<div class="lisp"><div class="tabbing">
(print &#x2019;(#1=(a #1#) #1#))
   <br>
<!--l. 2845--><p class="noindent" ></div>
<!--l. 2845--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-169000022.1.6" id="x139-169000022.1.6"></a></span>
                                                                          

                                                                          
<!--l. 2845--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-169100022.1.6" id="x139-169100022.1.6"></a></span>
</div>
<!--l. 2846--><p class="indent" >   might legitimately print <tt>(#1=(A #1#) #1#)</tt> or <tt>(#1=(A #1#) #2=(A #2#))</tt>;
the vote speciﬁes that the ﬁrst form is required.
<!--l. 2850--><p class="indent" >   User-deﬁned printing functions for the <tt><a 
href="symbols.html#x187-2604289r289">defstruct</a></tt> <tt>:print-function</tt>
option, as well as user-deﬁned methods for the CLOS generic function
<tt><a 
href="symbols.html#x187-2604689r689">print-object</a></tt>, may print objects to the supplied stream using <tt><a 
href="symbols.html#x187-2604941r941">write</a></tt>,
<tt>print1</tt>, <tt><a 
href="symbols.html#x187-2604686r686">princ</a></tt>, <tt><a 
href="symbols.html#x187-2604392r392">format</a></tt>, or <tt><a 
href="symbols.html#x187-2604689r689">print-object</a></tt> and expect circularities to be
detected and printed using <tt>#<i>n</i>#</tt> syntax (when <tt><a 
href="symbols.html#x187-2604027r27">*print-circle*</a></tt> is non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, of
course).
<!--l. 2857--><p class="indent" >   It seems to me that the same ought to apply to abbreviation as controlled by
<tt>*print-level*</tt> and <tt>*print-length*</tt>, but that was not addressed by this
vote.
</div>
<div class="defun">
<!--l. 2862--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1691001"></a><a 
 id="x139-1691002r650"></a> <b>*print-base*</b>
</div>
<!--l. 2865--><p class="indent" >   The value of <tt>*print-base*</tt> determines in what radix the printer will print
rationals. This may be any integer from <tt>2</tt> to <tt>36</tt>, inclusive; the default value is <tt>10</tt>
(decimal radix). For radices above <tt>10</tt>, letters of the alphabet are used to represent
digits above <tt>9</tt>.
</div>
<div class="defun">
<!--l. 2872--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1691003"></a><a 
 id="x139-1691004r651"></a> <b>*print-radix*</b>
</div>
<!--l. 2875--><p class="indent" >   If the variable <tt>*print-radix*</tt> is non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, the printer will print a radix
speciﬁer to indicate the radix in which it is printing a rational number. To
prevent confusion of the letter <tt>O</tt> with the digit <tt>0</tt>, and of the letter <tt>B</tt> with
the digit <tt>8</tt>, the radix speciﬁer is always printed using lowercase letters.
For example, if the current base is twenty-four (decimal), the decimal
integer twenty-three would print as <tt>#24rN</tt>. If <tt>*print-base*</tt> is <tt>2</tt>, <tt>8</tt>, or <tt>16</tt>,
then the radix speciﬁer used is <tt>#b</tt>, <tt>#o</tt>, or <tt>#x</tt>. For integers, base ten is
indicated by a trailing decimal point instead of a leading radix speciﬁer; for
ratios, however, <tt>#10r</tt> is used. The default value of <tt>*print-radix*</tt> is
                                                                          

                                                                          
<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>.
</div>
<div class="defun">
<!--l. 2888--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1691005"></a><a 
 id="x139-1691006r652"></a> <b>*print-case*</b>
</div>
<!--l. 2891--><p class="indent" >   The <tt><a 
href="symbols.html#x187-2604715r715">read</a></tt> function normally converts lowercase characters appearing in
symbols to corresponding uppercase characters, so that internally print names
normally contain only uppercase characters. However, users may prefer to see
output using lowercase letters or letters of mixed case. This variable controls the
case (upper, lower, or mixed) in which to print any uppercase characters in
the names of symbols when vertical-bar syntax is not used. The value of
<tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt> should be one of the keywords <tt>:upcase</tt>, <tt>:downcase</tt>, or
<tt>:capitalize</tt>; the initial value is <tt>:upcase</tt>.
<!--l. 2904--><p class="indent" >   Lowercase characters in the internal print name are always printed in
lowercase, and are preceded by a single escape character or enclosed by multiple
escape characters. Uppercase characters in the internal print name are printed in
uppercase, in lowercase, or in mixed case so as to capitalize words, according to
the value of <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt>. The convention for what constitutes a “word” is the
same as for the function <tt><a 
href="symbols.html#x187-2604826r826">string-capitalize</a></tt>.
<div class="newer">
<!--l. 2915--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx139-1691007"></a>to clarify the interaction of <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt> with
<tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt>. When <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt> determines the
case in which to print all uppercase characters in the print name of the symbol.
When <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, the implementation has some freedom as to
which characters will be printed so as to appear in an “escape context” (after
an escape character, typically <tt>\</tt>, or between multiple escape characters,
typically <tt>|</tt>); <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt> determines the case in which to print all
uppercase characters that will not appear in an escape context. For example,
when the value of <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt> is <tt>:upcase</tt>, an implementation might
choose to print the symbol whose print name is <tt>&#x0022;(S)HE&#x0022;</tt> as <tt>\(S\)HE</tt> or as
<tt>|(S)HE|</tt>, among other possibilities. When the value of <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt> is
<tt>:downcase</tt>, the corresponding output should be <tt>\(s\)he</tt> or <tt>|(S)HE|</tt>,
respectively.
<!--l. 2930--><p class="indent" >   Consider the following test code. (For the sake of this example assume that
<tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> is <tt>:upcase</tt> in the current readtable; this is discussed further
below.) <div class="lisp"><div class="tabbing">
                                                                          

                                                                          
(let ((tabwidth 11))
   <br>           (dolist (sym &#x2019;(|x| |FoObAr| |fOo|))<br>             (let ((tabstop -1))<br>
      (format t &#x0022;~&#x0026;&#x0022;)<br>                            (dolist (escape &#x2019;(t nil))<br>
        (dolist (case &#x2019;(:upcase :downcase :capitalize))<br>
          (format t &#x0022;~VT&#x0022; (* (incf tabstop) tabwidth))<br>
          (write sym :escape escape :case case)))))<br>      (format t &#x0022; %&#x0022;))<br>
<!--l. 2943--><p class="noindent" ></div>
<!--l. 2943--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-169200022.1.6" id="x139-169200022.1.6"></a></span>
<!--l. 2943--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-169300022.1.6" id="x139-169300022.1.6"></a></span>
</div>
<!--l. 2944--><p class="indent" >   An implementation that leans heavily on multiple-escape characters (vertical
bars) might produce the following output: <div class="lisp"><div class="tabbing">
|x|        |x|        |x|        x          x          x
   <br>|FoObAr|   |FoObAr|   |FoObAr|   FoObAr     foobar     Foobar<br>
|fOo|      |fOo|      |fOo|      fOo        foo        foo<br>
<!--l. 2950--><p class="noindent" ></div>
<!--l. 2950--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-169400022.1.6" id="x139-169400022.1.6"></a></span>
<!--l. 2950--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-169500022.1.6" id="x139-169500022.1.6"></a></span>
</div>
<!--l. 2951--><p class="indent" >   An implementation that leans heavily on single-escape characters (backslashes)
might produce the following output: <div class="lisp"><div class="tabbing">
\x         \x         \x         x          x          x
                                                                          

                                                                          
<br>   F\oO\bA\r  f\oo\ba\r  F\oo\ba\r  FoObAr     foobar     Foobar<br>
\fO\o      \fo\o      \fo\o      fOo        foo        foo<br>
<!--l. 2957--><p class="noindent" ></div>
<!--l. 2957--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-169600022.1.6" id="x139-169600022.1.6"></a></span>
<!--l. 2957--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-169700022.1.6" id="x139-169700022.1.6"></a></span>
</div>
<!--l. 2958--><p class="indent" >   These examples are not exhaustive; output using both kinds of escape
characters (for example, <tt>|FoO|\bA\r</tt>) is permissible (though ugly).
<!--l. 2961--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx139-1697001"></a>to add a new <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> slot to readtables to
control automatic case conversion during the reading of symbols. The value of
<tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> in the current readtable also aﬀects the printing of unescaped
letters (letters appearing in an escape context are always printed in their own
case).
      <ul class="itemize1">
      <li class="itemize">If <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> is <tt>:upcase</tt>, unescaped uppercase letters are printed
      in the case speciﬁed by <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt> and unescaped lowercase letters
      are  printed  in  their  own  case.  (If  <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is  non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>,  all
      lowercase letters will necessarily be escaped.)
      </li>
      <li class="itemize">If  <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> is  <tt>:downcase</tt>,  unescaped  lowercase  letters  are
      printed in the case speciﬁed by <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt> and unescaped uppercase
      letters are printed in their own case. (If <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>,
      all uppercase letters will necessarily be escaped.)
      </li>
      <li class="itemize">If <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> is <tt>:preserve</tt>, all unescaped letters are printed in
      their own case, regardless of the value of <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt>. There is no
      need to escape any letters, even if <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, though
      the X3J13 vote did not prohibit escaping letters in this situation.
      </li>
      <li class="itemize">If <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> is <tt>:invert</tt>, and if all unescaped letters are of the
                                                                          

                                                                          
      same case, then the case of all the unescaped letters is inverted; but if
      the unescaped letters are not all of the same case then each is printed
      in its own case. (Thus <tt>:invert</tt> does not always invert the case; the
      inversion is conditional.) There is no need to escape any letters, even if
      <tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt> is non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, though the X3J13 vote did not prohibit
      escaping letters in this situation.</li></ul>
<!--l. 2993--><p class="noindent" >Consider the following code. <div class="lisp"><div class="tabbing">
;;; Generate a table illustrating READTABLE-CASE and *PRINT-CASE*.
   <br>                                                                                               <br>
(let ((*readtable* (copy-readtable nil))<br>        (*print-case* *print-case*))<br>
  (format t &#x0022;READTABLE-CASE *PRINT-CASE*  Symbol-name  Output~<br>
           ~%————————-                         ————————-~<br>
           ~%&#x0022;)<br>  (dolist (readtable-case &#x2019;(:upcase :downcase :preserve :invert))<br>
    (setf (readtable-case *readtable*) readtable-case)<br>
    (dolist (print-case &#x2019;(:upcase :downcase :capitalize))<br>
      (dolist (sym &#x2019;(|ZEBRA| |Zebra| |zebra|))<br>
        (setq *print-case* print-case)<br>        (format t &#x0022;:~A~15T:~A~29T~A~42T~A~%&#x0022;<br>
                  (string-upcase readtable-case)<br>
                  (string-upcase print-case)<br>
                  (symbol-name sym)<br>                  (prin1-to-string sym)))))))<br>
<!--l. 3012--><p class="noindent" ></div>
<!--l. 3012--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-169800022.1.6" id="x139-169800022.1.6"></a></span>
<!--l. 3012--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-169900022.1.6" id="x139-169900022.1.6"></a></span>
</div>
<!--l. 3015--><p class="noindent" >Note that the call to <tt>prin1-to-string</tt> (the last argument in the call to
<tt><a 
href="symbols.html#x187-2604392r392">format</a></tt> that is within the nested loops) eﬀectively uses a non-<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> value for
<tt><a 
href="symbols.html#x187-2604028r28">*print-escape*</a></tt>.
<!--l. 3020--><p class="indent" >   Assuming an implementation that uses vertical bars around a symbol name if
any characters need escaping, the output from this test code should be
<div class="lisp"><div class="tabbing">
                                                                          

                                                                          
READTABLE-CASE *PRINT-CASE*  Symbol-name  Output
   <br>                                                       ————————————————–<br>
:UPCASE        :UPCASE       ZEBRA        ZEBRA<br>
:UPCASE        :UPCASE       Zebra        |Zebra|<br>
:UPCASE        :UPCASE       zebra        |zebra|<br>
:UPCASE        :DOWNCASE     ZEBRA        zebra<br>
:UPCASE        :DOWNCASE     Zebra        |Zebra|<br>
:UPCASE        :DOWNCASE     zebra        |zebra|<br>
:UPCASE        :CAPITALIZE   ZEBRA        Zebra<br>
:UPCASE        :CAPITALIZE   Zebra        |Zebra|<br>
:UPCASE        :CAPITALIZE   zebra        |zebra|<br>
:DOWNCASE      :UPCASE       ZEBRA        |ZEBRA|<br>
:DOWNCASE      :UPCASE       Zebra        |Zebra|<br>
:DOWNCASE      :UPCASE       zebra        ZEBRA<br>
:DOWNCASE      :DOWNCASE     ZEBRA        |ZEBRA|<br>
:DOWNCASE      :DOWNCASE     Zebra        |Zebra|<br>
:DOWNCASE      :DOWNCASE     zebra        zebra<br>
:DOWNCASE      :CAPITALIZE   ZEBRA        |ZEBRA|<br>
:DOWNCASE      :CAPITALIZE   Zebra        |Zebra|<br>
:DOWNCASE      :CAPITALIZE   zebra        Zebra<br>
:PRESERVE      :UPCASE       ZEBRA        ZEBRA<br>
:PRESERVE      :UPCASE       Zebra        Zebra<br>
:PRESERVE      :UPCASE       zebra        zebra<br>
:PRESERVE      :DOWNCASE     ZEBRA        ZEBRA<br>
:PRESERVE      :DOWNCASE     Zebra        Zebra<br>
:PRESERVE      :DOWNCASE     zebra        zebra<br>
:PRESERVE      :CAPITALIZE   ZEBRA        ZEBRA<br>
:PRESERVE      :CAPITALIZE   Zebra        Zebra<br>
:PRESERVE      :CAPITALIZE   zebra        zebra<br>
:INVERT        :UPCASE       ZEBRA        zebra<br>
:INVERT        :UPCASE       Zebra        Zebra<br>
:INVERT        :UPCASE       zebra        ZEBRA<br>
:INVERT        :DOWNCASE     ZEBRA        zebra<br>
:INVERT        :DOWNCASE     Zebra        Zebra<br>
:INVERT        :DOWNCASE     zebra        ZEBRA<br>
:INVERT        :CAPITALIZE   ZEBRA        zebra<br>
                                                                          

                                                                          
:INVERT        :CAPITALIZE   Zebra        Zebra<br>
:INVERT        :CAPITALIZE   zebra        ZEBRA<br>
   <br>
<!--l. 3063--><p class="noindent" ></div>
<!--l. 3063--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-170000022.1.6" id="x139-170000022.1.6"></a></span>
<!--l. 3063--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-170100022.1.6" id="x139-170100022.1.6"></a></span>
</div>
<!--l. 3065--><p class="indent" >   This illustrates all combinations for <tt><a 
href="symbols.html#x187-2604725r725">readtable-case</a></tt> and <tt><a 
href="symbols.html#x187-2604026r26">*print-case*</a></tt>.
</div>
</div>
                                                                          

                                                                          
<div class="defun">
<!--l. 3072--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1701001"></a><a 
 id="x139-1701002r653"></a> <b>*print-gensym*</b>
</div>
<!--l. 3075--><p class="indent" >   The <tt>*print-gensym*</tt> variable controls whether the preﬁx <tt>#:</tt> is printed before
symbols that have no home package. The preﬁx is printed if the variable is not
<tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>. The initial value of <tt>*print-gensym*</tt> is <tt><a 
href="symbols.html#x187-2604868r868">t</a></tt>.
</div>
   <div class="table">
                                                                          

                                                                          
<!--l. 3081--><p class="indent" >   <a 
 id="x139-17010037"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
 <div class="caption" 
><span class="id">Таблица 22.7: </span><span  
class="content">Examples of Print Level and Print Length Abbreviation</span></div><!--tex4ht:label?: x139-17010037 -->
<div class="lisp">
<div class="tabbing">
<!--tex4ht:inline--><div class="tabular"><table width="100%" class="tabular"><tr><td align="left" ><i>v</i> </td><td align="left" ><i>n</i></td><td align="left" >Output                                                                 </td>
</tr><tr><td align="left" >0 </td><td align="left" >1</td><td align="left" >#                                                                         </td>
</tr><tr><td align="left" >1 </td><td align="left" >1</td><td align="left" >(if ...)                                                                    </td>
</tr><tr><td align="left" >1 </td><td align="left" >2</td><td align="left" >(if # ...)                                                                </td>
</tr><tr><td align="left" >1 </td><td align="left" >3</td><td align="left" >(if # # ...)                                                             </td>
</tr><tr><td align="left" >1 </td><td align="left" >4</td><td align="left" >(if # # #)                                                             </td>
</tr><tr><td align="left" >2 </td><td align="left" >1</td><td align="left" >(if ...)                                                                    </td>
</tr><tr><td align="left" >2 </td><td align="left" >2</td><td align="left" >(if (member x ...) ...)                                                </td>
</tr><tr><td align="left" >2 </td><td align="left" >3</td><td align="left" >(if (member x y) (+ # 3) ...)                                     </td>
</tr><tr><td align="left" >3 </td><td align="left" >2</td><td align="left" >(if (member x ...) ...)                                                </td>
</tr><tr><td align="left" >3 </td><td align="left" >3</td><td align="left" >(if (member x y) (+ (car x) 3) ...)                              </td>
</tr><tr><td align="left" >3 </td><td align="left" >4</td><td align="left" >(if (member x y) (+ (car x) 3) &#x2019;(foo . #(a b c d ...)))     </td>
</tr><tr><td align="left" >3 </td><td align="left" >5</td><td align="left" >(if (member x y) (+ (car x) 3) &#x2019;(foo . #(a b c d &#x0022;Baz&#x0022;)))</td></tr></table>              </div>
<br>
</div>
<!--l. 3101--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-17020007" id="x139-17020007"></a></span>
<!--l. 3101--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-17030007" id="x139-17030007"></a></span>
</div>
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
<div class="defun">
<!--l. 3104--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1703001"></a><a 
 id="x139-1703002r654"></a> <b>*print-level*</b><br />
<i>
[Variable]</i><a 
 id="dx139-1703003"></a><a 
 id="x139-1703004r655"></a> <b>*print-length*</b>
</div>
<!--l. 3108--><p class="indent" >   The <tt>*print-level*</tt> variable controls how many levels deep a nested data
object will print. If <tt>*print-level*</tt> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> (the initial value), then no control
is exercised. Otherwise, the value should be an integer, indicating the
maximum level to be printed. An object to be printed is at level <tt>0</tt>; its
components (as of a list or vector) are at level <tt>1</tt>; and so on. If an object to be
recursively printed has components and is at a level equal to or greater
than the value of <tt>*print-level*</tt>, then the object is printed as simply
<tt>#</tt>.
<!--l. 3118--><p class="indent" >   The <tt>*print-length*</tt> variable controls how many elements at a given level are
printed. A value of <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> (the initial value) indicates that there be no limit to the
number of components printed. Otherwise, the value of <tt>*print-length*</tt> should
be an integer. Should the number of elements of a data object exceed the
value <tt>*print-length*</tt>, the printer will print three dots, <tt>...</tt>, in place of
those elements beyond the number speciﬁed by <tt>*print-length*</tt>. (In
the case of a dotted list, if the list contains exactly as many elements as
the value of <tt>*print-length*</tt>, and in addition has the non-null atom
terminating it, that terminating atom is printed rather than the three
dots.)
<tt>
<!--l. 3129--><p class="indent" >   *print-level*</tt> and <tt>*print-length*</tt> aﬀect the printing not only
of lists but also of vectors, arrays, and any other object printed with a
list-like syntax. They do not aﬀect the printing of symbols, strings, and
bit-vectors.
<!--l. 3134--><p class="indent" >   The Lisp reader will normally signal an error when reading an expression that
has been abbreviated because of level or length limits. This signal is given
because the <tt>#</tt> dispatch character normally signals an error when followed by
whitespace or <tt>)</tt>, and because <tt>...</tt> is deﬁned to be an illegal token, as are all
tokens consisting entirely of periods (other than the single dot used in dot
notation).
                                                                          

                                                                          
<!--l. 3141--><p class="indent" >   As an example, table <a 
href="#x139-17010037">22.7<!--tex4ht:ref: LEVEL-LENGTH-TABLE --></a> shows the ways the object <div class="lisp"><div class="tabbing">
(if (member x y) (+ (car x) 3) &#x2019;(foo . #(a b c d &#x0022;Baz&#x0022;)))
   <br>
<!--l. 3144--><p class="noindent" ></div>
<!--l. 3144--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-170400022.1.6" id="x139-170400022.1.6"></a></span>
<!--l. 3144--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-170500022.1.6" id="x139-170500022.1.6"></a></span>
</div>
<!--l. 3145--><p class="indent" >   would be printed for various values of <tt>*print-level*</tt> (in the column labeled
<i>v</i>) and <tt>*print-length*</tt> (in the column labeled <i>n</i>).
</div>
<div class="defun">
<!--l. 3149--><p class="noindent" ><div class="defunheader"> <i>[Variable]</i><a 
 id="dx139-1705001"></a><a 
 id="x139-1705002r656"></a> <b>*print-array*</b>
</div>
<!--l. 3152--><p class="indent" >   If <tt>*print-array*</tt> is <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, then the contents of arrays other than strings are
never printed. Instead, arrays are printed in a concise form (using <tt>#&#x003C;</tt>) that gives
enough information for the user to be able to identify the array but does not
include the entire array contents. If <tt>*print-array*</tt> is not <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>, non-string arrays
are printed using <tt>#(</tt>, <tt>#*</tt>, or <tt>#<i>n</i>A</tt> syntax. <div class="new"><i>Notice of correction.</i> In the ﬁrst edition,
the preceding paragraph mentioned the nonexistent variable <tt>print-array</tt> instead
of <tt>*print-array*</tt>.
</div> The initial value of <tt>*print-array*</tt> is implementation-dependent.
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 3167--><p class="indent" >   <div class="tabbing">
 <i>[Макрос]</i> <b>with-standard-io-syntax</b> <a 
 id="dx139-1705003"></a><a 
 id="x139-1705004r657"></a> {declaration}* {form}*
   <br>
                                                                          

                                                                          
<!--l. 3168--><p class="noindent" ></div>
<!--l. 3168--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-170600022.1.6" id="x139-170600022.1.6"></a></span>
</div>
<!--l. 3169--><p class="indent" >   Within the dynamic extent of the body, all reader/printer control variables,
including any implementation-deﬁned ones not speciﬁed by Common
Lisp, are bound to values that produce standard read/print behavior.
Table <a 
href="#x139-17060018">22.8<!--tex4ht:ref: WITH-STANDARD-IO-SYNTAX-TABLE --></a> shows the values to which standard Common Lisp variables are
bound.
   <div class="table">
                                                                          

                                                                          
<!--l. 3175--><p class="indent" >   <a 
 id="x139-17060018"></a><hr class="float"><div class="float" 
>
                                                                          

                                                                          
 <div class="caption" 
><span class="id">Таблица 22.8: </span><span  
class="content">Standard Bindings for I/O Control Variables</span></div><!--tex4ht:label?: x139-17060018 -->
<div class="flushleft" 
>
<!--l. 3178--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%" class="tabular"><tr><td align="left" >Variable                         </td><td align="left" >Value                                  </td>
</tr><tr><td align="left" >*package*                      </td><td align="left" >the <tt>common-lisp-user</tt> package</td>
</tr><tr><td align="left" >*print-array*                  </td><td align="left" >t                                        </td>
</tr><tr><td align="left" >*print-base*                   </td><td align="left" >10                                       </td>
</tr><tr><td align="left" >*print-case*                    </td><td align="left" >:upcase                                </td>
</tr><tr><td align="left" >*print-circle*                  </td><td align="left" >nil                                      </td>
</tr><tr><td align="left" >*print-escape*                </td><td align="left" >t                                        </td>
</tr><tr><td align="left" >*print-gensym*               </td><td align="left" >t                                        </td>
</tr><tr><td align="left" >*print-length*                 </td><td align="left" >nil                                      </td>
</tr><tr><td align="left" >*print-level*                   </td><td align="left" >nil                                      </td>
</tr><tr><td align="left" >*print-lines*                   </td><td align="left" >nil *                                    </td>
</tr><tr><td align="left" >*print-miser-width*         </td><td align="left" >nil *                                    </td>
</tr><tr><td align="left" >*print-pprint-dispatch*     </td><td align="left" >nil *                                    </td>
</tr><tr><td align="left" >*print-pretty*                 </td><td align="left" >nil                                      </td>
</tr><tr><td align="left" >*print-radix*                  </td><td align="left" >nil                                      </td>
</tr><tr><td align="left" >*print-readably*              </td><td align="left" >t                                        </td>
</tr><tr><td align="left" >*print-right-margin*         </td><td align="left" >nil *                                    </td>
</tr><tr><td align="left" >*read-base*                    </td><td align="left" >10                                       </td>
</tr><tr><td align="left" >*read-default-ﬂoat-format*</td><td align="left" >single-ﬂoat                           </td>
</tr><tr><td align="left" >*read-eval*                     </td><td align="left" >t                                        </td>
</tr><tr><td align="left" >*read-suppress*               </td><td align="left" >nil                                      </td>
</tr><tr><td align="left" >*readtable*                    </td><td align="left" >the standard readtable            </td></tr></table></div></div>
<!--l. 3206--><p class="noindent" >* X3J13 voted in June 1989 <a 
 id="dx139-1706002"></a>to introduce the printer control variables
<tt><a 
href="symbols.html#x187-2604038r38">*print-right-margin*</a></tt>, <tt><a 
href="symbols.html#x187-2604033r33">*print-miser-width*</a></tt>, <tt><a 
href="symbols.html#x187-2604032r32">*print-lines*</a></tt>, and
<tt><a 
href="symbols.html#x187-2604034r34">*print-pprint-dispatch*</a></tt> (see section <a 
href="clmse140.html#x171-218300026.2">26.2<!--tex4ht:ref: PPRINT-VARIABLES-SECTION --></a>) but did not specify the values to
which <tt><a 
href="symbols.html#x187-2604940r940">with-standard-io-syntax</a></tt> should bind them. I recommend that all four
should be bound to <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt>.
                                                                          

                                                                          
   </div><hr class="endfloat" />
   </div>
<!--l. 3217--><p class="indent" >   The values returned by <tt><a 
href="symbols.html#x187-2604940r940">with-standard-io-syntax</a></tt> are the values of the last
body <i>form</i>, or <tt><a 
href="symbols.html#x187-2604608r608">nil</a></tt> if there are no body forms.
<!--l. 3220--><p class="indent" >   The intent is that a pair of executions, as shown in the following example,
should provide reasonable reliable communication of data from one Lisp process
to another: <div class="lisp"><div class="tabbing">
;;; Write DATA to a ﬁle.
   <br>                               (with-open-ﬁle (ﬁle pathname :direction :output)<br>
  (with-standard-io-syntax<br>                              (print data ﬁle)))<br>
<br>                                             ;;; ...  Later, in another Lisp:<br>
(with-open-ﬁle (ﬁle pathname :direction :input)<br>   (with-standard-io-syntax<br>
    (setq data (read ﬁle))))<br>
<!--l. 3233--><p class="noindent" ></div>
<!--l. 3233--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-170700022.1.6" id="x139-170700022.1.6"></a></span>
<!--l. 3233--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-170800022.1.6" id="x139-170800022.1.6"></a></span>
</div>
<!--l. 3235--><p class="indent" >   Using <tt><a 
href="symbols.html#x187-2604940r940">with-standard-io-syntax</a></tt> to bind all the variables, instead of using
<tt><a 
href="symbols.html#x187-2604487r487">let</a></tt> and explicit bindings, ensures that nothing is overlooked and avoids problems
with implementation-deﬁned reader/printer control variables. If the user wishes to
use a non-standard value for some variable, such as <tt><a 
href="symbols.html#x187-2604023r23">*package*</a></tt> or <tt>*read-eval*</tt>, it
can be bound by <tt><a 
href="symbols.html#x187-2604487r487">let</a></tt> inside the body of <tt><a 
href="symbols.html#x187-2604940r940">with-standard-io-syntax</a></tt>. For example:
<div class="lisp"><div class="tabbing">
;;; Write DATA to a ﬁle. Forbid use of #. syntax.
   <br>
(with-open-ﬁle (ﬁle pathname :direction :output)<br>    (let ((*read-eval* nil))<br>
    (with-standard-io-syntax<br>                          (print data ﬁle))))<br>
<br>                        ;;; Read DATA from a ﬁle. Forbid use of #. syntax.<br>
                                                                          

                                                                          
(with-open-ﬁle (ﬁle pathname :direction :input)<br>      (let ((*read-eval* nil))<br>
    (with-standard-io-syntax<br>                     (setq data (read ﬁle)))))<br>
<!--l. 3254--><p class="noindent" ></div>
<!--l. 3254--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-170900022.1.6" id="x139-170900022.1.6"></a></span>
<!--l. 3254--><p class="noindent" ><span class="paragraphHead"><a 
href="#x139-171000022.1.6" id="x139-171000022.1.6"></a></span>
</div>
<!--l. 3255--><p class="indent" >   Similarly, a user who dislikes the arbitrary choice of values for <tt>*print-circle*</tt>
and <tt><a 
href="symbols.html#x187-2604035r35">*print-pretty*</a></tt> can bind these variables to other values inside the
body.
<!--l. 3259--><p class="indent" >   The X3J13 vote left it unclear whether <tt><a 
href="symbols.html#x187-2604940r940">with-standard-io-syntax</a></tt> permits
declarations to appear before the body of the macro call. I believe that was the
intent, and this is reﬂected in the syntax shown above; but this is only my
interpretation.
</div>
                                                                          

                                                                          
<!--l. 3265--><p class="indent" >   <div id="bottomlinks"><tt>&#x003C;</tt><a 
href="clmse113.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="io.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="io.html#tailio.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse112.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="io.html#clmse112.html" >Наверх</a><tt>&#x003E;</tt></div><a 
 id="tailclmse112.html"></a>   </div> </div> 
</body></html> 
