<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Формы верхнего уровня</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-30 23:01:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 1958--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch6.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse28.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse28.html#tailclmse28.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse29.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch5.html#clmse29.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">5.3   </span> <a 
href="clm.html#QQ2-39-72" id="x39-650005.3">Формы верхнего уровня</a></h3>
<!--l. 1960--><p class="noindent" >Стандартный путь взаимодействия с реализацией Common Lisp через <i>цикл
чтение-выполнение-печать</i> (<i>read-eval-print loop</i>): система циклично
считывает форму из некоторого источника ввода (клавиатура, файл),
выполняет её, затем выводит результат(ы) в некоторое устройство вывода
(дисплей, другой файл). Допускается любая форма (выполняемый объект
данных), однако существуют некоторые формы разработанные для удобного
применения в качестве форм <i>верхнего уровня</i>. Эти специальные формы
верхнего уровня могут использоваться для определения глобальных функции
(globally named functions), макросов, создания деклараций и определения
глобальных значений для специальных переменных.
<!--l. 1971--><p class="indent" >   Макросы обычно определяются с помощью специальной формы
<tt><a 
href="clmse44.html#x57-143004r118">defmacro</a></tt>. Этот механизм достаточно сложен. Для подробностей смотрите
главу <a 
href="clmch8.html#x56-1420008">8<!--tex4ht:ref: MACROS --></a>.
<!--l. 1974--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">5.3.1   </span> <a 
href="clmli1.html#QQ2-39-73" id="x39-660005.3.1">Определение именованных функций</a></h4>
<!--l. 1976--><p class="noindent" >Специальная форма <tt><a 
href="#x39-66002r13">defun</a></tt> обычно обозначает определение именованных
функций.
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> defun </b><a 
 id="dx39-66001"></a><a 
 id="x39-66002r13"></a> name lambda-list  [[ {declaration}*  | doc-string]]  { form}*
</td></tr></table>
<!--l. 1980--><p class="indent" >
</div>
                                                                          

                                                                          
<!--l. 1980--><p class="noindent" ><span class="paragraphHead"><a 
href="#x39-670005.3.1" id="x39-670005.3.1"></a></span>
   Выполнение формы <tt><a 
href="#x39-66002r13">defun</a></tt> приводит к тому, что символ <i>name</i> становиться
глобальным именем для функции определённой лямбда-выражением.
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(lambda <i>lambda-list</i> {<i><i>declaration</i> | <i>doc-string</i></i>}*  {<i><i> form</i></i>}* )
</td></tr></table>
<!--l. 1985--><p class="indent" >
</div>
</div>
<!--l. 1986--><p class="noindent" >определяется в лексическом окружении, в котором выполнялась форма
<tt><a 
href="#x39-66002r13">defun</a></tt>. А так как формы <tt><a 
href="#x39-66002r13">defun</a></tt> обычно выполняются на самом верхнем
уровне, лямбда-выражение обычно выполняется в нулевом лексическом
окружении.
<tt>
<!--l. 1991--><p class="indent" >   <a 
href="#x39-66002r13">defun</a></tt> в качестве параметра <i>name</i> принимает любое имя функции
(символ или список, у которого <i>car</i> элемент равен <tt><a 
href="clmse35.html#x47-89002r64">setf</a></tt>—смотрите
раздел <a 
href="clmse34.html#x46-820007.1">7.1<!--tex4ht:ref: FUNCTION-NAME-SECTION --></a>).
<!--l. 1995--><p class="indent" >   Так теперь можно записать <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun (setf cadr) ...)
</td></tr></table>
<!--l. 1998--><p class="indent" >
</div>
</div>
<!--l. 1999--><p class="noindent" >для определения <tt><a 
href="clmse35.html#x47-89002r64">setf</a></tt>-оператора для функции <tt><a 
href="clmse79.html#x99-200008r396">cadr</a></tt>. Это удобнее, чем
использование <tt>defsetf</tt> или <tt>define-modify-macro</tt>.
<!--l. 2002--><p class="indent" >   Если указана необязательная строка документации <i>doc-string</i>, тогда она
присоединяется к символу <i>name</i> в качестве строки документации
типа <tt><a 
href="clmse34.html#x46-84002r52">function</a></tt>. Смотрите <tt><a 
href="clmse140.html#x172-404017r847">documentation</a></tt>. Если после <i>doc-string</i> нет
деклараций, строка документации может быть использована только при
условии существования хотя бы одной формы после неё, иначе она будет
использована в качестве форм <i>form</i> функции. Указывать более чем одну
строку <i>doc-string</i> является ошибкой.
<!--l. 2010--><p class="indent" >   Формы <i>forms</i> составляют тело определяемой функции. Они выполняются
как неявный <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt>.
                                                                          

                                                                          
<!--l. 2013--><p class="indent" >   Тело определяемой функции неявно заключается в конструкцию <tt><a 
href="clmse40.html#x52-112002r87">block</a></tt>,
имя которой совпадает с <i>именем (name)</i> функции. Таким образом для
выхода из функции может быть использовано выражение<tt><a 
href="clmse40.html#x52-113002r88">return-from</a></tt>.
<!--l. 2017--><p class="indent" >   В некоторых реализациях в <tt><a 
href="#x39-66002r13">defun</a></tt> могут также выполняться другие
специальные учётные действия. <i>name</i> возвращается в качестве значения
формы <tt><a 
href="#x39-66002r13">defun</a></tt>. Например: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun discriminant (a b c)
</td></tr></table>
<!--l. 2021--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (declare (number a b c))</td></tr></table>
<!--l. 2022--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  &#x0022;Вычисляет дискриминант квадратного уравнения.</td></tr></table>
<!--l. 2023--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   Получает a, b и c, вычисляет значение b̂2-4*a*c.</td></tr></table>
<!--l. 2024--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   Квадратное уравнение a*x̂2+b*x+c=0 имеет действительные, multiple,</td></tr></table>
<!--l. 2025--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   или комплексные корни в зависимости от того, какое соответственно значение было получено</td></tr></table>
<!--l. 2026--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   положительное, ноль или отрицательное.&#x0022;</td></tr></table>
<!--l. 2027--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (- (* b b) (* 4 a c)))</td></tr></table>
<!--l. 2028--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> discriminant</td></tr></table>
<!--l. 2029--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   теперь (discriminant 1 2/3 -2) <span class="math"> ⇒</span> 76/9</td></tr></table>
<!--l. 2031--><p class="indent" >
</div>
</div>
<!--l. 2033--><p class="indent" >   Пользователю разрешено использовать <tt><a 
href="#x39-66002r13">defun</a></tt> для переопределения
функции, например, для установки корректной версии некорректного
определения. Пользователю также разрешено переопределять макрос на
функцию. Однако является ошибкой, попытка переопределить имя
специальной формы (смотрите таблицу ??) на функцию.
</div>
<!--l. 2040--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">5.3.2   </span> <a 
href="clmli1.html#QQ2-39-75" id="x39-680005.3.2">Определение глобальных переменных и констант</a></h4>
<!--l. 2042--><p class="noindent" >Для определения глобальных переменных используются специальные формы
<tt><a 
href="#x39-68002r14">defvar</a></tt> и <tt><a 
href="#x39-68004r15">defparameter</a></tt>. Для определения констант используется специальная
форма <tt><a 
href="#x39-68006r16">defconstant</a></tt>.
<div class=defmac>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> defvar </b><a 
 id="dx39-68001"></a><a 
 id="x39-68002r14"></a> name [initial-value [documentation]]
</td></tr></table>
<!--l. 2047--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>[Макрос]</i><b> defparameter </b><a 
 id="dx39-68003"></a><a 
 id="x39-68004r15"></a> name initial-value [documentation]</td></tr></table>
<!--l. 2048--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>[Макрос]</i><b> defconstant </b><a 
 id="dx39-68005"></a><a 
 id="x39-68006r16"></a> name initial-value [documentation]</td></tr></table>
<!--l. 2050--><p class="indent" >
</div>
<!--l. 2050--><p class="noindent" ><span class="paragraphHead"><a 
href="#x39-690005.3.2" id="x39-690005.3.2"></a></span>
   <tt><a 
href="#x39-68002r14">defvar</a></tt> рекомендуется для декларации использования в программе
специальных переменных. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defvar <i>variable</i>)
</td></tr></table>
<!--l. 2055--><p class="indent" >
</div>
</div>
<!--l. 2056--><p class="noindent" >указывает на то, что переменная <i>variable</i> будет специальной (<tt>special</tt>) (смотрите
<tt><a 
href="clmse47.html#x61-150002r124">proclaim</a></tt>), и может выполнять некоторые учётные действия, зависимые от
реализации.
<!--l. 2060--><p class="indent" >   Если для формы указан второй аргумент, <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defvar <i>variable</i> <i>initial-value</i>)
</td></tr></table>
<!--l. 2063--><p class="indent" >
</div>
</div>
<!--l. 2064--><p class="noindent" >тогда переменная <i>variable</i>, если она ещё не была проинициализирована,
инициализируется результатом выполнения формы <i>initial-value</i>. Форма
<i>initial-value</i> не выполняется, если в этом нет необходимости. Это полезно,
если форма <i>initial-value</i> выполняет что-то трудоёмкое, как, например,
создание большой структуры данных.
                                                                          

                                                                          
<!--l. 2070--><p class="indent" >   Если не существует специального связывания этой переменной,
инициализация производится присвоением глобального значения переменной.
Обычно, такого связывания быть не должно. FIXME.
<tt>
<!--l. 2074--><p class="indent" >   <a 
href="#x39-68002r14">defvar</a></tt> также предоставляют хорошее место для комментария,
описывающего значение переменной, тогда как обычное <tt>special</tt> указание
соблазняет задекларировать несколько переменных за один раз и не
предоставляет возможности прокомментировать их. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defvar *visible-windows* 0
</td></tr></table>
<!--l. 2079--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  &#x0022;Количество видимых окон на экране&#x0022;)</td></tr></table>
<!--l. 2081--><p class="indent" >
</div>
</div>
<tt>
<!--l. 2083--><p class="indent" >   <a 
href="#x39-68004r15">defparameter</a></tt> подобна <tt><a 
href="#x39-68002r14">defvar</a></tt>, но <tt><a 
href="#x39-68004r15">defparameter</a></tt> требует обязательной
формы <i>initial-value</i>, и, выполняя эту форму присваивает результат
переменной. Семантическое различие заключается в том, что <tt><a 
href="#x39-68002r14">defvar</a></tt>
предназначена декларировать переменную, изменяемую программой, тогда
как <tt><a 
href="#x39-68004r15">defparameter</a></tt> предназначена для декларации переменной, как
константы, которая может быть изменена (и во время выполнения
программы), для изменения поведения программы. Таким образом
<tt><a 
href="#x39-68004r15">defparameter</a></tt> не указывает, что количество никогда не изменяется, в
частности, она не разрешает компилятору предположить то, что значение
может быть вкомпилировано в программу.
<tt>
<!--l. 2094--><p class="indent" >   <a 
href="#x39-68006r16">defconstant</a></tt> похожа на <tt><a 
href="#x39-68004r15">defparameter</a></tt>, но в отличие от последней,
указывает, что значение переменной <i>name</i> фиксировано и позволяет
компилятору предположить, что значение может быть вкомпилировано в
программу. Однако, если компилятор для оптимизации выбирает
путь замены ссылок на имя константы на значения этой константы в
компилируемом коде, он должен позаботиться о том, чтобы такие «копии»
были эквивалентны <tt><a 
href="clmse32.html#x43-77004r45">eql</a></tt> объектам-значениям констант. Например,
компилятор может спокойно копировать числа, но должен позаботиться об
этом правиле, если значение константы является списком.
                                                                          

                                                                          
<!--l. 2104--><p class="indent" >   Если для переменной на момент вызова формы <tt><a 
href="#x39-68006r16">defconstant</a></tt> существует
специальные связывания, то возникает ошибка (но реализации могут
проверять, а могут и не проверять этот факт).
<!--l. 2108--><p class="indent" >   Если имя задекларировано с помощью <tt><a 
href="#x39-68006r16">defconstant</a></tt>, последующие
присваивания и связывания данной специальной переменной будут являться
ошибкой. Это справедливо для системозависимых констант, например, <tt><a 
href="clmse30.html#x41-73004r19">t</a></tt> и
<tt><a 
href="clmse69.html#x86-187002r284">most-positive-fixnum</a></tt>. Компилятор может также сигнализировать о
связывании лексической переменной с одинаковым именем.
<!--l. 2115--><p class="indent" >   Для любой из этих конструкций, документация должна быть строкой.
Строка присоединяется к имени переменной, параметра или константы как
тип документации <tt>variable</tt>, смотрите функцию <tt><a 
href="clmse140.html#x172-404017r847">documentation</a></tt>.
<i>
<!--l. 2119--><p class="indent" >   documentation-string</i> не выполняется и должна представлять строку, когда
выполняется <tt><a 
href="#x39-68002r14">defvar</a></tt>, <tt><a 
href="#x39-68004r15">defparameter</a></tt> или <tt><a 
href="#x39-68006r16">defconstant</a></tt>.
<!--l. 2123--><p class="indent" >   Например, форма <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defvar *avoid-registers* nil &#x0022;Compilation control switch #43&#x0022;)
</td></tr></table>
<!--l. 2126--><p class="indent" >
</div>
</div>
<!--l. 2127--><p class="noindent" >законна, но <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defvar *avoid-registers* nil
</td></tr></table>
<!--l. 2129--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (format nil &#x0022;Compilation control switch #~D&#x0022;</td></tr></table>
<!--l. 2130--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (incf *compiler-switch-number*)))</td></tr></table>
<!--l. 2132--><p class="indent" >
</div>
</div>
<!--l. 2133--><p class="noindent" >ошибочна, так как вызов <tt><a 
href="clmse110.html#x137-261003r666">format</a></tt> не является дословно строкой.
<!--l. 2135--><p class="indent" >   С другой стороны, форма <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defvar *avoid-registers* nil
</td></tr></table>
                                                                          

                                                                          
<!--l. 2137--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  #.(format nil &#x0022;Compilation control switch #~D&#x0022;</td></tr></table>
<!--l. 2138--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (incf *compiler-switch-number*)))</td></tr></table>
<!--l. 2140--><p class="indent" >
</div>
</div>
<!--l. 2141--><p class="noindent" >Может использоваться для вышеназванной цели, потому что вызов <tt><a 
href="clmse110.html#x137-261003r666">format</a></tt>
выполняется на во время чтения кода <tt><a 
href="clmse109.html#x136-255003r634">read</a></tt>, когда форма <tt><a 
href="#x39-68002r14">defvar</a></tt>
выполняется, в ней указана строка, которая являлась результатом вызова
<tt><a 
href="clmse110.html#x137-261003r666">format</a></tt>.
<!--l. 2146--><p class="indent" >   Эти конструкции обычно используются только как формы верхнего
уровня. Значения возвращаемые каждой из этих конструкций это
задекларированные имена <i>name</i>.
</div>
<!--l. 2150--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">5.3.3   </span> <a 
href="clmli1.html#QQ2-39-77" id="x39-700005.3.3">Контроль времени выполнения</a></h4>
<div class=defspec>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Специальная форма]</i><b> eval-when </b><a 
 id="dx39-70001"></a><a 
 id="x39-70002r17"></a> ( {situation}* )  { form}*
</td></tr></table>
<!--l. 2154--><p class="indent" >
</div>
<!--l. 2154--><p class="noindent" ><span class="paragraphHead"><a 
href="#x39-710005.3.3" id="x39-710005.3.3"></a></span>
   Тело формы <tt><a 
href="#x39-70002r17">eval-when</a></tt> выполняется как неявный <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt>, но только в
перечисленных ниже ситуациях. Каждая ситуация <i>situation</i> должна быть
одним символов, <tt>:compile-toplevel</tt>, <tt>:load-toplevel</tt> или <tt>:execute</tt>.
<!--l. 2159--><p class="indent" >   Использование <tt>:compile-toplevel</tt> и <tt>:load-toplevel</tt> контролирует, что и
когда выполняется для форм верхнего уровня. Использование <tt>:execute</tt>
контролирует будет ли производится выполнения форм не верхнего
уровня.
                                                                          

                                                                          
<!--l. 2163--><p class="indent" >   Конструкция <tt><a 
href="#x39-70002r17">eval-when</a></tt> может быть более понятна в терминах модели
того, как компилятор файлов, <tt><a 
href="clmse117.html#x146-282009r716">compile-file</a></tt>, выполняет формы в файле для
компиляции.
<!--l. 2167--><p class="indent" >   Формы следующие друг за другом читаются из файла с помощью
компилятора файла используя <tt><a 
href="clmse109.html#x136-255003r634">read</a></tt>. Эти формы верхнего уровня обычно
обрабатываются в том, что мы называем режим «времени некомпиляции
(not-compile-time mode)». Существует и другой режим, называемый режим
«времени-компиляции (compile-time-too mode)», которые вступает в игру для
форм верхнего уровня. Специальная форма <tt><a 
href="#x39-70002r17">eval-when</a></tt> используется для
аннотации программы таким образом, чтобы предоставить программе,
осуществлять выбор режима.
<!--l. 2175--><p class="indent" >   Обработка форм верхнего уровня в компиляторе файла работает так, как
рассказано ниже:
      <ul class="itemize1">
      <li class="itemize">Если          форма          является          макровызовом,          она
      разворачивается и результат обрабатывается, как форма верхнего
      уровня  в  том  же  режиме  обработки  (времени-компиляции  или
      времени-некомпиляции, (compile-time-too или not-compile-time).
      </li>
      <li class="itemize">Если  форма  <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt> (или  <tt>locally</tt>),  каждая  из  форм  из  их  тел
      обрабатываются, как формы верхнего уровня в том же режиме
      обработки.
      </li>
      <li class="itemize">Если   форма   <tt>compiler-let</tt>,   <tt><a 
href="clmse38.html#x50-102006r79">macrolet</a></tt>  или   <tt><a 
href="clmse38.html#x50-103002r80">symbol-macrolet</a></tt>,
      компилятор   файла   создаёт   соответствующие   связывания   и
      рекурсивно обрабатывает тела форм, как неявный <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt> верхнего
      уровня  в  контексте  установленных  связей  в  том  же  режиме
      обработки.
      </li>
      <li class="itemize">Если форма <tt><a 
href="#x39-70002r17">eval-when</a></tt>, она обрабатывается в соответствии со
      следующей таблицей:
      <div class="flushleft" 
>
                                                                          

                                                                          
<!--l. 2194--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" > LT</td><td align="left" >CT</td><td align="left" >EX</td><td align="left" >CTTM</td><td align="left" >Действие                                                     </td>
</tr><tr><td align="left" >  да </td><td align="left" > да </td><td align="left" >  –  </td><td align="left" >    –    </td><td align="left" >обработать тело в режиме время-компиляции   </td>
</tr><tr><td align="left" >  да </td><td align="left" >нет</td><td align="left" > да </td><td align="left" >   да   </td><td align="left" >обработать тело в режиме время-компиляции   </td>
</tr><tr><td align="left" >  да </td><td align="left" >нет</td><td align="left" >  –  </td><td align="left" >  нет  </td><td align="left" >обработать тело в режиме время-некомпиляции</td>
</tr><tr><td align="left" >  да </td><td align="left" >нет</td><td align="left" >нет</td><td align="left" >    –    </td><td align="left" >обработать тело в режиме время-некомпиляции</td></tr><tr><td align="left" > нет</td> <td align="left" > да </td> <td align="left" > – </td> <td align="left" > – </td> <td align="left" >выполнить тело</td>
</tr><tr><td align="left" > нет</td><td align="left" >нет</td><td align="left" > да </td><td align="left" >   да   </td><td align="left" >выполнить тело                                            </td></tr><tr><td align="left" > нет</td> <td align="left" >нет</td> <td align="left" > – </td> <td align="left" > нет </td> <td align="left" >ничего не делать</td>
</tr><tr><td align="left" > нет</td><td align="left" >нет</td><td align="left" >нет</td><td align="left" >    –    </td><td align="left" >ничего не делать                                           </td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr><td align="left" >  </td>
</tr></table></div></div>
      <!--l. 2208--><p class="noindent" >В этой таблице столбец LT спрашивает присутствует ли <tt>:load-toplevel</tt>
      в ситуациях указанных в форме <tt><a 
href="#x39-70002r17">eval-when</a></tt>. CT соответственно
      указывает на <tt>:compile-toplevel</tt> и EX на <tt>:execute</tt>. Столбец
      CTTM спрашивает встречается ли форма <tt><a 
href="#x39-70002r17">eval-when</a></tt> в режиме
      времени-компиляции. Фраза «обработка тела» означает обработку
      последовательно форм тела, как неявного <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt> верхнего уровня в
      указанном режиме, и «выполнение тела» означает выполнение форм
      тела последовательно, как неявный <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt> в динамическом контексте
      выполнения компилятора и в лексическом окружении, в котором
      встретилась <tt><a 
href="#x39-70002r17">eval-when</a></tt>.
      </li>
      <li class="itemize">В противном случае, форма верхнего уровня, которая не представлена в
      специальных случаях. Если в режиме времени-компиляции, компилятор
      сначала выполняет форму и затем выполняет обычную обработку
      компилятором. Если установлен режим времени-некомпиляции,
      выполняется только обычная обработка компилятором (смотрите
      раздел <a 
href="clmse117.html#x146-28200024.1">24.1<!--tex4ht:ref: COMPILER-SECTION --></a>). Любые подформы обрабатываются как формы не
      верхнего уровня.</li></ul>
<!--l. 2226--><p class="indent" >   Следует отметить, что формы верхнего уровня обрабатываются
гарантированно в порядке, в котором они были перечислены в тексте в
файле, и каждая форма верхнего уровня прочтённая компилятором
обрабатывается перед тем, как будет прочтена следующая. Однако, порядок
обработки (включая, в частности, раскрытие макросов) подформ, которые не
являются формами верхнего уровня, не определён.
<!--l. 2233--><p class="indent" >   Для формы <tt><a 
href="#x39-70002r17">eval-when</a></tt>, которая не является формой верхнего уровня в
компиляторе файлов (то есть либо в интерпретаторе, либо <tt><a 
href="clmse117.html#x146-282003r715">compile</a></tt>,
либо в компиляторе файлов, но не на верхнем уровне), если указана
ситуация <tt>:execute</tt>, тело формы обрабатывается как неявный <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt>. В
                                                                          

                                                                          
противном случае, тело игнорируется и форма <tt><a 
href="#x39-70002r17">eval-when</a></tt> имеет значение
<tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt>.
<!--l. 2239--><p class="indent" >   Для сохранения обратной совместимости, <i>situation</i> может также быть
<tt><a 
href="clmse117.html#x146-282003r715">compile</a></tt>, <tt><a 
href="clmse115.html#x143-279002r707">load</a></tt> или <tt><a 
href="clmse103.html#x128-236002r562">eval</a></tt>. Внутри формы верхнего уровня <tt><a 
href="#x39-70002r17">eval-when</a></tt>,
они имеют значения <tt>:compile-toplevel</tt>, <tt>:load-toplevel</tt> и <tt>:execute</tt>
соответственно. Однако их поведение не определено при использовании в
<tt><a 
href="#x39-70002r17">eval-when</a></tt> не верхнего уровня.
<!--l. 2246--><p class="indent" >   Следующие правила являются логическим продолжением предыдущих
определений:
      <ul class="itemize1">
      <li class="itemize">Никогда  не  случится  так,  чтобы  выполнение  одного  <tt><a 
href="#x39-70002r17">eval-when</a></tt>
      выражения приведёт к выполнению тела более чем один раз.
      </li>
      <li class="itemize">Старый ключевой символ <tt>eval</tt> был неправильно использован, потому
      что выполнение тела не нуждается в <tt>eval</tt>. Например, когда
      определение функции <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun foo () (eval-when (:execute) (print &#x2019;foo)))
</td></tr></table>
      <!--l. 2258--><p class="noindent" >
</div>
</div>
      <!--l. 2259--><p class="noindent" >скомпилируется, вызов <tt><a 
href="clmse110.html#x137-258008r650">print</a></tt> должен быть скомпилирован, а не
      выполнен во время компиляции.
      </li>
      <li class="itemize">Макросы, предназначенные для использования в качестве форм
      верхнего уровня, должны контролировать все побочные эффекты,
      которые будут сделаны формами в процессе развёртывания.
      Разворачиватель макроса сам по себе не должен порождать никаких
      побочных эффектов.
<div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defmacro foo ()
</td></tr></table>
      <!--l. 2270--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (really-foo)                              ;Неправильно</td></tr></table>
      <!--l. 2271--><p class="noindent" >                                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  ‘(really-foo))</td></tr></table>
      <!--l. 2272--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 2273--><p class="noindent" >                                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defmacro foo ()</td></tr></table>
      <!--l. 2274--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  ‘(eval-when (:compile-toplevel</td></tr></table>
      <!--l. 2275--><p class="noindent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">               :load-toplevel :execute)     ;Правильно</td></tr></table>
      <!--l. 2276--><p class="noindent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (really-foo)))</td></tr></table>
      <!--l. 2278--><p class="noindent" >
</div>
</div>
      <!--l. 2279--><p class="noindent" >Соблюдение этого правила будет значит, что такие макросы будут вести
      себя интуитивно понятно при вызовах в формах не верхнего
      уровня.
      </li>
      <li class="itemize">Расположение связывания переменной окружённой <tt><a 
href="#x39-70002r17">eval-when</a></tt>
      захватывает связывание, потому что режим «время-компиляции» не
      может случиться (потому что <tt><a 
href="#x39-70002r17">eval-when</a></tt> не может быть формой
      верхнего уровня) <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(let ((x 3))
</td></tr></table>
      <!--l. 2286--><p class="noindent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (eval-when (:compile-toplevel :load-toplevel :execute)</td></tr></table>
      <!--l. 2287--><p class="noindent" >                                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (print x)))</td></tr></table>
      <!--l. 2289--><p class="noindent" >
</div>
</div>
                                                                          

                                                                          
      <!--l. 2290--><p class="noindent" >выведет 3 во время выполнения (в данном случае загрузки) и не будет
      ничего выводить во время компиляции. Разворачивание <tt><a 
href="#x39-66002r13">defun</a></tt> и
      <tt><a 
href="clmse44.html#x57-143004r118">defmacro</a></tt> может быть выполнено в контексте <tt><a 
href="#x39-70002r17">eval-when</a></tt> и могут
      корректно захватывать лексическое окружение. Например, реализация
      может разворачивать форму <tt><a 
href="#x39-66002r13">defun</a></tt>, такую как: <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun bar (x) (defun foo () (+ x 3)))
</td></tr></table>
      <!--l. 2297--><p class="noindent" >
</div>
</div>
      <!--l. 2298--><p class="noindent" >в <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(progn (eval-when (:compile-toplevel)
</td></tr></table>
      <!--l. 2300--><p class="noindent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (compiler::notice-function &#x2019;bar &#x2019;(x)))</td></tr></table>
      <!--l. 2301--><p class="noindent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">       (eval-when (:load-toplevel :execute)</td></tr></table>
      <!--l. 2302--><p class="noindent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (setf (symbol-function &#x2019;bar)</td></tr></table>
      <!--l. 2303--><p class="noindent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">               #&#x2019;(lambda (x)</td></tr></table>
      <!--l. 2304--><p class="noindent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                   (progn (eval-when (:compile-toplevel)</td></tr></table>
      <!--l. 2305--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                            (compiler::notice-function &#x2019;foo</td></tr></table>
      <!--l. 2306--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                                                       &#x2019;()))</td></tr></table>
      <!--l. 2307--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                          (eval-when (:load-toplevel :execute)</td></tr></table>
      <!--l. 2308--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                            (setf (symbol-function &#x2019;foo)</td></tr></table>
      <!--l. 2309--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                                  #&#x2019;(lambda () (+ x 3)))))))))</td></tr></table>
      <!--l. 2311--><p class="noindent" >
</div>
</div>
      <!--l. 2312--><p class="noindent" >которая по предыдущим правилам будет обработана также, как и
      <div class=lisp><div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(progn (eval-when (:compile-toplevel)
</td></tr></table>
      <!--l. 2314--><p class="noindent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (compiler::notice-function &#x2019;bar &#x2019;(x)))</td></tr></table>
      <!--l. 2315--><p class="noindent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">       (eval-when (:load-toplevel :execute)</td></tr></table>
      <!--l. 2316--><p class="noindent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (setf (symbol-function &#x2019;bar)</td></tr></table>
      <!--l. 2317--><p class="noindent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">               #&#x2019;(lambda (x)</td></tr></table>
      <!--l. 2318--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                   (progn (eval-when (:load-toplevel :execute)</td></tr></table>
      <!--l. 2319--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                            (setf (symbol-function &#x2019;foo)</td></tr></table>
      <!--l. 2320--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                                  #&#x2019;(lambda () (+ x 3)))))))))</td></tr></table>
      <!--l. 2322--><p class="noindent" >
</div>
</div>
      </li></ul>
<!--l. 2326--><p class="indent" >   Вот несколько дополнительных примеров. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(let ((x 1))
</td></tr></table>
<!--l. 2328--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (eval-when (:execute :load-toplevel :compile-toplevel)</td></tr></table>
<!--l. 2329--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (setf (symbol-function &#x2019;foo1) #&#x2019;(lambda () x))))</td></tr></table>
<!--l. 2331--><p class="indent" >
</div>
</div>
<tt>
<!--l. 2332--><p class="noindent" ><a 
href="#x39-70002r17">eval-when</a></tt> в предыдущем выражении не является формой верхнего уровня,
таким образом во внимание берётся только ключевой символ <tt>:execute</tt>. это не
будет иметь эффекта во время компиляции. Однако этот код установит в
<tt>(symbol-function &#x2019;foo1)</tt> функцию которая возвращает <tt>1</tt> во время загрузки
(если <tt><a 
href="clmse38.html#x50-99002r74">let</a></tt> форма верхнего уровня) или во время выполнения (если форма <tt><a 
href="clmse38.html#x50-99002r74">let</a></tt>
вложена в какую-либо другую форму, которая ещё не была выполнена).
<div class=lisp><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(eval-when (:execute :load-toplevel :compile-toplevel)
</td></tr></table>
<!--l. 2340--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((x 2))</td></tr></table>
<!--l. 2341--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (eval-when (:execute :load-toplevel :compile-toplevel)</td></tr></table>
<!--l. 2342--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (setf (symbol-function &#x2019;foo2) #&#x2019;(lambda () x)))))</td></tr></table>
<!--l. 2344--><p class="indent" >
</div>
</div>
<!--l. 2345--><p class="noindent" >Если предыдущее выражение находилось на верхнем уровне в компилируемом
файле, оно будет выполнятся в обоих случаях, и во время компиляции и во
время загрузки.
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(eval-when (:execute :load-toplevel :compile-toplevel)
</td></tr></table>
<!--l. 2349--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (setf (symbol-function &#x2019;foo3) #&#x2019;(lambda () 3)))</td></tr></table>
<!--l. 2351--><p class="indent" >
</div>
</div>
<!--l. 2352--><p class="noindent" >Если предыдущее выражение находилось на верхнем уровне в компилируемом
файле, оно будет выполняться в обоих случаях, и во время компиляции и во
время загрузки.
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(eval-when (:compile-toplevel)
</td></tr></table>
<!--l. 2356--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (eval-when (:compile-toplevel)</td></tr></table>
<!--l. 2357--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (print &#x2019;foo4)))</td></tr></table>
<!--l. 2359--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 2360--><p class="noindent" >Предыдущее выражение ничего не делает, оно просто возвращает <tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt>.
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(eval-when (:compile-toplevel)
</td></tr></table>
<!--l. 2363--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (eval-when (:execute)</td></tr></table>
<!--l. 2364--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (print &#x2019;foo5)))</td></tr></table>
<!--l. 2366--><p class="indent" >
</div>
</div>
<!--l. 2367--><p class="noindent" >Если предыдущее выражение находилось на верхнем уровне в компилируемом
файле, <tt>foo5</tt> будет выведено во время компиляции. Если эта форма была не
на верхнем уровне, ничего не будет выведено во время компиляции. Вне
зависимости от контекста, ничего не будет выведено во время загрузки или
выполнения.
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(eval-when (:execute :load-toplevel)
</td></tr></table>
<!--l. 2373--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (eval-when (:compile-toplevel)</td></tr></table>
<!--l. 2374--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (print &#x2019;foo6)))</td></tr></table>
<!--l. 2376--><p class="indent" >
</div>
</div>
<!--l. 2377--><p class="noindent" >Если предыдущая форма находилась на верхнем уровне в компилируемом
файле, <tt>foo6</tt> будет выведено во время компиляции. Если форма была не на
верхнем уровне, ничего не будет выведено во время компиляции. Вне
зависимости от контекста, ничего не будет выведение во время загрузки или
выполнения кода.
                                                                          

                                                                          
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
   <!--l. 1084--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch6.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse28.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse28.html#tailclmse28.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse29.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch5.html#clmse29.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 1084--><p class="indent" >   <a 
 id="tailclmse29.html"></a>   
</body></html> 
