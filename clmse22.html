<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Уточняющие спецификаторы типов</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-13 16:31:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 1414--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse23.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse21.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse21.html#tailclmse21.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse22.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch4.html#clmse22.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">4.5   </span> <a 
 id="x31-490004.5"></a>Уточняющие спецификаторы типов</h3>
<!--l. 1417--><p class="noindent" >Некоторые списки, представляющие типы, с помощью символов могут быть
более специализированы. Такие подробности могут быть отражены, как более
эффективная реализация. Например, предположим что (array short-ﬂoat).
Реализация A, может выбрать специализированное представление для
массива коротких с плавающей точкой, а реализация B может выбрать более
общее представление.
<!--l. 1423--><p class="indent" >   Если вы хотите создать массива в целях хранения только коротких с
плавающей точкой, вы можете опционально указать для <a 
href="clmse91.html#x113-218002r525">make-array</a> тип
элементов short-ﬂoat. Это <i>не потребует</i> от <a 
href="clmse91.html#x113-218002r525">make-array</a> создать объект типа
(array short-ﬂoat); это просто позволит ей выбрать такой тип. Запрос можно
объяснить так: «Предоставь наиболее специализированный массив,
который может хранить короткие с плавающей точкой, который только
может предоставить реализация». Реализация A тогда предоставит
специализированный массив типа (array short-ﬂoat), а реализация B —
простой массив типа (array t).
<!--l. 1432--><p class="indent" >   На вопрос, действительно ли тип созданного массива (array short-ﬂoat),
реализация A ответит «да», но реализация B ответит «нет». Это свойство
<a 
href="clmse91.html#x113-218002r525">make-array</a> и подобных ей функций: то, что вы просите, необязательно
является тем, что вы получите.
<!--l. 1437--><p class="indent" >   Далее перечисленны возможные имена типов, которые задаются
списком:
<div class=flushdesc>
<!--l. 1440--><p class="indent" >
      <ul><li><b>
(array <i>тип-элемента</i> <i>размерность</i>) </b></li>Такая запись обозначает множество
      специализированных массивов, элементы которых приндлежат
      типу <i>тип-элемента</i> и размерность которых равна <i>размерность</i>.
      <i>тип-элемента</i> должен быть корректным спецификатором типа или не
      уточнен с помощью <a 
href="clmse108.html#x133-242010r596">*</a>. <i>размерность</i> может быть неотрицительным
                                                                          

                                                                          
      целым определяющим размер массива, может быть списком
      неотрицательных целых, определяющих размер каждого измерения
      (размер какого-либо измерения может быть не указан <a 
href="clmse108.html#x133-242010r596">*</a>), может быть не
      указана <a 
href="clmse108.html#x133-242010r596">*</a>. Например, <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(array integer 3)           ;Трехэлементный массив целых
</td></tr></table>
      <!--l. 1451--><p class="noindent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(array integer (* * *))     ;Трехмерный массив целых</td></tr></table>
      <!--l. 1452--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(array * (4 5 6))           ;Трехмерный массив, размеры измерений 4,5,6</td></tr></table>
      <!--l. 1454--><p class="noindent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(array character (3 *))     ;Двумерный массив символов</td></tr></table>
      <!--l. 1455--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                            ; у которого только три строки</td></tr></table>
      <!--l. 1456--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(array short-ﬂoat ())      ;Ранг массива равен нулю, массив содержит</td></tr></table>
      <!--l. 1457--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                            ; короткие с плавающие точкой</td></tr></table>
      <!--l. 1459--><p class="noindent" >
</div>
</div>
      <!--l. 1460--><p class="noindent" >Следует отметить, что (array t) является правильным подмножеством
      (array *). Причиной тому является то. что (array t) это можество
      массивов, которые могут содержать любой Common Lisp объект
      (элементы типа <a 
href="clmse31.html#x42-74004r19">t</a>, которые включают все элементы). С другой
      стороны, (array *) является множеством всех массивов, включая,
      например, массивы, которые могут хранить только строковые
      символы. Сейчас (array character) не является подмножеством
      (array t); два множества фактически непересекаются, потому
      что (array character) не является множеством всех массивов,
      которые могут хранить строковые символы, а является множеством
      массивов, которые специализированы хранить именно символы и
      никакие другие объекты. FIXME. Поэтому проверка, может ли
      массив foo хранить строковые символы, не может быть такой:
      <div class=lisp><div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(typep foo &#x2019;(array character))
</td></tr></table>
      <!--l. 1474--><p class="noindent" >
</div>
</div>
      <!--l. 1475--><p class="noindent" >, а должна быть такой: <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(subtypep &#x2019;character (array-element-type foo))
</td></tr></table>
      <!--l. 1478--><p class="noindent" >
</div>
</div>
      <!--l. 1479--><p class="noindent" >Смотрите <a 
href="clmse93.html#x115-220002r532">array-element-type</a>.
      <li><b>
(simple-array <i>тип-элемента</i> <i>размерности</i>) </b></li>Данная запись эквивалентна
      (array <i>тип-элемента</i> <i>размерности</i>) за исключением того, что
      дополнительно определяет, что объекты будут <i>простыми</i> массивами
      (смотрите раздел <a 
href="clmse7.html#x14-290002.5">2.5<!--tex4ht:ref: ARRAY-TYPE-SECTION --></a>).
      <li><b>
(vector <i>тип-элемента</i> <i>размер</i>) </b></li>Такой тип обозначает множество
      специализированный одномерных массивов, все элементы которых
      принадлежат типу тип-элемента и размер которого равен размер. Такой
      тип полностью эквивалентен (array <i>тип-элемента</i> (<i>размер</i>)). Например:
      <div class=lisp><div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(vector double-ﬂoat)     ;Векторы двойных
</td></tr></table>
      <!--l. 1492--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                          ; чисел с плавающей точкой</td></tr></table>
      <!--l. 1493--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(vector * 5)              ;Векторы длинной пять элементов</td></tr></table>
      <!--l. 1494--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(vector t 5)              ;Общие векторы длинной пять элементов FIXME</td></tr></table>
      <!--l. 1495--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(vector (mod 32) *)       ;Вектора целых чисел между 0 и 31</td></tr></table>
      <!--l. 1497--><p class="noindent" >
                                                                          

                                                                          
</div>
</div>
      <li><b>
(simple-vector <i>размер</i>) </b></li>Такая запись означает то же, что и (vector t
      <i>размер</i>).
      <li><b>
(copmlex <i>тип</i>) </b></li>Каждый элемент такого типа является комплексным числом,
      у которого действительная и мнимая части принадлежат типу
      <i>тип</i>.
      <li><b>
(function (<i>тип-аргумента-1</i> <i>тип-аргумента-2</i> ...) <i>тип-значения</i>) </b></li>Этот тип
      может использоваться только для декларации и не может для
      распознавания; <a 
href="clmse32.html#x43-76002r20">typep</a> будет сигнализировать ошибку, если ей
      будет передан такой спецификатор типа. Каждый элемент такого
      типа является функцией, которая принимает аргументы типов
      перечисленных с помощью форм <i>тип-аргумента-j</i> и возвращает
      значение типа <i>тип-значения</i>. В форме типов аргументов могут
      использоваться маркеры &#x0026;optional, &#x0026;rest и &#x0026;key. <i>тип-значения</i> может
      быть спецификатором типа <a 
href="clmse43.html#x55-131002r105">values</a> в случае, если функция возвращает
      несколько значений.
      <li><b>
(values <i>тип-значения-1</i> <i>тип-значения-2</i> ...) </b></li>Данный тип используется только
      в двух случаях: только как <i>тип-значения</i> для спецификатора типа
      <i>функции</i> и в специальной форме <a 
href="clmse50.html#x64-154002r126">the</a>. Данный спецификатор
      используется для задания типов в случаях возврата нескольких
      значений. В списке с типами могут использоваться маркеры &#x0026;optional,
      &#x0026;rest и &#x0026;key.</ul>
</div>
                                                                          

                                                                          
   <!--l. 1525--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse23.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse21.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse21.html#tailclmse21.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse22.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch4.html#clmse22.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 1525--><p class="indent" >   <a 
 id="tailclmse22.html"></a>  
</body></html> 
