<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Miscellaneous Features</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-04 00:46:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 1880--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch26.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse131.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse131.html#tailclmse131.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse132.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch25.html#clmse132.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">25.12   </span> <a 
href="clm.html#QQ2-162-371" id="x162-33200025.12">Miscellaneous Features</a></h3>
<!--l. 1883--><p class="noindent" >The Loop Facility provides the <tt><a 
href="#x162-335002r802">named</a></tt> construct to name a loop so that the
Common Lisp special form <tt><a 
href="clmse40.html#x52-113002r88">return-from</a></tt> can be used.
<!--l. 1886--><p class="indent" >   The loop keywords <tt><a 
href="#x162-334002r799">initially</a></tt> and <tt><a 
href="#x162-334006r801">finally</a></tt> designate loop constructs
that cause expressions to be evaluated before and after the loop body,
respectively.
<!--l. 1890--><p class="indent" >   The code for any <tt><a 
href="#x162-334002r799">initially</a></tt> clauses is collected into one <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt> in the order in
which the clauses appeared in the loop. The collected code is executed once in the
loop prologue after any implicit variable initializations.
<!--l. 1895--><p class="indent" >   The code for any <tt><a 
href="#x162-334006r801">finally</a></tt> clauses is collected into one <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt> in the order in
which the clauses appeared in the loop. The collected code is executed once in the
loop epilogue before any implicit values are returned from the accumulation
clauses. Explicit returns in the loop body, however, will exit the loop without
executing the epilogue code.
<!--l. 1902--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">25.12.1   </span> <a 
href="clmli1.html#QQ2-162-372" id="x162-33300025.12.1">Data Types</a></h4>
<!--l. 1905--><p class="noindent" >Many loop constructs take a <i>type-spec</i> argument that allows you to specify certain
data types for loop variables. While it is not necessary to specify a data type for
any variable, by doing so you ensure that the variable has a correctly typed initial
value. The type declaration is made available to the compiler for more eﬃcient
<tt><a 
href="clmse41.html#x53-117002r90">loop</a></tt> expansion. In some implementations, ﬁxnum and ﬂoat declarations
are especially useful; the compiler notices them and emits more eﬃcient
code.
<!--l. 1918--><p class="indent" >   The <i>type-spec</i> argument has the following syntax: <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>type-spec</i> ::= <tt>of-type</tt> <i>d-type-spec</i>
</td></tr></table>
<!--l. 1920--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>d-type-spec</i> ::= <i>type-speciﬁer</i> | <tt>(<i>d-type-spec</i> . <i>d-type-spec</i>)</tt></td></tr></table>
                                                                          

                                                                          
<!--l. 1922--><p class="indent" >
</div>
<!--l. 1923--><p class="noindent" >A <i> type-speciﬁer</i> in this syntax can be any Common Lisp type speciﬁer. The
<i>d-type-spec</i> argument is used for destructuring, as described in section <a 
href="#x162-33400025.12.2">25.12.2<!--tex4ht:ref: LOOP-DESTRUCTURING-SECTION --></a>. If
the <i>d-type-spec</i> argument consists solely of the types <tt>fixnum</tt>, <tt><a 
href="clmse65.html#x82-183002r214">float</a></tt>, <tt><a 
href="clmse30.html#x41-73004r19">t</a></tt>, or <tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt>, the
<tt>of-type</tt> keyword is optional. The <tt>of-type</tt> construct is optional in these cases to
provide backward compatibility; thus the following two expressions are the
same:
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; This expression uses the old syntax for type speciﬁers.
</td></tr></table>
<!--l. 1932--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for i ﬁxnum upfrom 3 ...)</td></tr></table>
<!--l. 1933--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 1934--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; This expression uses the new syntax for type speciﬁers.</td></tr></table>
<!--l. 1935--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for i of-type ﬁxnum upfrom 3 ...)</td></tr></table>
<!--l. 1937--><p class="indent" >
</div>
</div>
<!--l. 1939--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">25.12.2   </span> <a 
href="clmli1.html#QQ2-162-373" id="x162-33400025.12.2">Destructuring</a></h4>
<!--l. 1942--><p class="noindent" >Destructuring allows you to bind a set of variables to a corresponding set of values
anywhere that you can normally bind a value to a single variable. During <tt><a 
href="clmse41.html#x53-117002r90">loop</a></tt>
expansion, each variable in the variable list is matched with the values in
the values list. If there are more variables in the variable list than there
are values in the values list, the remaining variables are given a value of
<tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt>. If there are more values than variables listed, the extra values are
discarded.
<!--l. 1951--><p class="indent" >   Suppose you want to assign values from a list to the variables <tt>a</tt>, <tt>b</tt>, and <tt>c</tt>. You
could use one <tt><a 
href="clmse126.html#x156-312002r769">for</a></tt> clause to bind the variable <tt>numlist</tt> to the <i>car</i> of the speciﬁed
expression, and then you could use another <tt><a 
href="clmse126.html#x156-312002r769">for</a></tt> clause to bind the variables <tt>a</tt>, <tt>b</tt>,
and <tt>c</tt> sequentially. <div class=lisp><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Collect values by using FOR constructs.
</td></tr></table>
<!--l. 1957--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for numlist in &#x2019;((1 2 4.0) (5 6 8.3) (8 9 10.4))</td></tr></table>
<!--l. 1958--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      for a integer = (ﬁrst numlist)</td></tr></table>
<!--l. 1959--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      and for b integer = (second numlist)</td></tr></table>
<!--l. 1960--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      and for c ﬂoat = (third numlist)</td></tr></table>
<!--l. 1961--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      collect (list c b a))</td></tr></table>
<!--l. 1962--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> ((4.0 2 1) (8.3 6 5) (10.4 9 8))</td></tr></table>
<!--l. 1964--><p class="indent" >
</div>
</div>
<!--l. 1965--><p class="noindent" >Destructuring makes this process easier by allowing the variables to be bound in
parallel in each loop iteration. You can declare data types by using a
list of <i>type-spec</i> arguments. If all the types are the same, you can use a
shorthand destructuring syntax, as the second example following illustrates.
<div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Destructuring simpliﬁes the process.
</td></tr></table>
<!--l. 1971--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for (a b c) (integer integer ﬂoat) in</td></tr></table>
<!--l. 1972--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      &#x2019;((1 2 4.0) (5 6 8.3) (8 9 10.4))</td></tr></table>
<!--l. 1973--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      collect (list c b a)))</td></tr></table>
<!--l. 1974--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> ((4.0 2 1) (8.3 6 5) (10.4 9 8))</td></tr></table>
<!--l. 1975--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 1976--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; If all the types are the same, this way is even simpler.</td></tr></table>
<!--l. 1977--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for (a b c) ﬂoat in</td></tr></table>
<!--l. 1978--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      &#x2019;((1.0 2.0 4.0) (5.0 6.0 8.3) (8.0 9.0 10.4))</td></tr></table>
<!--l. 1979--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      collect (list c b a))</td></tr></table>
<!--l. 1980--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> ((4.0 2.0 1.0) (8.3 6.0 5.0) (10.4 9.0 8.0))</td></tr></table>
<!--l. 1982--><p class="indent" >
</div>
</div>
<!--l. 1985--><p class="indent" >   If you use destructuring to declare or initialize a number of groups of variables
into types, you can use the loop keyword <tt><a 
href="clmse33.html#x44-78004r49">and</a></tt> to simplify the process further.
<div class=lisp><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Initialize and declare variables in parallel
</td></tr></table>
<!--l. 1989--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; by using the AND construct.</td></tr></table>
<!--l. 1990--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop with (a b) ﬂoat = &#x2019;(1.0 2.0)</td></tr></table>
<!--l. 1991--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      and (c d) integer = &#x2019;(3 4)</td></tr></table>
<!--l. 1992--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      and (e f)</td></tr></table>
<!--l. 1993--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      return (list a b c d e f))</td></tr></table>
<!--l. 1994--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> (1.0 2.0 3 4 NIL NIL)</td></tr></table>
<!--l. 1996--><p class="indent" >
</div>
</div>
<!--l. 1998--><p class="indent" >   A data type speciﬁer for a destructuring pattern is a tree of type speciﬁers
with the same shape as the tree of variables, with the following exceptions:
      <ul class="itemize1">
      <li class="itemize">When aligning the trees, an atom in the type speciﬁer tree that matches
      a cons in the variable tree declares the same type for each variable.
      </li>
      <li class="itemize">A cons in the type speciﬁer tree that matches an atom in the variable
      tree is a non-atomic type specifer.
      </li></ul>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Declare X and Y to be of type VECTOR and FIXNUM, respectively.
</td></tr></table>
<!--l. 2014--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for (x y) of-type (vector ﬁxnum) in my-list do ...)</td></tr></table>
<!--l. 2016--><p class="indent" >
</div>
</div>
<!--l. 2020--><p class="indent" >   If <tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt> is used in a destructuring list, no variable is provided for its place.
<div class=lisp><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for (a nil b) = &#x2019;(1 2 3)
</td></tr></table>
<!--l. 2023--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      do (return (list a b)))</td></tr></table>
<!--l. 2024--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> (1 3)</td></tr></table>
<!--l. 2026--><p class="indent" >
</div>
</div>
<!--l. 2028--><p class="indent" >   Note that nonstandard lists can specify destructuring. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for (x . y) = &#x2019;(1 . 2)
</td></tr></table>
<!--l. 2030--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      do (return y))</td></tr></table>
<!--l. 2031--><p class="indent" >                                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> 2</td></tr></table>
<!--l. 2032--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2033--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for ((a . b) (c . d))</td></tr></table>
<!--l. 2034--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          of-type ((ﬂoat . ﬂoat) (integer . integer))</td></tr></table>
<!--l. 2035--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          in &#x2019;(((1.2 . 2.4) (3 . 4)) ((3.4 . 4.6) (5 . 6)))</td></tr></table>
<!--l. 2036--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      collect (list a b c d))</td></tr></table>
<!--l. 2037--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> ((1.2 2.4 3 4) (3.4 4.6 5 6))</td></tr></table>
<!--l. 2039--><p class="indent" >
</div>
</div>
<!--l. 2041--><p class="indent" >   [It is worth noting that the destructuring facility of <tt><a 
href="clmse41.html#x53-117002r90">loop</a></tt> predates, and diﬀers
in some details from, that of <tt><a 
href="clmse46.html#x59-146002r122">destructuring-bind</a></tt>, an extension that has been
provided by many implementors of Common Lisp.—GLS]
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Выражение цикла]</i><b> initially </b><a 
 id="dx162-334001"></a><a 
 id="x162-334002r799"></a> {expr}*
</td></tr></table>
<!--l. 2047--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>[Выражение цикла]</i><b> ﬁnally </b><a 
 id="dx162-334003"></a><a 
 id="x162-334004r800"></a> [<span class="math">do!|doing!] {expr}∗</span></td></tr></table>
<!--l. 2048--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Выражение цикла]</i><b> ﬁnally </b><a 
 id="dx162-334005"></a><a 
 id="x162-334006r801"></a> <span class="math"> return!expr</span></td></tr></table>
<!--l. 2050--><p class="indent" >
</div>
                                                                          

                                                                          
<!--l. 2050--><p class="noindent" ><span class="paragraphHead"><a 
href="#x162-33500025.12.2" id="x162-33500025.12.2"></a></span>
   The <tt><a 
href="#x162-334002r799">initially</a></tt> construct causes the speciﬁed expression to be evaluated in
the loop prologue, which precedes all loop code except for initial settings speciﬁed
by constructs <tt><a 
href="clmse129.html#x159-325002r792">with</a></tt>, <tt><a 
href="clmse126.html#x156-312002r769">for</a></tt>, or <tt><a 
href="clmse126.html#x156-312004r770">as</a></tt>. The <tt><a 
href="#x162-334006r801">finally</a></tt> construct causes the speciﬁed
expression to be evaluated in the loop epilogue after normal iteration
terminates.
<!--l. 2058--><p class="indent" >   The <i>expr</i> argument can be any non-atomic Common Lisp form.
<!--l. 2060--><p class="indent" >   Clauses such as <tt><a 
href="clmse131.html#x161-330002r798">return</a></tt>, <tt><a 
href="clmse127.html#x157-316002r774">always</a></tt>, <tt><a 
href="clmse127.html#x157-316004r775">never</a></tt>, and <tt><a 
href="clmse127.html#x157-316006r776">thereis</a></tt> can bypass the <tt><a 
href="#x162-334006r801">finally</a></tt>
clause.
<!--l. 2063--><p class="indent" >   The Common Lisp macro <tt><a 
href="clmse131.html#x161-330002r798">return</a></tt> (or the <tt><a 
href="clmse131.html#x161-330002r798">return</a></tt> loop construct) can be
used after <tt><a 
href="#x162-334006r801">finally</a></tt> to return values from a loop. The evaluation of the
<tt><a 
href="clmse131.html#x161-330002r798">return</a></tt> form inside the <tt><a 
href="#x162-334006r801">finally</a></tt> clause takes precedence over returning the
accumulation from clauses speciﬁed by such keywords as <tt><a 
href="clmse147.html#x181-469022r1018">collect</a></tt>, <tt><a 
href="clmse128.html#x158-320006r782">nconc</a></tt>,
<tt><a 
href="clmse128.html#x158-320002r780">append</a></tt>, <tt><a 
href="clmse128.html#x158-322002r786">sum</a></tt>, <tt><a 
href="clmse128.html#x158-321002r784">count</a></tt>, <tt><a 
href="clmse128.html#x158-323002r788">maximize</a></tt>, and <tt><a 
href="clmse128.html#x158-323006r790">minimize</a></tt>; the accumulation values
for these pre-empted clauses are not returned by the loop if <tt><a 
href="clmse131.html#x161-330002r798">return</a></tt> is
used.
<!--l. 2072--><p class="indent" >   The constructs <tt><a 
href="clmse131.html#x161-329002r796">do</a></tt>, <tt><a 
href="#x162-334002r799">initially</a></tt>, and <tt><a 
href="#x162-334006r801">finally</a></tt> are the only loop keywords that
take an arbitrary number of (non-atomic) forms and group them as if by using an
implicit <tt><a 
href="clmse37.html#x49-95002r71">progn</a></tt>.
<!--l. 2078--><p class="indent" >   Examples: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; This example parses a simple printed string representation
</td></tr></table>
<!--l. 2080--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; from BUFFER (which is itself a string) and returns the</td></tr></table>
<!--l. 2081--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; index of the closing double-quote character.</td></tr></table>
<!--l. 2082--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2083--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop initially (unless (char= (char buﬀer 0) #\&#x0022;)</td></tr></table>
<!--l. 2084--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  (loop-ﬁnish))</td></tr></table>
<!--l. 2085--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      for i ﬁxnum from 1 below (string-length buﬀer)</td></tr></table>
<!--l. 2086--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      when (char= (char buﬀer i) #\&#x0022;)</td></tr></table>
<!--l. 2087--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        return i)</td></tr></table>
<!--l. 2088--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2089--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The FINALLY clause prints the last value of I.</td></tr></table>
<!--l. 2090--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The collected value is returned.</td></tr></table>
<!--l. 2091--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2092--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for i from 1 to 10</td></tr></table>
<!--l. 2093--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      when (&#x003E; i 5)</td></tr></table>
                                                                          

                                                                          
<!--l. 2094--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        collect i</td></tr></table>
<!--l. 2095--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:184;" 
class="tabbing">      ﬁnally (print i)) </td><td style="width:400;" 
class="tabbing-right">                                      ;Prints 1 line</td></tr></table>
<!--l. 2096--><p class="indent" >                                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">11</td></tr></table>
<!--l. 2097--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> (6 7 8 9 10)</td></tr></table>
<!--l. 2098--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2099--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Return both the count of collected numbers</td></tr></table>
<!--l. 2100--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; as well as the numbers themselves.</td></tr></table>
<!--l. 2101--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 2102--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop for i from 1 to 10</td></tr></table>
<!--l. 2103--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      when (&#x003E; i 5)</td></tr></table>
<!--l. 2104--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        collect i into number-list</td></tr></table>
<!--l. 2105--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        and count i into number-count</td></tr></table>
<!--l. 2106--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      ﬁnally (return (values number-count number-list)))</td></tr></table>
<!--l. 2107--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> 5 and (6 7 8 9 10)</td></tr></table>
<!--l. 2109--><p class="indent" >
</div>
</div>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Выражение цикла]</i><b> named </b><a 
 id="dx162-335001"></a><a 
 id="x162-335002r802"></a> name
</td></tr></table>
<!--l. 2114--><p class="indent" >
</div>
<!--l. 2114--><p class="noindent" ><span class="paragraphHead"><a 
href="#x162-33600025.12.2" id="x162-33600025.12.2"></a></span>
   The <tt><a 
href="#x162-335002r802">named</a></tt> construct allows you to assign a name to a <tt><a 
href="clmse41.html#x53-117002r90">loop</a></tt> construct so that
you can use the Common Lisp special form <tt><a 
href="clmse40.html#x52-113002r88">return-from</a></tt> to exit the named
loop.
<!--l. 2119--><p class="indent" >   Only one name may be assigned per loop; the speciﬁed name becomes the
name of the implicit block for the loop.
<!--l. 2122--><p class="indent" >   If used, the <tt><a 
href="#x162-335002r802">named</a></tt> construct must be the ﬁrst clause in the loop expression,
coming right after the word <tt><a 
href="clmse41.html#x53-117002r90">loop</a></tt>.
<!--l. 2126--><p class="indent" >   Example: <div class=lisp><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Just name and return.
</td></tr></table>
<!--l. 2128--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(loop named max</td></tr></table>
<!--l. 2129--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      for i from 1 to 10</td></tr></table>
<!--l. 2130--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      do (print i)</td></tr></table>
<!--l. 2131--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:281;" 
class="tabbing">      do (return-from max &#x2019;done)) </td><td style="width:303;" 
class="tabbing-right">                          ;Prints 1 line</td></tr></table>
<!--l. 2132--><p class="indent" >                                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">1</td></tr></table>
<!--l. 2133--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   <span class="math"> ⇒</span> DONE</td></tr></table>
<!--l. 2135--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
   <!--l. 7--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch26.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse131.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse131.html#tailclmse131.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse132.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch25.html#clmse132.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 7--><p class="indent" >   <a 
 id="tailclmse132.html"></a>   
</body></html> 
