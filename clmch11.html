<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>11 Пакеты</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-19 00:40:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 2034--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse54.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse53.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse53.html#tailclmse53.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmch11.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clm.html#clmch11.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h2 class="chapterHead"><span class="titlemark">Глава 11</span><br /><a 
 id="x69-16100011"></a>Пакеты</h2>
<!--l. 2037--><p class="noindent" >В ранних реализациях Lisp&#x2019;а использовалось одно пространство имен для
всех символов. В больших Lisp&#x2019;овых системах, с модулями, написанными
разными программистами, случайные совпадения имен стали серьёзной
проблемой. Common Lisp решает эту проблему с помощью <i>системы пакетов</i>,
производной от системы пакетов, разработанной для Lisp Machine <span class="cite">[<a 
href="clmli5.html#XBLUE-LISPM">55</a>]</span>. Кроме
того система пакетов делает модульную структуру больших Lisp систем более
явной.
<i>
<!--l. 2046--><p class="indent" >   Пакет</i> — это структура данных, которая устанавливает связь между
выводимыми именами (строкой) и символами. Во время работы только один
пакет является текущим, и этот пакет используется Lisp&#x2019;овым считывателем
при преобразовании строк в символы. Текущий пакет храниться в
глобальной переменной <a 
href="clmse60.html#x76-168002r141">*package*</a>. С помощью <i>имени пакета</i> в выводимом
имени символа существует возможность ссылаться на символы других
пакетов. Например, когда foo:bar будет прочтён Common Lisp&#x2019;ом, то будет
ссылаться на символ bar из пакета foo. (Но при условии, что bar является
экспортированным символом из foo, то есть символом, который является
видимым извне пакета foo. Ссылка на внутренний символ требует
удваивания двоеточия: foo::bar.)
<!--l. 2059--><p class="indent" >   Связь строк и символов, доступных в данном пакете, делится на два вида:
<i>внешняя</i> и <i>внутренняя</i>. Речь идёт о символах доступных с помощью
этих связей, как о <i>внешних</i> и <i>внутренних</i> символах пакета, хотя на
самом деле различаются связи, а не символы. Внутри заданного пакета
имя ссылается максимум на один символ. Если оно ссылается на
символ, тогда этот символ в данном пакете является или внешним, или
внутренним.
<!--l. 2067--><p class="indent" >   Внешние символы являются частью интерфейса пакета доступного для
других пакетов. Внешние символы должны быть аккуратно спроектированы
и предоставлены для пользователей этого пакета. Внутренние символы
предусмотрены только для внутреннего использования, и эти символы
обычно скрыты от других пакетов. Большинство символов создаются как
внутренние. Они становятся внешними только, если явно передаются в
команду <a 
href="clmse60.html#x76-169026r156">export</a>.
<!--l. 2074--><p class="indent" >   Символ может встречаться во многих пакетах. Он будет всегда иметь
одно и то же имя, но в некоторых пакетах может быть внешним, а в других
                                                                          

                                                                          
внутренним. С другой стороны, одно и то же имя (строка) может ссылаться
на различные символы в различных пакетах.
<!--l. 2079--><p class="indent" >   Обычно, символ, который встречается в одном и более пакетах, будет
иметь только один родительский пакет, называемый <i>домашний пакет</i>
символа. Говорится, что такой пакет владеет символом. Все символы
содержат компонент, называемый <i>ячейка пакета</i>, который хранит указатель
на домашний пакет. Символ, который имеет домашний пакет, называется
<i>интернированным</i>. Некоторые символы не имеют домашнего пакета. Они
называются <i>дезинтернированными</i>. Их ячейка пакета содержит значение
<a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 2088--><p class="indent" >   Пакеты могут быть представлены как слои. С этой точки зрения, для
пользователя пакет выглядит как коллекция связей строк с внутренними и
внешними символами. Некоторые из этих связей могут устанавливаться
внутри самого пакета. Другие связи наследуются из других пакетов с
помощью конструкции <a 
href="clmse60.html#x76-169036r161">use-package</a>. (Механизм такого наследования описан
ниже.) В дальнейшем, мы будем называть символ <i>доступным</i> в пакете, если
на него можно сослаться без указания имени пакета, вне зависимости от того
унаследована ли связь символов с именем или установлена текущим пакетом.
И мы будем называть символ <i>родным</i> в пакете, если связь установлена самим
пакетом, а не унаследована. Таким образом, <i>родной</i> символ в пакете
является <i>доступным</i>, но <i>доступный</i> символ не обязательно является
<i>родным</i>.
<!--l. 2101--><p class="indent" >   Символ называется <i>интернированным в пакет</i>, если он доступен
в этом пакете и имеет некоторый родительский пакет. Обычно все
символы доступные в пакете будут в собственности некоторого пакета, но
иногда описываются случаи доступности никому не принадлежащего
(<i>дезинтернированного</i>) символа.
<!--l. 2107--><p class="indent" >   «<i>Интернировать</i> символ в пакет!» означает сделать так, чтобы пакет
стал владельцем символа, если до этого было не так. Этот процесс
выполняется функцией <a 
href="clmse60.html#x76-169020r153">intern</a>. Если символ прежде был бесхозным (никому
не принадлежал), тогда пакет становится его владельцем (домашним
пакетом). Но если символ уже принадлежал кому-то, то домашний пакет не
меняется.
<!--l. 2114--><p class="indent" >   «<i>Дезинтернировать</i> символ из пакета» означает убрать его из пакета.
Данный процесс выполняется функцией <a 
href="clmse60.html#x76-169024r155">unintern</a>. FIXME
   <div class="sectionTOCS">
                                                                          

                                                                          
    <span class="sectionToc" >11.1 <a 
href="clmse54.html#x70-16200011.1">Правила согласованности</a></span>
<br />    <span class="sectionToc" >11.2 <a 
href="clmse55.html#x71-16300011.2">Имена пакетов</a></span>
<br />    <span class="sectionToc" >11.3 <a 
href="clmse56.html#x72-16400011.3">Преобразование строк в символы</a></span>
<br />    <span class="sectionToc" >11.4 <a 
href="clmse57.html#x73-16500011.4">Экспортирование и импортирование символов</a></span>
<br />    <span class="sectionToc" >11.5 <a 
href="clmse58.html#x74-16600011.5">Конфликты имён</a></span>
<br />    <span class="sectionToc" >11.6 <a 
href="clmse59.html#x75-16700011.6">Системные пакеты</a></span>
<br />    <span class="sectionToc" >11.7 <a 
href="clmse60.html#x76-16800011.7">Функции и переменные для системы пакетов</a></span>
   </div>






                                                                          

                                                                          
   <!--l. 14--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse54.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse53.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse53.html#tailclmse53.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch11.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clm.html#clmch11.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 14--><p class="indent" >   <a 
 id="tailclmch11.html"></a>  
</body></html> 
