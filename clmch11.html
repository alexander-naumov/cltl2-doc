<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>11 Пакеты</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-17 21:46:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 2034--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse54.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse53.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse53.html#tailclmse53.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmch11.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clm.html#clmch11.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h2 class="chapterHead"><span class="titlemark">Глава 11</span><br /><a 
 id="x69-16100011"></a>Пакеты</h2>
<!--l. 2037--><p class="noindent" >Одна проблема была с ранними реализациями Lisp систем — это использование
одного пространства имен для всех символов. В больших Lisp&#x2019;овых системах,
с модулями написанными разными программистами, случайные совпадения
имен стали серьёзной проблемой. Common Lisp решает эту проблему с
помощью <i>системы пакетов</i>, производной от ранней системы пакетов,
разработанной для Lisp Machine <span class="cite">[<a 
href="clmli5.html#XBLUE-LISPM">55</a>]</span>. В дополнения к избежанию конфликтов
имён, система пакетов делает модульную структуру больших Lisp систем
более явной.
<i>
<!--l. 2046--><p class="indent" >   Пакет</i> — это структура данных, которая устанавливает связь между
выводимыми именами (строкой) и символами. Таким образом пакет заменяет
«oblist» или «obarray» из ранних версий Lisp&#x2019;овых систем. В любое время
только один пакет является текущим, и этот пакет используется Lisp&#x2019;овым
читателем при преобразовании строк в символы. Текущий пакет является, по
определению, значение глобальной переменной <a 
href="clmse60.html#x76-168002r141">*package*</a>. С помощью <i>имени
пакета</i> в выводимом имени символа существует возможность ссылаться на
символы других, а не текущего, пакетов. Например, когда foo:bar будет
прочтён Common Lisp&#x2019;ом, то будет ссылаться на символ bar из пакета foo.
(А точнее, это верно только, если bar является экспортированным
символом из foo, то есть символом, который является видимым извне
foo. Ссылка на внутренний символ требует удваивания двоеточия:
foo::bar.)
<!--l. 2060--><p class="indent" >   Отображение строк в символы доступное в данном пакете делиться на два
вида: <i>внешнее</i> и <i>внутреннее</i>. Речь идёт о символах доступных с помощью
этих отображений, как о <i>внешних</i> и <i>внутренних</i> символах пакета, хотя на
самом деле различаются отображения, а не символы. Внутри заданного
пакета, имя ссылается на один или ноль символов. Если оно ссылается на
символ, тогда этот символ в данном пакете внешний или внутренний в, но не
одновременно.
<!--l. 2068--><p class="indent" >   Внешние символы являются частью интерфейса пакета доступного в
других пакетах. Внешние символы должны быть выбраны с особой
тщательностью и публиковаться для пользователей этого пакета. Внутренние
символы предусмотрены только для внутреннего использования, и эти
символы обычно скрыты от других пакетов. Большинство символов
создаются как внутренние. Они становятся внешними только, если явно
                                                                          

                                                                          
передаются в команду <a 
href="clmse60.html#x76-169026r156">export</a>.
<!--l. 2075--><p class="indent" >   Символ может встречаться во многих пакетах. Он будет всегда иметь
одно и то же имя, но в некоторых пакетах может быть внешним, а в других
внутренним. С другой стороны, одно и то же имя (строка) может ссылаться
на различные символы в различных пакетах.
<!--l. 2080--><p class="indent" >   Обычно, символ, который встречается в одном и более пакетах, будет
иметь только один родительский пакет, называемый <i>домашний пакет</i>
символа. Говорится, что такой пакет владеет символом. Все символы
содержат компонент, называется <i>ячейка пакета</i>, которая хранит указатель
на домашний пакет. Символ, который имеет домашний пакет, называется
<i>интернированным</i>. Некоторые символы не имеют домашнего пакета. Они
называются дезинтернированными. Их ячейка пакета содержит значение
<a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 2089--><p class="indent" >   Пакеты могут быть представлены как слои. С этой точки зрения, для
пользователя, пакет выглядит как коллекция отображений из строк во
внутренние и внешние символы. Однако, некоторые из этих отображений
могут устанавливаться внутри самого пакета, тогда как другие отображения
наследуются из других пакетов с помощью конструкции <a 
href="clmse60.html#x76-169036r161">use-package</a>.
(Механизм такого наследования описан ниже.) В дальнейшем, мы будем
называть символ, <i>доступным</i> в пакете, если на него можно сослаться без
указания имени пакета, вне зависимости от того унаследовано ли
отображение символов, или установлено текущим пакетом. И мы будем
называть символ <i>родным</i> в пакете, если отображение установлено самим
пакетом, а не унаследовано. Таким образом настоящий символ в пакете
является доступным, но доступный символ не обязательно является
настоящим.
<!--l. 2101--><p class="indent" >   Символ называется <i>интернированным в пакет</i>, если он доступен в этом
пакете и имеет некоторый родительский пакет. Обычно все символы
доступные в пакете будут фактически в собственности некоторого пакета,
но такая терминология полезна, когда описываются патологические
случаи доступности никому не принадлежащего (дезинтернированного)
символа.
<!--l. 2107--><p class="indent" >   Как глагол, <i>интернировать</i> символ в пакет, означает сделать так, чтобы
пакет стал владельцем символа, если этого было не так. Этот процесс
выполняется функцией <a 
href="clmse60.html#x76-169020r153">intern</a>. Если символ прежде был бесхозным (никому
не принадлежал), тогда пакет становится его владельцем (домашним
пакетом). Но если символ уже принадлежал кому-то, то принадлежность не
меняется.
                                                                          

                                                                          
<i>
<!--l. 2114--><p class="indent" >   Дезинтернировать</i> символ из пакета означает убрать его из пакета.
Данный процесс выполняется функцией <a 
href="clmse60.html#x76-169024r155">unintern</a>. FIXME
   <div class="sectionTOCS">
    <span class="sectionToc" >11.1 <a 
href="clmse54.html#x70-16200011.1">Правила согласованности</a></span>
<br />    <span class="sectionToc" >11.2 <a 
href="clmse55.html#x71-16300011.2">Имена пакетов</a></span>
<br />    <span class="sectionToc" >11.3 <a 
href="clmse56.html#x72-16400011.3">Преобразование строк в символы</a></span>
<br />    <span class="sectionToc" >11.4 <a 
href="clmse57.html#x73-16500011.4">Экспортирование и импортирование символов</a></span>
<br />    <span class="sectionToc" >11.5 <a 
href="clmse58.html#x74-16600011.5">Конфликты имён</a></span>
<br />    <span class="sectionToc" >11.6 <a 
href="clmse59.html#x75-16700011.6">Системные пакеты</a></span>
<br />    <span class="sectionToc" >11.7 <a 
href="clmse60.html#x76-16800011.7">Функции и переменные для системы пакетов</a></span>
   </div>






                                                                          

                                                                          
   <!--l. 14--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse54.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse53.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse53.html#tailclmse53.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch11.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clm.html#clmch11.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 14--><p class="indent" >   <a 
 id="tailclmch11.html"></a>  
</body></html> 
