<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Ассоциативные списки</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-28 14:08:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 2335--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch16.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse84.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse84.html#tailclmse84.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse85.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch15.html#clmse85.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">15.6   </span> <a 
href="clm.html#QQ2-105-238" id="x105-20900015.6">Ассоциативные списки</a></h3>
<i>
<!--l. 2337--><p class="noindent" >Ассоциативный список</i>, или <i>a-list</i>, является структурой данных, часто
используемой в Lisp&#x2019;е. a-list является списком пар (cons-ячеек). Каждая пара
является ассоциацией. <i>car</i> элемент пары называется <i>key</i>, и <i>cdr</i> элемент
<i>datum</i>.
<!--l. 2342--><p class="indent" >   Преимущество a-list представления данных в том, что a-list может быть
постепенно увеличен путём простого добавления в начало новых записей.
Кроме того, поскольку функция поиска <a 
href="#x105-209006r483">assoc</a> по порядку проходит элементы
a-list, то новые записи могут «скрыть» старые. Если a-list рассматривать как
отображение ключей в значения, то отображение может быть не только
увеличено, но также изменено с помощью добавления новых записей в начало
a-list.
<!--l. 2350--><p class="indent" >   Иногда a-list представляет биективное (bijective) отображение, и
бывает нужно получить ключ для некоторого значения. Для этих
целей используется функция «реверсивного» поиска <a 
href="#x105-209012r486">rassoc</a>. Другие
варианты поиска в a-list могут быть созданы с помощью функции <a 
href="clmse78.html#x97-198002r379">ﬁnd</a> или
<a 
href="clmse84.html#x104-208002r467">member</a>.
<!--l. 2355--><p class="indent" >   Допустимо, чтобы <a 
href="clmse31.html#x42-74002r18">nil</a> был элемент a-list вместо пары ключ-значение.
Такой элемент не считается парой и просто пропускается при использовании
функции <a 
href="#x105-209006r483">assoc</a>.
<div class=defun>
<!--l. 2359--><p class="noindent" ><i>[Функция]</i><a 
 id="dx105-209001"></a><a 
 id="x105-209002r481"></a><b> acons</b>  <i>key</i> <i>datum</i> <i>a-list</i>
<!--l. 2361--><p class="noindent" ><a 
href="#x105-209002r481">acons</a> создаёт новый ассоциативный список, с помощью добавления пары (<i>key</i>
. <i>datum</i>) к старому <i>a-list</i>. <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(acons x y a) <span class="math"> ≡</span> (cons (cons x y) a)
</td></tr></table>
<!--l. 2366--><p class="indent" >
</div>
                                                                          

                                                                          
</div>
</div>
<div class=defun>
<!--l. 2369--><p class="noindent" ><i>[Функция]</i><a 
 id="dx105-209003"></a><a 
 id="x105-209004r482"></a><b> pairlis</b>  <i>keys</i> <i>data</i> &#x0026;optional  <i>a-list</i>
<!--l. 2371--><p class="noindent" ><a 
href="#x105-209004r482">pairlis</a> принимает два списка и создаёт ассоциативный список, который
связывает элементы первого списка с соответствующими элементами второго.
Если списки не одинаковой длины, это является ошибкой. Если указан
необязательный аргумент <i>a-list</i>, тогда новые пары добавляются к нему в
начало.
<!--l. 2377--><p class="indent" >   Новые пары могут быть расположены в итоговом списке a-list в любом
порядке. Например: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(pairlis &#x2019;(one two) &#x2019;(1 2) &#x2019;((three . 3) (four . 19)))
</td></tr></table>
<!--l. 2381--><p class="indent" >
</div>
</div>
<!--l. 2382--><p class="noindent" >может быть <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">((one . 1) (two . 2) (three . 3) (four . 19))
</td></tr></table>
<!--l. 2385--><p class="indent" >
</div>
</div>
<!--l. 2386--><p class="noindent" >или может быть так <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">((two . 2) (one . 1) (three . 3) (four . 19))
</td></tr></table>
<!--l. 2389--><p class="indent" >
</div>
</div>
</div>
<div class=defun>
                                                                          

                                                                          
<!--l. 2392--><p class="noindent" ><i>[Функция]</i><a 
 id="dx105-209005"></a><a 
 id="x105-209006r483"></a><b> assoc</b>  <i>item</i> <i>a-list</i> &#x0026;key  <i>:test</i> <i>:test-not</i> <i>:key</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx105-209007"></a><a 
 id="x105-209008r484"></a><b> assoc-if</b>  <i>predicate</i> <i>a-list</i> &#x0026;key  <i>:key</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx105-209009"></a><a 
 id="x105-209010r485"></a><b> assoc-if-not</b>  <i>predicate</i> <i>a-list</i> &#x0026;key  <i>:key</i>
<!--l. 2396--><p class="noindent" >Каждая из этих функций осуществляет поиск в ассоциативном списке <i>a-list</i>.
Функция возвращает первую пару, удовлетворяющую условию, или <a 
href="clmse31.html#x42-74002r18">nil</a>, если
такой пары не было найдено. Например: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assoc &#x2019;r &#x2019;((a . b) (c . d) (r . x) (s . y) (r . z)))
</td></tr></table>
<!--l. 2402--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        <span class="math"> ⇒</span> (r . x)</td></tr></table>
<!--l. 2403--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assoc &#x2019;goo &#x2019;((foo . bar) (zoo . goo))) <span class="math"> ⇒</span> <a 
href="clmse31.html#x42-74002r18">nil</a></td></tr></table>
<!--l. 2404--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assoc &#x2019;2 &#x2019;((1 a b c) (2 b c d) (-7 x y z))) <span class="math"> ⇒</span> (2 b c d)</td></tr></table>
<!--l. 2406--><p class="indent" >
</div>
</div>
<!--l. 2407--><p class="noindent" >Если функция вернула пару, можно изменить её значение с помощью <a 
href="clmse82.html#x102-206004r458">rplacd</a>.
(Однако лучше будет добавить новую «затеняющую» пару в начало, чем
модифицировать старую.) Например: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq values &#x2019;((x . 100) (y . 200) (z . 50)))
</td></tr></table>
<!--l. 2412--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assoc &#x2019;y values) <span class="math"> ⇒</span> (y . 200)</td></tr></table>
<!--l. 2413--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(rplacd (assoc &#x2019;y values) 201)</td></tr></table>
<!--l. 2414--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assoc &#x2019;y values) <span class="math"> ⇒</span> (y . 201) теперь</td></tr></table>
<!--l. 2416--><p class="indent" >
</div>
</div>
<!--l. 2417--><p class="noindent" >Типичный приём использования (cdr (assoc x y)). Так как <i>cdr</i> от <a 
href="clmse31.html#x42-74002r18">nil</a> гарантировано
вычисляется в <a 
href="clmse31.html#x42-74002r18">nil</a>, то в случае отсутствия нужной пары, будет возвращено
значение <a 
href="clmse31.html#x42-74002r18">nil</a>. <a 
href="clmse31.html#x42-74002r18">nil</a> также будет возвращено, если значение для ключа
равно <a 
href="clmse31.html#x42-74002r18">nil</a>. Такое поведение удобно, если <a 
href="clmse31.html#x42-74002r18">nil</a> несёт смысл «значения
по-умолчанию».
<!--l. 2423--><p class="indent" >   Два выражения <div class=lisp><div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assoc <i>item</i> <i>list</i> :test <i>fn</i>)
</td></tr></table>
<!--l. 2426--><p class="indent" >
</div>
</div>
<!--l. 2427--><p class="noindent" >и <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ﬁnd <i>item</i> <i>list</i> :test <i>fn</i> :key #&#x2019;car)
</td></tr></table>
<!--l. 2430--><p class="indent" >
</div>
</div>
<!--l. 2431--><p class="noindent" >эквивалентны за исключением, того что <a 
href="#x105-209006r483">assoc</a> игнорирует значения <a 
href="clmse31.html#x42-74002r18">nil</a> на месте
пар.
<!--l. 2434--><p class="indent" >   Смотрите также <a 
href="clmse78.html#x97-198002r379">ﬁnd</a> и <a 
href="clmse78.html#x97-198008r382">position</a>.
</div>
<div class=defun>
<!--l. 2437--><p class="noindent" ><i>[Функция]</i><a 
 id="dx105-209011"></a><a 
 id="x105-209012r486"></a><b> rassoc</b>  <i>item</i> <i>a-list</i> &#x0026;key  <i>:test</i> <i>:test-not</i> <i>:key</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx105-209013"></a><a 
 id="x105-209014r487"></a><b> rassoc-if</b>  <i>predicate</i> <i>a-list</i> &#x0026;key  <i>:key</i><br 
class="newline" /><i>[Функция]</i><a 
 id="dx105-209015"></a><a 
 id="x105-209016r488"></a><b> rassoc-if-not</b>  <i>predicate</i> <i>a-list</i> &#x0026;key  <i>:key</i>
<!--l. 2441--><p class="noindent" ><a 
href="#x105-209012r486">rassoc</a> является реверсивной формой для <a 
href="#x105-209006r483">assoc</a>. Функция ищет пары, у
которых <i>cdr</i> элемент удовлетворяет заданному условию. Если <i>a-list</i>
рассматривается как отображение, то <a 
href="#x105-209012r486">rassoc</a> обрабатывает <i>a-list</i> как
представление инверсного отображения. Например: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(rassoc &#x2019;a &#x2019;((a . b) (b . c) (c . a) (z . a))) <span class="math"> ⇒</span> (c . a)
</td></tr></table>
<!--l. 2449--><p class="indent" >
</div>
</div>
<!--l. 2451--><p class="indent" >   Выражения <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(rassoc <i>item</i> <i>list</i> :test <i>fn</i>)
</td></tr></table>
<!--l. 2454--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 2455--><p class="noindent" >и <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(ﬁnd <i>item</i> <i>list</i> :test <i>fn</i> :key #&#x2019;cdr)
</td></tr></table>
<!--l. 2458--><p class="indent" >
</div>
</div>
<!--l. 2459--><p class="noindent" >эквивалентны за исключением, того что <a 
href="#x105-209012r486">rassoc</a> игнорирует значения <a 
href="clmse31.html#x42-74002r18">nil</a> на месте
пар.
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
   <!--l. 395--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch16.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse84.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse84.html#tailclmse84.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse85.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch15.html#clmse85.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 395--><p class="indent" >   <a 
 id="tailclmse85.html"></a>  
</body></html> 
