<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Using the Automatically Deﬁned Constructor Function</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-02-22 17:23:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 340--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse106.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse104.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse104.html#tailclmse104.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse105.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch19.html#clmse105.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">19.3   </span> <a 
 id="x129-17100019.3"></a>Using the Automatically Deﬁned Constructor Function</h3>
<!--l. 342--><p class="noindent" >After you have deﬁned a new structure with <a 
href="clmse104.html#x128-170002r617">defstruct</a>, you can create instances of
this structure by using the constructor function. By default, <a 
href="clmse104.html#x128-170002r617">defstruct</a> deﬁnes this
function automatically. For a structure named foo, the constructor function is
normally named make-foo; you can specify a diﬀerent name by giving it as
the argument to the <i>:constructor</i> option, or specify that you don&#x2019;t want
a normal constructor function at all by using <a 
href="clmse31.html#x42-70002r19">nil</a> as the argument (in
which case one or more “by-position” constructors should be requested; see
section <a 
href="clmse108.html#x132-17400019.6">19.6<!--tex4ht:ref: DEFSTRUCT-CONSTRUCTOR-SYNTAX --></a>).
<!--l. 355--><p class="indent" >   A call to a constructor function, in general, has the form <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(name-of-constructor-function
</td></tr></table>
<!--l. 357--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        slot-keyword-1 form-1</td></tr></table>
<!--l. 358--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        slot-keyword-2 form-2</td></tr></table>
<!--l. 359--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ...)</td></tr></table>
<!--l. 361--><p class="indent" >
</div>
</div>
<!--l. 362--><p class="noindent" >All arguments are keyword arguments. Each slot-keyword should be a keyword whose
name matches the name of a slot of the structure (<a 
href="clmse104.html#x128-170002r617">defstruct</a> determines the
possible keywords simply by interning each slot-name in the keyword package).
All the keywords and forms are evaluated. In short, it is just as if the constructor
function took all its arguments as <i>&#x0026;key</i> parameters. For example, the ship
structure shown in section <a 
href="clmse103.html#x127-16900019.1">19.1<!--tex4ht:ref: DEFSTRUCT-INTRO-SECTION --></a> has a constructor function that takes arguments
roughly as if its deﬁnition were <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun make-ship (&#x0026;key x-position y-position
</td></tr></table>
                                                                          

                                                                          
<!--l. 372--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       x-velocity y-velocity mass)</td></tr></table>
<!--l. 373--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 375--><p class="indent" >
</div>
</div>
<!--l. 378--><p class="indent" >   If slot-keyword-j names a slot, then that element of the created structure will
be initialized to the value of form-j. If no pair slot-keyword-j and form-j is present
for a given slot, then the slot will be initialized by evaluating the default-init
form speciﬁed for that slot in the call to <a 
href="clmse104.html#x128-170002r617">defstruct</a>. (In other words, the
initialization speciﬁed in the <a 
href="clmse104.html#x128-170002r617">defstruct</a> defers to any speciﬁed in a call to
the constructor function.) If the default initialization form is used, it
is evaluated at construction time, but in the lexical environment of the
<a 
href="clmse104.html#x128-170002r617">defstruct</a> form in which it appeared. If the <a 
href="clmse104.html#x128-170002r617">defstruct</a> itself also did not
specify any initialization, the element&#x2019;s initial value is undeﬁned. You
should always specify the initialization, either in the <a 
href="clmse104.html#x128-170002r617">defstruct</a> or in the
call to the constructor function, if you care about the initial value of the
slot.
<!--l. 395--><p class="indent" >   Each initialization form speciﬁed for a <a 
href="clmse104.html#x128-170002r617">defstruct</a> component, when used by the
constructor function for an otherwise unspeciﬁed component, is re-evaluated on
every call to the constructor function. It is as if the initialization forms were used
as init forms for the keyword parameters of the constructor function. For example,
if the form <i>(gensym)</i> were used as an initialization form, either in the
constructor-function call or as the default initialization form in the <a 
href="clmse104.html#x128-170002r617">defstruct</a> form,
then every call to the constructor function would call <a 
href="clmse56.html#x71-110006r166">gensym</a> once to generate a
new symbol.
<div class=newer>
<!--l. 409--><p class="indent" >   X3J13 voted in October 1988 ⟨<b>?</b>⟩ to clarify that the default value in a
defstruct slot is not evaluated unless it is needed in the creation of a particular
structure instance. If it is never needed, there can be no type-mismatch
error, even if the type of the slot is speciﬁed, and no warning should be
issued.
<!--l. 417--><p class="indent" >   For example, in the following sequence only the last form is in error. <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defstruct person (name .007 :type string))
</td></tr></table>
<!--l. 419--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
                                                                          

                                                                          
<!--l. 420--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(make-person :name &#x0022;James&#x0022;)</td></tr></table>
<!--l. 421--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 422--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(make-person)     ;Error to give name the value <i>.007</i></td></tr></table>
<!--l. 424--><p class="indent" >
</div>
</div>
</div>
                                                                          

                                                                          
   <!--l. 428--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse106.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse104.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse104.html#tailclmse104.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse105.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch19.html#clmse105.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 428--><p class="indent" >   <a 
 id="tailclmse105.html"></a>  
</body></html> 
