<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Specialized Error-Signaling Forms and Macros</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-28 14:08:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 336--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse120.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse118.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse118.html#tailclmse118.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse119.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch24.html#clmse119.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">24.2   </span> <a 
href="clm.html#QQ2-148-324" id="x148-28400024.2">Specialized Error-Signaling Forms and Macros</a></h3>
<!--l. 339--><p class="noindent" >These facilities are designed to make it convenient for the user to insert error
checks into code.
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> check-type </b><a 
 id="dx148-284001"></a><a 
 id="x148-284002r719"></a> place typespec [string]
</td></tr></table>
<!--l. 344--><p class="indent" >
</div>
<!--l. 344--><p class="noindent" ><span class="paragraphHead"><a 
href="#x148-28500024.2" id="x148-28500024.2"></a></span>
   <div class=obsolete><a 
href="clmse148.html#x182-446002r919">check-type</a> signals an error if the contents of <i>place</i> are not of the desired type.
Upon continuing from this error, the user will be asked for a new value;
<a 
href="clmse148.html#x182-446002r919">check-type</a> will store the new value in <i>place</i> and start over, checking the type of
the new value and signaling another error if it is still not of the desired type.
Subforms of <i>place</i> may be evaluated multiple times because of the implicit loop
generated. <a 
href="clmse148.html#x182-446002r919">check-type</a> returns <a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 355--><p class="indent" >   The <i>place</i> must be a generalized variable reference acceptable to <a 
href="clmse36.html#x48-90002r64">setf</a>.
The <i>typespec</i> must be a type speciﬁer; it is not evaluated. The <i>string</i>
should be an English description of the type, starting with an indeﬁnite
article (“a” or “an”); it is evaluated. If <i>string</i> is not supplied, it is computed
automatically from <i>typespec</i>. (The optional <i>string</i> argument is allowed because
some applications of <a 
href="clmse148.html#x182-446002r919">check-type</a> may require a more speciﬁc description
of what is wanted than can be generated automatically from the type
speciﬁer.)
                                                                          

                                                                          
<!--l. 366--><p class="indent" >   The error message will mention place, its contents, and the desired
type.
</div>
<div class=newer>
<!--l. 370--><p class="indent" >   The precise format and content of the error message is implementation-dependent.
The example shown below is representative of current practice.
</div>
<div class=implementation>
<!--l. 376--><p class="noindent" ><b>Заметка для реализации:</b> An implementation may choose to generate
a somewhat diﬀerently worded error message if it recognizes that <i>place</i> is of
a particular form, such as one of the arguments to the function that called
<a 
href="clmse148.html#x182-446002r919">check-type</a>.
</div>
<div class=new>
<!--l. 386--><p class="indent" >   X3J13 voted in June 1988 <a 
 id="dx148-285001"></a>to adopt a proposal for a Common Lisp Condition
System. This proposal modiﬁes the deﬁnition of <a 
href="clmse148.html#x182-446002r919">check-type</a> to specify its
interaction with the condition system. See section <a 
href="clmse148.html#x182-44600029.4.2">29.4.2<!--tex4ht:ref: CONDITION-ASSERTIONS --></a>.
</div>
<div class=newer>
<!--l. 394--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx148-285002"></a>to clarify order of evaluation (see section <a 
href="clmse36.html#x48-900007.2">7.2<!--tex4ht:ref: SETF-SECTION --></a>).
</div>
<!--l. 398--><p class="indent" >   Examples: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq aardvarks &#x2019;(sam harry fred))
</td></tr></table>
<!--l. 400--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(check-type aardvarks (vector integer))</td></tr></table>
<!--l. 401--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Error: The value of AARDVARKS, (SAM HARRY FRED),</td></tr></table>
<!--l. 402--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       is not a vector of integers.</td></tr></table>
<!--l. 403--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 404--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq naards &#x2019;foo)</td></tr></table>
<!--l. 405--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(check-type naards (integer 0 *) &#x0022;a positive integer&#x0022;)</td></tr></table>
<!--l. 406--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">Error: The value of NAARDS, FOO, is not a positive integer.</td></tr></table>
<!--l. 408--><p class="indent" >
</div>
</div>
</div>
<div class=defmac>
                                                                          

                                                                          
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> assert </b><a 
 id="dx148-285003"></a><a 
 id="x148-285004r720"></a> test-form [( {place}* ) [string  {arg}* ]]
</td></tr></table>
<!--l. 415--><p class="indent" >
</div>
<!--l. 415--><p class="noindent" ><span class="paragraphHead"><a 
href="#x148-28600024.2" id="x148-28600024.2"></a></span>
   <div class=obsolete><a 
href="clmse148.html#x182-447002r920">assert</a> signals an error if the value of <i>test-form</i> is <a 
href="clmse31.html#x42-74002r18">nil</a>. Continuing from this
error will allow the user to alter the values of some variables, and <a 
href="clmse148.html#x182-447002r920">assert</a> will then
start over, evaluating <i>test-form</i> again. <a 
href="clmse148.html#x182-447002r920">assert</a> returns <a 
href="clmse31.html#x42-74002r18">nil</a>.
<i>
<!--l. 423--><p class="indent" >   test-form</i> is any form. Each <i>place</i> (there may be any number of them, or none)
must be a generalized-variable reference acceptable to <a 
href="clmse36.html#x48-90002r64">setf</a>. These should
be variables on which <i>test-form</i> depends, whose values may sensibly be
changed by the user in attempting to correct the error. Subforms of each
<i>place</i> are only evaluated if an error is signaled, and may be re-evaluated
if the error is re-signaled (after continuing without actually ﬁxing the
problem).
<!--l. 431--><p class="indent" >   The <i>string</i> is an error message string, and the <i>args</i> are additional arguments;
they are evaluated only if an error is signaled, and re-evaluated if the error is
signaled again. The function <a 
href="clmse111.html#x138-262003r666">format</a> is applied in the usual way to <i>string</i> and <i>args</i>
to produce the actual error message. If <i>string</i> is omitted (and therefore also the
<i>args</i>), a default error message is used.
</div>
<div class=implementation>
<!--l. 442--><p class="noindent" ><b>Заметка для реализации:</b> The debugger need not include the <i>test-form</i> in the error
message, and the <i>places</i> should not be included in the message, but they should be made
available for the user&#x2019;s perusal. If the user gives the “continue” command, he should be
presented with the opportunity to alter the values of any or all of the references.
The details of this depend on the implementation&#x2019;s style of user interface, of
course.
</div>
<div class=new>
                                                                          

                                                                          
<!--l. 455--><p class="indent" >   X3J13 voted in June 1988 <a 
 id="dx148-286001"></a>to adopt a proposal for a Common Lisp Condition
System. This proposal modiﬁes the deﬁnition of <a 
href="clmse148.html#x182-447002r920">assert</a> to specify its interaction
with the condition system. See section <a 
href="clmse148.html#x182-44600029.4.2">29.4.2<!--tex4ht:ref: CONDITION-ASSERTIONS --></a>.
</div>
<div class=newer>
<!--l. 463--><p class="indent" >   X3J13 voted in March 1988 <a 
 id="dx148-286002"></a>to clarify order of evaluation (see section <a 
href="clmse36.html#x48-900007.2">7.2<!--tex4ht:ref: SETF-SECTION --></a>).
</div>
<div class=newer>
<!--l. 468--><p class="indent" >   X3J13 voted in June 1989 <a 
 id="dx148-286003"></a>to extend the speciﬁcation of <a 
href="clmse148.html#x182-447002r920">assert</a> to allow a <i>place</i>
whose <a 
href="clmse36.html#x48-90002r64">setf</a> method has more than one store variable (see deﬁne-setf-method).
</div>
<!--l. 473--><p class="indent" >   Examples: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assert (valve-closed-p v1))
</td></tr></table>
<!--l. 475--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 476--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assert (valve-closed-p v1) ()</td></tr></table>
<!--l. 477--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x0022;Live steam is escaping!&#x0022;)</td></tr></table>
<!--l. 478--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 479--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assert (valve-closed-p v1)</td></tr></table>
<!--l. 480--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((valve-manual-control v1))</td></tr></table>
<!--l. 481--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x0022;Live steam is escaping!&#x0022;)</td></tr></table>
<!--l. 482--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 483--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; Note here that the user is invited to change BASE,</td></tr></table>
<!--l. 484--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; but not the bounds MINBASE and MAXBASE.</td></tr></table>
<!--l. 485--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">
</td></tr></table>
<!--l. 486--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assert (&#x003C;= minbase base maxbase)</td></tr></table>
<!--l. 487--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (base)</td></tr></table>
<!--l. 488--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x0022;Base ~D is not in the range ~D, ~D&#x0022;</td></tr></table>
<!--l. 489--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        base minbase maxbase)</td></tr></table>
<!--l. 490--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 491--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; Note here that it is probably not desirable to include the</td></tr></table>
<!--l. 492--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; entire contents of the two matrices in the error message.</td></tr></table>
<!--l. 493--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; It is reasonable to assume that the debugger will give</td></tr></table>
<!--l. 494--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;; the user access to the values of the places A and B.</td></tr></table>
<!--l. 495--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
                                                                          

                                                                          
<!--l. 496--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(assert (= (array-dimension a 1)</td></tr></table>
<!--l. 497--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (array-dimension b 0))</td></tr></table>
<!--l. 498--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (a b)</td></tr></table>
<!--l. 499--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x0022;Cannot multiply a ~D-by-~D matrix ~</td></tr></table>
<!--l. 500--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         and a ~D-by-~D matrix.&#x0022;</td></tr></table>
<!--l. 501--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (array-dimension a 0)</td></tr></table>
<!--l. 502--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (array-dimension a 1)</td></tr></table>
<!--l. 503--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (array-dimension b 0)</td></tr></table>
<!--l. 504--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (array-dimension b 1))</td></tr></table>
<!--l. 506--><p class="indent" >
</div>
</div>
</div>
                                                                          

                                                                          
   <!--l. 509--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse120.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse118.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse118.html#tailclmse118.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse119.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch24.html#clmse119.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 509--><p class="indent" >   <a 
 id="tailclmse119.html"></a>  
</body></html> 
