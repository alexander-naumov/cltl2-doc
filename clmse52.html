<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Declaration Speciﬁers Спецификаторы деклараций</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-09 12:51:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 668--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse53.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse51.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse51.html#tailclmse51.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse52.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#clmse52.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">9.2   </span> <a 
 id="x66-1720009.2"></a>Declaration Speciﬁers Спецификаторы деклараций</h3>
<!--l. 671--><p class="noindent" >Here is a list of valid declaration speciﬁers for use in <a 
href="clmse51.html#x65-167003r153">declare</a>. A construct is
said to be “aﬀected” by a declaration if it occurs within the scope of a
declaration.
<!--l. 675--><p class="indent" >   Ниже представлен список спецификаторов деклараций для использования
в <a 
href="clmse51.html#x65-167003r153">declare</a>.
<div class=flushdesc>
<!--l. 679--><p class="indent" >
      <ul><li><b>
special </b></li>(special <i>var1</i> <i>var2</i> ...) speciﬁes that all of the variables named are to be
      considered <i>special</i>. This speciﬁer aﬀects variable bindings but also
      pervasively aﬀects references. All variable bindings aﬀected are made to be
      dynamic bindings, and aﬀected variable references refer to the current
      dynamic binding rather than to the current local binding. For example: <div class=lisp>
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun hack (thing *mod*)       ;The binding of the parameter
</td></tr></table>
      <!--l. 689--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (special *mod*))     ; *mod* is visible to hack1,</td></tr></table>
      <!--l. 690--><p class="noindent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (hack1 (car thing)))          ; but not that of thing</td></tr></table>
      <!--l. 691--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 692--><p class="noindent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun hack1 (arg)</td></tr></table>
      <!--l. 693--><p class="noindent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (special *mod*))     ;Declare references to *mod*</td></tr></table>
      <!--l. 694--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                                ; within hack1 to be special</td></tr></table>
      <!--l. 695--><p class="noindent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (if (atom arg) *mod*</td></tr></table>
      <!--l. 696--><p class="noindent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (cons (hack1 (car arg)) (hack1 (cdr arg)))))</td></tr></table>
      <!--l. 698--><p class="noindent" >
                                                                          

                                                                          
</div>
</div>
      <!--l. 699--><p class="noindent" >Note that it is conventional, though not required, to give special variables
      names that begin and end with an asterisk.
      <!--l. 702--><p class="noindent" >A special declaration does <i>not</i> aﬀect bindings pervasively. Inner bindings
      of a variable implicitly shadow a special declaration and must be
      explicitly re-declared to be special. (However, a special proclamation
      <i>does</i> pervasively aﬀect bindings; this exception is made for reasons
      of convenience and compatibility with MacLisp.) For example: <div class=lisp>
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(proclaim &#x2019;(special x))     ;x is always special
</td></tr></table>
      <!--l. 711--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 712--><p class="noindent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun example (x y)</td></tr></table>
      <!--l. 713--><p class="noindent" >                                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (special y))</td></tr></table>
      <!--l. 714--><p class="noindent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (let ((y 3) (x (* x 2)))</td></tr></table>
      <!--l. 715--><p class="noindent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (print (+ y (locally (declare (special y)) y)))</td></tr></table>
      <!--l. 716--><p class="noindent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (let ((y 4)) (declare (special y)) (foo x))))</td></tr></table>
      <!--l. 718--><p class="noindent" >
</div>
</div>
      <!--l. 719--><p class="noindent" >In the contorted code above, the outermost and innermost bindings of y are
      special and therefore dynamically scoped, but the middle binding is lexically
      scoped. The two arguments to <a 
href="clmse111.html#x136-262002r626">+</a> are diﬀerent, one being the value, which is
      3, of the lexically bound variable y, and the other being the value of the
      special variable named y (a binding of which happens, coincidentally, to
      lexically surround it at an outer level). All the bindings of x and references
      to x are special, however, because of the proclamation that x is always
      special.
      <!--l. 729--><p class="noindent" >As a matter of style, use of special proclamations should be avoided. The
      <a 
href="clmse30.html#x40-71002r14">defvar</a> and <a 
href="clmse30.html#x40-71004r15">defparameter</a> macros are the conventional means for proclaiming
      special variables in a program.
                                                                          

                                                                          
      <li><b>
special </b></li>(special <i>var1</i> <i>var2</i> ...) указывает на то, что все указанные переменные
      должны рассматриваться как <i>специальные</i>. Данный спецификатор
      воздействует как на связывания переменных, так и на ссылки на
      эти переменные в коде. Все указанные связывания переменных
      будут динамическими, и ссылки будут осуществляться на эти
      связывания, а не на связывания определенные локально. Например: <div class=lisp>
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun hack (thing *mod*)       ;Связывание параметра
</td></tr></table>
      <!--l. 743--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (special *mod*))     ; *mod* доступно для hack1,</td></tr></table>
      <!--l. 744--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (hack1 (car thing)))          ; но связывание thing нет</td></tr></table>
      <!--l. 745--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 746--><p class="noindent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun hack1 (arg)</td></tr></table>
      <!--l. 747--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (special *mod*))     ;Декларируем что ссылка на *mod*</td></tr></table>
      <!--l. 748--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                                ; внутри hack1 будет специальной</td></tr></table>
      <!--l. 749--><p class="noindent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (if (atom arg) *mod*</td></tr></table>
      <!--l. 750--><p class="noindent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (cons (hack1 (car arg)) (hack1 (cdr arg)))))</td></tr></table>
      <!--l. 752--><p class="noindent" >
</div>
</div>
      <!--l. 753--><p class="noindent" >Следует отметить, что по правилам хорошего тона, имена специальных
      переменных окружаются звездочками.
      <!--l. 756--><p class="noindent" >Декларация special <i>не</i> охватывает все связывания. Внутренние
      связывания переменных неявно скрывают декларацию special и должны
      быть явно передекларированы в специальные. (Однако прокламация
      special имеет глобальный эффект. Это сделано для совместимости с
      MacLisp&#x2019;ом.) Например: <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(proclaim &#x2019;(special x))     ;x всегда специальная
</td></tr></table>
      <!--l. 763--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 764--><p class="noindent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun example (x y)</td></tr></table>
      <!--l. 765--><p class="noindent" >                                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (special y))</td></tr></table>
      <!--l. 766--><p class="noindent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (let ((y 3) (x (* x 2)))</td></tr></table>
      <!--l. 767--><p class="noindent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (print (+ y (locally (declare (special y)) y)))</td></tr></table>
      <!--l. 768--><p class="noindent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (let ((y 4)) (declare (special y)) (foo x))))</td></tr></table>
      <!--l. 770--><p class="noindent" >
</div>
</div>
      <!--l. 771--><p class="noindent" >В вышеприведенном коде, внешние и внутренние связывания
      переменной y являются специальными и, таким образом, действуют в
      динамической области видимости. Однако среднее связывание
      действует в лексической области видимости. Два аргумента <a 
href="clmse111.html#x136-262002r626">+</a>
      различаются, один содержит значение 3 лексически связанной
      переменной y, другой содержит значение специальной переменной
      y. Все связывания и переменной x и ссылки на нее является
      специальными, так как в коде использовалась прокламация
      special.
      <!--l. 780--><p class="noindent" >В целях стиля, необходимо избегать использование прокламаций special.
      Для объявления специальных переменных предназначены макросы
      <a 
href="clmse30.html#x40-71002r14">defvar</a> и <a 
href="clmse30.html#x40-71004r15">defparameter</a>.
      <li><b>
type </b></li>(type <i>type</i> <i>var1</i> <i>var2</i> ...) aﬀects only variable bindings and speciﬁes that the
      variables mentioned will take on values only of the speciﬁed type. In
      particular, values assigned to the variables by <a 
href="clmse35.html#x47-90002r61">setq</a>, as well as the initial
      values of the variables, must be of the speciﬁed type.
<div class=new>
      <!--l. 793--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx66-172001"></a>to alter the interpretation of type declarations.
      They are not to be construed to aﬀect “only variable bindings.” The
      new rule for a declaration of a variable to have a speciﬁed type is
      threefold:
                                                                          

                                                                          
           <ul class="itemize1">
           <li class="itemize">It is an error if, during the execution of any reference to that
           variable  within  the  scope  of  the  declaration,  the  value  of  the
           variable is not of the declared type.
           </li>
           <li class="itemize">It is an error if, during the execution of a <a 
href="clmse35.html#x47-90002r61">setq</a> of that variable
           within the scope of the declaration, the new value for the variable
           is not of the declared type.
           </li>
           <li class="itemize">It is an error if, at any moment that execution enters the scope
           of the declaration, the value of the variable is not of the declared
           type.</li></ul>
      <!--l. 810--><p class="noindent" >One may think of a type declaration (declare (type face bodoni)) as
      implicitly changing every reference to bodoni within the scope of the
      declaration to (the face bodoni); changing every expression <i>exp</i> assigned to
      bodoni within the scope of the declaration to (the face <i>exp</i>); and implicitly
      executing (the face bodoni) every time execution enters the scope of the
      declaration.
      <!--l. 817--><p class="noindent" >These new rules make type declarations much more useful. Under ﬁrst
      edition rules, a type declaration was useless if not associated with a variable
      binding; declarations such as in <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(locally
</td></tr></table>
      <!--l. 821--><p class="noindent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (type (byte 8) x y))</td></tr></table>
      <!--l. 822--><p class="noindent" >                                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (+ x y))</td></tr></table>
      <!--l. 824--><p class="noindent" >
</div>
</div>
      <!--l. 825--><p class="noindent" >at best had no eﬀect and at worst were erroneous, depending on
      one&#x2019;s interpretation of the ﬁrst edition. Under the interpretation
      approved by X3J13, such declarations have “the obvious natural
      interpretation.”
                                                                          

                                                                          
      <!--l. 829--><p class="noindent" >X3J13 noted that if nested type declarations refer to the same variable, then
      all of them have eﬀect; the value of the variable must be a member of the
      intersection of the declared types.
      <!--l. 833--><p class="noindent" >Nested type declarations could occur as a result of either macro expansion
      or carefully crafted code. There are three cases. First, the inner type might
      be a subtype of the outer one: <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun compare (apples oranges)
</td></tr></table>
      <!--l. 837--><p class="noindent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (type number apples oranges))</td></tr></table>
      <!--l. 838--><p class="noindent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (cond ((typep apples &#x2019;ﬁxnum)</td></tr></table>
      <!--l. 839--><p class="noindent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         ;; The programmer happens to know that, thanks to</td></tr></table>
      <!--l. 840--><p class="noindent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         ;; constraints imposed by the caller, if APPLES</td></tr></table>
      <!--l. 841--><p class="noindent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         ;; is a ﬁxnum, then ORANGES will be also, and</td></tr></table>
      <!--l. 842--><p class="noindent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         ;; therefore wishes to avoid the unnecessary cost</td></tr></table>
      <!--l. 843--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         ;; of checking ORANGES.  Nevertheless the compiler</td></tr></table>
      <!--l. 844--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         ;; should be informed to allow it to optimize code.</td></tr></table>
      <!--l. 845--><p class="noindent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (locally (declare (type ﬁxnum apples oranges)))</td></tr></table>
      <!--l. 846--><p class="noindent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                  ;; Maybe the compiler could have ﬁgured</td></tr></table>
      <!--l. 847--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                  ;; out by ﬂow analysis that APPLES must</td></tr></table>
      <!--l. 848--><p class="noindent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                  ;; be a ﬁxnum here, but it doesn&#x2019;t hurt</td></tr></table>
      <!--l. 849--><p class="noindent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                  ;; to say it explicitly.</td></tr></table>
      <!--l. 850--><p class="noindent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">           (&#x003C; apples oranges)))</td></tr></table>
      <!--l. 851--><p class="noindent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        ((or (complex apples)</td></tr></table>
      <!--l. 852--><p class="noindent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">             (complex oranges))</td></tr></table>
      <!--l. 853--><p class="noindent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (error &#x0022;Not yet implemented.  Sorry.&#x0022;))</td></tr></table>
      <!--l. 854--><p class="noindent" >                                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">        ...))</td></tr></table>
      <!--l. 856--><p class="noindent" >
                                                                          

                                                                          
</div>
</div>
      <!--l. 857--><p class="noindent" >This is the case most likely to arise in code written completely by
      hand.
      <!--l. 859--><p class="noindent" >Second, the outer type might be a subtype of the inner one. In this case the
      inner declaration has no additional practical eﬀect, but it is harmless. This
      is likely to occur if code declares a variable to be of a very speciﬁc type and
      then passes it to a macro that then declares it to be of a less speciﬁc
      type.
      <!--l. 866--><p class="noindent" >Third, the inner and outer declarations might be for types that overlap,
      neither being a subtype of the other. This is likely to occur only as a result
      of macro expansion. For example, user code might declare a variable to be of
      type integer, and a macro might later declare it to be of type (or
      ﬁxnum package); in this case a compiler could intersect the two
      types to determine that in this instance the variable may hold only
      ﬁxnums.
      <!--l. 874--><p class="noindent" >The reader should note that the following code fragment is, perhaps
      astonishingly, <i>not in error</i> under the interpretation approved by X3J13: <div class=lisp>
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(let ((james .007)
</td></tr></table>
      <!--l. 878--><p class="noindent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (maxwell 86))</td></tr></table>
      <!--l. 879--><p class="noindent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (ﬂet ((spy-swap ()</td></tr></table>
      <!--l. 880--><p class="noindent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">           (rotatef james maxwell)))</td></tr></table>
      <!--l. 881--><p class="noindent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (locally (declare (integer maxwell))</td></tr></table>
      <!--l. 882--><p class="noindent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (spy-swap)</td></tr></table>
      <!--l. 883--><p class="noindent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (view-movie &#x0022;The Sound of Music&#x0022;)</td></tr></table>
      <!--l. 884--><p class="noindent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (spy-swap)</td></tr></table>
      <!--l. 885--><p class="noindent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      maxwell)))</td></tr></table>
      <!--l. 886--><p class="noindent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  ⇒ 86  (after a couple of hours of Julie Andrews)</td></tr></table>
      <!--l. 888--><p class="noindent" >
                                                                          

                                                                          
</div>
</div>
      <!--l. 889--><p class="noindent" >The variable maxwell is declared to be an integer over the <i>scope</i> of the type
      declaration, not over its <i>extent</i>. Indeed maxwell takes on the non-integer
      value .007 while the Trapp family make their escape, but because no
      reference to maxwell within the scope of the declaration ever produces a
      non-integer value, the code is correct.
      <!--l. 897--><p class="noindent" >Now the assignment to maxwell during the ﬁrst call to spy-swap,
      and the reference to maxwell during the second call, <i>do</i> involve
      non-integer values, but they occur within the body of spy-swap,
      which is <i>not</i> in the scope of the type declaration! One could put the
      declaration in a diﬀerent place so as to include spy-swap in the scope: <div class=lisp>
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(let ((james .007)
</td></tr></table>
      <!--l. 904--><p class="noindent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (maxwell 86))</td></tr></table>
      <!--l. 905--><p class="noindent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (locally (declare (integer maxwell))</td></tr></table>
      <!--l. 906--><p class="noindent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (ﬂet ((spy-swap ()</td></tr></table>
      <!--l. 907--><p class="noindent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">             (rotatef james maxwell)))</td></tr></table>
      <!--l. 908--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (spy-swap)                                   ;Bug!</td></tr></table>
      <!--l. 909--><p class="noindent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (view-movie &#x0022;The Sound of Music&#x0022;)</td></tr></table>
      <!--l. 910--><p class="noindent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (spy-swap)</td></tr></table>
      <!--l. 911--><p class="noindent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      maxwell)))</td></tr></table>
      <!--l. 913--><p class="noindent" >
</div>
</div>
      <!--l. 914--><p class="noindent" >and then the code is indeed in error.
      </div>
<div class=new>
      <!--l. 918--><p class="noindent" >X3J13 also voted in January 1989 <a 
 id="dx66-172002"></a>to alter the meaning of the <a 
href="clmse35.html#x47-88006r54">function</a> type
      speciﬁer when used in type declarations (see section <a 
href="clmse22.html#x31-510004.5">4.5<!--tex4ht:ref: SPECIALIZED-TYPE-SPECIFIER-SECTION --></a>).
      </div>
                                                                          

                                                                          
      <li><b>
 <i>type</i> </b></li>(<i>type</i> <i>var1</i> <i>var2</i> ...) is an abbreviation for (type <i>type</i> <i>var1</i> <i>var2</i> ...), provided
      that <i>type</i> is one of the symbols appearing in table <a 
href="clmse19.html#x28-480011">4.1<!--tex4ht:ref: TYPE-SYMBOLS-TABLE --></a>.
<div class=new>
      <!--l. 934--><p class="noindent" >Observe that this covers the particularly common case of declaring numeric
      variables: <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(declare (single-ﬂoat mass dx dy dz)
</td></tr></table>
      <!--l. 937--><p class="noindent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (double-ﬂoat acceleration sum))</td></tr></table>
      <!--l. 939--><p class="noindent" >
</div>
</div>
      <!--l. 940--><p class="noindent" >In many implementations there is also some advantage to declaring variables
      to have certain specialized vector types such as base-string.
      </div>
      <li><b>
ftype </b></li>(ftype <i>type</i> <i>function-name-1</i> <i>function-name-2</i> ...) speciﬁes that the named
      functions will be of the functional type <i>type</i>, an example of which follows.
      For example: <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(declare (ftype (function (integer list) t) nth)
</td></tr></table>
      <!--l. 950--><p class="noindent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (ftype (function (number) ﬂoat) sin cos))</td></tr></table>
      <!--l. 952--><p class="noindent" >
</div>
</div>
      <!--l. 953--><p class="noindent" >Note that rules of lexical scoping are observed; if one of the functions
      mentioned has a lexically apparent local deﬁnition (as made by <a 
href="clmse39.html#x51-114006r93">ﬂet</a> or
      <a 
href="clmse39.html#x51-114008r94">labels</a>), then the declaration applies to that local deﬁnition and not to the
      global function deﬁnition.
                                                                          

                                                                          
<div class=newer>
      <!--l. 959--><p class="noindent" >X3J13 voted in March 1989 <a 
 id="dx66-172003"></a>to extend ftype declaration speciﬁers to accept
      any function-name (a symbol or a list whose <i>car</i> is <a 
href="clmse36.html#x48-93002r66">setf</a>—see section <a 
href="clmse35.html#x47-860007.1">7.1<!--tex4ht:ref: FUNCTION-NAME-SECTION --></a>).
      Thus one may write <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(declaim (ftype (function (list) t) (setf cadr)))
</td></tr></table>
      <!--l. 966--><p class="noindent" >
</div>
</div>
      <!--l. 967--><p class="noindent" >to indicate the type of the <a 
href="clmse36.html#x48-93002r66">setf</a> expansion function for <a 
href="clmse86.html#x106-224008r447">cadr</a>.
      </div>
<div class=new>
      <!--l. 971--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx66-172004"></a>to alter the meaning of the <a 
href="clmse35.html#x47-88006r54">function</a> type
      speciﬁer when used in ftype declarations (see section <a 
href="clmse22.html#x31-510004.5">4.5<!--tex4ht:ref: SPECIALIZED-TYPE-SPECIFIER-SECTION --></a>).
      </div></ul>
</div>
<div class=obsolete>
<div class=flushdesc>
<!--l. 981--><p class="indent" >
      <ul><li><b>
<a 
href="clmse35.html#x47-88006r54">function</a> </b></li>(function <i>name</i> <i>arglist</i> <i>result-type1</i> <i>result-type2</i> ...) is entirely equivalent
      to <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(ftype (function <i>arglist</i> <i>result-type1</i> <i>result-type2</i> ...) <i>name</i>)
</td></tr></table>
      <!--l. 986--><p class="noindent" >
</div>
</div>
      <!--l. 987--><p class="noindent" >but may be more convenient for some purposes. For example: <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(declare (function nth (integer list) t)
</td></tr></table>
      <!--l. 990--><p class="noindent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (function sin (number) ﬂoat)</td></tr></table>
      <!--l. 991--><p class="noindent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (function cos (number) ﬂoat))</td></tr></table>
      <!--l. 993--><p class="noindent" >
</div>
</div>
      <!--l. 994--><p class="noindent" >The syntax mildly resembles that of <a 
href="clmse30.html#x40-69002r13">defun</a>: a function-name, then an
      argument list, then a speciﬁcation of results.
      <!--l. 997--><p class="noindent" >Note that rules of lexical scoping are observed; if one of the functions
      mentioned has a lexically apparent local deﬁnition (as made by <a 
href="clmse39.html#x51-114006r93">ﬂet</a> or
      <a 
href="clmse39.html#x51-114008r94">labels</a>), then the declaration applies to that local deﬁnition and not to the
      global function deﬁnition.</ul>
</div>
</div>
<div class=new>
<!--l. 1005--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx66-172005"></a>to remove this interpretation of the <a 
href="clmse35.html#x47-88006r54">function</a>
declaration speciﬁer from the language. Instead, a declaration speciﬁer <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(function <i>var1</i> <i>var2</i> ...)
</td></tr></table>
<!--l. 1012--><p class="indent" >
</div>
</div>
<!--l. 1013--><p class="noindent" >is to be treated simply as an abbreviation for <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(type function <i>var1</i> <i>var2</i> ...)
</td></tr></table>
<!--l. 1016--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 1017--><p class="noindent" >just as for all other symbols appearing in table <a 
href="clmse19.html#x28-480011">4.1<!--tex4ht:ref: TYPE-SYMBOLS-TABLE --></a>.
<!--l. 1019--><p class="indent" >   X3J13 noted that although <a 
href="clmse35.html#x47-88006r54">function</a> appears in table <a 
href="clmse19.html#x28-480011">4.1<!--tex4ht:ref: TYPE-SYMBOLS-TABLE --></a>, the ﬁrst edition also
discussed it explicitly, with a diﬀerent meaning, without noting whether the
diﬀering interpretation was to replace or augment the interpretation regarding
table <a 
href="clmse19.html#x28-480011">4.1<!--tex4ht:ref: TYPE-SYMBOLS-TABLE --></a>. Unfortunately there is an ambiguous case: the declaration <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(declare (function foo nil string))
</td></tr></table>
<!--l. 1028--><p class="indent" >
</div>
</div>
<!--l. 1029--><p class="noindent" >can be construed to abbreviate either <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(declare (ftype (function () string) foo))
</td></tr></table>
<!--l. 1032--><p class="indent" >
</div>
</div>
<!--l. 1033--><p class="noindent" >or <div class=lisp>  <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(declare (type function foo nil string))
</td></tr></table>
<!--l. 1036--><p class="indent" >
</div>
</div>
<!--l. 1037--><p class="noindent" >The latter could perhaps be rejected on semantic grounds: it would be an error to
declare <a 
href="clmse31.html#x42-77002r19">nil</a>, a constant, to be of type <a 
href="clmse35.html#x47-88006r54">function</a>. In any case, X3J13 determined that
the ice was too thin here; the possibility of confusion is not worth the convenience
of an abbreviation for ftype declarations. The change also makes the language
more consistent.
</div>
                                                                          

                                                                          
<div class=flushdesc>
<!--l. 1046--><p class="indent" >
      <ul><li><b>
inline </b></li>(inline <i>function1</i> <i>function2</i> ...) speciﬁes that it is desirable for the
      compiler to open-code calls to the speciﬁed functions; that is, the code
      for a speciﬁed function should be integrated into the calling routine,
      appearing in-line in place of a procedure call. This may achieve extra
      speed  at  the  expense  of  debuggability  (calls  to  functions  compiled
      in-line cannot be traced, for example). This declaration is pervasive.
      Remember that a compiler is free to ignore this declaration.
      <!--l. 1058--><p class="noindent" >Note that rules of lexical scoping are observed; if one of the functions
      mentioned has a lexically apparent local deﬁnition (as established by
      <a 
href="clmse39.html#x51-114006r93">ﬂet</a> or <a 
href="clmse39.html#x51-114008r94">labels</a>), then the declaration applies to that local deﬁnition and
      not to the global function deﬁnition.
<div class=newer>
      <!--l. 1064--><p class="noindent" >X3J13 voted in October 1988 <a 
 id="dx66-172006"></a>to clarify that during compilation the inline
      declaration speciﬁer serves two distinct purposes: it indicates not only that
      aﬀected calls to the speciﬁed functions should be expanded in-line, but also
      that aﬀected deﬁnitions of the speciﬁed functions must be recorded for
      possible use in performing such expansions.
      <!--l. 1071--><p class="noindent" >Looking at it the other way, the compiler is not required to save function
      deﬁnitions against the possibility of future expansions unless the functions
      have already been proclaimed to be inline. If a function is proclaimed (or
      declaimed) inline before some call to that function but the current deﬁnition
      of that function was established before the proclamation was processed, it is
      implementation-dependent whether that call will be expanded in-line. (Of
      course, it is implementation-dependent anyway, because a compiler is always
      free to ignore inline declaration speciﬁers. However, the intent of the
      committee is clear: for best results, the user is advised to put any inline
      proclamation of a function before any deﬁnition of or call to that
      function.)
      <!--l. 1085--><p class="noindent" >Consider these examples: <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun huey (x) (+ x 100))         ;Compiler need not remember this
</td></tr></table>
                                                                          

                                                                          
      <!--l. 1087--><p class="noindent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(declaim (inline huey dewey))</td></tr></table>
      <!--l. 1088--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun dewey (y) (huey (sqrt y)))  ;Call to huey unlikely to be expanded</td></tr></table>
      <!--l. 1089--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun louie (z) (dewey (/ z)))    ;Call to dewey likely to be expanded</td></tr></table>
      <!--l. 1091--><p class="noindent" >
</div>
</div>
      <!--l. 1094--><p class="noindent" >X3J13 voted in March 1989 <a 
 id="dx66-172007"></a>to extend inline declaration speciﬁers to
      accept any function-name (a symbol or a list whose <i>car</i> is <a 
href="clmse36.html#x48-93002r66">setf</a>—see
      section <a 
href="clmse35.html#x47-860007.1">7.1<!--tex4ht:ref: FUNCTION-NAME-SECTION --></a>). Thus one may write (declare (inline (setf cadr))) to
      indicate that the <a 
href="clmse36.html#x48-93002r66">setf</a> expansion function for <a 
href="clmse86.html#x106-224008r447">cadr</a> should be compiled
      in-line.
      </div>
      <li><b>
notinline </b></li>(notinline <i>function1</i> <i>function2</i> ...) speciﬁes that it is <i>undesirable</i> to
      compile the speciﬁed functions in-line. This declaration is pervasive. A
      compiler is <i>not</i> free to ignore this declaration.
      <!--l. 1109--><p class="noindent" >Note that rules of lexical scoping are observed; if one of the functions
      mentioned has a lexically apparent local deﬁnition (as made by <a 
href="clmse39.html#x51-114006r93">ﬂet</a> or
      <a 
href="clmse39.html#x51-114008r94">labels</a>), then the declaration applies to that local deﬁnition and not to the
      global function deﬁnition.
<div class=newer>
      <!--l. 1115--><p class="noindent" >X3J13 voted in March 1989 <a 
 id="dx66-172008"></a>to extend notinline declaration speciﬁers to
      accept any function-name (a symbol or a list whose <i>car</i> is <a 
href="clmse36.html#x48-93002r66">setf</a>—see
      section <a 
href="clmse35.html#x47-860007.1">7.1<!--tex4ht:ref: FUNCTION-NAME-SECTION --></a>). Thus one may write (declare (notinline (setf cadr))) to indicate
      that the <a 
href="clmse36.html#x48-93002r66">setf</a> expansion function for <a 
href="clmse86.html#x106-224008r447">cadr</a> should not be compiled
      in-line.
      </div>
<div class=new>
      <!--l. 1125--><p class="noindent" >X3J13 voted in January 1989 <a 
 id="dx66-172009"></a>to clarify that the proper way to deﬁne a
      function gnards that is not inline by default, but for which a local
      declaration (declare (inline gnards)) has half a chance of actually compiling
      gnards in-line, is as follows: <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(declaim (inline gnards))
</td></tr></table>
      <!--l. 1132--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 1133--><p class="noindent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun gnards ...)</td></tr></table>
      <!--l. 1134--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 1135--><p class="noindent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(declaim (notinline gnards))</td></tr></table>
      <!--l. 1137--><p class="noindent" >
</div>
</div>
      <!--l. 1138--><p class="noindent" >The point is that the ﬁrst declamation informs the compiler that the
      deﬁnition of gnards may be needed later for in-line expansion, and the
      second declamation prevents any expansions unless and until it is
      overridden.
      <!--l. 1143--><p class="noindent" >While an implementation is never required to perform in-line expansion,
      many implementations that do support such expansion will not process
      inline requests successfully unless deﬁnitions are written with these
      proclamations in the manner shown above.
      </div>
      <li><b>
ignore </b></li>(ignore <i>var1</i> <i>var2</i> ... <i>varn</i>) aﬀects only variable bindings and speciﬁes that
      the bindings of the speciﬁed variables are never used. It is desirable for a
      compiler to issue a warning if a variable so declared is ever referred to or is
      also declared special, or if a variable is lexical, never referred to, and not
      declared to be ignored.
      <li><b>
ignore </b></li>(ignore <i>var1</i> <i>var2</i> ... <i>varn</i>) применяется только для связываний
      переменных и указывает на то, что связывания указанных переменных
      никогда не используются. Желательно, чтобы компилятор выдавал
      предупреждение, если переменная не используется и не задекларирована
      игнорироваться.
      <li><b>
optimize </b></li>(optimize (<i>quality1</i> <i>value1</i>) (<i>quality2</i> <i>value2</i>)...) advises the compiler
      that each <i>quality</i> should be given attention according to the speciﬁed
      corresponding <i>value</i>. A quality is a symbol; standard qualities include speed
                                                                          

                                                                          
      (of the object code), space (both code size and run-time space), safety
      (run-time error checking), and compilation-speed (speed of the compilation
      process). <div class=newer> X3J13 voted in October 1988 <a 
 id="dx66-172010"></a>to add the standard quality debug
      (ease of debugging).
      </div> Other qualities may be recognized by particular implementations. A <i>value</i>
      should be a non-negative integer, normally in the range 0 to 3. The value
      0 means that the quality is totally unimportant, and 3 that the
      quality is extremely important; 1 and 2 are intermediate values,
      with 1 the “normal” or “usual” value. One may abbreviate (<i>quality</i>
      3) to simply <i>quality</i>. This declaration is pervasive. For example: <div class=lisp>
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun often-used-subroutine (x y)
</td></tr></table>
      <!--l. 1185--><p class="noindent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (optimize (safety 2)))</td></tr></table>
      <!--l. 1186--><p class="noindent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (error-check x y)</td></tr></table>
      <!--l. 1187--><p class="noindent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (hairy-setup x)</td></tr></table>
      <!--l. 1188--><p class="noindent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (do ((i 0 (+ i 1))</td></tr></table>
      <!--l. 1189--><p class="noindent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">       (z x (cdr z)))</td></tr></table>
      <!--l. 1190--><p class="noindent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      ((null z) i)</td></tr></table>
      <!--l. 1191--><p class="noindent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    ;; This inner loop really needs to burn.</td></tr></table>
      <!--l. 1192--><p class="noindent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (declare (optimize speed))</td></tr></table>
      <!--l. 1193--><p class="noindent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (declare (ﬁxnum i))</td></tr></table>
      <!--l. 1194--><p class="noindent" >                                                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    )))</td></tr></table>
      <!--l. 1196--><p class="noindent" >
</div>
</div>
      <li><b>
optimize </b></li>(optimize (<i>quality1</i> <i>value1</i>) (<i>quality2</i> <i>value2</i>)...) рекомендует
      компилятору использовать указанные значения для свойств
      компилятора. Свойство компилятора является символом. Стандратные
                                                                          

                                                                          
      свойства включают speed (скомпилированного кода), space (и размер
      кода и run-time space), safety (проверка ошибок во время выполнения) и
      compilation-speed (скорость процесса компиляции).
      <!--l. 1207--><p class="noindent" >Также реализацией могут представляться другие свойства. <i>value</i>
      должно быть неотрицательным целым числом, обычно на интервале 0 и
      3. Значение 0 означает, что свойство полностью не важно, и 3, что
      свойство полностью важно. 1 и 2 промежуточные значение, 1
      «нормальный» или «обычный» уровень. Для наизначимого уровня
      существует аббревиатура, то есть (<i>quality</i> 3) можно записать, как просто
      <i>quality</i>. Например: <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun often-used-subroutine (x y)
</td></tr></table>
      <!--l. 1217--><p class="noindent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (optimize (safety 2)))</td></tr></table>
      <!--l. 1218--><p class="noindent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (error-check x y)</td></tr></table>
      <!--l. 1219--><p class="noindent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (hairy-setup x)</td></tr></table>
      <!--l. 1220--><p class="noindent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (do ((i 0 (+ i 1))</td></tr></table>
      <!--l. 1221--><p class="noindent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">       (z x (cdr z)))</td></tr></table>
      <!--l. 1222--><p class="noindent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      ((null z) i)</td></tr></table>
      <!--l. 1223--><p class="noindent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    ;; This inner loop really needs to burn.</td></tr></table>
      <!--l. 1224--><p class="noindent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (declare (optimize speed))</td></tr></table>
      <!--l. 1225--><p class="noindent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (declare (ﬁxnum i))</td></tr></table>
      <!--l. 1226--><p class="noindent" >                                                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    )))</td></tr></table>
      <!--l. 1228--><p class="noindent" >
</div>
</div>
      <li><b>
declaration </b></li>(declaration <i>name1</i> <i>name2</i> ...) advises the compiler that each <i>namej</i>
      is a valid but non-standard declaration name. The purpose of this is to tell
      one compiler not to issue warnings for declarations meant for another
      compiler or other program processor.
                                                                          

                                                                          
<div class=obsolete>
      <!--l. 1238--><p class="noindent" >This kind of declaration may be used only as a proclamation. For example: <div class=lisp>
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(proclaim &#x2019;(declaration author
</td></tr></table>
      <!--l. 1241--><p class="noindent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                        target-language</td></tr></table>
      <!--l. 1242--><p class="noindent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                        target-machine))</td></tr></table>
      <!--l. 1243--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 1244--><p class="noindent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(proclaim &#x2019;(target-language ada))</td></tr></table>
      <!--l. 1245--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 1246--><p class="noindent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(proclaim &#x2019;(target-machine IBM-650))</td></tr></table>
      <!--l. 1248--><p class="noindent" >
</div>
</div>
      <!--l. 1249--><p class="noindent" >
                                                                          

                                                                          
<div class=lisp>
<div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun strangep (x)
</td></tr></table>
      <!--l. 1251--><p class="noindent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (author &#x0022;Harry Tweeker&#x0022;))</td></tr></table>
      <!--l. 1252--><p class="noindent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (member x &#x2019;(strange weird odd peculiar)))</td></tr></table>
      <!--l. 1254--><p class="noindent" >
</div>
</div>
</div>
<div class=newer>
      <!--l. 1258--><p class="noindent" >X3J13 voted in June 1989 <a 
 id="dx66-172011"></a>to introduce the new macro <a 
href="clmse51.html#x65-170007r157">declaim</a>,
      which is guaranteed to be recognized appropriately by the compiler
      and is often more convenient than <a 
href="clmse51.html#x65-170002r156">proclaim</a> for establishing global
      declarations.
      <!--l. 1263--><p class="noindent" >The declaration declaration speciﬁer may be used with <a 
href="clmse51.html#x65-170007r157">declaim</a> as well as
      <a 
href="clmse51.html#x65-170002r156">proclaim</a>. The preceding examples would be better written using <a 
href="clmse51.html#x65-170007r157">declaim</a>, to
      ensure that the compiler will process them properly.
<div class=lisp>
<div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(declaim (declaration author
</td></tr></table>
      <!--l. 1268--><p class="noindent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                      target-language</td></tr></table>
      <!--l. 1269--><p class="noindent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                      target-machine))</td></tr></table>
      <!--l. 1270--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
      <!--l. 1271--><p class="noindent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(declaim (target-language ada)</td></tr></table>
      <!--l. 1272--><p class="noindent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (target-machine IBM-650))</td></tr></table>
      <!--l. 1273--><p class="noindent" >                                                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing"></td></tr></table>
                                                                          

                                                                          
      <!--l. 1274--><p class="noindent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun strangep (x)</td></tr></table>
      <!--l. 1275--><p class="noindent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (author &#x0022;Harry Tweeker&#x0022;))</td></tr></table>
      <!--l. 1276--><p class="noindent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (member x &#x2019;(strange weird odd peculiar)))</td></tr></table>
      <!--l. 1278--><p class="noindent" >
</div>
</div>
</div>
      <li><b>
declaration </b></li>(declaration <i>name1</i> <i>name2</i> ...) декларирует компилятору, что
      каждая <i>namej</i> является нестандартным именем декларации. Целью
      является сообщить одному компилятор не создавать предупреждений
      для деклараций, которые используются для другого компилятора.
      </ul>
</div>
<div class=newer>
<!--l. 1290--><p class="indent" >   X3J13 voted in March 1989 <a 
 id="dx66-172012"></a>to introduce a new declaration speciﬁer
dynamic-extent for variables, and voted in June 1989 <a 
 id="dx66-172013"></a>to extend it to handle
function-names as well. <div class=flushdesc>
      <ul><li><b>
dynamic-extent </b></li>
      <!--l. 1297--><p class="noindent" >(dynamic-extent <i>item1</i> <i>item2</i> ... <i>itemn</i>) declares that certain variables
      or function-names refer to data objects whose extents may be regarded
      as dynamic; that is, the declaration may be construed as a guarantee
      on the part of the programmer that the program will behave correctly
      even if the data objects have only dynamic extent rather than the usual
      indeﬁnite extent.
      <!--l. 1304--><p class="noindent" >Each  <i>item</i> may  be  either  a  variable  name  or  (function  <i>f </i>)  where  <i>f </i>
      is a function-name (see section <a 
href="clmse35.html#x47-860007.1">7.1<!--tex4ht:ref: FUNCTION-NAME-SECTION --></a>). (Of course, (function <i>f </i>) may be
      abbreviated in the usual way as #&#x2019;<i>f </i>.)
      <!--l. 1309--><p class="noindent" >It  is  permissible  for  an  implementation  simply  to  ignore  this
      declaration. In implementations that do not ignore it, the compiler
      (or interpreter) is free to make whatever optimizations are appropriate
      given   this   information;   the   most   common   optimization   is   to
                                                                          

                                                                          
      stack-allocate  the  initial  value  of  the  object.  The  data  types  that
      can be optimized in this manner may vary from implementation to
      implementation.
      <!--l. 1316--><p class="noindent" >The meaning of this declaration can be stated more precisely. We say
      that object <i>x</i> is an <i>otherwise inaccessible part</i> of <i>y</i> if and only if making
      <i>y</i> inaccessible would make <i>x</i> inaccessible. (Note that every object is
      an otherwise inaccessible part of itself.) Now suppose that construct
      <i>c</i> contains a dynamic-extent declaration for variable (or function) <i>v</i>
      (which need not be bound by <i>c</i>). Consider the values <i>w</i><sub>1</sub>,…,<i>w</i><sub>n</sub> taken on
      by <i>v</i> during the course of some execution of <i>c</i>. The declaration asserts
      that if some object <i>x</i> is an otherwise inaccessible part of <i>w</i><sub>j</sub> whenever <i>w</i><sub>j</sub>
      becomes the value of <i>v</i>, then just after execution of c terminates <i>x</i> will
      be either inaccessible or still an otherwise inaccessible part of the value
      of <i>v</i>. If this assertion is ever violated, the consequences are undeﬁned.
      <!--l. 1332--><p class="noindent" >In some implementations, it is possible to allocate data structures in
      a way that will make them easier to reclaim than by general-purpose
      garbage collection (for example, on the stack or in some temporary
      area).  The  dynamic-extent  declaration  is  designed  to  give  the
      implementation the information necessary to exploit such techniques.
      <!--l. 1339--><p class="noindent" >For example, in the code fragment <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(let ((x (list &#x2019;a1 &#x2019;b1 &#x2019;c1))
</td></tr></table>
      <!--l. 1341--><p class="noindent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">      (y (cons &#x2019;a2 (cons &#x2019;b2 (cons &#x2019;c2 &#x2019;d2)))))</td></tr></table>
      <!--l. 1342--><p class="noindent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (dynamic-extent x y))</td></tr></table>
      <!--l. 1343--><p class="noindent" >                                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  ...)</td></tr></table>
      <!--l. 1345--><p class="noindent" >
</div>
</div>
      <!--l. 1346--><p class="noindent" >it is not diﬃcult to prove that the otherwise inaccessible parts of x include
      the three conses constructed by <a 
href="clmse87.html#x107-225038r493">list</a>, and that the otherwise inaccessible
      parts of y include three other conses manufactured by the three calls to
      <a 
href="clmse86.html#x106-224062r474">cons</a>. Given the presence of the dynamic-extent declaration, a compiler
                                                                          

                                                                          
      would be justiﬁed in stack-allocating these six conses and reclaiming their
      storage on exit from the <a 
href="clmse39.html#x51-107003r84">let</a> form.
      <!--l. 1354--><p class="noindent" >Since stack allocation of the initial value entails knowing at the object&#x2019;s
      creation time that the object can be stack-allocated, it is not generally
      useful to declare dynamic-extent for variables that have no lexically
      apparent initial value. For example, <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun f ()
</td></tr></table>
      <!--l. 1359--><p class="noindent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (let ((x (list 1 2 3)))</td></tr></table>
      <!--l. 1360--><p class="noindent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (declare (dynamic-extent x))</td></tr></table>
      <!--l. 1361--><p class="noindent" >                                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    ...))</td></tr></table>
      <!--l. 1363--><p class="noindent" >
</div>
</div>
      <!--l. 1364--><p class="noindent" >would permit a compiler to stack-allocate the list in x. However, <div class=lisp>
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun g (x) (declare (dynamic-extent x)) ...)
</td></tr></table>
      <!--l. 1367--><p class="noindent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun f () (g (list 1 2 3)))</td></tr></table>
      <!--l. 1369--><p class="noindent" >
</div>
</div>
      <!--l. 1370--><p class="noindent" >could not typically permit a similar optimization in <a 
href="clmse151.html#x184-436004r906">f</a> because of the
      possibility of later redeﬁnition of g. Only an implementation careful enough
      to recompile <a 
href="clmse151.html#x184-436004r906">f</a> if the deﬁnition of g were to change incompatibly could
      stack-allocate the list argument to g in <a 
href="clmse151.html#x184-436004r906">f</a>.
      <!--l. 1376--><p class="noindent" >Other interesting cases are <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(declaim (inline g))
</td></tr></table>
      <!--l. 1378--><p class="noindent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun g (x) (declare (dynamic-extent x)) ...)</td></tr></table>
      <!--l. 1379--><p class="noindent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun f () (g (list 1 2 3)))</td></tr></table>
      <!--l. 1381--><p class="noindent" >
</div>
</div>
      <!--l. 1382--><p class="noindent" >and <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun f ()
</td></tr></table>
      <!--l. 1384--><p class="noindent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (ﬂet ((g (x) (declare (dynamic-extent x)) ...))</td></tr></table>
      <!--l. 1385--><p class="noindent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">    (g (list 1 2 3))))</td></tr></table>
      <!--l. 1387--><p class="noindent" >
</div>
</div>
      <!--l. 1388--><p class="noindent" >In each case some compilers might realize the optimization is possible and
      others might not.
      <!--l. 1391--><p class="noindent" >An interesting variant of this is the so-called <i>stack-allocated rest list</i>, which
      can be achieved (in implementations supporting the optimization) by <div class=lisp>
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(defun f (&#x0026;rest x)
</td></tr></table>
      <!--l. 1394--><p class="noindent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (dynamic-extent x))</td></tr></table>
      <!--l. 1395--><p class="noindent" >                                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  ...)</td></tr></table>
      <!--l. 1397--><p class="noindent" >
                                                                          

                                                                          
</div>
</div>
      <!--l. 1398--><p class="noindent" >Note here that although the initial value of x is not explicitly present,
      nevertheless in the usual implementation strategy the function <a 
href="clmse151.html#x184-436004r906">f</a> is
      responsible for assembling the list for x from the passed arguments, so the <a 
href="clmse151.html#x184-436004r906">f</a>
      function can be optimized by a compiler to construct a stack-allocated list
      instead of a heap-allocated list.
      <!--l. 1404--><p class="noindent" >Some Common Lisp functions take other functions as arguments; frequently
      the argument function is a so-called <i>downward funarg</i>, that is, a functional
      argument that is passed only downward and whose extent may therefore be
      dynamic. <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(ﬂet ((gd (x) (atan (sinh x))))
</td></tr></table>
      <!--l. 1408--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (dynamic-extent #&#x2019;gd))     ;<a 
href="clmse42.html#x54-137003r113">mapcar</a> won&#x2019;t hang on to gd</td></tr></table>
      <!--l. 1409--><p class="noindent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (mapcar #&#x2019;gd my-list-of-numbers))</td></tr></table>
      <!--l. 1411--><p class="noindent" >
</div>
</div>
      <!--l. 1414--><p class="noindent" >The following three examples are in error, since in each case the value of x is
      used outside of its extent. <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(length (let ((x (list 1 2 3)))
</td></tr></table>
      <!--l. 1418--><p class="noindent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">          (declare (dynamic-extent x))</td></tr></table>
      <!--l. 1419--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">          x))                                    ;Wrong</td></tr></table>
      <!--l. 1421--><p class="noindent" >
</div>
</div>
      <!--l. 1422--><p class="noindent" >The preceding code is obviously incorrect, because the cons cells making up
      the list in x might be deallocated (thanks to the declaration) before <a 
href="clmse81.html#x100-218008r402">length</a> is
      called. <div class=lisp> <div class=tabbing>
                                                                          

                                                                          
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(length (list (let ((x (list 1 2 3)))
</td></tr></table>
      <!--l. 1426--><p class="noindent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                (declare (dynamic-extent x))</td></tr></table>
      <!--l. 1427--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">                x)))                             ;Wrong</td></tr></table>
      <!--l. 1429--><p class="noindent" >
</div>
</div>
      <!--l. 1430--><p class="noindent" >In this second case it is less obvious that the code is incorrect, because one
      might argue that the cons cells making up the list in x have no eﬀect on the
      result to be computed by <a 
href="clmse81.html#x100-218008r402">length</a>. Nevertheless the code brieﬂy violates the
      assertion implied by the declaration and is therefore incorrect. (It is not
      diﬃcult to imagine a perfectly sensible implementation of a garbage
      collector that might become confused by a cons cell containing a dangling
      pointer to a list that was once stack-allocated but then deallocated.) <div class=lisp>
      <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(progn (let ((x (list 1 2 3)))
</td></tr></table>
      <!--l. 1440--><p class="noindent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         (declare (dynamic-extent x))</td></tr></table>
      <!--l. 1441--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">         x)                                      ;Wrong</td></tr></table>
      <!--l. 1442--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">       (print &#x0022;Six dollars is your change have a nice day NEXT!&#x0022;))</td></tr></table>
      <!--l. 1444--><p class="noindent" >
</div>
</div>
      <!--l. 1445--><p class="noindent" >In this third case it is even less obvious that the code is incorrect, because
      the value of x returned from the <a 
href="clmse39.html#x51-107003r84">let</a> construct is discarded right away by the
      <a 
href="clmse38.html#x50-102002r80">progn</a>. Indeed it is, but “right away” isn&#x2019;t fast enough. The code brieﬂy
      violates the assertion implied by the declaration and is therefore incorrect.
      (If the code is being interpreted, the interpreter might hang on to
      the value returned by the <a 
href="clmse39.html#x51-107003r84">let</a> for some time before it is eventually
      discarded.)
                                                                          

                                                                          
      <!--l. 1454--><p class="noindent" >Here is one last example, one that has little practical import but is
      theoretically quite instructive. <div class=lisp> <div class=tabbing>
      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">(dotimes (j 10)
</td></tr></table>
      <!--l. 1457--><p class="noindent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (declare (dynamic-extent j))</td></tr></table>
      <!--l. 1458--><p class="noindent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (setq foo 3)                     ;Correct</td></tr></table>
      <!--l. 1459--><p class="noindent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:44;" 
class="tabbing"></td><td  
class="tabbing">  (setq foo j))                    ;Erroneous—but why? (see text)</td></tr></table>
      <!--l. 1461--><p class="noindent" >
</div>
</div>
      <!--l. 1462--><p class="noindent" >Since j is an integer by the deﬁnition of <a 
href="clmse42.html#x54-135003r112">dotimes</a>, but <a 
href="clmse33.html#x44-81002r46">eq</a> and <a 
href="clmse33.html#x44-81005r47">eql</a> are not
      necessarily equivalent for integers, what are the otherwise inaccessible parts
      of j, which this declaration requires the body of the <a 
href="clmse42.html#x54-135003r112">dotimes</a> not to “save”? If
      the value of j is 3, and the body does (setq foo 3), is that an error?
      The answer is no, but the interesting thing is that it depends on
      the implementation-dependent behavior of <a 
href="clmse33.html#x44-81002r46">eq</a> on numbers. In an
      implementation where <a 
href="clmse33.html#x44-81002r46">eq</a> and <a 
href="clmse33.html#x44-81005r47">eql</a> are equivalent for 3, then 3 is not an
      otherwise inaccessible part because (eq j (+ 2 1)) is true, and therefore
      there is another way to access the object besides going through
      j. On the other hand, in an implementation where <a 
href="clmse33.html#x44-81002r46">eq</a> and <a 
href="clmse33.html#x44-81005r47">eql</a> are
      not equivalent for 3, then the particular 3 that is the value of j is
      an otherwise inaccessible part, but any other 3 is not. Thus (setq
      foo 3) is valid but (setq foo j) is erroneous. Since (setq foo j) is
      erroneous in some implementations, it is erroneous in all portable
      programs, but some other implementations may not be able to detect the
      error. (If this conclusion seems strange, it may help to replace 3
      everywhere in the preceding argument with some obvious bignum such as
      375374638837424898243 and to replace 10 with some even larger
      bignum.)
      <!--l. 1484--><p class="noindent" >The dynamic-extent declaration should be used with great care. It makes
      possible great performance improvements in some situations, but if the user
      misdeclares something and consequently the implementation returns a
      pointer into the stack (or stores it in the heap), an undeﬁned situation
                                                                          

                                                                          
      may result and the integrity of the Lisp storage mechanism may be
      compromised. Debugging these situations may be tricky. Users who have
      asked for this feature have indicated a willingness to deal with such
      problems; nevertheless, I do not encourage casual users to use this
      declaration.</ul>
</div>
</div>
<!--l. 1497--><p class="indent" >   An implementation is free to support other (implementation-dependent)
declaration speciﬁers as well. On the other hand, a Common Lisp compiler
is free to ignore entire classes of declaration speciﬁers (for example,
implementation-dependent declaration speciﬁers not supported by that compiler&#x2019;s
implementation), except for the declaration declaration speciﬁer. Compiler
implementors are encouraged, however, to program the compiler to issue by
default a warning if the compiler ﬁnds a declaration speciﬁer of a kind it never
uses. Such a warning is required in any case if a declaration speciﬁer is not
one of those deﬁned above and has not been declared in a declaration
declaration.
<!--l. 1511--><p class="indent" >   Реализация может поддерживать другие спецификаторы деклараций
(специфичные для нее). С другой стороны, компилятор Common Lisp может
игнорировать некорые виды деклараций (например, неподдерживаемые
компилятором), за исключением спецификатора декларации declaration.
Однако, разработчики компиляторов поощряются в том, чтобы выдавать
предупреждение об использовании неизвестных деклараций.
                                                                          

                                                                          
   <!--l. 1519--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse53.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse51.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse51.html#tailclmse51.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse52.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch9.html#clmse52.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 1519--><p class="indent" >   <a 
 id="tailclmse52.html"></a>  
</body></html> 
