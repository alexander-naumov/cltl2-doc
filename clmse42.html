<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Iteration Цикл</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-11 14:56:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 4167--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse43.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse41.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse41.html#tailclmse41.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse42.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch7.html#clmse42.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">7.8   </span> <a 
 id="x54-1280007.8"></a>Iteration Цикл</h3>
<a 
 id="dx54-128001"></a>
<!--l. 4170--><p class="noindent" >Common Lisp provides a number of iteration constructs. The <a 
href="#x54-129002r106">loop</a> construct
provides a trivial iteration facility; it is little more than a <a 
href="clmse38.html#x50-102002r80">progn</a> with a branch
from the bottom back to the top. The <a 
href="clmse142.html#x173-366002r881">do</a> and <a 
href="#x54-132005r110">do*</a> constructs provide a general
iteration facility for controlling the variation of several variables on each
cycle. For specialized iterations over the elements of a list or <i>n</i> consecutive
integers, <a 
href="#x54-134002r111">dolist</a> and <a 
href="#x54-135003r112">dotimes</a> are provided. The <a 
href="#x54-138002r119">tagbody</a> construct is the most
general, permitting arbitrary <a 
href="#x54-140002r122">go</a> statements within it. (The traditional <a 
href="#x54-139002r120">prog</a>
construct is a synthesis of <a 
href="#x54-138002r119">tagbody</a>, <a 
href="clmse41.html#x53-124002r103">block</a>, and <a 
href="clmse39.html#x51-107003r84">let</a>.) Most of the iteration
constructs permit statically deﬁned non-local exits (see <a 
href="clmse41.html#x53-125002r104">return-from</a> and
<a 
href="clmse142.html#x173-367002r883">return</a>).
<!--l. 4185--><p class="indent" >   Common Lisp предоставляет некоторые конструкции для циклов.
Конструкция <a 
href="#x54-129002r106">loop</a> предоставляет простую функциональность. Она слегка
больше, чем <a 
href="clmse38.html#x50-102002r80">progn</a>, и имеет ветку для переноса управления снизу вверх.
Конструкции <a 
href="clmse142.html#x173-366002r881">do</a> и <a 
href="#x54-132005r110">do*</a> предоставляют общую функциональность для
управления на каждом цикле изменением нескольких переменных. Для
специализированных циклов над элементами списка или <i>n</i> последовательных
чисел предоставляются формы <a 
href="#x54-134002r111">dolist</a> и <a 
href="#x54-135003r112">dotimes</a>. Конструкция <a 
href="#x54-138002r119">tagbody</a>
наиболее общая конструкция, которая внутри себя позволяет использование
выражений <a 
href="#x54-140002r122">go</a>. (Традиционная конструкция <a 
href="#x54-139002r120">prog</a> — это синтез <a 
href="#x54-138002r119">tagbody</a>, <a 
href="clmse41.html#x53-124002r103">block</a>
и <a 
href="clmse39.html#x51-107003r84">let</a>.) Большинство конструкций циклов позволяют определенные статически
нелокальные выходы (смотрите <a 
href="clmse41.html#x53-125002r104">return-from</a> и <a 
href="clmse142.html#x173-367002r883">return</a>).
<!--l. 4198--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.8.1   </span> <a 
 id="x54-1290007.8.1"></a>Indeﬁnite Iteration Бесконечный цикл</h4>
<!--l. 4200--><p class="noindent" >The <a 
href="#x54-129002r106">loop</a> construct is the simplest iteration facility. It controls no variables, and
simply executes its body repeatedly.
<!--l. 4203--><p class="indent" >   Конструкция <a 
href="#x54-129002r106">loop</a> является наипростейшей функциональностью для
                                                                          

                                                                          
итераций. Она не управляет переменными, и просто циклично выполняет
свое тело.
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> loop </b><a 
 id="dx54-129001"></a><a 
 id="x54-129002r106"></a> { form}*
</td></tr></table>
<!--l. 4208--><p class="indent" >
</div>
<!--l. 4208--><p class="noindent" ><span class="paragraphHead"><a 
 id="x54-1300007.8.1"></a></span>
   Each <i>form</i> is evaluated in turn from left to right. When the last <i>form</i> has been
evaluated, then the ﬁrst <i>form</i> is evaluated again, and so on, in a never-ending
cycle. The <a 
href="#x54-129002r106">loop</a> construct never returns a value. Its execution must be terminated
explicitly, using <a 
href="clmse142.html#x173-367002r883">return</a> or <a 
href="clmse45.html#x57-154003r134">throw</a>, for example.
<!--l. 4215--><p class="indent" >   <a 
href="#x54-129002r106">loop</a>, like most iteration constructs, establishes an implicit block named <a 
href="clmse31.html#x42-77002r19">nil</a>.
Thus <a 
href="clmse142.html#x173-367002r883">return</a> may be used to exit from a <a 
href="#x54-129002r106">loop</a> with speciﬁed results.
<!--l. 4219--><p class="indent" >   Каждая форма <i>form</i> выполняется последовательно слева направо. Когда
вычислена последняя форма, тогда вычисляется первая форма и так далее, в
безостановочном цикле. Конструкция <a 
href="#x54-129002r106">loop</a> никогда не возвращает значение.
Ее выполнение может быть остановлено явно, с помощью <a 
href="clmse142.html#x173-367002r883">return</a> или <a 
href="clmse45.html#x57-154003r134">throw</a>,
например.
<!--l. 4225--><p class="indent" >   <a 
href="#x54-129002r106">loop</a>, как и многие конструкции циклов, устанавливает неявный блок с
именем <a 
href="clmse31.html#x42-77002r19">nil</a>. Таким образом, <a 
href="clmse142.html#x173-367002r883">return</a> с заданным результатом может
использоваться для выхода и <a 
href="#x54-129002r106">loop</a>.
<!--l. 4230--><p class="indent" >   <a 
href="#x54-129002r106">loop</a> <div class=obsolete> A <a 
href="#x54-129002r106">loop</a> construct has this meaning only if every <i>form</i> is non-atomic (a
list). The case where some <i>form</i> is atomic is reserved for future extensions.
<div class=implementation>
<!--l. 4237--><p class="noindent" ><b>Implementation note:</b> There have been several proposals for a powerful iteration
mechanism to be called <a 
href="#x54-129002r106">loop</a>. One version is provided in Lisp Machine Lisp.
Implementors are encouraged to experiment with extensions to the <a 
href="#x54-129002r106">loop</a> syntax, but
users should be advised that in all likelihood some speciﬁc set of extensions to <a 
href="#x54-129002r106">loop</a> will
be adopted in a future revision of Common Lisp.
</div>
</div>
                                                                          

                                                                          
<div class=new>
<!--l. 4248--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx54-130001"></a>to include just such an extension of <a 
href="#x54-129002r106">loop</a>. See
chapter <a 
href="clmch26.html#x162-33400026">26<!--tex4ht:ref: LOOP --></a>.
</div>
</div>
<!--l. 4255--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.8.2   </span> <a 
 id="x54-1310007.8.2"></a>General Iteration Общие циклы</h4>
<!--l. 4257--><p class="noindent" >In contrast to <a 
href="#x54-129002r106">loop</a>, <a 
href="clmse142.html#x173-366002r881">do</a> and <a 
href="#x54-132005r110">do*</a> provide a powerful and general mechanism for
repetitively recalculating many variables.
<!--l. 4260--><p class="indent" >   В отличие от <a 
href="#x54-129002r106">loop</a>, <a 
href="clmse142.html#x173-366002r881">do</a> и <a 
href="#x54-132005r110">do*</a> предоставляют мощный механизм для
повторных вычислений большого количества переменных.
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> do </b><a 
 id="dx54-131001"></a><a 
 id="x54-131002r107"></a> ( {(var [init [step]])}* )
</td></tr></table>
<!--l. 4265--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(end-test  {result}* )</td></tr></table>
<!--l. 4266--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  {tag | statement}* </td></tr></table>
<!--l. 4266--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>[Macro]</i><b> do* </b><a 
 id="dx54-131003"></a><a 
 id="x54-131004r108"></a> ( {(var [init [step]])}* )</td></tr></table>
<!--l. 4268--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(end-test  {result}* )</td></tr></table>
<!--l. 4269--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  {tag | statement}* </td></tr></table>
<!--l. 4270--><p class="indent" >
</div>
<!--l. 4270--><p class="noindent" ><span class="paragraphHead"><a 
 id="x54-1320007.8.2"></a></span>
   The <a 
href="clmse142.html#x173-366002r881">do</a> special form provides a generalized iteration facility, with an arbitrary
number of “index variables.” These variables are bound within the iteration and
stepped in parallel in speciﬁed ways. They may be used both to generate
successive values of interest (such as successive integers) or to accumulate results.
When an end condition is met, the iteration terminates with a speciﬁed
value.
                                                                          

                                                                          
<!--l. 4278--><p class="indent" >   Специальная форма <a 
href="clmse142.html#x173-366002r881">do</a> представляет общую функциональность цикла, с
произвольным количеством «переменных-индексов». Эти переменные
связываются при входе в цикл и параллельно наращиваются, как это было
задано. Они могут быть использованы, как для генерации необходимых
последовательных чисел (как, например, последовательные целые
числа), так и для накопления результата. Когда условие окончания
цикла успешно выполнилось, тогда цикл завершается с заданным
значением.
<!--l. 4287--><p class="indent" >   In general, a <a 
href="clmse142.html#x173-366002r881">do</a> loop looks like this: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do ((<i>var1</i> <i>init1</i> <i>step1</i>)
</td></tr></table>
<!--l. 4289--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (<i>var2</i> <i>init2</i> <i>step2</i>)</td></tr></table>
<!--l. 4290--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     ...</td></tr></table>
<!--l. 4291--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (<i>varn</i> <i>initn</i> <i>stepn</i>))</td></tr></table>
<!--l. 4292--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (<i>end-test</i> . <i>result</i>)</td></tr></table>
<!--l. 4293--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   {<i><i>declaration</i></i>}* </td></tr></table>
<!--l. 4294--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  . <i>tagbody</i>)</td></tr></table>
<!--l. 4296--><p class="indent" >
</div>
</div>
<!--l. 4297--><p class="noindent" >A <a 
href="#x54-132005r110">do*</a> loop looks exactly the same except that the name <a 
href="clmse142.html#x173-366002r881">do</a> is replaced by
<a 
href="#x54-132005r110">do*</a>.
<!--l. 4300--><p class="indent" >   В общем виде <a 
href="clmse142.html#x173-366002r881">do</a> выглядит так: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do ((<i>var1</i> <i>init1</i> <i>step1</i>)
</td></tr></table>
<!--l. 4302--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (<i>var2</i> <i>init2</i> <i>step2</i>)</td></tr></table>
<!--l. 4303--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     ...</td></tr></table>
<!--l. 4304--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (<i>varn</i> <i>initn</i> <i>stepn</i>))</td></tr></table>
<!--l. 4305--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (<i>end-test</i> . <i>result</i>)</td></tr></table>
<!--l. 4306--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   {<i><i>declaration</i></i>}* </td></tr></table>
<!--l. 4307--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  . <i>tagbody</i>)</td></tr></table>
<!--l. 4309--><p class="indent" >
</div>
                                                                          

                                                                          
</div>
<!--l. 4310--><p class="noindent" >Цикл <a 
href="#x54-132005r110">do*</a> выглядит также, кроме изменения имени с <a 
href="clmse142.html#x173-366002r881">do</a> на <a 
href="#x54-132005r110">do*</a>.
<!--l. 4312--><p class="indent" >   The ﬁrst item in the form is a list of zero or more index-variable speciﬁers.
Each index-variable speciﬁer is a list of the name of a variable <i>var</i>, an initial value
<i>init</i>, and a stepping form <i>step</i>. If <i>init</i> is omitted, it defaults to <a 
href="clmse31.html#x42-77002r19">nil</a>. If <i>step</i> is
omitted, the <i>var</i> is not changed by the <a 
href="clmse142.html#x173-366002r881">do</a> construct between repetitions
(though code within the <a 
href="clmse142.html#x173-366002r881">do</a> is free to alter the value of the variable by using
<a 
href="clmse35.html#x47-90002r61">setq</a>).
<!--l. 4321--><p class="indent" >   Первый элемент формы является списком нуля и более спецификаторов
переменных-индексов. Каждый спецификатор является списком из имени
переменной <i>var</i>, первоначального значения <i>init</i>, и форма приращения <i>step</i>.
Если <i>init</i> опущен, используется первоначальное значение <a 
href="clmse31.html#x42-77002r19">nil</a>. Если <i>step</i>
опущен, <i>var</i> не изменяется на итерациях цикла (но может изменяться в теле
цикла с помощью формы <a 
href="clmse35.html#x47-90002r61">setq</a>).
<!--l. 4329--><p class="indent" >   An index-variable speciﬁer can also be just the name of a variable. In this case,
the variable has an initial value of <a 
href="clmse31.html#x42-77002r19">nil</a> and is not changed between repetitions. As
a matter of style, it is recommended that an unadorned variable name be written
only when that variable will be stored into (such as by <a 
href="clmse35.html#x47-90002r61">setq</a>) before its ﬁrst use. If
it is important that the initial value be <a 
href="clmse31.html#x42-77002r19">nil</a> rather than some undeﬁned value,
then it is clearer to write out (<i>varj</i> <a 
href="clmse31.html#x42-77002r19">nil</a>) if the initial value is intended to
mean “false,” or (<i>varj</i> &#x2019;()) if the initial value is intended to be an empty
list.
<!--l. 4342--><p class="indent" >   Спецификатор переменной-индекса может также быть просто именем
переменной. В этом случае переменная будет иметь первоначальное
значение <a 
href="clmse31.html#x42-77002r19">nil</a> и не будет изменяться при итерациях цикла. В целях
стиля, использовать просто имя переменной рекомендуется, только
если перед первым использованием для нее устанавливается значение
с помощью <a 
href="clmse35.html#x47-90002r61">setq</a>. Если необходимо чтобы первоначальное значение
было <a 
href="clmse31.html#x42-77002r19">nil</a>, а не неопределенное, то лучше указывать это явно, если
нужна ложь так: (<i>varj</i> <a 
href="clmse31.html#x42-77002r19">nil</a>) или если нужен пустой список так: (<i>varj</i>
&#x2019;()).
<div class=new>
<!--l. 4354--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx54-132001"></a>to regularize the binding formats for <a 
href="clmse142.html#x173-366002r881">do</a>, <a 
href="#x54-132005r110">do*</a>, <a 
href="clmse39.html#x51-107003r84">let</a>,
<a 
href="clmse39.html#x51-109003r86">let*</a>, <a 
href="#x54-139002r120">prog</a>, <a 
href="#x54-139004r121">prog*</a>, and <a 
href="clmse39.html#x51-111003r88">compiler-let</a>. In the case of <a 
href="clmse142.html#x173-366002r881">do</a> and <a 
href="#x54-132005r110">do*</a> the ﬁrst edition was
inconsistent; the formal syntax fails to reﬂect the fact that a simple variable name
may appear, as described in the preceding paragraph. The deﬁnitions should
read
<div class=defmac>
                                                                          

                                                                          
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> do </b><a 
 id="dx54-132002"></a><a 
 id="x54-132003r109"></a> ( {var | (var [init [step]])}* )
</td></tr></table>
<!--l. 4365--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(end-test  {result}* )</td></tr></table>
<!--l. 4366--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  {tag | statement}* </td></tr></table>
<!--l. 4366--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>[Macro]</i><b> do* </b><a 
 id="dx54-132004"></a><a 
 id="x54-132005r110"></a> ( {var | (var [init [step]])}* )</td></tr></table>
<!--l. 4368--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(end-test  {result}* )</td></tr></table>
<!--l. 4369--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  {tag | statement}* </td></tr></table>
<!--l. 4370--><p class="indent" >
</div>
<!--l. 4370--><p class="noindent" ><span class="paragraphHead"><a 
 id="x54-1330007.8.2"></a></span>
   for consistency with the reading of the ﬁrst edition and the X3J13
vote.
</div>
</div>
<!--l. 4375--><p class="indent" >   Before the ﬁrst iteration, all the <i>init</i> forms are evaluated, and each
<i>var</i> is bound to the value of its respective <i>init</i>. This is a binding, not an
assignment; when the loop terminates, the old values of those variables will
be restored. For <a 
href="clmse142.html#x173-366002r881">do</a>, <i>all</i> of the <i>init</i> forms are evaluated <i>before</i> any <i>var</i>
is bound; hence all the <i>init</i> forms may refer to the old bindings of all
the variables (that is, to the values visible before beginning execution of
the <a 
href="clmse142.html#x173-366002r881">do</a> construct). For <a 
href="#x54-132005r110">do*</a>, the ﬁrst <i>init</i> form is evaluated, then the ﬁrst
<i>var</i> is bound to that value, then the second <i>init</i> form is evaluated, then
the second <i>var</i> is bound, and so on; in general, the <i>initj</i> form can refer
to the <i>new</i> binding <i>vark</i> if k &#x003C; j, and otherwise to the <i>old</i> binding of
<i>vark</i>.
<!--l. 4391--><p class="indent" >   Перед первой итерацией вычисляются все формы <i>init</i>, и каждая
переменная <i>var</i> связывается с соотвествующим результатом вычислений <i>init</i>.
Используется именно связывание, а не присвоение. Когда цикл завершается,
старые значения этих переменных восстанавливаются. Для <a 
href="clmse142.html#x173-366002r881">do</a>, <i>все</i>
формы <i>init</i> вычисляется перед тем, как будут связаны переменные <i>var</i>.
Таким образом все формы могут ссылаться на старые связывания этих
                                                                          

                                                                          
переменных (то есть на значения, которые были видимы до начала
выполнения конструкции <a 
href="clmse142.html#x173-366002r881">do</a>). Для <a 
href="#x54-132005r110">do*</a> вычисляется первая форма <i>init</i>, затем
первая переменная связывается с результатом этих вычислений. Затем
вычисляется вторая форма <i>init</i> и вторая переменная <i>var</i> связывается с этим
значением, и так далее. В целом, форма <i>initj</i> может ссылаться на <i>новые</i>
связывания <i>vark</i>, если k &#x003C; j, иначе ссылка происходит на <i>старое</i>
связывание.
<!--l. 4407--><p class="indent" >   The second element of the loop is a list of an end-testing predicate form
<i>end-test</i> and zero or more <i>result</i> forms. This resembles a <a 
href="clmse40.html#x52-120002r100">cond</a> clause. At the
beginning of each iteration, after processing the variables, the <i>end-test</i> is
evaluated. If the result is <a 
href="clmse31.html#x42-77002r19">nil</a>, execution proceeds with the body of the <a 
href="clmse142.html#x173-366002r881">do</a> (or <a 
href="#x54-132005r110">do*</a>)
form. If the result is not <a 
href="clmse31.html#x42-77002r19">nil</a>, the <i>result</i> forms are evaluated in order as an implicit
<a 
href="clmse38.html#x50-102002r80">progn</a>, <a 
 id="dx54-133001"></a>and then <a 
href="clmse142.html#x173-366002r881">do</a> returns. <a 
href="clmse142.html#x173-366002r881">do</a> returns the results of evaluating the last <i>result</i>
form. If there are no <i>result</i> forms, the value of <a 
href="clmse142.html#x173-366002r881">do</a> is <a 
href="clmse31.html#x42-77002r19">nil</a>. Note that this is
not quite analogous to the treatment of clauses in a <a 
href="clmse40.html#x52-120002r100">cond</a> form, because
a <a 
href="clmse40.html#x52-120002r100">cond</a> clause with no <i>result</i> forms returns the (non-<a 
href="clmse31.html#x42-77002r19">nil</a>) result of the
test.
<!--l. 4424--><p class="indent" >   Второй элемент конструкции цикла это список из формы предиката-выхода
<i>end-test</i> и нуля и более форм результата <i>result</i>. Этот элемент напоминает
подвыражение <a 
href="clmse40.html#x52-120002r100">cond</a>. В начале каждой итерации, после обработки всех
переменных, вычисляется форма <i>end-test</i>. Если результат <a 
href="clmse31.html#x42-77002r19">nil</a>, выполняется
тело формы <a 
href="clmse142.html#x173-366002r881">do</a> (или <a 
href="#x54-132005r110">do*</a>). Если результат не <a 
href="clmse31.html#x42-77002r19">nil</a>, последовательно
вычисляются формы <i>result</i>, как неявный <a 
href="clmse38.html#x50-102002r80">progn</a>, и затем <a 
href="clmse142.html#x173-366002r881">do</a> возвращает
управление. <a 
href="clmse142.html#x173-366002r881">do</a> возвращает результаты вычисления последей формы <i>result</i>.
Если таких форм не быть, значением <a 
href="clmse142.html#x173-366002r881">do</a> становиться <a 
href="clmse31.html#x42-77002r19">nil</a>. Следует отметить,
что аналогия с подвыражениями <a 
href="clmse40.html#x52-120002r100">cond</a> не полная, так как <a 
href="clmse40.html#x52-120002r100">cond</a> в этом случае
возвращает результат формы условия.
<!--l. 4438--><p class="indent" >   At the beginning of each iteration other than the ﬁrst, the index variables are
updated as follows. All the <i>step</i> forms are evaluated, from left to right, and the
resulting values are assigned to the respective index variables. Any variable that
has no associated <i>step</i> form is not assigned to. For <a 
href="clmse142.html#x173-366002r881">do</a>, all the <i>step</i> forms are
evaluated before any variable is updated; the assignment of values to variables is
done in parallel, as if by <a 
href="clmse35.html#x47-91003r62">psetq</a>. Because <i>all</i> of the <i>step</i> forms are evaluated before
<i>any</i> of the variables are altered, a <i>step</i> form when evaluated always has access to
the <i>old</i> values of <i>all</i> the index variables, even if other <i>step</i> forms precede it. For
<a 
href="#x54-132005r110">do*</a>, the ﬁrst <i>step</i> form is evaluated, then the value is assigned to the ﬁrst
<i>var</i>, then the second <i>step</i> form is evaluated, then the value is assigned to
the second <i>var</i>, and so on; the assignment of values to variables is done
                                                                          

                                                                          
sequentially, as if by <a 
href="clmse35.html#x47-90002r61">setq</a>. For either <a 
href="clmse142.html#x173-366002r881">do</a> or <a 
href="#x54-132005r110">do*</a>, after the variables have been
updated, the <i>end-test</i> is evaluated as described above, and the iteration
continues.
<!--l. 4460--><p class="indent" >   Переменные-индексы изменяются в начале каждой непервой итерации
так, как написано далее. Слева направо вычисляются все формы <i>step</i>, и
затем результаты присваиваются переменным-индексам. Если такой формы
<i>step</i> для переменной указано не было, то переменная и не изменяется. Для
<a 
href="clmse142.html#x173-366002r881">do</a>, все формы <i>step</i> вычисляются перед там, как будут изменены переменные.
Присваивания переменным осуществляются параллельно, как в <a 
href="clmse35.html#x47-91003r62">psetq</a>. Так
как <i>все</i> формы <i>step</i> вычисляются перед тем, как будет изменена хоть одна
переменных, форма <i>step</i> при вычислении всегда ссылается на старые
значения <i>всех</i> переменных-индексов, даже если другие формы <i>step</i>
были выполнены. Для <a 
href="#x54-132005r110">do*</a>, вычисляется первая форма <i>step</i>, затем
полученное значение присваивается первой переменной-индексом, затем
вычисляется вторая форма <i>step</i>, и полученное значение присваивается второй
переменной, и так далее. Присваивание происходит последовательно, как в
<a 
href="clmse35.html#x47-90002r61">setq</a>. И для <a 
href="clmse142.html#x173-366002r881">do</a>, и для <a 
href="#x54-132005r110">do*</a> после того как переменные были изменены,
вычисляется <i>end-test</i> так, как уже было описано выше. Затем продолжаются
итерации.
<!--l. 4480--><p class="indent" >   If the <i>end-test</i> of a <a 
href="clmse142.html#x173-366002r881">do</a> form is <a 
href="clmse31.html#x42-77002r19">nil</a>, the test will never succeed. Therefore
this provides an idiom for “do forever”: the <i>body</i> of the <a 
href="clmse142.html#x173-366002r881">do</a> is executed
repeatedly, stepping variables as usual. (The <a 
href="#x54-129002r106">loop</a> construct performs a “do
forever” that steps no variables.) The inﬁnite loop can be terminated by the
use of <a 
href="clmse142.html#x173-367002r883">return</a>, <a 
href="clmse41.html#x53-125002r104">return-from</a>, <a 
href="#x54-140002r122">go</a> to an outer level, or <a 
href="clmse45.html#x57-154003r134">throw</a>. For example: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do ((j 0 (+ j 1)))
</td></tr></table>
<!--l. 4490--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (<a 
href="clmse31.html#x42-77002r19">nil</a>)                        ;Do forever</td></tr></table>
<!--l. 4491--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (format t &#x0022;~%Input ~D:&#x0022; j)</td></tr></table>
<!--l. 4492--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((item (read)))</td></tr></table>
<!--l. 4493--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (if (null item) (return)     ;Process items until <a 
href="clmse31.html#x42-77002r19">nil</a> seen</td></tr></table>
<!--l. 4494--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (format t &#x0022;~&#x0026;Output ~D: ~S&#x0022; j (process item)))))</td></tr></table>
<!--l. 4496--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
<!--l. 4498--><p class="indent" >   Если <i>end-test</i> формы <a 
href="clmse142.html#x173-366002r881">do</a> равен <a 
href="clmse31.html#x42-77002r19">nil</a>, тогда предикат всегда ложен. Таким
образом получается «бесконечный цикл»: тело <i>body</i> <a 
href="clmse142.html#x173-366002r881">do</a> выполняется
циклично, переменные-индексы изменяются как обычно. (Конструкция <a 
href="#x54-129002r106">loop</a>
также является «бесконечным циклом», только без переменных-индексов.)
Бесконечный цикл может быть остановлен использованием <a 
href="clmse142.html#x173-367002r883">return</a>,
<a 
href="clmse41.html#x53-125002r104">return-from</a>, <a 
href="#x54-140002r122">go</a> на более высокий уровень или <a 
href="clmse45.html#x57-154003r134">throw</a>. Например: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do ((j 0 (+ j 1)))
</td></tr></table>
<!--l. 4508--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (<a 
href="clmse31.html#x42-77002r19">nil</a>)                        ;Выполнять вечно</td></tr></table>
<!--l. 4509--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (format t &#x0022;~%Input ~D:&#x0022; j)</td></tr></table>
<!--l. 4510--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((item (read)))</td></tr></table>
<!--l. 4511--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (if (null item) (return)     ;Обрабатывать элементы пока не найден <a 
href="clmse31.html#x42-77002r19">nil</a></td></tr></table>
<!--l. 4512--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (format t &#x0022;~&#x0026;Output ~D: ~S&#x0022; j (process item)))))</td></tr></table>
<!--l. 4514--><p class="indent" >
</div>
</div>
<!--l. 4517--><p class="indent" >   The remainder of the <a 
href="clmse142.html#x173-366002r881">do</a> form constitutes an implicit <a 
href="#x54-138002r119">tagbody</a>. Tags may
appear within the body of a <a 
href="clmse142.html#x173-366002r881">do</a> loop for use by <a 
href="#x54-140002r122">go</a> statements appearing in the
body (but such <a 
href="#x54-140002r122">go</a> statements may not appear in the variable speciﬁers, the
<i>end-test</i>, or the <i>result</i> forms). When the end of a <a 
href="clmse142.html#x173-366002r881">do</a> body is reached,
the next iteration cycle (beginning with the evaluation of <i>step</i> forms)
occurs.
<!--l. 4525--><p class="indent" >   Оставшаяся часть <a 
href="clmse142.html#x173-366002r881">do</a> оборачивается в неявный <a 
href="#x54-138002r119">tagbody</a>. Тэги могут
использоваться внутри тела цикла <a 
href="clmse142.html#x173-366002r881">do</a> для того, чтобы затем использовать
выражения <a 
href="#x54-140002r122">go</a>. На такие выражения <a 
href="#x54-140002r122">go</a> не могут использоваться в
спецификаторах переменных-индексов, в предикате <i>end-test</i> и в формах
результата <i>result</i>. Когда управление достигает конца тела цикла <a 
href="clmse142.html#x173-366002r881">do</a>,
наступает следующая цикл итерации (начинающийся с вычисления форм
<i>step</i>).
<!--l. 4533--><p class="indent" >   An implicit <a 
href="clmse41.html#x53-124002r103">block</a> named <a 
href="clmse31.html#x42-77002r19">nil</a> surrounds the entire <a 
href="clmse142.html#x173-366002r881">do</a> form. A <a 
href="clmse142.html#x173-367002r883">return</a> statement
may be used at any point to exit the loop immediately.
<!--l. 4537--><p class="indent" >   Неявный <a 
href="clmse41.html#x53-124002r103">block</a> с именем <a 
href="clmse31.html#x42-77002r19">nil</a> окружает всю форму <a 
href="clmse142.html#x173-366002r881">do</a>. Выражение <a 
href="clmse142.html#x173-367002r883">return</a>
может использоваться в любом месте для немедленного выхода из
цикла.
<!--l. 4541--><p class="indent" >   <a 
href="clmse51.html#x65-167003r153">declare</a> forms may appear at the beginning of a <a 
href="clmse142.html#x173-366002r881">do</a> body. They apply to code
                                                                          

                                                                          
in the <a 
href="clmse142.html#x173-366002r881">do</a> body, to the bindings of the <a 
href="clmse142.html#x173-366002r881">do</a> variables, to the <i>init</i> forms, to the <i>step</i>
forms, to the <i>end-test</i>, and to the <i>result</i> forms.
<!--l. 4546--><p class="indent" >   Формы <a 
href="clmse51.html#x65-167003r153">declare</a> могут использоваться в начала тела <a 
href="clmse142.html#x173-366002r881">do</a>. Они применяются
к коду внутри тела <a 
href="clmse142.html#x173-366002r881">do</a>, для связываний переменных-индексов, для форм
<i>init</i>, для форм <i>step</i>, для предиката <i>end-test</i> и для форм результата
<i>result</i>.
<div class=incompatibility>
<!--l. 4552--><p class="noindent" ><b>Compatibility note:</b> “Old-style” MacLisp <a 
href="clmse142.html#x173-366002r881">do</a> loops, that is, those of the form (do <i>var</i>
<i>init</i> <i>step</i> <i>end-test</i> . <i>body</i>), are not supported in Common Lisp. Such old-style loops are
considered obsolete and in any case are easily converted to a new-style <a 
href="clmse142.html#x173-366002r881">do</a> with the
insertion of three pairs of parentheses. In practice the compiler can catch nearly
all instances of old-style <a 
href="clmse142.html#x173-366002r881">do</a> loops because they will not have a legal format
anyway.
</div>
<!--l. 4564--><p class="indent" >   Here are some examples of the use of <a 
href="clmse142.html#x173-366002r881">do</a>: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do ((i 0 (+ i 1))     ;Sets every null element of a-vector to zero
</td></tr></table>
<!--l. 4566--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (n (length a-vector)))</td></tr></table>
<!--l. 4567--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ((= i n))</td></tr></table>
<!--l. 4568--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (when (null (aref a-vector i))</td></tr></table>
<!--l. 4569--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (setf (aref a-vector i) 0)))</td></tr></table>
<!--l. 4571--><p class="indent" >
</div>
</div>
<!--l. 4572--><p class="noindent" >The construction <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do ((x e (cdr x))
</td></tr></table>
<!--l. 4574--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (oldx x x))</td></tr></table>
<!--l. 4575--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ((null x))</td></tr></table>
<!--l. 4576--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>body</i>)</td></tr></table>
<!--l. 4578--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
<!--l. 4579--><p class="noindent" >exploits parallel assignment to index variables. On the ﬁrst iteration, the value of
oldx is whatever value x had before the <a 
href="clmse142.html#x173-366002r881">do</a> was entered. On succeeding iterations,
oldx contains the value that x had on the previous iteration.
<!--l. 4584--><p class="indent" >   Вот парочка примеров использования <a 
href="clmse142.html#x173-366002r881">do</a>: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do ((i 0 (+ i 1))     ;Sets every null element of a-vector to zero
</td></tr></table>
<!--l. 4586--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (n (length a-vector)))</td></tr></table>
<!--l. 4587--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ((= i n))</td></tr></table>
<!--l. 4588--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (when (null (aref a-vector i))</td></tr></table>
<!--l. 4589--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (setf (aref a-vector i) 0)))</td></tr></table>
<!--l. 4591--><p class="indent" >
</div>
</div>
<!--l. 4592--><p class="noindent" >Конструкция <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do ((x e (cdr x))
</td></tr></table>
<!--l. 4594--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (oldx x x))</td></tr></table>
<!--l. 4595--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ((null x))</td></tr></table>
<!--l. 4596--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>body</i>)</td></tr></table>
<!--l. 4598--><p class="indent" >
</div>
</div>
<!--l. 4599--><p class="noindent" >использует параллельное присваивание пременным-индексам. На первой
итерации значение oldx получает значение x, которое было до входа в цикл.
При выходе из цикла oldx будет содержать значение x, которое было на
предыдущей итерации.
<!--l. 4604--><p class="indent" >   Very often an iterative algorithm can be most clearly expressed entirely in the
<i>step</i> forms of a <a 
href="clmse142.html#x173-366002r881">do</a>, and the <i>body</i> is empty. For example, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do ((x foo (cdr x))
</td></tr></table>
<!--l. 4608--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (y bar (cdr y))</td></tr></table>
<!--l. 4609--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (z &#x2019;() (cons (f (car x) (car y)) z)))</td></tr></table>
                                                                          

                                                                          
<!--l. 4610--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ((or (null x) (null y))</td></tr></table>
<!--l. 4611--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (nreverse z)))</td></tr></table>
<!--l. 4613--><p class="indent" >
</div>
</div>
<!--l. 4614--><p class="noindent" >does the same thing as (mapcar #&#x2019;f foo bar). Note that the <i>step</i> computation for z
exploits the fact that variables are stepped in parallel. Also, the body of
the loop is empty. Finally, the use of <a 
href="clmse81.html#x100-218012r404">nreverse</a> to put an accumulated <a 
href="clmse142.html#x173-366002r881">do</a>
loop result into the correct order is a standard idiom. Another example: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun list-reverse (list)
</td></tr></table>
<!--l. 4620--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (do ((x list (cdr x))</td></tr></table>
<!--l. 4621--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (y &#x2019;() (cons (car x) y)))</td></tr></table>
<!--l. 4622--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           ((endp x) y)))</td></tr></table>
<!--l. 4624--><p class="indent" >
</div>
</div>
<!--l. 4625--><p class="noindent" >Note the use of <a 
href="clmse87.html#x107-225002r476">endp</a> rather than <a 
href="clmse32.html#x43-80002r23">null</a> or <a 
href="clmse32.html#x43-80006r25">atom</a> to test for the end of a list; this may
result in more robust code.
<!--l. 4628--><p class="indent" >   Очень часто алгоритм цикла может быть по большей части выражен в
формах <i>step</i> и тело при этом останется пустым. Например, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(do ((x foo (cdr x))
</td></tr></table>
<!--l. 4632--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (y bar (cdr y))</td></tr></table>
<!--l. 4633--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (z &#x2019;() (cons (f (car x) (car y)) z)))</td></tr></table>
<!--l. 4634--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ((or (null x) (null y))</td></tr></table>
<!--l. 4635--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (nreverse z)))</td></tr></table>
<!--l. 4637--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
<!--l. 4638--><p class="noindent" >делает то же, что и (mapcar #&#x2019;f foo bar). Следует отметить, что вычисление <i>step</i>
для z использует тот факт, что переменные переприсваиваются параллельно.
Тело функции пустое. Наконец, использование <a 
href="clmse81.html#x100-218012r404">nreverse</a> в форме возврата
результата, переставляет элементы списка для правильного результата.
Другой пример: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun list-reverse (list)
</td></tr></table>
<!--l. 4645--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (do ((x list (cdr x))</td></tr></table>
<!--l. 4646--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (y &#x2019;() (cons (car x) y)))</td></tr></table>
<!--l. 4647--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           ((endp x) y)))</td></tr></table>
<!--l. 4649--><p class="indent" >
</div>
</div>
<!--l. 4650--><p class="noindent" >Нужно заметить, что используется <a 
href="clmse87.html#x107-225002r476">endp</a> вместо <a 
href="clmse32.html#x43-80002r23">null</a> или <a 
href="clmse32.html#x43-80006r25">atom</a> для проверки
конца списка. Это дает более надежный алгоритм.
<!--l. 4653--><p class="indent" >   As an example of nested loops, suppose that env holds a list of conses. The <i>car</i>
of each cons is a list of symbols, and the <i>cdr</i> of each cons is a list of equal
length containing corresponding values. Such a data structure is similar
to an association list but is divided into “frames”; the overall structure
resembles a rib cage. A lookup function on such a data structure might be <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun ribcage-lookup (sym ribcage)
</td></tr></table>
<!--l. 4661--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (do ((r ribcage (cdr r)))</td></tr></table>
<!--l. 4662--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           ((null r) <a 
href="clmse31.html#x42-77002r19">nil</a>)</td></tr></table>
<!--l. 4663--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (do ((s (caar r) (cdr s))</td></tr></table>
<!--l. 4664--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (v (cdar r) (cdr v)))</td></tr></table>
<!--l. 4665--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             ((null s))</td></tr></table>
<!--l. 4666--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (when (eq (car s) sym)</td></tr></table>
<!--l. 4667--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (return-from ribcage-lookup (car v))))))</td></tr></table>
<!--l. 4669--><p class="indent" >
</div>
</div>
                                                                          

                                                                          
<!--l. 4670--><p class="noindent" >(Notice the use of indentation in the above example to set oﬀ the bodies of the <a 
href="clmse142.html#x173-366002r881">do</a>
loops.)
<!--l. 4673--><p class="indent" >   В качестве примера вложенных циклов, предположим что env содержит
список cons-ячеек. <i>car</i> элемента каждой cons-ячейки является списком
символов, и <i>cdr</i> каждой cons-ячейки является списком такой же длины с
соответствующими значениями. Такая структура данных похожа на
ассоциативный список, но она в отличие разделена на «кадры». Общая
структура напоминает грудную клетку. Функция поиска по такой структуре
может быть такой: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun ribcage-lookup (sym ribcage)
</td></tr></table>
<!--l. 4682--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (do ((r ribcage (cdr r)))</td></tr></table>
<!--l. 4683--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           ((null r) <a 
href="clmse31.html#x42-77002r19">nil</a>)</td></tr></table>
<!--l. 4684--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (do ((s (caar r) (cdr s))</td></tr></table>
<!--l. 4685--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              (v (cdar r) (cdr v)))</td></tr></table>
<!--l. 4686--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             ((null s))</td></tr></table>
<!--l. 4687--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (when (eq (car s) sym)</td></tr></table>
<!--l. 4688--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (return-from ribcage-lookup (car v))))))</td></tr></table>
<!--l. 4690--><p class="indent" >
</div>
</div>
<!--l. 4691--><p class="noindent" >(Примечание, использование отступов в примере выше выделяет тела
вложенных циклов.)
<!--l. 4694--><p class="indent" >   A <a 
href="clmse142.html#x173-366002r881">do</a> loop may be explained in terms of the more primitive constructs <a 
href="clmse41.html#x53-124002r103">block</a>,
<a 
href="clmse142.html#x173-367002r883">return</a>, <a 
href="clmse39.html#x51-107003r84">let</a>, <a 
href="#x54-129002r106">loop</a>, <a 
href="#x54-138002r119">tagbody</a>, and <a 
href="clmse35.html#x47-91003r62">psetq</a> as follows: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(block nil
</td></tr></table>
<!--l. 4698--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((<i>var1</i> <i>init1</i>)</td></tr></table>
<!--l. 4699--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (<i>var2</i> <i>init2</i>)</td></tr></table>
<!--l. 4700--><p class="indent" >                                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ...</td></tr></table>
<!--l. 4701--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (<i>varn</i> <i>initn</i>))</td></tr></table>
<!--l. 4702--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     {<i><i>declaration</i></i>}* </td></tr></table>
<!--l. 4703--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (loop (when <i>end-test</i> (return (progn . <i>result</i>)))</td></tr></table>
<!--l. 4704--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (tagbody . <i>tagbody</i>)</td></tr></table>
                                                                          

                                                                          
<!--l. 4705--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (psetq <i>var1</i> <i>step1</i></td></tr></table>
<!--l. 4706--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 <i>var2</i> <i>step2</i></td></tr></table>
<!--l. 4707--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 ...</td></tr></table>
<!--l. 4708--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 <i>varn</i> <i>stepn</i>))))</td></tr></table>
<!--l. 4710--><p class="indent" >
</div>
</div>
<!--l. 4711--><p class="noindent" ><a 
href="#x54-132005r110">do*</a> is exactly like <a 
href="clmse142.html#x173-366002r881">do</a> except that the bindings and steppings of the variables are
performed sequentially rather than in parallel. It is as if, in the above explanation,
<a 
href="clmse39.html#x51-107003r84">let</a> were replaced by <a 
href="clmse39.html#x51-109003r86">let*</a> and <a 
href="clmse35.html#x47-91003r62">psetq</a> were replaced by <a 
href="clmse35.html#x47-90002r61">setq</a>.
<!--l. 4717--><p class="indent" >   Цикл <a 
href="clmse142.html#x173-366002r881">do</a> может быть выражен в терминах более примитивных
конструкций <a 
href="clmse41.html#x53-124002r103">block</a>, <a 
href="clmse142.html#x173-367002r883">return</a>, <a 
href="clmse39.html#x51-107003r84">let</a>, <a 
href="#x54-129002r106">loop</a>, <a 
href="#x54-138002r119">tagbody</a> и <a 
href="clmse35.html#x47-91003r62">psetq</a>: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(block nil
</td></tr></table>
<!--l. 4721--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((<i>var1</i> <i>init1</i>)</td></tr></table>
<!--l. 4722--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (<i>var2</i> <i>init2</i>)</td></tr></table>
<!--l. 4723--><p class="indent" >                                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ...</td></tr></table>
<!--l. 4724--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (<i>varn</i> <i>initn</i>))</td></tr></table>
<!--l. 4725--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     {<i><i>declaration</i></i>}* </td></tr></table>
<!--l. 4726--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (loop (when <i>end-test</i> (return (progn . <i>result</i>)))</td></tr></table>
<!--l. 4727--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (tagbody . <i>tagbody</i>)</td></tr></table>
<!--l. 4728--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (psetq <i>var1</i> <i>step1</i></td></tr></table>
<!--l. 4729--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 <i>var2</i> <i>step2</i></td></tr></table>
<!--l. 4730--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 ...</td></tr></table>
<!--l. 4731--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 <i>varn</i> <i>stepn</i>))))</td></tr></table>
<!--l. 4733--><p class="indent" >
</div>
</div>
<!--l. 4734--><p class="noindent" ><a 
href="#x54-132005r110">do*</a> почти то же, что и <a 
href="clmse142.html#x173-366002r881">do</a> за исключением того, что связывание и наращение
переменных происходит последовательно, а не праллельно. Таким образом, в
вышеприведенной конструкции, <a 
href="clmse39.html#x51-107003r84">let</a> будет заменен на <a 
href="clmse39.html#x51-109003r86">let*</a> и <a 
href="clmse35.html#x47-91003r62">psetq</a> на
<a 
href="clmse35.html#x47-90002r61">setq</a>.
</div>
                                                                          

                                                                          
<!--l. 4741--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.8.3   </span> <a 
 id="x54-1340007.8.3"></a>Simple Iteration Constructs Простые конструкции циклов</h4>
<!--l. 4743--><p class="noindent" >The constructs <a 
href="#x54-134002r111">dolist</a> and <a 
href="#x54-135003r112">dotimes</a> execute a body of code once for each value
taken by a single variable. They are expressible in terms of <a 
href="clmse142.html#x173-366002r881">do</a>, but capture very
common patterns of use.
<!--l. 4747--><p class="indent" >   Конструкции <a 
href="#x54-134002r111">dolist</a> и <a 
href="#x54-135003r112">dotimes</a> для каждого значения взятого для одной
переменной выполняют тело один раз. Они хоть и выражаются в терминах
<a 
href="clmse142.html#x173-366002r881">do</a>, но захватывют очень простые шаблоны использования.
<!--l. 4751--><p class="indent" >   Both <a 
href="#x54-134002r111">dolist</a> and <a 
href="#x54-135003r112">dotimes</a> perform a body of statements repeatedly. On each
iteration a speciﬁed variable is bound to an element of interest that the
body may examine. <a 
href="#x54-134002r111">dolist</a> examines successive elements of a list, and
<a 
href="#x54-135003r112">dotimes</a> examines integers from 0 to n − 1 for some speciﬁed positive integer
<i>n</i>.
<!--l. 4758--><p class="indent" >   И <a 
href="#x54-134002r111">dolist</a> и <a 
href="#x54-135003r112">dotimes</a> циклично выполняют тело. На каждой итерации заданная
переменная связывается с элементом, которая затем может использоваться в
теле. <a 
href="#x54-134002r111">dolist</a> использует элементы списка, и <a 
href="#x54-135003r112">dotimes</a> использует целые
числа от 0 по n − 1, при некотором указанном положительном целом
<i>n</i>.
<!--l. 4763--><p class="indent" >   The value of any of these constructs may be speciﬁed by an optional result
form, which if omitted defaults to the value <a 
href="clmse31.html#x42-77002r19">nil</a>.
<!--l. 4766--><p class="indent" >   Результат двух этих конструкций может быть указан с помощью
опициональной формы результата. Если эта форма опущена результат равен
<a 
href="clmse31.html#x42-77002r19">nil</a>.
<!--l. 4769--><p class="indent" >   The <a 
href="clmse142.html#x173-367002r883">return</a> statement may be used to return immediately from a <a 
href="#x54-134002r111">dolist</a> or
<a 
href="#x54-135003r112">dotimes</a> form, discarding any following iterations that might have been performed;
in eﬀect, a <a 
href="clmse41.html#x53-124002r103">block</a> named <a 
href="clmse31.html#x42-77002r19">nil</a> surrounds the construct. The body of the loop
is implicitly a <a 
href="#x54-138002r119">tagbody</a> construct; it may contain tags to serve as the
targets of <a 
href="#x54-140002r122">go</a> statements. Declarations may appear before the body of the
loop.
<!--l. 4778--><p class="indent" >   Выражение <a 
href="clmse142.html#x173-367002r883">return</a> может быть использовано для немедленного возврата
из форм <a 
href="#x54-134002r111">dolist</a> или <a 
href="#x54-135003r112">dotimes</a>, игнорируя все оставшиеся итерации, которые
должны были быть выполнены. <a 
href="clmse41.html#x53-124002r103">block</a> с именем <a 
href="clmse31.html#x42-77002r19">nil</a> окружает конструкцию.
Тело цикла неявно обернуто конструкцией <a 
href="#x54-138002r119">tagbody</a>. Таким образом тело
может содержать теги и <a 
href="#x54-140002r122">go</a> выражения. Декларации могут быть указаны
перед телом цикла.
<div class=defmac>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> dolist </b><a 
 id="dx54-134001"></a><a 
 id="x54-134002r111"></a> (var listform [resultform])
</td></tr></table>
<!--l. 4787--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  {tag | statement}* </td></tr></table>
<!--l. 4788--><p class="indent" >
</div>
<!--l. 4788--><p class="noindent" ><span class="paragraphHead"><a 
 id="x54-1350007.8.3"></a></span>
   <a 
href="#x54-134002r111">dolist</a> provides straightforward iteration over the elements of a list.
First <a 
href="#x54-134002r111">dolist</a> evaluates the form <i>listform</i>, which should produce a list. It
then executes the body once for each element in the list, in order, with
the variable <i>var</i> bound to the element. Then <i>resultform</i> (a single form,
<i>not</i> an implicit <a 
href="clmse38.html#x50-102002r80">progn</a>) is evaluated, and the result is the value of the
<a 
href="#x54-134002r111">dolist</a> form. (When the <i>resultform</i> is evaluated, the control variable <i>var</i> is
still bound and has the value <a 
href="clmse31.html#x42-77002r19">nil</a>.) If <i>resultform</i> is omitted, the result is
<a 
href="clmse31.html#x42-77002r19">nil</a>.
<!--l. 4801--><p class="indent" >   <a 
href="#x54-134002r111">dolist</a> предоставляет прямой цикл по списку элементов. Сначала <a 
href="#x54-134002r111">dolist</a>
вычисляет форму <i>listform</i>, которая должна вернуть список. Затем для
каждого элемента вычисляется тело цикла. Данный элемент на каждой
итерации связывается с переменной <i>var</i>. Затем вычисляется <i>resultform</i> (одна
форма, <i>не</i> неявный <a 
href="clmse38.html#x50-102002r80">progn</a>). (Когда вычисляется <i>resultform</i>, переменная <i>var</i>
все еще связана, и имеет значение <a 
href="clmse31.html#x42-77002r19">nil</a>.) Если <i>resultform</i> опущена, то результат
равен <a 
href="clmse31.html#x42-77002r19">nil</a>.
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(dolist (x &#x2019;(a b c d)) (prin1 x) (princ &#x0022; &#x0022;))  ⇒ <a 
href="clmse31.html#x42-77002r19">nil</a>
</td></tr></table>
<!--l. 4812--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   after printing “a b c d ” (note the trailing space)</td></tr></table>
<!--l. 4814--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(dolist (x &#x2019;(a b c d)) (prin1 x) (princ &#x0022; &#x0022;))  ⇒ <a 
href="clmse31.html#x42-77002r19">nil</a>
</td></tr></table>
<!--l. 4817--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   вывод «a b c d » (в том числе пробел в конце)</td></tr></table>
<!--l. 4819--><p class="indent" >
</div>
</div>
<!--l. 4821--><p class="indent" >   An explicit <a 
href="clmse142.html#x173-367002r883">return</a> statement may be used to terminate the loop and return a
speciﬁed value.
<!--l. 4824--><p class="indent" >   Для завершения цикла и возврата заданного значения может использоваться
явное выражение <a 
href="clmse142.html#x173-367002r883">return</a>.
<div class=new>
<!--l. 4828--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx54-135001"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-1420007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> dotimes </b><a 
 id="dx54-135002"></a><a 
 id="x54-135003r112"></a> (var countform [resultform])
</td></tr></table>
<!--l. 4836--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  {tag | statement}* </td></tr></table>
<!--l. 4837--><p class="indent" >
</div>
<!--l. 4837--><p class="noindent" ><span class="paragraphHead"><a 
 id="x54-1360007.8.3"></a></span>
   <a 
href="#x54-135003r112">dotimes</a> provides straightforward iteration over a sequence of integers. The
expression (dotimes (<i>var</i> <i>countform</i> <i>resultform</i>) . <i>progbody</i>) evaluates the form
<i>countform</i>, which should produce an integer. It then performs <i>progbody</i>
once for each integer from zero (inclusive) to <i>count</i> (exclusive), in order,
with the variable <i>var</i> bound to the integer; if the value of <i>countform</i>
is zero or negative, then the <i>progbody</i> is performed zero times. Finally,
<i>resultform</i> (a single form, <i>not</i> an implicit <a 
href="clmse38.html#x50-102002r80">progn</a>) is evaluated, and the
                                                                          

                                                                          
result is the value of the <a 
href="#x54-135003r112">dotimes</a> form. (When the <i>resultform</i> is evaluated,
the control variable <i>var</i> is still bound and has as its value the number
of times the body was executed.) If <i>resultform</i> is omitted, the result is
<a 
href="clmse31.html#x42-77002r19">nil</a>.
<!--l. 4853--><p class="indent" >   <a 
href="#x54-135003r112">dotimes</a> предоставляет цикл над последовательностью целых чисел.
Выражение (dotimes (<i>var</i> <i>countform</i> <i>resultform</i>) . <i>progbody</i>) вычисляет
форму <i>countform</i>, которая должна вернуть целое число. Затем тело
цикла выполняется по порядку один раз для каждого число от нуля
(включительно) до <i>count</i> (исключая). При этом переменная <i>var</i> связывается
с текущим целым числом. Если значение <i>countform</i> отрицательно
или равно нулю, тогда <i>progbody</i> не выполняется ни разу. Наконец
выполняется <i>resultform</i> (одна форма, <i>не</i> неявный <a 
href="clmse38.html#x50-102002r80">progn</a>), и полученный
результат возвращается из формы цикла. (Когда <i>result</i> вычисляется,
переменная-индекс <i>var</i> все еще связана и содержит количество выполненных
итераций.) Если <i>resultform</i> опущена, то результат равен <a 
href="clmse31.html#x42-77002r19">nil</a>.
<!--l. 4867--><p class="indent" >   An explicit <a 
href="clmse142.html#x173-367002r883">return</a> statement may be used to terminate the loop and return a
speciﬁed value.
<!--l. 4870--><p class="indent" >   Для завершения цикла и возврата заданного значения может использоваться
выражение <a 
href="clmse142.html#x173-367002r883">return</a>.
<!--l. 4873--><p class="indent" >   Here is an example of the use of <a 
href="#x54-135003r112">dotimes</a> in processing strings: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; True if the speciﬁed subsequence of the string is a
</td></tr></table>
<!--l. 4875--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; palindrome (reads the same forwards and backwards).</td></tr></table>
<!--l. 4876--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4877--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun palindromep (string &#x0026;optional</td></tr></table>
<!--l. 4878--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                           (start 0)</td></tr></table>
<!--l. 4879--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                           (end (length string)))</td></tr></table>
<!--l. 4880--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (dotimes (k (ﬂoor (- end start) 2) <a 
href="clmse31.html#x42-77004r20">t</a>)</td></tr></table>
<!--l. 4881--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (unless (char-equal (char string (+ start k))</td></tr></table>
<!--l. 4882--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        (char string (- end k 1)))</td></tr></table>
<!--l. 4883--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (return <a 
href="clmse31.html#x42-77002r19">nil</a>))))</td></tr></table>
<!--l. 4884--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4885--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep &#x0022;Able was I ere I saw Elba&#x0022;)  ⇒ <a 
href="clmse31.html#x42-77004r20">t</a></td></tr></table>
<!--l. 4886--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4887--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep &#x0022;A man, a plan, a canal–Panama!&#x0022;)  ⇒ <a 
href="clmse31.html#x42-77002r19">nil</a></td></tr></table>
<!--l. 4888--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
                                                                          

                                                                          
<!--l. 4889--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-if-not #&#x2019;alpha-char-p     ;Remove punctuation</td></tr></table>
<!--l. 4890--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               &#x0022;A man, a plan, a canal–Panama!&#x0022;)</td></tr></table>
<!--l. 4891--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ &#x0022;AmanaplanacanalPanama&#x0022;</td></tr></table>
<!--l. 4892--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4893--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep</td></tr></table>
<!--l. 4894--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> (remove-if-not #&#x2019;alpha-char-p</td></tr></table>
<!--l. 4895--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                &#x0022;A man, a plan, a canal–Panama!&#x0022;))  ⇒ <a 
href="clmse31.html#x42-77004r20">t</a></td></tr></table>
<!--l. 4896--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4897--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep</td></tr></table>
<!--l. 4898--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> (remove-if-not</td></tr></table>
<!--l. 4899--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   #&#x2019;alpha-char-p</td></tr></table>
<!--l. 4900--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   &#x0022;Unremarkable was I ere I saw Elba Kramer, nu?&#x0022;))  ⇒ <a 
href="clmse31.html#x42-77004r20">t</a></td></tr></table>
<!--l. 4901--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4902--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep</td></tr></table>
<!--l. 4903--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> (remove-if-not</td></tr></table>
<!--l. 4904--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   #&#x2019;alpha-char-p</td></tr></table>
<!--l. 4905--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   &#x0022;A man, a plan, a cat, a ham, a yak,</td></tr></table>
<!--l. 4906--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   a yam, a hat, a canal–Panama!&#x0022;))  ⇒ <a 
href="clmse31.html#x42-77004r20">t</a></td></tr></table>
<!--l. 4908--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep</td></tr></table>
<!--l. 4909--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> (remove-if-not</td></tr></table>
<!--l. 4910--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   #&#x2019;alpha-char-p</td></tr></table>
<!--l. 4911--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   &#x0022;Ja-da, ja-da, ja-da ja-da jing jing jing&#x0022;))  ⇒ <a 
href="clmse31.html#x42-77002r19">nil</a></td></tr></table>
<!--l. 4913--><p class="indent" >
</div>
</div>
<!--l. 4915--><p class="indent" >   Пример использования <a 
href="#x54-135003r112">dotimes</a> для обработки строк: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; True if the speciﬁed subsequence of the string is a
</td></tr></table>
<!--l. 4917--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; palindrome (reads the same forwards and backwards).</td></tr></table>
<!--l. 4918--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4919--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun palindromep (string &#x0026;optional</td></tr></table>
<!--l. 4920--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                           (start 0)</td></tr></table>
<!--l. 4921--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                           (end (length string)))</td></tr></table>
<!--l. 4922--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (dotimes (k (ﬂoor (- end start) 2) <a 
href="clmse31.html#x42-77004r20">t</a>)</td></tr></table>
<!--l. 4923--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (unless (char-equal (char string (+ start k))</td></tr></table>
                                                                          

                                                                          
<!--l. 4924--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        (char string (- end k 1)))</td></tr></table>
<!--l. 4925--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (return <a 
href="clmse31.html#x42-77002r19">nil</a>))))</td></tr></table>
<!--l. 4926--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4927--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep &#x0022;Able was I ere I saw Elba&#x0022;)  ⇒ <a 
href="clmse31.html#x42-77004r20">t</a></td></tr></table>
<!--l. 4928--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4929--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep &#x0022;A man, a plan, a canal–Panama!&#x0022;)  ⇒ <a 
href="clmse31.html#x42-77002r19">nil</a></td></tr></table>
<!--l. 4930--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4931--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(remove-if-not #&#x2019;alpha-char-p     ;Удалить знаки препинания</td></tr></table>
<!--l. 4932--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               &#x0022;A man, a plan, a canal–Panama!&#x0022;)</td></tr></table>
<!--l. 4933--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ &#x0022;AmanaplanacanalPanama&#x0022;</td></tr></table>
<!--l. 4934--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4935--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep</td></tr></table>
<!--l. 4936--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> (remove-if-not #&#x2019;alpha-char-p</td></tr></table>
<!--l. 4937--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                &#x0022;A man, a plan, a canal–Panama!&#x0022;))  ⇒ <a 
href="clmse31.html#x42-77004r20">t</a></td></tr></table>
<!--l. 4938--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4939--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep</td></tr></table>
<!--l. 4940--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> (remove-if-not</td></tr></table>
<!--l. 4941--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   #&#x2019;alpha-char-p</td></tr></table>
<!--l. 4942--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   &#x0022;Unremarkable was I ere I saw Elba Kramer, nu?&#x0022;))  ⇒ <a 
href="clmse31.html#x42-77004r20">t</a></td></tr></table>
<!--l. 4943--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4944--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep</td></tr></table>
<!--l. 4945--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> (remove-if-not</td></tr></table>
<!--l. 4946--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   #&#x2019;alpha-char-p</td></tr></table>
<!--l. 4947--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   &#x0022;A man, a plan, a cat, a ham, a yak,</td></tr></table>
<!--l. 4948--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   a yam, a hat, a canal–Panama!&#x0022;))  ⇒ <a 
href="clmse31.html#x42-77004r20">t</a></td></tr></table>
<!--l. 4950--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(palindromep</td></tr></table>
<!--l. 4951--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> (remove-if-not</td></tr></table>
<!--l. 4952--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   #&#x2019;alpha-char-p</td></tr></table>
<!--l. 4953--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   &#x0022;Ja-da, ja-da, ja-da ja-da jing jing jing&#x0022;))  ⇒ <a 
href="clmse31.html#x42-77002r19">nil</a></td></tr></table>
<!--l. 4955--><p class="indent" >
</div>
</div>
<!--l. 4957--><p class="indent" >   Altering the value of <i>var</i> in the body of the loop (by using <a 
href="clmse35.html#x47-90002r61">setq</a>, for example)
will have unpredictable, possibly implementation-dependent results. A Common
Lisp compiler may choose to issue a warning if such a variable appears in a
<a 
href="clmse35.html#x47-90002r61">setq</a>.
                                                                          

                                                                          
<!--l. 4962--><p class="indent" >   Изменение значения переменной <i>var</i> в теле цикла (с помощью <a 
href="clmse35.html#x47-90002r61">setq</a>
например) будет иметь непредсказуемые последствия, возможно зависящие
от реализации. Компилятор Common Lisp&#x2019;а может вывести предупреждение о
том, что переменная-индекс используется в <a 
href="clmse35.html#x47-90002r61">setq</a>.
<div class=incompatibility>
<!--l. 4968--><p class="noindent" ><b>Compatibility note:</b> The <a 
href="#x54-135003r112">dotimes</a> construct is the closest thing in Common Lisp to the
Interlisp rptq construct.
</div>
</div>
<!--l. 4975--><p class="indent" >   See also <a 
href="clmse63.html#x79-189005r198">do-symbols</a>, <a 
href="clmse63.html#x79-190005r199">do-external-symbols</a>, and <a 
href="clmse63.html#x79-191005r200">do-all-symbols</a>.
<!--l. 4978--><p class="indent" >   Смотрите также <a 
href="clmse63.html#x79-189005r198">do-symbols</a>, <a 
href="clmse63.html#x79-190005r199">do-external-symbols</a> и <a 
href="clmse63.html#x79-191005r200">do-all-symbols</a>.
<!--l. 4981--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.8.4   </span> <a 
 id="x54-1370007.8.4"></a>Mapping Отображение</h4>
<a 
 id="dx54-137001"></a>
<!--l. 4984--><p class="noindent" >Mapping is a type of iteration in which a function is successively applied to pieces
of one or more sequences. The result of the iteration is a sequence containing the
respective results of the function applications. There are several options for the
way in which the pieces of the list are chosen and for what is done with the results
returned by the applications of the function.
<!--l. 4992--><p class="indent" >   Отображение — это тип цикла, в котором заданная функция применяется
к частям одной или более последовательностей. Результатом цикла является
последовательность, полученная из результатов выполнения это функции.
Существует несколько опции для указания того, какие части списка будут
использоваться в цикле, и что будет происходить с результатом применения
функции.
<!--l. 4999--><p class="indent" >   The function <a 
href="clmse82.html#x101-219005r407">map</a> may be used to map over any kind of sequence. The
following functions operate only on lists.
<!--l. 5002--><p class="indent" >   Функция <a 
href="clmse82.html#x101-219005r407">map</a> может быть использована для отображения любого
типа последовательности. Следующие же функции оперируют только
списками.
<div class=defun>
<!--l. 5006--><p class="noindent" ><i>[Function]</i><a 
 id="dx54-137002"></a><a 
 id="x54-137003r113"></a><b> mapcar</b>  <i>function</i> <i>list</i> &#x0026;rest  <i>more-lists</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx54-137004"></a><a 
 id="x54-137005r114"></a><b> maplist</b>  <i>function</i> <i>list</i> &#x0026;rest  <i>more-lists</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx54-137006"></a><a 
 id="x54-137007r115"></a><b> mapc</b>  <i>function</i> <i>list</i> &#x0026;rest  <i>more-lists</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx54-137008"></a><a 
 id="x54-137009r116"></a><b> mapl</b>  <i>function</i> <i>list</i> &#x0026;rest  <i>more-lists</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx54-137010"></a><a 
 id="x54-137011r117"></a><b> mapcan</b>  <i>function</i> <i>list</i> &#x0026;rest  <i>more-lists</i><br 
class="newline" /><i>[Function]</i><a 
 id="dx54-137012"></a><a 
 id="x54-137013r118"></a><b> mapcon</b>  <i>function</i> <i>list</i> &#x0026;rest  <i>more-lists</i>
<!--l. 5013--><p class="noindent" >For each of these mapping functions, the ﬁrst argument is a function and the rest
must be lists. The function must take as many arguments as there are
lists.
<!--l. 5018--><p class="indent" >   Для каждой из этих фунцкий отображения, первый аргумент является
функцией и оставшиеся аргументы должны быть списками. Функция в
первом аргументе должно принимать столько аргументов, сколько было
передано списков в функцию отображения.
<!--l. 5023--><p class="indent" >   <a 
href="#x54-137003r113">mapcar</a> operates on successive elements of the lists. First the function is
applied to the <i>car</i> of each list, then to the <i>cadr</i> of each list, and so on. (Ideally all
the lists are the same length; if not, the iteration terminates when the shortest list
runs out, and excess elements in other lists are ignored.) The value returned by
<a 
href="#x54-137003r113">mapcar</a> is a list of the results of the successive calls to the function. For example: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(mapcar #&#x2019;abs &#x2019;(3 -4 2 -5 -6))  ⇒ (3 4 2 5 6)
</td></tr></table>
<!--l. 5033--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(mapcar #&#x2019;cons &#x2019;(a b c) &#x2019;(1 2 3))  ⇒ ((a . 1) (b . 2) (c . 3))</td></tr></table>
<!--l. 5035--><p class="indent" >
</div>
</div>
<!--l. 5037--><p class="indent" >   <a 
href="#x54-137003r113">mapcar</a> последовательно обрабатывает элементы списков. Сначала
функция применяется к <i>car</i> элементу каждого списка, затем к <i>cadr</i> элементу,
и так далее. (Лучше всего, чтобы все переданные списки имели одинаковую
длину. Если это не так, то цикл завершиться, как только закончится самый
короткий список, и все оставшиеся элементы в других списках будут
проигнорированы.) Значение, возвращаемое <a 
href="#x54-137003r113">mapcar</a>, является списком
результатов последовательных вызовов функции из первого параметра.
Например: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(mapcar #&#x2019;abs &#x2019;(3 -4 2 -5 -6))  ⇒ (3 4 2 5 6)
</td></tr></table>
<!--l. 5047--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(mapcar #&#x2019;cons &#x2019;(a b c) &#x2019;(1 2 3))  ⇒ ((a . 1) (b . 2) (c . 3))</td></tr></table>
<!--l. 5049--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 5051--><p class="indent" >   <a 
href="#x54-137005r114">maplist</a> is like <a 
href="#x54-137003r113">mapcar</a> except that the function is applied to the lists and
successive <i>cdr</i>&#x2019;s of those lists rather than to successive elements of the lists. For
example: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(maplist #&#x2019;(lambda (x) (cons &#x2019;foo x))
</td></tr></table>
<!--l. 5056--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         &#x2019;(a b c d))</td></tr></table>
<!--l. 5057--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ ((foo a b c d) (foo b c d) (foo c d) (foo d))</td></tr></table>
<!--l. 5059--><p class="indent" >
</div>
</div>
<!--l. 5061--><p class="indent" >   <a 
href="#x54-137005r114">maplist</a> похожа на <a 
href="#x54-137003r113">mapcar</a> за исключением того, что функция применяется
к спискам и последующим <i>cdr</i> элементам этих списков, а не последовательно
к элементам спискам. Например: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(maplist #&#x2019;(lambda (x) (cons &#x2019;foo x))
</td></tr></table>
<!--l. 5066--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         &#x2019;(a b c d))</td></tr></table>
<!--l. 5067--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ ((foo a b c d) (foo b c d) (foo c d) (foo d))</td></tr></table>
<!--l. 5069--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(maplist #&#x2019;(lambda (x) (if (member (car x) (cdr x)) 0 1)))
</td></tr></table>
<!--l. 5072--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         &#x2019;(a b a c d b c))</td></tr></table>
<!--l. 5073--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ (0 0 1 0 1 1 1)</td></tr></table>
<!--l. 5074--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   ;An entry is 1 if the corresponding element of the input</td></tr></table>
<!--l. 5075--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   ; list was the last instance of that element in the input list.</td></tr></table>
<!--l. 5077--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(maplist #&#x2019;(lambda (x) (if (member (car x) (cdr x)) 0 1)))
</td></tr></table>
<!--l. 5080--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         &#x2019;(a b a c d b c))</td></tr></table>
<!--l. 5081--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ (0 0 1 0 1 1 1)</td></tr></table>
<!--l. 5082--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   ;Возвращается 1, если соответсвующий элемент входящего списка</td></tr></table>
<!--l. 5083--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   ;  появлялся последний раз в данном списке.</td></tr></table>
<!--l. 5085--><p class="indent" >
</div>
</div>
<!--l. 5087--><p class="indent" >   <a 
href="#x54-137009r116">mapl</a> and <a 
href="#x54-137007r115">mapc</a> are like <a 
href="#x54-137005r114">maplist</a> and <a 
href="#x54-137003r113">mapcar</a>, respectively, except that they do
not accumulate the results of calling the function.
<!--l. 5091--><p class="indent" >   <a 
href="#x54-137009r116">mapl</a> и <a 
href="#x54-137007r115">mapc</a> похожи на <a 
href="#x54-137005r114">maplist</a> и <a 
href="#x54-137003r113">mapcar</a>, соответственно, за исключением
того, что они не накапливают результаты вызова функций.
<div class=incompatibility>
<!--l. 5095--><p class="noindent" ><b>Compatibility note:</b> In all Lisp systems since Lisp 1.5, <a 
href="#x54-137009r116">mapl</a> has been called
<a 
href="clmse82.html#x101-219005r407">map</a>. In the chapter on sequences it is explained why this was a bad choice.
Here the name <a 
href="clmse82.html#x101-219005r407">map</a> is used for the far more useful generic sequence mapper, in
closer accordance with the computer science literature, especially the growing
body of papers on functional programming. <div class=new> Note that this remark, predating
the design of the Common Lisp Object System, uses the term “generic” in a
generic sense and not necessarily in the technical sense used by CLOS (see
chapter <a 
href="clmch2.html#x9-170002">2<!--tex4ht:ref: DTYPES --></a>).
</div>
</div>
<!--l. 5111--><p class="indent" >   These functions are used when the function is being called merely for its side
eﬀects rather than for its returned values. The value returned by <a 
href="#x54-137009r116">mapl</a> or <a 
href="#x54-137007r115">mapc</a> is
the second argument, that is, the ﬁrst sequence argument.
<!--l. 5116--><p class="indent" >   Эти функци используются, когда функция в первом параметре
предназначена для побочных эффектов, а не для возвращаемого значения.
Значение возвращаемое <a 
href="#x54-137009r116">mapl</a> или <a 
href="#x54-137007r115">mapc</a> является вторым аргументом, то есть
                                                                          

                                                                          
первой последовательностью для отображения.
<!--l. 5121--><p class="indent" >   <a 
href="#x54-137011r117">mapcan</a> and <a 
href="#x54-137013r118">mapcon</a> are like <a 
href="#x54-137003r113">mapcar</a> and <a 
href="#x54-137005r114">maplist</a>, respectively, except that
they combine the results of the function using <a 
href="clmse139.html#x170-357006r867">nconc</a> instead of <a 
href="clmse87.html#x107-225038r493">list</a>. That is, <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(mapcon <i>f </i> <i>x1</i> ... <i>xn</i>)
</td></tr></table>
<!--l. 5125--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ≡ (apply #&#x2019;nconc (maplist <i>f </i> <i>x1</i> ... <i>xn</i>))</td></tr></table>
<!--l. 5127--><p class="indent" >
</div>
</div>
<!--l. 5128--><p class="noindent" >and similarly for the relationship between <a 
href="#x54-137011r117">mapcan</a> and <a 
href="#x54-137003r113">mapcar</a>. Conceptually, these
functions allow the mapped function to return a variable number of items to be
put into the output list. This is particularly useful for eﬀectively returning zero or
one item: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(mapcan #&#x2019;(lambda (x) (and (numberp x) (list x)))
</td></tr></table>
<!--l. 5133--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x2019;(a 1 b c 3 4 d 5))</td></tr></table>
<!--l. 5134--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ (1 3 4 5)</td></tr></table>
<!--l. 5136--><p class="indent" >
</div>
</div>
<!--l. 5137--><p class="noindent" >In this case the function serves as a ﬁlter; this is a standard Lisp idiom using <a 
href="#x54-137011r117">mapcan</a>.
(The function <a 
href="clmse83.html#x102-220010r418">remove-if-not</a> might have been useful in this particular context,
however.) Remember that <a 
href="clmse139.html#x170-357006r867">nconc</a> is a destructive operation, and therefore so are
<a 
href="#x54-137011r117">mapcan</a> and <a 
href="#x54-137013r118">mapcon</a>; the lists returned by the <i>function</i> are altered in order to
concatenate them.
<!--l. 5145--><p class="indent" >   <a 
href="#x54-137011r117">mapcan</a> и <a 
href="#x54-137013r118">mapcon</a> похожи на <a 
href="#x54-137003r113">mapcar</a> и <a 
href="#x54-137005r114">maplist</a> соответственно, за
исключением того, что результат создается с помощью функции <a 
href="clmse139.html#x170-357006r867">nconc</a>, а не
<a 
href="clmse87.html#x107-225038r493">list</a>. То есть, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(mapcon <i>f </i> <i>x1</i> ... <i>xn</i>)
</td></tr></table>
<!--l. 5149--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ≡ (apply #&#x2019;nconc (maplist <i>f </i> <i>x1</i> ... <i>xn</i>))</td></tr></table>
<!--l. 5151--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 5152--><p class="noindent" >Такое же различие между <a 
href="#x54-137011r117">mapcan</a> и <a 
href="#x54-137003r113">mapcar</a>. Концептуально, эти функции
позволяют функции отображения возвращать переменное количество
элементов. Таким образом длина результата может быть не равна длине
входного списка. Это, в частности, полезно для возврата нуля или одного
элемента: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(mapcan #&#x2019;(lambda (x) (and (numberp x) (list x)))
</td></tr></table>
<!--l. 5158--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        &#x2019;(a 1 b c 3 4 d 5))</td></tr></table>
<!--l. 5159--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ⇒ (1 3 4 5)</td></tr></table>
<!--l. 5161--><p class="indent" >
</div>
</div>
<!--l. 5162--><p class="noindent" >В этом случае функция действует, как фильтр. Это стандартная Lisp&#x2019;овая
идиома использования <a 
href="#x54-137011r117">mapcan</a>. (Однако, в этом контексте функция
<a 
href="clmse83.html#x102-220010r418">remove-if-not</a> также может быть полезна.) Помните, что <a 
href="clmse139.html#x170-357006r867">nconc</a> деструктивная
операция, следовательно и <a 
href="#x54-137011r117">mapcan</a> и <a 
href="#x54-137013r118">mapcon</a> также деструктивны. Список
возвращаемый функцией <i>function</i> изменяется для соединения и возврата
результата.
<!--l. 5169--><p class="indent" >   Sometimes a <a 
href="clmse142.html#x173-366002r881">do</a> or a straightforward recursion is preferable to a mapping
operation; however, the mapping functions should be used wherever they
naturally apply because this increases the clarity of the code.
<!--l. 5173--><p class="indent" >   Иногда <a 
href="clmse142.html#x173-366002r881">do</a> или прямая последовательная рекурсия удобнее, чем функции
отображения. Однако, функции отображения должны быть использованы
везде, где они действительно необходимы, так как они увеличивают ясность
кода.
<!--l. 5177--><p class="indent" >   The functional argument to a mapping function must be acceptable to <a 
href="clmse37.html#x49-101002r77">apply</a>;
it cannot be a macro or the name of a special form. Of course, there is nothing
wrong with using a function that has &#x0026;optional and &#x0026;rest parameters as the
functional argument.
<!--l. 5182--><p class="indent" >   Функциональный аргумент функции отображения должен быть
подходящим для функции <a 
href="clmse37.html#x49-101002r77">apply</a>. Он не может быть макросов или
именем специальной формы. Кроме того, в качестве функционального
аргумента можно использовать функцию, имеющую &#x0026;optional и &#x0026;rest
параметры.
                                                                          

                                                                          
<div class=newer>
<!--l. 5188--><p class="indent" >   X3J13 voted in June 1988 <a 
 id="dx54-137014"></a>to allow the <i>function</i> to be only of type <a 
href="clmch10.html#x68-17500010">symbol</a> or
<a 
href="clmse35.html#x47-88006r54">function</a>; a lambda-expression is no longer acceptable as a functional argument.
One must use the <a 
href="clmse35.html#x47-88006r54">function</a> special form or the abbreviation #&#x2019; before a
lambda-expression that appears as an explicit argument form.
</div>
<div class=new>
<!--l. 5196--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx54-137015"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-1420007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
</div>
<!--l. 5202--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.8.5   </span> <a 
 id="x54-1380007.8.5"></a>The “Program Feature” Использование «GOTO»</h4>
<!--l. 5204--><p class="noindent" >Lisp implementations since Lisp 1.5 have had what was originally called “the
program feature,” as if it were impossible to write programs without it!
The <a 
href="#x54-139002r120">prog</a> construct allows one to write in an Algol-like or Fortran-like
statement-oriented style, using <a 
href="#x54-140002r122">go</a> statements that can refer to tags in
the body of the <a 
href="#x54-139002r120">prog</a>. Modern Lisp programming style tends to use <a 
href="#x54-139002r120">prog</a>
rather infrequently. The various iteration constructs, such as <a 
href="clmse142.html#x173-366002r881">do</a>, have
bodies with the characteristics of a <a 
href="#x54-139002r120">prog</a>. (However, the ability to use
<a 
href="#x54-140002r122">go</a> statements within iteration constructs is very seldom called upon in
practice.)
<!--l. 5215--><p class="indent" >   Реализации Lisp&#x2019;а начиная с Lisp&#x2019;а 1.5 содержат то, что изначально
называлось «the program feature», как будто без этого невозможно писать
программы! Конструкция <a 
href="#x54-139002r120">prog</a> позволяет писать в Algol- или Fortran-
императивном стиле, используя выражения <a 
href="#x54-140002r122">go</a>, которые могут ссылаться на
теги в теле <a 
href="#x54-139002r120">prog</a>. Современный стиль программирования на Lisp&#x2019;е стремится
снизить использование <a 
href="#x54-139002r120">prog</a>. Различные конструкции циклов, как <a 
href="clmse142.html#x173-366002r881">do</a>, имеют
тели с характеристиками <a 
href="#x54-139002r120">prog</a>. (Тем не менее, возможность использовать
выражения <a 
href="#x54-140002r122">go</a> внутри конструкции цикла очень редко используется на
практике.)
<!--l. 5225--><p class="indent" >   Three distinct operations are performed by <a 
href="#x54-139002r120">prog</a>: it binds local variables, it
permits use of the <a 
href="clmse142.html#x173-367002r883">return</a> statement, and it permits use of the <a 
href="#x54-140002r122">go</a> statement. In
Common Lisp, these three operations have been separated into three distinct
constructs: <a 
href="clmse39.html#x51-107003r84">let</a>, <a 
href="clmse41.html#x53-124002r103">block</a>, and <a 
href="#x54-138002r119">tagbody</a>. These three constructs may be used
independently as building blocks for other types of constructs.
                                                                          

                                                                          
<!--l. 5233--><p class="indent" >   <a 
href="#x54-139002r120">prog</a> предоставляет три различные операции: связывание локальный
переменных, использование выражения <a 
href="clmse142.html#x173-367002r883">return</a> и использование выражения
<a 
href="#x54-140002r122">go</a>. В Common Lisp&#x2019;е эти три операции были разделены на три конструкции:
<a 
href="clmse39.html#x51-107003r84">let</a>, <a 
href="clmse41.html#x53-124002r103">block</a> и <a 
href="#x54-138002r119">tagbody</a>. Эти три конструкции могут использоваться независимо,
как строительные кирпичики для других типов конструкций.
<div class=defspec>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> tagbody </b><a 
 id="dx54-138001"></a><a 
 id="x54-138002r119"></a> {tag | statement}*
</td></tr></table>
<!--l. 5244--><p class="indent" >
</div>
<!--l. 5244--><p class="noindent" ><span class="paragraphHead"><a 
 id="x54-1390007.8.5"></a></span>
   The part of a <a 
href="#x54-138002r119">tagbody</a> after the variable list is called the <i>body</i>. An item
in the body may be a symbol or an integer, in which case it is called a
<i>tag</i>, or an item in the body may be a list, in which case it is called a
<i>statement</i>.
<!--l. 5250--><p class="indent" >   Each element of the body is processed from left to right. A <i>tag</i> is ignored; a
<i>statement</i> is evaluated, and its results are discarded. If the end of the body is
reached, the <a 
href="#x54-138002r119">tagbody</a> returns <a 
href="clmse31.html#x42-77002r19">nil</a>.
<!--l. 5255--><p class="indent" >   If (go <i>tag</i>) is evaluated, control jumps to the part of the body labelled with the
<i>tag</i>.
<!--l. 5258--><p class="indent" >   Часть <a 
href="#x54-138002r119">tagbody</a> после списка переменные называется <i>телом</i>. Элемент тела
может быть символов или целым числом, и называться в этом случае <i>тег</i>.
Также элемент тела может быть списока, и называться в этом случае
<i>выражением</i>.
<!--l. 5263--><p class="indent" >   Каждый элемент тела обрабатывается слева направо. <i>Теги</i> игнорируются.
<i>Выражения</i> вычисляются и их результаты игнорируются. Если управление
достигает конца тела, <a 
href="#x54-138002r119">tagbody</a> возвращает <a 
href="clmse31.html#x42-77002r19">nil</a>.
<!--l. 5268--><p class="indent" >   Если вычисляется форма (go <i>tag</i>), управление перемещается на часть
тела, обозначенную <i>тегом</i>.
<div class=incompatibility>
<!--l. 5272--><p class="noindent" ><b>Compatibility note:</b> The “computed <a 
href="#x54-140002r122">go</a>” feature of MacLisp is not supported. The
                                                                          

                                                                          
syntax of a computed <a 
href="#x54-140002r122">go</a> is idiosyncratic, and the feature is not supported by Lisp
Machine Lisp, NIL (New Implementation of Lisp), or Interlisp. The computed <a 
href="#x54-140002r122">go</a> has
been infrequently used in MacLisp anyway and is easily simulated with no loss of
eﬃciency by using a <a 
href="clmse40.html#x52-121002r101">case</a> statement each of whose clauses performs a (non-computed)
<a 
href="#x54-140002r122">go</a>.
</div>
<!--l. 5283--><p class="indent" >   The scope of the tags established by a <a 
href="#x54-138002r119">tagbody</a> is lexical, and the extent
is dynamic. Once a <a 
href="#x54-138002r119">tagbody</a> construct has been exited, it is no longer
legal to <a 
href="#x54-140002r122">go</a> to a <i>tag</i> in its body. It is permissible for a <a 
href="#x54-140002r122">go</a> to jump to a
<a 
href="#x54-138002r119">tagbody</a> that is not the innermost <a 
href="#x54-138002r119">tagbody</a> construct containing that <a 
href="#x54-140002r122">go</a>;
the tags established by a <a 
href="#x54-138002r119">tagbody</a> will only shadow other tags of like
name.
<!--l. 5291--><p class="indent" >   Область видимости тегов, устанавливаемых в <a 
href="#x54-138002r119">tagbody</a>, является
лексической. Продолжительность видимости тегов динамическая. Когда
управление вышло из конструкции <a 
href="#x54-138002r119">tagbody</a>, ссылка <a 
href="#x54-140002r122">go</a> на теги в ее теле
невозможны. Существует возможность для <a 
href="#x54-140002r122">go</a> прыжка в <a 
href="#x54-138002r119">tagbody</a>,
которая не находится внутри конструкции <a 
href="#x54-138002r119">tagbody</a>, которая и содержала
этот <a 
href="#x54-140002r122">go</a>. То есть возможны прыжки в родительский <a 
href="#x54-138002r119">tagbody</a>. Теги
устанавливаемые <a 
href="#x54-138002r119">tagbody</a> будут только скрывать другие одноименные
теги.
<!--l. 5300--><p class="indent" >   The lexical scoping of the <a 
href="#x54-140002r122">go</a> targets named by tags is fully general and has
consequences that may be surprising to users and implementors of other Lisp
systems. For example, the <a 
href="#x54-140002r122">go</a> in the following example actually does work in
Common Lisp as one might expect: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(tagbody
</td></tr></table>
<!--l. 5306--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (catch &#x2019;stuﬀ</td></tr></table>
<!--l. 5307--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (mapcar #&#x2019;(lambda (x) (if (numberp x)</td></tr></table>
<!--l. 5308--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                (hairyfun x)</td></tr></table>
<!--l. 5309--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                (go lose)))</td></tr></table>
<!--l. 5310--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              items))</td></tr></table>
<!--l. 5311--><p class="indent" >                                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (return)</td></tr></table>
<!--l. 5312--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> lose</td></tr></table>
<!--l. 5313--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (error &#x0022;I lost big!&#x0022;))</td></tr></table>
<!--l. 5315--><p class="indent" >
</div>
                                                                          

                                                                          
</div>
<!--l. 5316--><p class="noindent" >Depending on the situation, a <a 
href="#x54-140002r122">go</a> in Common Lisp does not necessarily correspond to
a simple machine “jump” instruction. A <a 
href="#x54-140002r122">go</a> can break up catchers if necessary to
get to the target. It is possible for a “closure” created by <a 
href="clmse35.html#x47-88006r54">function</a> for a
lambda-expression to refer to a <a 
href="#x54-140002r122">go</a> target as long as the tag is lexically apparent.
See chapter <a 
href="clmch3.html#x25-450003">3<!--tex4ht:ref: SCOPE --></a> for an elaborate example of this.
<!--l. 5324--><p class="indent" >   Лексическая область видимости для тегов (целей <a 
href="#x54-140002r122">go</a>) полностью
полноправно и последствия могут быть сюрпризом для пользователей и
разработчиков других Lisp систем. Например, <a 
href="#x54-140002r122">go</a> в следующем примере,
работает в Common Lisp так, как это и ожидается: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(tagbody
</td></tr></table>
<!--l. 5330--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (catch &#x2019;stuﬀ</td></tr></table>
<!--l. 5331--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (mapcar #&#x2019;(lambda (x) (if (numberp x)</td></tr></table>
<!--l. 5332--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                (hairyfun x)</td></tr></table>
<!--l. 5333--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                (go lose)))</td></tr></table>
<!--l. 5334--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              items))</td></tr></table>
<!--l. 5335--><p class="indent" >                                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (return)</td></tr></table>
<!--l. 5336--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> lose</td></tr></table>
<!--l. 5337--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (error &#x0022;I lost big!&#x0022;))</td></tr></table>
<!--l. 5339--><p class="indent" >
</div>
</div>
<!--l. 5340--><p class="noindent" >В зависимости от ситуации, <a 
href="#x54-140002r122">go</a> в Common Lisp&#x2019;е не обязательно похож на
простую машинную иструкцию «jump». Если необходимо, <a 
href="#x54-140002r122">go</a> может
перепрыгивать ловушки исключений. Возможно так, что «замыкание»,
созданное с помощью <a 
href="clmse35.html#x47-88006r54">function</a>, для лямбда-выражения ссылается на тег (цель
<a 
href="#x54-140002r122">go</a>) так долго, сколько лексически доступен данный тег. Смотрите <a 
href="clmch3.html#x25-450003">3<!--tex4ht:ref: SCOPE --></a> для
понимания этого примера.
<div class=new>
<!--l. 5348--><p class="indent" >   There are some holes in this speciﬁcation (and that of <a 
href="#x54-140002r122">go</a>) that leave
some room for interpretation. For example, there is no explicit prohibition
against the same tag appearing more than once in the same <a 
href="#x54-138002r119">tagbody</a> body.
Every implementation I know of will complain in the compiler, if not
in the interpreter, if there is a <a 
href="#x54-140002r122">go</a> to such a duplicated tag; but some
                                                                          

                                                                          
implementors take the position that duplicate tags are permitted provided
there is no <a 
href="#x54-140002r122">go</a> to such a tag. (“If a tree falls in the forest, and there is no
one there to hear it, then no one needs to yell ‘Timber!&#x2019; ”) Also, some
implementations allow objects other than symbols, integers, and lists in the
body and typically ignore them. Consequently, some programmers use
redundant tags such as — for formatting purposes, and strings as comments: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun dining-philosopher (j)
</td></tr></table>
<!--l. 5363--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (tagbody —</td></tr></table>
<!--l. 5364--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   think   (unless (hungry) (go think))</td></tr></table>
<!--l. 5365--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           —</td></tr></table>
<!--l. 5366--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           &#x0022;Can&#x2019;t eat without chopsticks.&#x0022;</td></tr></table>
<!--l. 5367--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (snatch (chopstick j))</td></tr></table>
<!--l. 5368--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (snatch (chopstick (mod (+ j 1) 5)))</td></tr></table>
<!--l. 5369--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           —</td></tr></table>
<!--l. 5370--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   eat     (when (hungry)</td></tr></table>
<!--l. 5371--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (mapc #&#x2019;gobble-down</td></tr></table>
<!--l. 5372--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   &#x2019;(twice-cooked-pork kung-pao-chi-ding</td></tr></table>
<!--l. 5373--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     wu-dip-har orange-ﬂavor-beef</td></tr></table>
<!--l. 5374--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     two-side-yellow-noodles twinkies))</td></tr></table>
<!--l. 5375--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             (go eat))</td></tr></table>
<!--l. 5376--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           —</td></tr></table>
<!--l. 5377--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           &#x0022;Can&#x2019;t think with my neighbors&#x2019; stomachs rumbling.&#x0022;</td></tr></table>
<!--l. 5378--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (relinquish (chopstick j))</td></tr></table>
<!--l. 5379--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (relinquish (chopstick (mod (+ j 1) 5)))</td></tr></table>
<!--l. 5380--><p class="indent" >                                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           —</td></tr></table>
<!--l. 5381--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (if (happy) (go think)</td></tr></table>
<!--l. 5382--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">               (become insurance-salesman))))</td></tr></table>
<!--l. 5384--><p class="indent" >
</div>
</div>
<!--l. 5385--><p class="noindent" >In certain implementations of Common Lisp they get away with it. Others abhor
what they view as an abuse of unintended ambiguity in the language speciﬁcation.
For maximum portability, I advise users to steer clear of these issues. Similarly, it
                                                                          

                                                                          
is best to avoid using <a 
href="clmse31.html#x42-77002r19">nil</a> as a tag, even though it is a symbol, because a few
implementations treat <a 
href="clmse31.html#x42-77002r19">nil</a> as a list to be executed. To be extra careful, avoid
calling from within a <a 
href="#x54-138002r119">tagbody</a> a macro whose expansion might not be a non-<a 
href="clmse31.html#x42-77002r19">nil</a>
list; wrap such a call in (progn ...), or rewrite the macro to return (progn ...) if
possible.
</div>
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> prog </b><a 
 id="dx54-139001"></a><a 
 id="x54-139002r120"></a> ( {var | (var [init])}* )  {declaration}*  {tag | statement}*
</td></tr></table>
<!--l. 5399--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>[Macro]</i><b> prog* </b><a 
 id="dx54-139003"></a><a 
 id="x54-139004r121"></a> ( {var | (var [init])}* )  {declaration}*  {tag | statement}* </td></tr></table>
<!--l. 5401--><p class="indent" >
</div>
<!--l. 5401--><p class="noindent" ><span class="paragraphHead"><a 
 id="x54-1400007.8.5"></a></span>
   The <a 
href="#x54-139002r120">prog</a> construct is a synthesis of <a 
href="clmse39.html#x51-107003r84">let</a>, <a 
href="clmse41.html#x53-124002r103">block</a>, and <a 
href="#x54-138002r119">tagbody</a>, allowing bound
variables and the use of <a 
href="clmse142.html#x173-367002r883">return</a> and <a 
href="#x54-140002r122">go</a> within a single construct. A typical <a 
href="#x54-139002r120">prog</a>
construct looks like this: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(prog (<i>var1</i> <i>var2</i> (<i>var3</i> <i>init3</i>) <i>var4</i> (<i>var5</i> <i>init5</i>))
</td></tr></table>
<!--l. 5406--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       {<i><i>declaration</i></i>}* </td></tr></table>
<!--l. 5407--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>statement1</i></td></tr></table>
<!--l. 5408--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>tag1</i></td></tr></table>
<!--l. 5409--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>statement2</i></td></tr></table>
<!--l. 5410--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>statement3</i></td></tr></table>
<!--l. 5411--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>statement4</i></td></tr></table>
<!--l. 5412--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>tag2</i></td></tr></table>
<!--l. 5413--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>statement5</i></td></tr></table>
<!--l. 5414--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      ...</td></tr></table>
<!--l. 5415--><p class="indent" >                                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      )</td></tr></table>
<!--l. 5417--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 5418--><p class="noindent" >The list after the keyword <a 
href="#x54-139002r120">prog</a> is a set of speciﬁcations for binding <i>var1</i>, <i>var2</i>,
etc., which are temporary variables bound locally to the <a 
href="#x54-139002r120">prog</a>. This list is
processed exactly as the list in a <a 
href="clmse39.html#x51-107003r84">let</a> statement: ﬁrst all the <i>init</i> forms are
evaluated from left to right (where <a 
href="clmse31.html#x42-77002r19">nil</a> is used for any omitted <i>init</i> form), and
then the variables are all bound in parallel to the respective results. Any
<i>declaration</i> appearing in the <a 
href="#x54-139002r120">prog</a> is used as if appearing at the top of the <a 
href="clmse39.html#x51-107003r84">let</a>
body.
<!--l. 5429--><p class="indent" >   Конструкция <a 
href="#x54-139002r120">prog</a> является синтезом <a 
href="clmse39.html#x51-107003r84">let</a>, <a 
href="clmse41.html#x53-124002r103">block</a> и <a 
href="#x54-138002r119">tagbody</a>, позволяющая
связывать переменные, использовать <a 
href="clmse142.html#x173-367002r883">return</a> и <a 
href="#x54-140002r122">go</a> в одной конструкции.
Обычно конструкция <a 
href="#x54-139002r120">prog</a> выглядит так: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(prog (<i>var1</i> <i>var2</i> (<i>var3</i> <i>init3</i>) <i>var4</i> (<i>var5</i> <i>init5</i>))
</td></tr></table>
<!--l. 5433--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       {<i><i>declaration</i></i>}* </td></tr></table>
<!--l. 5434--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>statement1</i></td></tr></table>
<!--l. 5435--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>tag1</i></td></tr></table>
<!--l. 5436--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>statement2</i></td></tr></table>
<!--l. 5437--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>statement3</i></td></tr></table>
<!--l. 5438--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>statement4</i></td></tr></table>
<!--l. 5439--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>tag2</i></td></tr></table>
<!--l. 5440--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>statement5</i></td></tr></table>
<!--l. 5441--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      ...</td></tr></table>
<!--l. 5442--><p class="indent" >                                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      )</td></tr></table>
<!--l. 5444--><p class="indent" >
</div>
</div>
<!--l. 5445--><p class="noindent" >Список после ключевого символа <a 
href="#x54-139002r120">prog</a> является множеством спецификаторов
для связывания переменных <i>var1</i>, <i>var2</i>. Этот список обрабатывается так же,
как и в выражении <a 
href="clmse39.html#x51-107003r84">let</a>: сначала слева направо выполняются все формы <i>init</i>
(если формы нет, берется значение <a 
href="clmse31.html#x42-77002r19">nil</a>), и затем переменные параллельно
связываются с полученными ранее значениями. Возможно использовать
<i>декларации</i> в начале дела <a 
href="#x54-139002r120">prog</a> так же, как и в <a 
href="clmse39.html#x51-107003r84">let</a>.
<!--l. 5454--><p class="indent" >   The body of the <a 
href="#x54-139002r120">prog</a> is executed as if it were a <a 
href="#x54-138002r119">tagbody</a> construct; the <a 
href="#x54-140002r122">go</a>
statement may be used to transfer control to a <i>tag</i>.
                                                                          

                                                                          
<!--l. 5458--><p class="indent" >   Тело <a 
href="#x54-139002r120">prog</a> выполняется, как обернутое в <a 
href="#x54-138002r119">tagbody</a>. Таким образом, для
перемещения управления к <i>тегу</i> могут использоваться выражения
<a 
href="#x54-140002r122">go</a>.
<!--l. 5461--><p class="indent" >   A <a 
href="#x54-139002r120">prog</a> implicitly establishes a <a 
href="clmse41.html#x53-124002r103">block</a> named <a 
href="clmse31.html#x42-77002r19">nil</a> around the entire <a 
href="#x54-139002r120">prog</a>
construct, so that <a 
href="clmse142.html#x173-367002r883">return</a> may be used at any time to exit from the <a 
href="#x54-139002r120">prog</a>
construct.
<!--l. 5465--><p class="indent" >   <a 
href="#x54-139002r120">prog</a> неявно устанавливает вокруг тела <a 
href="clmse41.html#x53-124002r103">block</a> с именем <a 
href="clmse31.html#x42-77002r19">nil</a>. Это значит,
можно в любое время использовать <a 
href="clmse142.html#x173-367002r883">return</a> для выхода из конструкции
<a 
href="#x54-139002r120">prog</a>.
<!--l. 5468--><p class="indent" >   Here is a ﬁne example of what can be done with <a 
href="#x54-139002r120">prog</a>: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun king-of-confusion (w)
</td></tr></table>
<!--l. 5470--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  &#x0022;Take a cons of two lists and make a list of conses.</td></tr></table>
<!--l. 5471--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   Think of this function as being like a zipper.&#x0022;</td></tr></table>
<!--l. 5472--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (prog (x y z)     ;Initialize x, y, z to <a 
href="clmse31.html#x42-77002r19">nil</a></td></tr></table>
<!--l. 5473--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (setq y (car w) z (cdr w))</td></tr></table>
<!--l. 5474--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   loop</td></tr></table>
<!--l. 5475--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (cond ((null y) (return x))</td></tr></table>
<!--l. 5476--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              ((null z) (go err)))</td></tr></table>
<!--l. 5477--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   rejoin</td></tr></table>
<!--l. 5478--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (setq x (cons (cons (car y) (car z)) x))</td></tr></table>
<!--l. 5479--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (setq y (cdr y) z (cdr z))</td></tr></table>
<!--l. 5480--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (go loop)</td></tr></table>
<!--l. 5481--><p class="indent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   err</td></tr></table>
<!--l. 5482--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (cerror &#x0022;Will self-pair extraneous items&#x0022;</td></tr></table>
<!--l. 5483--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                &#x0022;Mismatch - gleep!  S&#x0022; y)</td></tr></table>
<!--l. 5484--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (setq z y)</td></tr></table>
<!--l. 5485--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (go rejoin)))</td></tr></table>
<!--l. 5487--><p class="indent" >
</div>
</div>
<!--l. 5488--><p class="noindent" >which is accomplished somewhat more perspicuously by <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun prince-of-clarity (w)
</td></tr></table>
                                                                          

                                                                          
<!--l. 5490--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  &#x0022;Take a cons of two lists and make a list of conses.</td></tr></table>
<!--l. 5491--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   Think of this function as being like a zipper.&#x0022;</td></tr></table>
<!--l. 5492--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (do ((y (car w) (cdr y))</td></tr></table>
<!--l. 5493--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (z (cdr w) (cdr z))</td></tr></table>
<!--l. 5494--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (x &#x2019;() (cons (cons (car y) (car z)) x)))</td></tr></table>
<!--l. 5495--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      ((null y) x)</td></tr></table>
<!--l. 5496--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (when (null z)</td></tr></table>
<!--l. 5497--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (cerror &#x0022;Will self-pair extraneous items&#x0022;</td></tr></table>
<!--l. 5498--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x0022;Mismatch - gleep!  S&#x0022; y)</td></tr></table>
<!--l. 5499--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (setq z y))))</td></tr></table>
<!--l. 5501--><p class="indent" >
</div>
</div>
<!--l. 5503--><p class="indent" >   Вот небольшой пример того, что можно сделать с помощью <a 
href="#x54-139002r120">prog</a>: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun king-of-confusion (w)
</td></tr></table>
<!--l. 5505--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  &#x0022;Take a cons of two lists and make a list of conses.</td></tr></table>
<!--l. 5506--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   Think of this function as being like a zipper.&#x0022;</td></tr></table>
<!--l. 5507--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (prog (x y z)     ;Инициализировать x, y, z в <a 
href="clmse31.html#x42-77002r19">nil</a></td></tr></table>
<!--l. 5508--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (setq y (car w) z (cdr w))</td></tr></table>
<!--l. 5509--><p class="indent" >                                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   loop</td></tr></table>
<!--l. 5510--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (cond ((null y) (return x))</td></tr></table>
<!--l. 5511--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              ((null z) (go err)))</td></tr></table>
<!--l. 5512--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   rejoin</td></tr></table>
<!--l. 5513--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (setq x (cons (cons (car y) (car z)) x))</td></tr></table>
<!--l. 5514--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (setq y (cdr y) z (cdr z))</td></tr></table>
<!--l. 5515--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (go loop)</td></tr></table>
<!--l. 5516--><p class="indent" >                                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   err</td></tr></table>
<!--l. 5517--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (cerror &#x0022;Will self-pair extraneous items&#x0022;</td></tr></table>
<!--l. 5518--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                &#x0022;Mismatch - gleep!  S&#x0022; y)</td></tr></table>
<!--l. 5519--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (setq z y)</td></tr></table>
<!--l. 5520--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (go rejoin)))</td></tr></table>
<!--l. 5522--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 5523--><p class="noindent" >которые делает то же, что и: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun prince-of-clarity (w)
</td></tr></table>
<!--l. 5525--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  &#x0022;Take a cons of two lists and make a list of conses.</td></tr></table>
<!--l. 5526--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   Think of this function as being like a zipper.&#x0022;</td></tr></table>
<!--l. 5527--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (do ((y (car w) (cdr y))</td></tr></table>
<!--l. 5528--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (z (cdr w) (cdr z))</td></tr></table>
<!--l. 5529--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (x &#x2019;() (cons (cons (car y) (car z)) x)))</td></tr></table>
<!--l. 5530--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      ((null y) x)</td></tr></table>
<!--l. 5531--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (when (null z)</td></tr></table>
<!--l. 5532--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (cerror &#x0022;Will self-pair extraneous items&#x0022;</td></tr></table>
<!--l. 5533--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x0022;Mismatch - gleep!  S&#x0022; y)</td></tr></table>
<!--l. 5534--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (setq z y))))</td></tr></table>
<!--l. 5536--><p class="indent" >
</div>
</div>
<!--l. 5538--><p class="indent" >   The <a 
href="#x54-139002r120">prog</a> construct may be explained in terms of the simpler constructs <a 
href="clmse41.html#x53-124002r103">block</a>,
<a 
href="clmse39.html#x51-107003r84">let</a>, and <a 
href="#x54-138002r119">tagbody</a> as follows: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(prog <i>variable-list</i> {<i><i>declaration</i></i>}*  . <i>body</i>)
</td></tr></table>
<!--l. 5542--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ≡ (block nil (let <i>variable-list</i> {<i><i>declaration</i></i>}*  (tagbody . <i>body</i>)))</td></tr></table>
<!--l. 5544--><p class="indent" >
</div>
</div>
<!--l. 5546--><p class="indent" >   Конструкция <a 
href="#x54-139002r120">prog</a> может быть выражена в терминах более простых
конструкций <a 
href="clmse41.html#x53-124002r103">block</a>, <a 
href="clmse39.html#x51-107003r84">let</a> и <a 
href="#x54-138002r119">tagbody</a>: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(prog <i>variable-list</i> {<i><i>declaration</i></i>}*  . <i>body</i>)
</td></tr></table>
<!--l. 5549--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ≡ (block nil (let <i>variable-list</i> {<i><i>declaration</i></i>}*  (tagbody . <i>body</i>)))</td></tr></table>
<!--l. 5551--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 5553--><p class="indent" >   The <a 
href="#x54-139004r121">prog*</a> special form is almost the same as <a 
href="#x54-139002r120">prog</a>. The only diﬀerence is that
the binding and initialization of the temporary variables is done <i>sequentially</i>, so
that the <i>init</i> form for each one can use the values of previous ones. Therefore
<a 
href="#x54-139004r121">prog*</a> is to <a 
href="#x54-139002r120">prog</a> as <a 
href="clmse39.html#x51-109003r86">let*</a> is to <a 
href="clmse39.html#x51-107003r84">let</a>. For example, <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(prog* ((y z) (x (car y)))
</td></tr></table>
<!--l. 5560--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (return x))</td></tr></table>
<!--l. 5562--><p class="indent" >
</div>
</div>
<!--l. 5563--><p class="noindent" >returns the <i>car</i> of the value of z.
<!--l. 5565--><p class="indent" >   Специальная форма <a 
href="#x54-139004r121">prog*</a> очень похожа на <a 
href="#x54-139002r120">prog</a>. Одно отличие в том, что
связывание и инициализация переменных осуществляется <i>последовательно</i>,
тем самым форма <i>init</i> использовать значения ранее связанных переменных.
Таким образом <a 
href="#x54-139004r121">prog*</a> относится к <a 
href="#x54-139002r120">prog</a>, как <a 
href="clmse39.html#x51-109003r86">let*</a> к <a 
href="clmse39.html#x51-107003r84">let</a>. Например, <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(prog* ((y z) (x (car y)))
</td></tr></table>
<!--l. 5571--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (return x))</td></tr></table>
<!--l. 5573--><p class="indent" >
</div>
</div>
<!--l. 5574--><p class="noindent" >возвращает <i>car</i> элемент значения z.
<div class=new>
<!--l. 5577--><p class="indent" >   I haven&#x2019;t seen <a 
href="#x54-139002r120">prog</a> used very much in the last several years. Apparently
splitting it into functional constituents (<a 
href="clmse39.html#x51-107003r84">let</a>, <a 
href="clmse41.html#x53-124002r103">block</a>, <a 
href="#x54-138002r119">tagbody</a>) has been a success.
Common Lisp programmers now tend to use whichever speciﬁc construct is
appropriate.
</div>
</div>
<div class=defspec>
                                                                          

                                                                          
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> go </b><a 
 id="dx54-140001"></a><a 
 id="x54-140002r122"></a> tag
</td></tr></table>
<!--l. 5586--><p class="indent" >
</div>
<!--l. 5586--><p class="noindent" ><span class="paragraphHead"><a 
 id="x54-1410007.8.5"></a></span>
   The (go <i>tag</i>) special form is used to do a “go to” within a <a 
href="#x54-138002r119">tagbody</a> construct.
The <i>tag</i> must be a symbol or an integer; the <i>tag</i> is not evaluated. <a 
href="#x54-140002r122">go</a> transfers
control to the point in the body labelled by a tag <a 
href="clmse33.html#x44-81005r47">eql</a> to the one given. If there is
no such tag in the body, the bodies of lexically containing <a 
href="#x54-138002r119">tagbody</a> constructs (if
any) are examined as well. It is an error if there is no matching tag lexically
visible to the point of the <a 
href="#x54-140002r122">go</a>.
<!--l. 5597--><p class="indent" >   The <a 
href="#x54-140002r122">go</a> form does not ever return a value.
<!--l. 5599--><p class="indent" >   As a matter of style, it is recommended that the user think twice before using
a <a 
href="#x54-140002r122">go</a>. Most purposes of <a 
href="#x54-140002r122">go</a> can be accomplished with one of the iteration
primitives, nested conditional forms, or <a 
href="clmse41.html#x53-125002r104">return-from</a>. If the use of <a 
href="#x54-140002r122">go</a> seems to be
unavoidable, perhaps the control structure implemented by <a 
href="#x54-140002r122">go</a> should be packaged
as a macro deﬁnition.
<!--l. 5606--><p class="indent" >   Специальная форма (go <i>tag</i>) используется для применения «goto»
внутри конструкции <a 
href="#x54-138002r119">tagbody</a>. <i>tag</i> должен быть символов или целым
числом. <i>tag</i> не вычисляется. <a 
href="#x54-140002r122">go</a> переносит управление на точку тела,
которая была помечена тегом равным <a 
href="clmse33.html#x44-81005r47">eql</a> заданному. Если такого тега в
теле нет, поиск осуществляется в лексически доступном теле другой
конструкции <a 
href="#x54-138002r119">tagbody</a>. Использоваться <a 
href="#x54-140002r122">go</a> с тегом, которого нет, является
ошибкой.
<!--l. 5614--><p class="indent" >   Форма <a 
href="#x54-140002r122">go</a> никогда не возвращает значение.
<!--l. 5616--><p class="indent" >   В целях стиля, рекомендуется дважды подумать, прежде чем использовать
<a 
href="#x54-140002r122">go</a>. Большинство функций <a 
href="#x54-140002r122">go</a> могут быть заменены циклами, вложенными
условными формамы или <a 
href="clmse41.html#x53-125002r104">return-from</a>. Если использование <a 
href="#x54-140002r122">go</a> неизбежно,
рекомендуется управляющую структуру реализованную с помощью <a 
href="#x54-140002r122">go</a>
«упаковать» в определении макроса.
</div>
                                                                          

                                                                          
<div class=new>
                                                                          

                                                                          
   <!--l. 5626--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse43.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse41.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse41.html#tailclmse41.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse42.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch7.html#clmse42.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 5626--><p class="indent" >   <a 
 id="tailclmse42.html"></a>   
</body></html> 
