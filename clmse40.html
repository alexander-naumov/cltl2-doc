<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Conditionals</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,charset=utf-8,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-02-22 17:23:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 2655--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse41.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse39.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse39.html#tailclmse39.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse40.html">Tail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch7.html#clmse40.html" >Up</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">7.6   </span> <a 
 id="x52-840007.6"></a>Conditionals</h3>
<!--l. 2657--><p class="noindent" >The traditional conditional construct in Lisp is <a 
href="#x52-84008r98">cond</a>. However, <a 
href="clmse141.html#x172-248002r876">if</a> is much simpler
and is directly comparable to conditional constructs in other programming
languages, so it is considered to be primitive in Common Lisp and is described
ﬁrst. Common Lisp also provides the dispatching constructs <a 
href="#x52-84010r99">case</a> and <a 
href="#x52-84012r100">typecase</a>,
which are often more convenient than <a 
href="#x52-84008r98">cond</a>.
<div class=defspec>
<!--l. 2665--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Special form]</i><b> if </b> <a 
 id="dx52-84001"></a><a 
 id="x52-84002r95"></a>   test then  [ <i>else</i>]
</td></tr></table>
<!--l. 2666--><p class="indent" >
</div>
   The <a 
href="clmse141.html#x172-248002r876">if</a> special form corresponds to the <b>if</b>-<b>then</b>-<b>else</b> construct found in most
algebraic programming languages. First the form <i>test</i> is evaluated. If the result is
not <a 
href="clmse31.html#x42-70002r19">nil</a>, then the form <i>then</i> is selected; otherwise the form <i>else</i> is selected.
Whichever form is selected is then evaluated, and <a 
href="clmse141.html#x172-248002r876">if</a> returns whatever is returned
by evaluation of the selected form. <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(if <i>test</i> <i>then</i> <i>else</i>)  ≡ (cond (<i>test</i> <i>then</i>) (<a 
href="clmse31.html#x42-70004r20">t</a> <i>else</i>))
</td></tr></table>
<!--l. 2675--><p class="indent" >
</div>
</div>
<!--l. 2676--><p class="noindent" >but <a 
href="clmse141.html#x172-248002r876">if</a> is considered more readable in some situations.
<!--l. 2678--><p class="indent" >   The <i>else</i> form may be omitted, in which case if the value of <i>test</i> is <a 
href="clmse31.html#x42-70002r19">nil</a>
then nothing is done and the value of the <a 
href="clmse141.html#x172-248002r876">if</a> form is <a 
href="clmse31.html#x42-70002r19">nil</a>. If the value of
the <a 
href="clmse141.html#x172-248002r876">if</a> form is important in this situation, then the <a 
href="clmse34.html#x45-75004r51">and</a> construct may
                                                                          

                                                                          
be stylistically preferable, depending on the context. If the value is not
important, but only the eﬀect, then the <a 
href="clmse141.html#x172-248004r877">when</a> construct may be stylistically
preferable.
</div>
<div class=defmac>
<!--l. 2689--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> when </b> <a 
 id="dx52-84003"></a><a 
 id="x52-84004r96"></a>   test  {<i>form</i>}∗
</td></tr></table>
<!--l. 2690--><p class="indent" >
</div>
   <i>(when <i>test</i> <i>form1</i> <i>form2</i> ... )</i> ﬁrst evaluates <i>test</i>. If the result is <a 
href="clmse31.html#x42-70002r19">nil</a>, then no
<i>form</i> is evaluated, and <a 
href="clmse31.html#x42-70002r19">nil</a> is returned. Otherwise the <i>form</i>s constitute an implicit
<a 
href="clmse38.html#x50-82002r80">progn</a> and are evaluated sequentially from left to right, and the value of the last
one is returned. <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(when <i>p</i> <i>a</i> <i>b</i> <i>c</i>)  ≡ (and <i>p</i> (progn <i>a</i> <i>b</i> <i>c</i>))
</td></tr></table>
<!--l. 2698--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(when <i>p</i> <i>a</i> <i>b</i> <i>c</i>)  ≡ (cond (<i>p</i> <i>a</i> <i>b</i> <i>c</i>))</td></tr></table>
<!--l. 2699--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(when <i>p</i> <i>a</i> <i>b</i> <i>c</i>)  ≡ (if <i>p</i> (progn <i>a</i> <i>b</i> <i>c</i>) <a 
href="clmse31.html#x42-70002r19">nil</a>)</td></tr></table>
<!--l. 2700--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(when <i>p</i> <i>a</i> <i>b</i> <i>c</i>)  ≡ (unless (not <i>p</i>) <i>a</i> <i>b</i> <i>c</i>)</td></tr></table>
<!--l. 2702--><p class="indent" >
</div>
</div>
<!--l. 2703--><p class="noindent" >As a matter of style, <a 
href="clmse141.html#x172-248004r877">when</a> is normally used to conditionally produce some side
eﬀects, and the value of the <a 
href="clmse141.html#x172-248004r877">when</a> form is normally not used. If the value
is relevant, then it may be stylistically more appropriate to use <a 
href="clmse34.html#x45-75004r51">and</a> or
<a 
href="clmse141.html#x172-248002r876">if</a>.
</div>
<div class=defmac>
<!--l. 2711--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> unless </b> <a 
 id="dx52-84005"></a><a 
 id="x52-84006r97"></a>   test  {<i>form</i>}∗
</td></tr></table>
<!--l. 2712--><p class="indent" >
                                                                          

                                                                          
</div>
   <i>(unless <i>test</i> <i>form1</i> <i>form2</i> ... )</i> ﬁrst evaluates <i>test</i>. If the result is <i>not</i> <a 
href="clmse31.html#x42-70002r19">nil</a>, then
the <i>form</i>s are not evaluated, and <a 
href="clmse31.html#x42-70002r19">nil</a> is returned. Otherwise the <i>form</i>s constitute
an implicit <a 
href="clmse38.html#x50-82002r80">progn</a> and are evaluated sequentially from left to right, and the value
of the last one is returned. <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(unless <i>p</i> <i>a</i> <i>b</i> <i>c</i>)  ≡ (cond ((not <i>p</i>) <i>a</i> <i>b</i> <i>c</i>))
</td></tr></table>
<!--l. 2720--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(unless <i>p</i> <i>a</i> <i>b</i> <i>c</i>)  ≡ (if <i>p</i> <a 
href="clmse31.html#x42-70002r19">nil</a> (progn <i>a</i> <i>b</i> <i>c</i>))</td></tr></table>
<!--l. 2721--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(unless <i>p</i> <i>a</i> <i>b</i> <i>c</i>)  ≡ (when (not <i>p</i>) <i>a</i> <i>b</i> <i>c</i>)</td></tr></table>
<!--l. 2723--><p class="indent" >
</div>
</div>
<!--l. 2724--><p class="noindent" >As a matter of style, <a 
href="clmse141.html#x172-248006r878">unless</a> is normally used to conditionally produce some
side eﬀects, and the value of the <a 
href="clmse141.html#x172-248006r878">unless</a> form is normally not used. If the
value is relevant, then it may be stylistically more appropriate to use
<a 
href="clmse141.html#x172-248002r876">if</a>.
</div>
<div class=defmac>
<!--l. 2732--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> cond </b> <a 
 id="dx52-84007"></a><a 
 id="x52-84008r98"></a>   {<i>(test{<i>form</i>}∗ )</div> }∗
</td></tr></table>
<!--l. 2733--><p class="indent" >
</div>
   A <a 
href="#x52-84008r98">cond</a> form has a number (possibly zero) of <i>clauses</i>, which are lists of forms.
Each clause consists of a <i>test</i> followed by zero or more <i>consequents</i>. For example: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(cond (<i>test-1</i> <i>consequent-1-1</i> <i>consequent-1-2</i> ...)
</td></tr></table>
<!--l. 2740--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (<i>test-2</i>)</td></tr></table>
<!--l. 2741--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (<i>test-3</i> <i>consequent-3-1</i> ...)</td></tr></table>
<!--l. 2742--><p class="indent" >                                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      ... )</td></tr></table>
<!--l. 2744--><p class="indent" >
                                                                          

                                                                          
</div>
</div>
<!--l. 2746--><p class="noindent" >The ﬁrst clause whose <i>test</i> evaluates to non-<a 
href="clmse31.html#x42-70002r19">nil</a> is selected; all other clauses are
ignored, and the consequents of the selected clause are evaluated in order (as an
implicit <a 
href="clmse38.html#x50-82002r80">progn</a>).
<!--l. 2750--><p class="indent" >   More speciﬁcally, <a 
href="#x52-84008r98">cond</a> processes its clauses in order from left to right. For
each clause, the <i>test</i> is evaluated. If the result is <a 
href="clmse31.html#x42-70002r19">nil</a>, <a 
href="#x52-84008r98">cond</a> advances to the next
clause. Otherwise, the <i>cdr</i> of the clause is treated as a list of forms, or
consequents; these forms are evaluated in order from left to right, as an
implicit <a 
href="clmse38.html#x50-82002r80">progn</a>. After evaluating the consequents, <a 
href="#x52-84008r98">cond</a> returns without
inspecting any remaining clauses. The <a 
href="#x52-84008r98">cond</a> special form returns the results of
evaluating the last of the selected consequents; if there were no consequents
in the selected clause, then the single (and necessarily non-null) value
of the <i>test</i> is returned. If <a 
href="#x52-84008r98">cond</a> runs out of clauses (every test produced
<a 
href="clmse31.html#x42-70002r19">nil</a>, and therefore no clause was selected), the value of the <a 
href="#x52-84008r98">cond</a> form is
<a 
href="clmse31.html#x42-70002r19">nil</a>.
<!--l. 2766--><p class="indent" >   If it is desired to select the last clause unconditionally if all others fail, the
standard convention is to use <a 
href="clmse31.html#x42-70004r20">t</a> for the <i>test</i>. As a matter of style, it is desirable to
write a last clause <i>(<a 
href="clmse31.html#x42-70004r20">t</a> <a 
href="clmse31.html#x42-70002r19">nil</a>)</i> if the value of the <a 
href="#x52-84008r98">cond</a> form is to be used for something.
Similarly, it is in questionable taste to let the last clause of a <a 
href="#x52-84008r98">cond</a> be a “singleton
clause”; an explicit <a 
href="clmse31.html#x42-70004r20">t</a> should be provided. (Note moreover that <i>(cond ... (<i>x</i>))</i> may
behave diﬀerently from <i>(cond ... (<a 
href="clmse31.html#x42-70004r20">t</a> <i>x</i>))</i> if <i>x</i> might produce multiple values; the
former always returns a single value, whereas the latter returns whatever values
<i>x</i> returns. However, as a matter of style it is preferable to obtain this
behavior by writing <i>(cond ... (t (values <i>x</i>)))</i>, using the <a 
href="clmse44.html#x56-94002r121">values</a> function
explicitly to indicate the discarding of any excess values.) For example: <div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:427;" 
class="tabbing">(setq z (cond (a &#x2019;foo) (b &#x2019;bar)))                                </td><td  
class="tabbing">;Possibly confusing
</td></tr></table>
<!--l. 2783--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:427;" 
class="tabbing">(setq z (cond (a &#x2019;foo) (b &#x2019;bar) (<a 
href="clmse31.html#x42-70004r20">t</a> <a 
href="clmse31.html#x42-70002r19">nil</a>)))                       </td><td  
class="tabbing">;Better</td></tr></table>
<!--l. 2784--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:427;" 
class="tabbing">(cond (a b) (c d) (e))                                             </td><td  
class="tabbing">;Possibly confusing</td></tr></table>
<!--l. 2785--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:427;" 
class="tabbing">(cond (a b) (c d) (<a 
href="clmse31.html#x42-70004r20">t</a> e))                                           </td><td  
class="tabbing">;Better</td></tr></table>
<!--l. 2786--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:427;" 
class="tabbing">(cond (a b) (c d) (<a 
href="clmse31.html#x42-70004r20">t</a> (values e)))                               </td><td  
class="tabbing">;Better (if one value</td></tr></table>
<!--l. 2787--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:427;" 
class="tabbing">                                                                         </td><td  
class="tabbing">; needed)</td></tr></table>
                                                                          

                                                                          
<!--l. 2788--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:427;" 
class="tabbing">(cond (a b) (c))                                                    </td><td  
class="tabbing">;Possibly confusing</td></tr></table>
<!--l. 2789--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:427;" 
class="tabbing">(cond (a b) (t c))                                                  </td><td  
class="tabbing">;Better</td></tr></table>
<!--l. 2790--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:427;" 
class="tabbing">(if a b c)                                                             </td><td  
class="tabbing">;Also better</td></tr></table>
<!--l. 2792--><p class="indent" >
</div>
</div>
<!--l. 2793--><p class="noindent" >A Lisp <a 
href="#x52-84008r98">cond</a> form may be compared to a continued <b>if</b>-<b>then</b>-<b>else</b> as found in many
algebraic programming languages: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:185;" 
class="tabbing">(cond (<i>p</i> ...)                </td><td style="width:195;" 
class="tabbing">                                 </td><td  
class="tabbing"><b>if</b> <i>p</i> <b>then</b> ...
</td></tr></table>
<!--l. 2797--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:185;" 
class="tabbing">      (<i>q</i> ...)               </td><td style="width:195;" 
class="tabbing">    roughly                   </td><td  
class="tabbing"><b>else</b> <b>if</b> <i>q</i> <b>then</b> ...</td></tr></table>
<!--l. 2798--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:185;" 
class="tabbing">      (<i>r</i> ...)               </td><td style="width:195;" 
class="tabbing"> corresponds                </td><td  
class="tabbing"><b>else</b> <b>if</b> <i>r</i> <b>then</b> ...</td></tr></table>
<!--l. 2799--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:185;" 
class="tabbing">      ...                    </td><td style="width:195;" 
class="tabbing">        to                       </td><td  
class="tabbing">...</td></tr></table>
<!--l. 2800--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:185;" 
class="tabbing">      (<a 
href="clmse31.html#x42-70004r20">t</a> ...))              </td><td style="width:195;" 
class="tabbing">                                 </td><td  
class="tabbing"><b>else</b> ...</td></tr></table>
<!--l. 2802--><p class="indent" >
</div>
</div>
<div class=defmac>
   <div class=tabbing>
   )
</div> }∗
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> case </b> <a 
 id="dx52-84009"></a><a 
 id="x52-84010r99"></a>   keyform  {<i>( {<i>( {<i>key</i>}∗ ) | key</div> }{<i>form</i>}∗
</td></tr></table>
<!--l. 2807--><p class="indent" >
</div>
   <a 
href="#x52-84010r99">case</a> is a conditional that chooses one of its clauses to execute by comparing a
value to various constants, which are typically keyword symbols, integers, or
characters (but may be any objects). Its form is as follows: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(case <i>keyform</i>
</td></tr></table>
<!--l. 2813--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (<i>keylist-1</i> <i>consequent-1-1</i> <i>consequent-1-2</i> ...)</td></tr></table>
                                                                          

                                                                          
<!--l. 2814--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (<i>keylist-2</i> <i>consequent-2-1</i> ...)</td></tr></table>
<!--l. 2815--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (<i>keylist-3</i> <i>consequent-3-1</i> ...)</td></tr></table>
<!--l. 2816--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 2818--><p class="indent" >
</div>
</div>
<!--l. 2819--><p class="noindent" >Structurally <a 
href="#x52-84010r99">case</a> is much like <a 
href="#x52-84008r98">cond</a>, and it behaves like <a 
href="#x52-84008r98">cond</a> in selecting one clause
and then executing all consequents of that clause. However, <a 
href="#x52-84010r99">case</a> diﬀers in the
mechanism of clause selection.
<!--l. 2824--><p class="indent" >   The ﬁrst thing <a 
href="#x52-84010r99">case</a> does is to evaluate the form <i>keyform</i> to produce an
object called the <i>key object</i>. Then <a 
href="#x52-84010r99">case</a> considers each of the clauses in
turn. If <i>key</i> is in the <i>keylist</i> (that is, is <a 
href="clmse33.html#x44-74004r47">eql</a> to any item in the <i>keylist</i>) of a
clause, the consequents of that clause are evaluated as an implicit <a 
href="clmse38.html#x50-82002r80">progn</a>;
<a 
href="#x52-84010r99">case</a> returns what was returned by the last consequent (or <a 
href="clmse31.html#x42-70002r19">nil</a> if there
are no consequents in that clause). If no clause is satisﬁed, <a 
href="#x52-84010r99">case</a> returns
<a 
href="clmse31.html#x42-70002r19">nil</a>.
<!--l. 2835--><p class="indent" >   The keys in the keylists are <i>not</i> evaluated; literal key values must appear in
the keylists. It is an error for the same key to appear in more than one clause; a
consequence is that the order of the clauses does not aﬀect the behavior of the
<a 
href="#x52-84010r99">case</a> construct.
<!--l. 2841--><p class="indent" >   Instead of a <i>keylist</i>, one may write one of the symbols <a 
href="clmse31.html#x42-70004r20">t</a> and otherwise. A
clause with such a symbol always succeeds and must be the last clause (this is an
exception to the order-independence of clauses). See also <a 
href="clmse155.html#x189-337006r996">ecase</a> and <a 
href="clmse155.html#x189-337008r997">ccase</a>, each of
which provides an implicit otherwise clause to signal an error if no clause is
satisﬁed.
<!--l. 2849--><p class="indent" >   If there is only one key for a clause, then that key may be written in place of a
list of that key, provided that no ambiguity results. Such a “singleton key” may
not be <a 
href="clmse31.html#x42-70002r19">nil</a> (which is confusable with <i>(</i><i>)</i>, a list of no keys), <a 
href="clmse31.html#x42-70004r20">t</a>, otherwise, or a
cons.
<div class=incompatibility>
<!--l. 2855--><p class="noindent" ><b>Compatibility note:</b> The Lisp Machine Lisp caseq construct uses <a 
href="clmse33.html#x44-74002r46">eq</a> for the
comparison. In Lisp Machine Lisp caseq therefore works for ﬁxnums but not bignums.
The MacLisp caseq construct simply prohibits the use of bignums; indeed, it permits
only ﬁxnums and symbols as clause keys. In the interest of hiding the ﬁxnum-bignum
distinction, and for general language consistency, <a 
href="#x52-84010r99">case</a> uses <a 
href="clmse33.html#x44-74004r47">eql</a> in Common
Lisp.
<!--l. 2866--><p class="indent" >   The Interlisp selectq construct is similar to <a 
href="#x52-84010r99">case</a>.
</div>
                                                                          

                                                                          
<div class=defmac>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Macro]</i><b> typecase </b> <a 
 id="dx52-84011"></a><a 
 id="x52-84012r100"></a>   keyform  {<i>(type{<i>form</i>}∗ )</div> }∗
</td></tr></table>
<!--l. 2873--><p class="indent" >
</div>
   <a 
href="#x52-84012r100">typecase</a> is a conditional that chooses one of its clauses by examining the type
of an object. Its form is as follows: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(typecase <i>keyform</i>
</td></tr></table>
<!--l. 2878--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (<i>type-1</i> <i>consequent-1-1</i> <i>consequent-1-2</i> ...)</td></tr></table>
<!--l. 2879--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (<i>type-2</i> <i>consequent-2-1</i> ...)</td></tr></table>
<!--l. 2880--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (<i>type-3</i> <i>consequent-3-1</i> ...)</td></tr></table>
<!--l. 2881--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 2883--><p class="indent" >
</div>
</div>
<!--l. 2884--><p class="noindent" >Structurally <a 
href="#x52-84012r100">typecase</a> is much like <a 
href="#x52-84008r98">cond</a> or <a 
href="#x52-84010r99">case</a>, and it behaves like them in selecting
one clause and then executing all consequents of that clause. It diﬀers in the
mechanism of clause selection.
<!--l. 2889--><p class="indent" >   The ﬁrst thing <a 
href="#x52-84012r100">typecase</a> does is to evaluate the form <i>keyform</i> to produce an
object called the key object. Then <a 
href="#x52-84012r100">typecase</a> considers each of the clauses in turn.
The <i>type</i> that appears in each clause is a type speciﬁer; it is not evaluated but is a
literal type speciﬁer. The ﬁrst clause for which the key is of that clause&#x2019;s speciﬁed
<i>type</i> is selected, the consequents of this clause are evaluated as an implicit <a 
href="clmse38.html#x50-82002r80">progn</a>,
and <a 
href="#x52-84012r100">typecase</a> returns what was returned by the last consequent (or <a 
href="clmse31.html#x42-70002r19">nil</a> if there are
no consequents in that clause). If no clause is satisﬁed, <a 
href="#x52-84012r100">typecase</a> returns
<a 
href="clmse31.html#x42-70002r19">nil</a>.
<!--l. 2903--><p class="indent" >   As for <a 
href="#x52-84010r99">case</a>, the symbol <a 
href="clmse31.html#x42-70004r20">t</a> or otherwise may be written for <i>type</i> to indicate that
the clause should always be selected. See also <a 
href="clmse155.html#x189-337002r994">etypecase</a> and <a 
href="clmse155.html#x189-337004r995">ctypecase</a>, each of
which provides an implicit otherwise clause to signal an error if no clause is
satisﬁed.
<!--l. 2909--><p class="indent" >   It is permissible for more than one clause to specify a given type, particularly
if one is a subtype of another; the earliest applicable clause is chosen. Thus for
                                                                          

                                                                          
<a 
href="#x52-84012r100">typecase</a>, unlike <a 
href="#x52-84010r99">case</a>, the order of the clauses may aﬀect the behavior of the
construct. For example: <div class=lisp> <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(typecase an-object
</td></tr></table>
<!--l. 2916--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:278;" 
class="tabbing">   (string ...)                             </td><td  
class="tabbing">;This clause handles strings</td></tr></table>
<!--l. 2917--><p class="indent" >     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:278;" 
class="tabbing">   ((array t) ...)                          </td><td  
class="tabbing">;This clause handles general arrays</td></tr></table>
<!--l. 2918--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:278;" 
class="tabbing">   ((array bit) ...)                       </td><td  
class="tabbing">;This clause handles bit arrays</td></tr></table>
<!--l. 2919--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:278;" 
class="tabbing">   (array ...)                              </td><td  
class="tabbing">;This handles all other arrays</td></tr></table>
<!--l. 2920--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:278;" 
class="tabbing">   ((or list number) ...)                </td><td  
class="tabbing">;This handles lists and numbers</td></tr></table>
<!--l. 2921--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:278;" 
class="tabbing">   (t ...))                                   </td><td  
class="tabbing">;This handles all other objects</td></tr></table>
<!--l. 2923--><p class="indent" >
</div>
</div>
<!--l. 2924--><p class="noindent" >A Common Lisp compiler may choose to issue a warning if a clause cannot be
selected because it is completely shadowed by earlier clauses.
                                                                          

                                                                          
   <!--l. 2929--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse41.html" >Next</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse39.html" >Prev</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse39.html#tailclmse39.html" >PrevTail</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse40.html" >Front</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch7.html#clmse40.html" >Up</a><tt>&#x003E;</tt></p></div>
<!--l. 2929--><p class="indent" >   <a 
 id="tailclmse40.html"></a>  
</body></html> 
