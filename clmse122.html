<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>How the Loop Facility Works</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-04-06 02:07:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="cltl2ed.css"></head><body 
>
<!--l. 48--><p class="noindent" > <div id="main_container"> <div id="content"> <!--l. 48--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse123.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse121.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse121.html#tailclmse121.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse122.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch25.html#clmse122.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">25.2   </span> <a 
href="clm.html#QQ2-152-339" id="x152-29900025.2">How the Loop Facility Works</a></h3>
<!--l. 50--><p class="noindent" >The driving element of the Loop Facility is the <tt><a 
href="clmse41.html#x53-117002r90">loop</a></tt> macro. When Lisp
encounters a <tt><a 
href="clmse41.html#x53-117002r90">loop</a></tt> macro call form, it invokes the Loop Facility and passes to it
the loop clauses as a list of unevaluated forms, as with any macro. The loop
clauses contain Common Lisp forms and loop keywords. The loop keywords are
recognized by their symbol name, regardless of the packages that contain them.
The <tt><a 
href="clmse41.html#x53-117002r90">loop</a></tt> macro translates the given form into Common Lisp code and returns
the expanded form.
<!--l. 59--><p class="indent" >   The expanded loop form is one or more lambda-expressions for the local
binding of loop variables and a block and a tagbody that express a looping control
structure. The variables established in the loop construct are bound as if
by using <tt><a 
href="clmse38.html#x50-99002r74">let</a></tt> or <tt>lambda</tt>. Implementations can interleave the setting of
initial values with the bindings. However, the assignment of the initial
values is always calculated in the order speciﬁed by the user. A variable
is thus sometimes bound to a harmless value of the correct data type,
and then later in the prologue it is set to the true initial value by using
<tt><a 
href="clmse34.html#x46-86002r59">setq</a></tt>.
<!--l. 70--><p class="indent" >   The expanded form consists of three basic parts in the tagbody:
      <ul class="itemize1">
      <li class="itemize">The <i>loop prologue</i> contains forms that are executed before iteration
      begins, such as initial settings of loop variables and possibly an initial
      termination test.
      </li>
      <li class="itemize">The <i>loop body</i> contains those forms that are executed during iteration,
      including  application-speciﬁc  calculations,  termination  tests,  and
      variable stepping. <i>Stepping</i> is the process of assigning a variable the
      next item in a series of items.
      </li>
                                                                          

                                                                          
      <li class="itemize">The  <i>loop  epilogue</i>  contains  forms  that  are  executed  after  iteration
      terminates, such as code to return values from the loop.</li></ul>
<!--l. 91--><p class="indent" >   Expansion of the <tt><a 
href="clmse41.html#x53-117002r90">loop</a></tt> macro produces an implicit block (named <tt><a 
href="clmse30.html#x41-73002r18">nil</a></tt>). Thus,
the Common Lisp macro <tt><a 
href="clmse131.html#x161-330002r798">return</a></tt> and the special form <tt><a 
href="clmse40.html#x52-113002r88">return-from</a></tt> can be used
to return values from a loop or to exit a loop.
<!--l. 97--><p class="indent" >   Within the executable parts of loop clauses and around the entire loop
form, you can still bind variables by using the Common Lisp special form
<tt><a 
href="clmse38.html#x50-99002r74">let</a></tt>.
                                                                          

                                                                          
   <!--l. 103--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmse123.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse121.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse121.html#tailclmse121.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse122.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch25.html#clmse122.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 103--><p class="indent" >   <a 
 id="tailclmse122.html"></a>  </div> </div> 
</body></html> 
