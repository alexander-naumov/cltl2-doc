<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Functions in the Programmer Interface</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,index=2,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-03-19 15:57:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
</head><body 
>
   <!--l. 2841--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch29.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse145.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse145.html#tailclmse145.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="#tailclmse146.html">В-конец</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch28.html#clmse146.html" >Вверх</a><tt>&#x003E;</tt></p></div>
   <h3 class="sectionHead"><span class="titlemark">28.2   </span> <a 
href="clm.html#QQ2-179-450" id="x179-41200028.2">Functions in the Programmer Interface</a></h3>
<!--l. 2844--><p class="noindent" >This section describes the functions, macros, special forms, and generic functions
provided by the Common Lisp Object System Programmer Interface. The
Programmer Interface comprises the functions and macros that are suﬃcient for
writing most object-oriented programs.
<!--l. 2849--><p class="indent" >   This section is reference material that requires an understanding of the basic
concepts of the Common Lisp Object System. The functions are arranged in
alphabetical order for convenient reference.
<!--l. 2853--><p class="indent" >   The description of each function, macro, special form, and generic
function includes its purpose, its syntax, the semantics of its arguments and
returned values, and often an example and cross-references to related
functions.
<!--l. 2858--><p class="indent" >   The syntax description for a function, macro, or special form describes its
parameters. The description of a generic function includes descriptions of the
methods that are deﬁned on that generic function by the Common Lisp Object
System. A <i>method signature</i> is used to describe the parameters and parameter
specializers for each method.
<!--l. 2865--><p class="indent" >   The following is an example of the format for the syntax description of a
generic function with the method signature for one primary method:
<div class=defun>
<!--l. 2869--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-412001"></a><a 
 id="x179-412002r862"></a><b> f</b>  <i>x</i> <i>y</i> &#x0026;optional  <i>z</i> &#x0026;key  <i>:k</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-412003"></a><a 
 id="x179-412004r863"></a><b> f</b>  (<i>x</i> class) (<i>y</i> t) &#x0026;optional  <i>z</i> &#x0026;key  <i>:k</i>
<!--l. 2872--><p class="noindent" >This description indicates that the generic function <a 
href="#x179-412004r863">f</a> has two required parameters,
<i>x</i> and <i>y</i>. In addition, there is an optional parameter <i>z</i> and a keyword parameter
:k.
<!--l. 2877--><p class="indent" >   The method signature indicates that this method on the generic function <a 
href="#x179-412004r863">f</a> has
two required parameters, <i>x</i>, which must be an instance of the class class, and <i>y</i>,
which can be any object. In addition, there is an optional parameter <i>z</i> and a
keyword parameter :k. The signature also indicates that this method on <a 
href="#x179-412004r863">f</a> is a
primary method and has no qualiﬁers.
<!--l. 2884--><p class="indent" >   The syntax description for a generic function describes the lambda-list of the
                                                                          

                                                                          
generic function itself, while the method signatures describe the lambda-lists of
the deﬁned methods.
<!--l. 2888--><p class="indent" >   The generic functions described in this book are all standard generic functions.
They all use standard method combination.
<!--l. 2891--><p class="indent" >   Any implementation of the Common Lisp Object System is allowed to provide
additional methods on the generic functions described here.
<!--l. 2895--><p class="indent" >   It is useful to categorize the functions and macros according to their role in
this standard:
</div>
      <ul class="itemize1">
      <li class="itemize"><i>Tools used for simple object-oriented programming</i>
      <!--l. 2903--><p class="noindent" >These  tools  allow  for  deﬁning  new  classes,  methods,  and  generic
      functions and for making instances. Some tools used within method
      bodies  are  also  listed  here.  Some  of  the  macros  listed  here  have  a
      corresponding function that performs the same task at a lower level of
      abstraction.
      <div class="flushleft" 
>
<!--l. 2909--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" >call-next-method           </td><td align="left" ><a 
href="#x179-420004r908">initialize-instance</a>    </td></tr><tr><td align="left" ><a 
href="#x179-413008r870">change-class</a> </td> <td align="left" ><a 
href="#x179-420012r912">make-instance</a></td>
</tr><tr><td align="left" ><a 
href="#x179-413022r877">defclass</a>                              </td><td align="left" ><a 
href="#x179-420026r919">next-method-p</a>       </td>
</tr><tr><td align="left" ><a 
href="#x179-414002r878">defgeneric</a>                          </td><td align="left" ><a 
href="#x179-420053r932">slot-boundp</a>           </td>
</tr><tr><td align="left" ><a 
href="#x179-416002r881">defmethod</a>                          </td><td align="left" ><a 
href="#x179-420067r939">slot-value</a>              </td></tr><tr><td align="left" ><a 
href="#x179-417048r904">generic-ﬂet</a> </td> <td align="left" ><a 
href="#x179-420077r944">with-accessors</a></td>
</tr><tr><td align="left" ><a 
href="#x179-418002r905">generic-function</a>                   </td><td align="left" ><a 
href="#x179-421004r945">with-added-methods</a></td>
</tr><tr><td align="left" ><a 
href="#x179-419002r906">generic-labels</a>                      </td><td align="left" ><a 
href="#x179-422002r946">with-slots</a>              </td></tr></table>
</div></div>
      </li>
      <li class="itemize"><i>Functions underlying the commonly used macros</i>
      <div class="flushleft" 
>
<!--l. 2926--><p class="noindent" >
                                                                          

                                                                          
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" ><a 
href="#x179-412009r865">add-method</a>                      </td><td align="left" ><a 
href="#x179-420043r927">reinitialize-instance</a>                    </td></tr><tr><td align="left" ><a 
href="#x179-413012r872">class-name</a> </td> <td align="left" ><a 
href="#x179-420047r929">remove-method</a></td>
</tr><tr><td align="left" ><a 
href="#x179-413020r876">compute-applicable-methods</a></td><td align="left" ><a 
href="#x179-420051r931">shared-initialize</a>                         </td>
</tr><tr><td align="left" ><a 
href="#x179-417035r898">ensure-generic-function</a>       </td><td align="left" ><a 
href="#x179-420055r933">slot-exists-p</a>                              </td>
</tr><tr><td align="left" ><a 
href="#x179-417038r899">ﬁnd-class</a>                         </td><td align="left" ><a 
href="#x179-420057r934">slot-makunbound</a>                      </td></tr><tr><td align="left" ><a 
href="#x179-417042r901">ﬁnd-method</a> </td> <td align="left" ><a 
href="#x179-420061r936">slot-missing</a></td>
</tr><tr><td align="left" ><a 
href="#x179-417046r903">function-keywords</a>              </td><td align="left" ><a 
href="#x179-420065r938">slot-unbound</a>                            </td>
</tr><tr><td align="left" ><a 
href="#x179-420018r915">make-instances-obsolete</a>      </td><td align="left" >update-instance-for-diﬀerent-class </td>
</tr><tr><td align="left" ><a 
href="#x179-420030r921">no-applicable-method</a>         </td><td align="left" >update-instance-for-redeﬁned-class</td>
</tr><tr><td align="left" ><a 
href="#x179-420034r923">no-next-method</a>                 </td><td align="left" >                                             </td></tr></table>
</div></div>
      </li>
      <li class="itemize"><i>Tools for declarative method combination</i>
      <div class="flushleft" 
>
<!--l. 2945--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" ><a 
href="#x179-412011r866">call-method</a>                       </td><td align="left" ><a 
href="#x179-420020r916">method-combination-error</a></td></tr><tr><td align="left" >deﬁne-method-combination  </td> <td align="left" ><a 
href="#x179-420024r918">method-qualiﬁers</a></td>
</tr><tr><td align="left" ><a 
href="#x179-420006r909">invalid-method-error</a>            </td><td align="left" >                                  </td></tr></table>
</div></div>
      </li>
      <li class="itemize"><i>General Common Lisp support tools</i>
      <div class="flushleft" 
>
<!--l. 2957--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%"><tr><td align="left" ><a 
href="#x179-413018r875">class-of</a>                                </td><td align="left" ><a 
href="#x179-420038r925">print-object</a>      </td>
</tr><tr><td align="left" >documentation              </td><td align="left" ><a 
href="clmse39.html#x51-104002r80">symbol-macrolet</a></td></tr></table>
</div></div>
      <!--l. 2965--><p class="noindent" >[Note that <a 
href="clmse124.html#x154-305006r771">describe</a> appeared in this list in the original CLOS proposal
      <span class="cite">[<a 
href="clmli5.html#XSIGPLAN-CLOS">5</a>, <a 
href="clmli5.html#XLASC-CLOS-PART-2">7</a>]</span>, but X3J13 voted in March 1989 <a 
 id="dx179-412005"></a>not to make <a 
href="clmse124.html#x154-305006r771">describe</a> a generic
      function after all (see <a 
href="clmse124.html#x154-305011r773">describe-object</a>).—GLS]</li></ul>
<!--l. 2971--><p class="noindent" >[At this point the original CLOS report contained a description of the [[<i> </i>]] and <span class="math"> ↓</span><i></i>
notation; that description is omitted here. I have adopted the notation for use
throughout this book. It is described in section <a 
href="clmse2.html#x8-140001.2.5">1.2.5<!--tex4ht:ref: FUNCTION-HEADER-NOTATION-SECTION --></a>.—GLS]
<div class=defun>
                                                                          

                                                                          
<!--l. 2978--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-412006"></a><a 
 id="x179-412007r864"></a><b> add-method</b>  <i>generic-function</i> <i>method</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-412008"></a><a 
 id="x179-412009r865"></a><b> add-method</b>  (<i>generic-function</i> standard-generic-function)
(<i>method</i> method)
<!--l. 2981--><p class="noindent" >The generic function <a 
href="#x179-412009r865">add-method</a> adds a method to a generic function. It
destructively modiﬁes the generic function and returns the modiﬁed generic
function as its result.
<!--l. 2987--><p class="indent" >   The <i>generic-function</i> argument is a generic function object.
<!--l. 2990--><p class="indent" >   The <i>method</i> argument is a method object. The lambda-list of the method
function must be congruent with the lambda-list of the generic function, or an
error is signaled.
<!--l. 2995--><p class="indent" >   The modiﬁed generic function is returned. The result of <a 
href="#x179-412009r865">add-method</a> is <a 
href="clmse33.html#x44-78002r44">eq</a> to
the <i>generic-function</i> argument.
<!--l. 2999--><p class="indent" >   If the given method agrees with an existing method of the generic function on
parameter specializers and qualiﬁers, the existing method is replaced. See
section <a 
href="clmse145.html#x178-38100028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> for a deﬁnition of agreement in this context.
<!--l. 3004--><p class="indent" >   If the method object is a method object of another generic function, an error is
signaled.
<!--l. 3007--><p class="indent" >   See section <a 
href="clmse145.html#x178-38100028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> as well as <a 
href="#x179-416002r881">defmethod</a>, <a 
href="#x179-414002r878">defgeneric</a>, <a 
href="#x179-417042r901">ﬁnd-method</a>, and
<a 
href="#x179-420047r929">remove-method</a>.
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> call-method </b><a 
 id="dx179-412010"></a><a 
 id="x179-412011r866"></a> method next-method-list
</td></tr></table>
<!--l. 3018--><p class="indent" >
</div>
<!--l. 3018--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-41300028.2" id="x179-41300028.2"></a></span>
   The macro <a 
href="#x179-412011r866">call-method</a> is used in method combination. This macro hides the
implementation-dependent details of how methods are called. It can be used only
within an eﬀective method form, for the name <a 
href="#x179-412011r866">call-method</a> is deﬁned only within
the lexical scope of such a form.
                                                                          

                                                                          
<!--l. 3024--><p class="indent" >   The macro <a 
href="#x179-412011r866">call-method</a> invokes the speciﬁed method, supplying it with
arguments and with deﬁnitions for <a 
href="#x179-413002r867">call-next-method</a> and for <a 
href="#x179-420026r919">next-method-p</a>. The
arguments are the arguments that were supplied to the eﬀective method form
containing the invocation of <a 
href="#x179-412011r866">call-method</a>. The deﬁnitions of <a 
href="#x179-413002r867">call-next-method</a> and
<a 
href="#x179-420026r919">next-method-p</a> rely on the list of method objects given as the second argument to
<a 
href="#x179-412011r866">call-method</a>.
<!--l. 3032--><p class="indent" >   The <a 
href="#x179-413002r867">call-next-method</a> function available to the method that is the ﬁrst
subform will call the ﬁrst method in the list that is the second subform. The
<a 
href="#x179-413002r867">call-next-method</a> function available in that method, in turn, will call the second
method in the list that is the second subform, and so on, until the list of next
methods is exhausted.
<!--l. 3043--><p class="indent" >   The <i>method</i> argument is a method object; the next-method-list argument is a
list of method objects.
<!--l. 3046--><p class="indent" >   A list whose ﬁrst element is the symbol make-method and whose second
element is a Lisp form can be used instead of a method object as the ﬁrst subform
of <a 
href="#x179-412011r866">call-method</a> or as an element of the second subform of <a 
href="#x179-412011r866">call-method</a>. Such a list
speciﬁes a method object whose method function has a body that is the given
form.
<!--l. 3053--><p class="indent" >   The result of <a 
href="#x179-412011r866">call-method</a> is the value or values returned by the method
invocation.
<!--l. 3056--><p class="indent" >   See <a 
href="#x179-413002r867">call-next-method</a>, <a 
href="#x179-415005r880">deﬁne-method-combination</a>, and <a 
href="#x179-420026r919">next-method-p</a>.
</div>
<div class=defun>
<!--l. 3060--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-413001"></a><a 
 id="x179-413002r867"></a><b> call-next-method</b>  &#x0026;rest  <i>args</i>
<!--l. 3062--><p class="noindent" >The function <a 
href="#x179-413002r867">call-next-method</a> can be used within the body of a method deﬁned
by a method-deﬁning form to call the next method.
<!--l. 3066--><p class="indent" >   The function <a 
href="#x179-413002r867">call-next-method</a> returns the value or values returned by the
method it calls. If there is no next method, the generic function <a 
href="#x179-420034r923">no-next-method</a> is
called.
<!--l. 3070--><p class="indent" >   The type of method combination used determines which methods
can invoke <a 
href="#x179-413002r867">call-next-method</a>. The standard method combination type
allows call-next-method to be used within primary methods and :around
methods.
<!--l. 3076--><p class="indent" >   The standard method combination type deﬁnes the next method according to
the following rules:
      <ul class="itemize1">
                                                                          

                                                                          
      <li class="itemize">If <a 
href="#x179-413002r867">call-next-method</a> is used in an :around method, the next method is
      the next most speciﬁc :around method, if one is applicable.
      </li>
      <li class="itemize">If there are no :around methods at all or if <a 
href="#x179-413002r867">call-next-method</a> is called by
      the least speciﬁc :around method, other methods are called as follows:
           <ul class="itemize2">
           <li class="itemize">All the :before methods are called, in most-speciﬁc-ﬁrst order. The
           function <a 
href="#x179-413002r867">call-next-method</a> cannot be used in :before methods.
           </li>
           <li class="itemize">The most speciﬁc primary method is called. Inside the body of
           a primary method, <a 
href="#x179-413002r867">call-next-method</a> may be used to pass control
           to the next most speciﬁc primary method. The generic function
           <a 
href="#x179-420034r923">no-next-method</a> is called if <a 
href="#x179-413002r867">call-next-method</a> is used and there are
           no more primary methods.
           </li>
           <li class="itemize">All the :after methods are called in most-speciﬁc-last order. The
           function <a 
href="#x179-413002r867">call-next-method</a> cannot be used in :after methods.</li></ul>
      </li></ul>
<!--l. 3108--><p class="indent" >   For further discussion of the use of <a 
href="#x179-413002r867">call-next-method</a>, see sections <a 
href="clmse145.html#x178-38600028.1.7">28.1.7<!--tex4ht:ref: Standard-Method-Combination-SECTION --></a>
and <a 
href="clmse145.html#x178-38800028.1.7">28.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a>.
<!--l. 3115--><p class="indent" >   When <a 
href="#x179-413002r867">call-next-method</a> is called with no arguments, it passes the current
method&#x2019;s original arguments to the next method. Neither argument defaulting,
nor using <a 
href="clmse35.html#x47-87002r59">setq</a>, nor rebinding variables with the same names as parameters of
the method aﬀects the values <a 
href="#x179-413002r867">call-next-method</a> passes to the method it
calls.
<!--l. 3121--><p class="indent" >   When <a 
href="#x179-413002r867">call-next-method</a> is called with arguments, the next method is called
with those arguments. When providing arguments to <a 
href="#x179-413002r867">call-next-method</a>, the
following rule must be satisﬁed or an error is signaled: The ordered set of methods
applicable for a changed set of arguments for <a 
href="#x179-413002r867">call-next-method</a> must be the same
as the ordered set of applicable methods for the original arguments to the generic
function. Optimizations of the error checking are possible, but they must not
change the semantics of <a 
href="#x179-413002r867">call-next-method</a>.
<!--l. 3130--><p class="indent" >   If <a 
href="#x179-413002r867">call-next-method</a> is called with arguments but omits optional arguments, the
next method called defaults those arguments.
                                                                          

                                                                          
<!--l. 3135--><p class="indent" >   The function <a 
href="#x179-413002r867">call-next-method</a> returns the value or values returned by the
method it calls.
<!--l. 3139--><p class="indent" >   Further computation is possible after <a 
href="#x179-413002r867">call-next-method</a> returns.
<!--l. 3141--><p class="indent" >   The deﬁnition of the function <a 
href="#x179-413002r867">call-next-method</a> has lexical scope (for it is
deﬁned only within the body of a method deﬁned by a method-deﬁning form) and
indeﬁnite extent.
<!--l. 3145--><p class="indent" >   For generic functions using a type of method combination deﬁned by the short
form of <a 
href="#x179-415005r880">deﬁne-method-combination</a>, <a 
href="#x179-413002r867">call-next-method</a> can be used in :around
methods only.
<!--l. 3149--><p class="indent" >   The function <a 
href="#x179-420026r919">next-method-p</a> can be used to test whether or not there is a next
method.
<!--l. 3152--><p class="indent" >   If <a 
href="#x179-413002r867">call-next-method</a> is used in methods that do not support it, an error is
signaled.
<!--l. 3155--><p class="indent" >   See sections <a 
href="clmse145.html#x178-38400028.1.7">28.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>, <a 
href="clmse145.html#x178-38600028.1.7">28.1.7<!--tex4ht:ref: Standard-Method-Combination-SECTION --></a>, and <a 
href="clmse145.html#x178-38800028.1.7">28.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a> as well as the functions
deﬁne-method-combination, <a 
href="#x179-420026r919">next-method-p</a>, and <a 
href="#x179-420034r923">no-next-method</a>.
</div>
<div class=defun>
<!--l. 3164--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-413003"></a><a 
 id="x179-413004r868"></a><b> change-class</b>  <i>instance</i> <i>new-class</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-413005"></a><a 
 id="x179-413006r869"></a><b> change-class</b>  (<i>instance</i> standard-object) (<i>new-class</i> standard-class)<br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-413007"></a><a 
 id="x179-413008r870"></a><b> change-class</b>  (<i>instance</i> t) (<i>new-class</i> symbol)
<!--l. 3168--><p class="noindent" >The generic function <a 
href="#x179-413008r870">change-class</a> changes the class of an instance to a new class.
It destructively modiﬁes and returns the instance.
<!--l. 3173--><p class="indent" >   If in the old class there is any slot of the same name as a local slot in the new
class, the value of that slot is retained. This means that if the slot has a value, the
value returned by <a 
href="#x179-420067r939">slot-value</a> after <a 
href="#x179-413008r870">change-class</a> is invoked is <a 
href="clmse33.html#x44-78004r45">eql</a> to the value
returned by <a 
href="#x179-420067r939">slot-value</a> before <a 
href="#x179-413008r870">change-class</a> is invoked. Similarly, if the slot was
unbound, it remains unbound. The other slots are initialized as described in
section <a 
href="clmse145.html#x178-40600028.1.11">28.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a>.
<!--l. 3186--><p class="indent" >   The <i>instance</i> argument is a Lisp object.
<!--l. 3188--><p class="indent" >   The <i>new-class</i> argument is a class object or a symbol that names a
class.
<!--l. 3191--><p class="indent" >   If the second of the preceding methods is selected, that method invokes
<a 
href="#x179-413008r870">change-class</a> on <i>instance</i> and (ﬁnd-class <i>new-class</i>).
<!--l. 3196--><p class="indent" >   The modiﬁed instance is returned. The result of <a 
href="#x179-413008r870">change-class</a> is <a 
href="clmse33.html#x44-78002r44">eq</a> to the
<i>instance</i> argument.
<!--l. 3199--><p class="indent" >   Examples:
<div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass position () ())
</td></tr></table>
<!--l. 3202--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3203--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass x-y-position (position)</td></tr></table>
<!--l. 3204--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ((x :initform 0 :initarg :x)</td></tr></table>
<!--l. 3205--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (y :initform 0 :initarg :y)))</td></tr></table>
<!--l. 3206--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3207--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass rho-theta-position (position)</td></tr></table>
<!--l. 3208--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ((rho :initform 0)</td></tr></table>
<!--l. 3209--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (theta :initform 0)))</td></tr></table>
<!--l. 3210--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3211--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod update-instance-for-diﬀerent-class :before</td></tr></table>
<!--l. 3212--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           ((old x-y-position)</td></tr></table>
<!--l. 3213--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            (new rho-theta-position)</td></tr></table>
<!--l. 3214--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            &#x0026;key)</td></tr></table>
<!--l. 3215--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Copy the position information from old to new to make new</td></tr></table>
<!--l. 3216--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; be a rho-theta-position at the same position as old.</td></tr></table>
<!--l. 3217--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((x (slot-value old &#x2019;x))</td></tr></table>
<!--l. 3218--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (y (slot-value old &#x2019;y)))</td></tr></table>
<!--l. 3219--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (setf (slot-value new &#x2019;rho) (sqrt (+ (* x x) (* y y)))</td></tr></table>
<!--l. 3220--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (slot-value new &#x2019;theta) (atan y x))))</td></tr></table>
<!--l. 3222--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; At this point an instance of the class x-y-position can be
</td></tr></table>
<!--l. 3224--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; changed to be an instance of the class rho-theta-position</td></tr></table>
<!--l. 3225--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; using change-class:</td></tr></table>
<!--l. 3226--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3227--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq p1 (make-instance &#x2019;x-y-position :x 2 :y 0))</td></tr></table>
<!--l. 3228--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
                                                                          

                                                                          
<!--l. 3229--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(change-class p1 &#x2019;rho-theta-position)</td></tr></table>
<!--l. 3230--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 3231--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The result is that the instance bound to p1 is now</td></tr></table>
<!--l. 3232--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; an instance of the class rho-theta-position.</td></tr></table>
<!--l. 3233--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The update-instance-for-diﬀerent-class method</td></tr></table>
<!--l. 3234--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; performed the initialization of the rho and theta</td></tr></table>
<!--l. 3235--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; slots based on the values of the x and y slots,</td></tr></table>
<!--l. 3236--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; which were maintained by the old instance.</td></tr></table>
<!--l. 3238--><p class="indent" >
</div>
</div>
<!--l. 3241--><p class="indent" >   After completing all other actions, <a 
href="#x179-413008r870">change-class</a> invokes the generic
function update-instance-for-diﬀerent-class. The generic function
update-instance-for-diﬀerent-class can be used to assign values to slots in the
transformed instance.
<!--l. 3246--><p class="indent" >   The generic function <a 
href="#x179-413008r870">change-class</a> has several semantic diﬃculties. First, it
performs a destructive operation that can be invoked within a method on an
instance that was used to select that method. When multiple methods are
involved because methods are being combined, the methods currently executing or
about to be executed may no longer be applicable. Second, some implementations
might use compiler optimizations of slot access, and when the class of an instance
is changed the assumptions the compiler made might be violated. This
implies that a programmer must not use <a 
href="#x179-413008r870">change-class</a> inside a method if
any methods for that generic function access any slots, or the results are
undeﬁned.
<!--l. 3259--><p class="indent" >   See section <a 
href="clmse145.html#x178-40600028.1.11">28.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a> as well as update-instance-for-diﬀerent-class.
</div>
<div class=defun>
<!--l. 3265--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-413009"></a><a 
 id="x179-413010r871"></a><b> class-name</b>  <i>class</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-413011"></a><a 
 id="x179-413012r872"></a><b> class-name</b>  (<i>class</i> class)
<!--l. 3268--><p class="noindent" >The generic function <a 
href="#x179-413012r872">class-name</a> takes a class object and returns its name. The
<i>class</i> argument is a class object. The <i>new-value</i> argument is any object. The name
of the given class is returned.
<!--l. 3275--><p class="indent" >   The name of an anonymous class is <a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 3277--><p class="indent" >   If <i>S</i> is a symbol such that <i>S</i> <span class="math"> =</span>(class-name <i>C</i>) and <i>C</i> <span class="math"> =</span> (ﬁnd-class <i>S</i>), then
<i>S</i> is the proper name of <i>C</i> (see section <a 
href="clmse145.html#x178-36400028.1.2">28.1.2<!--tex4ht:ref: Classes-SECTION --></a>).
<!--l. 3280--><p class="indent" >   See also section <a 
href="clmse145.html#x178-36400028.1.2">28.1.2<!--tex4ht:ref: Classes-SECTION --></a> and <a 
href="#x179-417038r899">ﬁnd-class</a>.
                                                                          

                                                                          
</div>
<div class=defun>
<!--l. 3284--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-413013"></a><a 
 id="x179-413014r873"></a><b> (setf</b>  <i>class-name)</i> <i>new-value</i> <i>class</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-413015"></a><a 
 id="x179-413016r874"></a><b> (setf</b>  <i>class-name)</i> <i>new-value</i> (<i>class</i> class)
<!--l. 3287--><p class="noindent" >The generic function (setf class-name) takes a class object and sets its name.
The <i>class</i> argument is a class object. The <i>new-value</i> argument is any
object.
</div>
<div class=defun>
<!--l. 3295--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-413017"></a><a 
 id="x179-413018r875"></a><b> class-of</b>  <i>object</i>
<!--l. 3297--><p class="noindent" >The function <a 
href="#x179-413018r875">class-of</a> returns the class of which the given object is an instance.
The argument to <a 
href="#x179-413018r875">class-of</a> may be any Common Lisp object. The function <a 
href="#x179-413018r875">class-of</a>
returns the class of which the argument is an instance.
</div>
<div class=defun>
<!--l. 3307--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-413019"></a><a 
 id="x179-413020r876"></a><b> compute-applicable-methods</b>  <i>generic-function</i> <i>function-arguments</i>
<!--l. 3309--><p class="noindent" >Given a generic function and a set of arguments, the function
compute-applicable-methods returns the set of methods that are applicable for
those arguments.
<!--l. 3314--><p class="indent" >   The methods are sorted according to precedence order. See section <a 
href="clmse145.html#x178-38400028.1.7">28.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>.
<!--l. 3322--><p class="indent" >   The <i>generic-function</i> argument must be a generic function object. The
<i>function-arguments</i> argument is a list of the arguments to that generic function.
The result is a list of the applicable methods in order of precedence. See
section <a 
href="clmse145.html#x178-38400028.1.7">28.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>.
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> defclass </b><a 
 id="dx179-413021"></a><a 
 id="x179-413022r877"></a> class-name ( {superclass-name}* )
</td></tr></table>
<!--l. 3332--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">( {slot-speciﬁer}* )  [[<span class="math"> ↓</span>class-option]] </td></tr></table>
<!--l. 3333--><p class="indent" >
</div>
                                                                          

                                                                          
<!--l. 3333--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-41400028.2" id="x179-41400028.2"></a></span>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>class-name</i> ::= <i>symbol</i>
</td></tr></table>
<!--l. 3335--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>superclass-name</i> ::= <i>symbol</i></td></tr></table>
<!--l. 3336--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>slot-speciﬁer</i> ::= <i>slot-name</i> | (<i>slot-name</i> <span class="math">[[↓slot-option ]]</span>)</td></tr></table>
<!--l. 3338--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>slot-name</i> ::= <i>symbol</i></td></tr></table>
<!--l. 3339--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing"><i>slot-option</i> ::= </td><td  
class="tabbing"> {<i>:reader <i>reader-function-name</i></i>}* </td></tr></table>
<!--l. 3340--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">                    </td><td  
class="tabbing">|  {<i>:writer <i>writer-function-name</i></i>}* </td></tr></table>
<!--l. 3341--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">                    </td><td  
class="tabbing">|  {<i>:accessor <i>reader-function-name</i></i>}* </td></tr></table>
<!--l. 3342--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">                    </td><td  
class="tabbing">|  {<i>:allocation <i>allocation-type</i></i>} </td></tr></table>
<!--l. 3343--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">                    </td><td  
class="tabbing">|  {<i>:initarg <i>initarg-name</i></i>}* </td></tr></table>
<!--l. 3344--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">                    </td><td  
class="tabbing">|  {<i>:initform <i>form</i></i>} </td></tr></table>
<!--l. 3345--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:117;" 
class="tabbing">                    </td><td  
class="tabbing">|  {<i>:type <i>type-speciﬁer</i></i>} </td></tr></table>
<!--l. 3346--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  |  {<i>:documentation <i>string</i></i>}  </td><td  
class="tabbing"></td></tr></table>
<!--l. 3348--><p class="indent" >
</div>
                                                                          

                                                                          
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>reader-function-name</i> ::= <i>symbol</i>
</td></tr></table>
<!--l. 3351--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>writer-function-name</i> ::= <i>function-name/</i></td></tr></table>
<!--l. 3352--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>function-name</i> ::=  {<i><i>symbol</i> | (setf <i>symbol</i>)</i>} </td></tr></table>
<!--l. 3353--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>initarg-name</i> ::= <i>symbol</i></td></tr></table>
<!--l. 3354--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>allocation-type</i> ::= :instance | :class</td></tr></table>
<!--l. 3355--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:127;" 
class="tabbing"><i>class-option</i> ::= </td><td  
class="tabbing">(:default-initargs <i>initarg-list</i>)</td></tr></table>
<!--l. 3356--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:127;" 
class="tabbing">                      </td><td  
class="tabbing">| (:documentation <i>string</i>)</td></tr></table>
<!--l. 3357--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   | (:metaclass <i>class-name</i>) </td><td  
class="tabbing"></td></tr></table>
<!--l. 3358--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>initarg-list</i> ::=  {<i><i>initarg-name default-initial-value-form</i></i>}* </td></tr></table>
<!--l. 3360--><p class="indent" >
</div>
<!--l. 3361--><p class="noindent" >The macro <a 
href="#x179-413022r877">defclass</a> deﬁnes a new named class. It returns the new class object as its
result.
<!--l. 3364--><p class="indent" >   The syntax of <a 
href="#x179-413022r877">defclass</a> provides options for specifying initialization arguments
for slots, for specifying default initialization values for slots, and for requesting
that methods on speciﬁed generic functions be automatically generated for
reading and writing the values of slots. No reader or writer functions are deﬁned
by default; their generation must be explicitly requested.
<!--l. 3371--><p class="indent" >   Deﬁning a new class also causes a type of the same name to be deﬁned. The
predicate (typep <i>object class-name</i>) returns true if the class of the given object is
<i>class-name</i> itself or a subclass of the class <i>class-name</i>. A class object can be used
as a type speciﬁer. Thus (typep <i>object class</i>) returns true if the class of the <i>object</i>
is <i>class</i> itself or a subclass of <i>class</i>.
<!--l. 3383--><p class="indent" >   The <i>class-name</i> argument is a non-<a 
href="clmse31.html#x42-74002r18">nil</a> symbol. It becomes the proper name of
the new class. If a class with the same proper name already exists and that class
is an instance of standard-class, and if the <a 
href="#x179-413022r877">defclass</a> form for the deﬁnition of the
new class speciﬁes a class of class standard-class, the deﬁnition of the existing
class is replaced.
<!--l. 3390--><p class="indent" >   Each <i>superclass-name</i> argument is a non-<a 
href="clmse31.html#x42-74002r18">nil</a> symbol that speciﬁes a direct
superclass of the new class. The new class will inherit slots and methods
from each of its direct superclasses, from their direct superclasses, and
so on. See section <a 
href="clmse145.html#x178-36900028.1.3">28.1.3<!--tex4ht:ref: Inheritance-SECTION --></a> for a discussion of how slots and methods are
inherited.
                                                                          

                                                                          
<!--l. 3397--><p class="indent" >   Each <i>slot-speciﬁer</i> argument is the name of the slot or a list consisting of the
slot name followed by zero or more slot options. The <i>slot-name</i> argument is a
symbol that is syntactically valid for use as a variable name. If there are any
duplicate slot names, an error is signaled.
<!--l. 3403--><p class="indent" >   The following slot options are available:
      <ul class="itemize1">
      <li class="itemize">The :reader slot option speciﬁes that an unqualiﬁed method is to be
      deﬁned on the generic function named reader-function-name to read
      the value of the given slot. The <i>reader-function-name</i> argument is a
      non-<a 
href="clmse31.html#x42-74002r18">nil</a> symbol. The :reader slot option may be speciﬁed more than
      once for a given slot.
      </li>
      <li class="itemize">The  :writer  slot  option  speciﬁes  that  an  unqualiﬁed  method  is  to
      be  deﬁned  on  the  generic  function  named  writer-function-name  to
      write the value of the slot. The <i>writer-function-name</i> argument is a
      function-name. The :writer slot option may be speciﬁed more than once
      for a given slot.
      </li>
      <li class="itemize">The :accessor slot option speciﬁes that an unqualiﬁed method is to be
      deﬁned on the generic function named reader-function-name to read the
      value of the given slot and that an unqualiﬁed method is to be deﬁned
      on the generic function named (setf <i>reader-function-name</i>) to be used
      with <a 
href="clmse36.html#x48-90002r64">setf</a> to modify the value of the slot. The reader-function-name
      argument is a non-<a 
href="clmse31.html#x42-74002r18">nil</a> symbol. The :accessor slot option may be speciﬁed
      more than once for a given slot.
      </li>
      <li class="itemize">The :allocation slot option is used to specify where storage is to be
      allocated for the given slot. Storage for a slot may be located in each
      instance or in the class object itself, for example. The value of the
      allocation-type argument can be either the keyword :instance or the
      keyword :class. The :allocation slot option may be speciﬁed at most
      once for a given slot. If the :allocation slot option is not speciﬁed, the
      eﬀect is the same as specifying :allocation :instance.
                                                                          

                                                                          
           <ul class="itemize2">
           <li class="itemize">If <i>allocation-type</i> is :instance, a local slot of the given name is
           allocated in each instance of the class.
           </li>
           <li class="itemize">If  <i>allocation-type</i> is  :class,  a  shared  slot  of  the  given  name  is
           allocated. The value of the slot is shared by all instances of the
           class. If a class <span class="math">C<sub>1</sub></span> deﬁnes such a shared slot, any subclass <span class="math">C<sub>2</sub></span> of <span class="math">C<sub>1</sub></span>
           will share this single slot unless the <a 
href="#x179-413022r877">defclass</a> form for <span class="math">C<sub>2</sub></span> speciﬁes a
           slot of the same name or there is a superclass of <span class="math">C<sub>2</sub></span> that precedes
           <span class="math">C<sub>1</sub></span> in the class precedence list of <span class="math">C<sub>2</sub></span> and that deﬁnes a slot of the
           same name.</li></ul>
      </li>
      <li class="itemize">The :initform slot option is used to provide a default initial value form to be
      used in the initialization of the slot. The :initform slot option may
      be speciﬁed at most once for a given slot. This form is evaluated
      every time it is used to initialize the slot. The lexical environment in
      which this form is evaluated is the lexical environment in which the
      <a 
href="#x179-413022r877">defclass</a> form was evaluated. Note that the lexical environment refers
      both to variables and to functions. For local slots, the dynamic
      environment is the dynamic environment in which <a 
href="#x179-420012r912">make-instance</a> was
      called; for shared slots, the dynamic environment is the dynamic
      environment in which the <a 
href="#x179-413022r877">defclass</a> form was evaluated. See section
      <a 
href="clmse145.html#x178-39300028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>.
      <!--l. 3472--><p class="noindent" >No implementation is permitted to extend the syntax of <a 
href="#x179-413022r877">defclass</a> to
      allow (<i>slot-name form</i>) as an abbreviation for (<i>slot-name</i> :initform
      <i>form</i>).
      </li>
      <li class="itemize">The :initarg slot option declares an initialization argument named
      <i>initarg-name</i> and speciﬁes that this initialization argument initializes the
      given slot. If the initialization argument has a value in the call to
      <a 
href="#x179-420004r908">initialize-instance</a>, the value will be stored into the given slot, and the slot&#x2019;s
      :initform slot option, if any, is not evaluated. If none of the initialization
      arguments speciﬁed for a given slot has a value, the slot is initialized
      according to the :initform slot option, if speciﬁed. The :initarg slot option
      can be speciﬁed more than once for a given slot. The <i>initarg-name</i> argument
      can be any symbol.
                                                                          

                                                                          
      </li>
      <li class="itemize">The :type slot option speciﬁes that the contents of the slot will always be of
      the speciﬁed data type. It eﬀectively declares the result type of the reader
      generic function when applied to an object of this class. The result of
      attempting to store in a slot a value that does not satisfy the type of the
      slot is undeﬁned. The :type slot option may be speciﬁed at most
      once for a given slot. The :type slot option is further discussed in
      section <a 
href="clmse145.html#x178-37100028.1.3">28.1.3<!--tex4ht:ref: Inheritance-of-Slots-and-Slot-Options-SECTION --></a>.
      </li>
      <li class="itemize">The :documentation slot option provides a documentation string for the
      slot.</li></ul>
<!--l. 3503--><p class="indent" >   Each class option is an option that refers to the class as a whole or to all class
slots. The following class options are available:
      <ul class="itemize1">
      <li class="itemize">The :default-initargs class option is followed by a list of alternating
      initialization argument names and default initial value forms. If any
      of these initialization arguments does not appear in the initialization
      argument  list  supplied  to  <a 
href="#x179-420012r912">make-instance</a>,  the  corresponding  default
      initial value form is evaluated, and the initialization argument name
      and  the  form&#x2019;s  value  are  added  to  the  end  of  the  initialization
      argument list before the instance is created (see section <a 
href="clmse145.html#x178-39300028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>). The
      default  initial  value  form  is  evaluated  each  time  it  is  used.  The
      lexical  environment  in  which  this  form  is  evaluated  is  the  lexical
      environment in which the <a 
href="#x179-413022r877">defclass</a> form was evaluated. The dynamic
      environment is the dynamic environment in which <a 
href="#x179-420012r912">make-instance</a> was
      called. If an initialization argument name appears more than once in a
      :default-initargs class option, an error is signaled. The :default-initargs
      class option may be speciﬁed at most once.
      </li>
      <li class="itemize">The :documentation class option causes a documentation string to be
      attached to the class name. The documentation type for this string
      is type. The form (documentation <i>class-name</i> &#x2019;type) may be used to
      retrieve the documentation string. The :documentation class option
      may be speciﬁed at most once.
                                                                          

                                                                          
      </li>
      <li class="itemize">The :metaclass class option is used to specify that instances of the class
      being deﬁned are to have a diﬀerent metaclass than the default provided
      by the system (the class standard-class). The class-name argument is
      the name of the desired metaclass. The :metaclass class option may be
      speciﬁed at most once.
      </li></ul>
<!--l. 3542--><p class="indent" >   The new class object is returned as the result.
<!--l. 3545--><p class="indent" >   If a class with the same proper name already exists and that class is an
instance of standard-class, and if the <a 
href="#x179-413022r877">defclass</a> form for the deﬁnition of the new
class speciﬁes a class of class standard-class, the existing class is redeﬁned, and
instances of it (and its subclasses) are updated to the new deﬁnition at the time
that they are next accessed (see section <a 
href="clmse145.html#x178-40100028.1.10">28.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a>).
<!--l. 3552--><p class="indent" >   Note the following rules of <a 
href="#x179-413022r877">defclass</a> for standard classes:
      <ul class="itemize1">
      <li class="itemize">It is not required that the superclasses of a class be deﬁned before the
      <a 
href="#x179-413022r877">defclass</a> form for that class is evaluated.
      </li>
      <li class="itemize">All the superclasses of a class must be deﬁned before an instance of the
      class can be made.
      </li>
      <li class="itemize">A class must be deﬁned before it can be used as a parameter specializer
      in a <a 
href="#x179-416002r881">defmethod</a> form.
      </li></ul>
<!--l. 3570--><p class="indent" >   The Object System may be extended to cover situations where these rules are
not obeyed.
<!--l. 3573--><p class="indent" >   Some slot options are inherited by a class from its superclasses, and some can
be shadowed or altered by providing a local slot description. No class options
except :default-initargs are inherited. For a detailed description of how slots and
slot options are inherited, see section <a 
href="clmse145.html#x178-37100028.1.3">28.1.3<!--tex4ht:ref: Inheritance-of-Slots-and-Slot-Options-SECTION --></a>.
<!--l. 3579--><p class="indent" >   The options to <a 
href="#x179-413022r877">defclass</a> can be extended. An implementation must signal an
error if it observes a class option or a slot option that is not implemented
locally.
                                                                          

                                                                          
<!--l. 3583--><p class="indent" >   It is valid to specify more than one reader, writer, accessor, or initialization
argument for a slot. No other slot option may appear more than once in a single
slot description, or an error is signaled.
<!--l. 3588--><p class="indent" >   If no reader, writer, or accessor is speciﬁed for a slot, the slot can be accessed
only by the function <a 
href="#x179-420067r939">slot-value</a>.
<!--l. 3591--><p class="indent" >   See sections <a 
href="clmse145.html#x178-36400028.1.2">28.1.2<!--tex4ht:ref: Classes-SECTION --></a>, <a 
href="clmse145.html#x178-36900028.1.3">28.1.3<!--tex4ht:ref: Inheritance-SECTION --></a>, <a 
href="clmse145.html#x178-40100028.1.10">28.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a>, <a 
href="clmse145.html#x178-37500028.1.5">28.1.5<!--tex4ht:ref: Determining-the-Class-Precedence-List-SECTION --></a>, <a 
href="clmse145.html#x178-39300028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a> as well as <a 
href="#x179-420067r939">slot-value</a>,
<a 
href="#x179-420012r912">make-instance</a>, and <a 
href="#x179-420004r908">initialize-instance</a>.
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> defgeneric </b><a 
 id="dx179-414001"></a><a 
 id="x179-414002r878"></a> function-name lambda-list
</td></tr></table>
<!--l. 3605--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> [[<span class="math"> ↓</span>option |  {method-description}* ]] </td></tr></table>
<!--l. 3606--><p class="indent" >
</div>
<!--l. 3606--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-41500028.2" id="x179-41500028.2"></a></span>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>function-name</i> ::=  {<i><i>symbol</i> | (setf <i>symbol</i>)</i>}
</td></tr></table>
<!--l. 3608--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:126;" 
class="tabbing"><i>lambda-list</i> ::= (</td><td  
class="tabbing"> {<i>var</i>}* </td></tr></table>
<!--l. 3609--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:126;" 
class="tabbing">                     </td><td  
class="tabbing"> [<i>&#x0026;optional {<i>var | (<i>var</i>)</i>}*</i>] </td></tr></table>
<!--l. 3610--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:126;" 
class="tabbing">                     </td><td  
class="tabbing"> [<i>&#x0026;rest <i>var</i></i>] </td></tr></table>
<!--l. 3611--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      [<i>&#x0026;key {<i>keyword-parameter</i>}*  [<i>&#x0026;allow-other-keys</i>]</i>] ) </td><td  
class="tabbing"></td></tr></table>
<!--l. 3613--><p class="indent" >
</div>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>keyword-parameter</i> ::= <i>var</i> | ( {<i>var | (<i>keyword</i> <i>var</i>)</i>} )
</td></tr></table>
                                                                          

                                                                          
<!--l. 3615--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing"><i>option</i> ::= </td><td  
class="tabbing">(:argument-precedence-order  {<i>parameter-name</i>}+ )
</td></tr></table>
<!--l. 3616--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">           </td><td  
class="tabbing">| (declare  {<i>declaration</i>}+ )
</td></tr></table>
<!--l. 3617--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">              </td><td  
class="tabbing">| (:documentation <i>string</i>)</td></tr></table>
<!--l. 3618--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">              </td><td  
class="tabbing">| (:method-combination <i>symbol</i> {<i>arg</i>}* )</td></tr></table>
<!--l. 3619--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:84;" 
class="tabbing">              </td><td  
class="tabbing">| (:generic-function-class <i>class-name</i>)</td></tr></table>
<!--l. 3620--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">            | (:method-class <i>class-name</i>) </td><td style="width:257;" 
class="tabbing"></td></tr></table>
<!--l. 3621--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>method-description</i> ::= (:method </td><td style="width:257;" 
class="tabbing"> {<i>method-qualiﬁer</i>}*
</td></tr></table>
<!--l. 3622--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            </td><td style="width:257;" 
class="tabbing"><i>specialized-lambda-list</i></td></tr></table>
<!--l. 3623--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         </td><td  
class="tabbing"> [[<i> {<i>declaration</i>}* | documentation</i>]] </td></tr></table>
<!--l. 3624--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                            {<i> form</i>}* ) </td><td  
class="tabbing"></td></tr></table>
<!--l. 3625--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:42;" 
class="tabbing"><i>method-qualiﬁer</i> ::= <i>non-nil-atom</i>
</td></tr></table>
<!--l. 3626--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>specialized-lambda-list</i> ::=
</td></tr></table>
<!--l. 3627--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:42;" 
class="tabbing">      (</td><td  
class="tabbing"> {<i>var | (var parameter-specializer-name)</i>}* </td></tr></table>
<!--l. 3628--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:42;" 
class="tabbing">       </td><td  
class="tabbing"> [<i>&#x0026;optional {<i>var | (var [<i>initform [<i>supplied-p-parameter</i>]</i>])</i>}*</i>] </td></tr></table>
<!--l. 3629--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:42;" 
class="tabbing">       </td><td  
class="tabbing"> [<i>&#x0026;rest <i>var</i></i>] </td></tr></table>
<!--l. 3630--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       </td><td  
class="tabbing"> [<i>&#x0026;key {<i>specialized-keyword-parameter</i>}*  [<i>&#x0026;allow-other-keys</i>]</i>] </td></tr></table>
<!--l. 3631--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        [<i>&#x0026;aux {<i>var | (<i>var</i>  [<i>initform</i>])</i>}*</i>] ) </td><td  
class="tabbing"></td></tr></table>
<!--l. 3632--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>specialized-keyword-parameter</i> ::=
</td></tr></table>
<!--l. 3633--><p class="indent" >      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      <i>var</i> | ( {<i>var | (<i>keyword</i> <i>var</i>)</i>}  [<i>initform [<i>supplied-p-parameter</i>]</i>] )</td></tr></table>
<!--l. 3635--><p class="indent" >
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>parameter-specializer-name</i> ::= <i>symbol</i> | (eql <i>eql-specializer-form</i>)
</td></tr></table>
<!--l. 3637--><p class="indent" >
</div>
<!--l. 3638--><p class="noindent" >The macro <a 
href="#x179-414002r878">defgeneric</a> is used to deﬁne a generic function or to specify options and
declarations that pertain to a generic function as a whole.
<!--l. 3642--><p class="indent" >   If (fboundp <i>function-name</i>) is <a 
href="clmse31.html#x42-74002r18">nil</a>, a new generic function is created. If
(fdeﬁnition function-speciﬁer) is a generic function, that generic function is
modiﬁed. If <i>function-name/</i> names a non-generic function, a macro, or a special
form, an error is signaled.
                                                                          

                                                                          
<!--l. 3648--><p class="indent" >   [X3J13 voted in March 1989 <a 
 id="dx179-415001"></a>to use <a 
href="clmse35.html#x47-86008r55">fdeﬁnition</a> in the previous paragraph, as
shown, rather than <a 
href="clmse35.html#x47-86006r54">symbol-function</a>, as it appeared in the original report on
CLOS <span class="cite">[<a 
href="clmli5.html#XSIGPLAN-CLOS">5</a>, <a 
href="clmli5.html#XLASC-CLOS-PART-2">7</a>]</span>. The vote also changed all occurrences of <i>function-speciﬁer</i> in the
original report to <i>function-name</i>; this change is reﬂected here.—GLS]
<!--l. 3654--><p class="indent" >   Each <i>method-description</i> deﬁnes a method on the generic function.
The lambda-list of each method must be congruent with the lambda-list
speciﬁed by the <i>lambda-list</i> option. If this condition does not hold, an
error is signaled. See section <a 
href="clmse145.html#x178-38200028.1.6">28.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a> for a deﬁnition of congruence in this
context.
<!--l. 3662--><p class="indent" >   The macro <a 
href="#x179-414002r878">defgeneric</a> returns the generic function object as its result.
<!--l. 3668--><p class="indent" >   The <i>function-name</i> argument is a non-<a 
href="clmse31.html#x42-74002r18">nil</a> symbol or a list of the form (setf
<i>symbol</i>).
                                                                          

                                                                          
<!--l. 3673--><p class="indent" >   The <i>lambda-list</i> argument is an ordinary function lambda-list with the
following exceptions:
      <ul class="itemize1">
      <li class="itemize">The use of &#x0026;aux is not allowed.
      </li>
      <li class="itemize">Optional and keyword arguments may not have default initial value
      forms nor use supplied-p parameters. The generic function passes to
      the method all the argument values passed to it, and only those; default
      values are not supported. Note that optional and keyword arguments
      in method deﬁnitions, however, can have default initial value forms and
      can use supplied-p parameters.</li></ul>
<!--l. 3689--><p class="indent" >   The following options are provided. A given option may occur only once, or an
error is signaled.
      <ul class="itemize1">
      <li class="itemize">The :argument-precedence-order option is used to specify the order
      in which the required arguments in a call to the generic function are
      tested for speciﬁcity when selecting a particular method. Each required
      argument, as speciﬁed in the <i>lambda-list</i> argument, must be included
      exactly once as a parameter-name so that the full and unambiguous
      precedence order is supplied. If this condition is not met, an error is
      signaled.
      </li>
      <li class="itemize">The <a 
href="clmse48.html#x62-150003r123">declare</a> option is used to specify declarations that pertain to the
      generic function. The following standard Common Lisp declaration is
      allowed:
           <ul class="itemize2">
           <li class="itemize">An optimize declaration speciﬁes whether method selection should
           be optimized for speed or space, but it has no eﬀect on methods.
           To control how a method is optimized, an optimize declaration
           must  be  placed  directly  in  the  <a 
href="#x179-416002r881">defmethod</a>  form  or  method
                                                                          

                                                                          
           description. The optimization qualities speed and space are the
           only  qualities  this  standard  requires,  but  an  implementation
           can extend the Common Lisp Object System to recognize other
           qualities.  A  simple  implementation  that  has  only  one  method
           selection technique and ignores the optimize declaration is valid.</li></ul>
      <!--l. 3721--><p class="noindent" >The special, ftype, <a 
href="clmse35.html#x47-85002r52">function</a>, inline, notinline, and declaration declarations
      are not permitted. Individual implementations can extend the <a 
href="clmse48.html#x62-150003r123">declare</a> option
      to support additional declarations. If an implementation notices a
      declaration that it does not support and that has not been proclaimed as a
      non-standard declaration name in a declaration proclamation, it should issue
      a warning.
      </li>
      <li class="itemize">The :documentation argument associates a documentation string with the
      generic function. The documentation type for this string is <a 
href="clmse35.html#x47-85002r52">function</a>. The
      form (documentation function-name/ &#x2019;function) may be used to retrieve this
      string.
      </li>
      <li class="itemize">The :generic-function-class option may be used to specify that the generic
      function is to have a diﬀerent class than the default provided by the system
      (the class standard-generic-function). The <i>class-name</i> argument
      is the name of a class that can be the class of a generic function.
      If <i>function-name</i> speciﬁes an existing generic function that has a
      diﬀerent value for the :generic-function-class argument and the new
      generic function class is compatible with the old, <a 
href="#x179-413008r870">change-class</a> is called
      to change the class of the generic function; otherwise an error is
      signaled.
      </li>
      <li class="itemize">The :method-class option is used to specify that all methods on
      this generic function are to have a diﬀerent class from the default
      provided by the system (the class standard-method). The class-name
      argument is the name of a class that is capable of being the class of a
      method.
      </li>
      <li class="itemize">The :method-combination option is followed by a symbol that names a type
                                                                          

                                                                          
      of method combination. The arguments (if any) that follow that
      symbol depend on the type of method combination. Note that the
      standard method combination type does not support any arguments.
      However, all types of method combination deﬁned by the short form of
      <a 
href="#x179-415005r880">deﬁne-method-combination</a> accept an optional argument named <i>order</i>,
      defaulting to :most-speciﬁc-ﬁrst, where a value of :most-speciﬁc-last reverses
      the order of the primary methods without aﬀecting the order of the
      auxiliary methods.
      </li></ul>
<!--l. 3768--><p class="indent" >   The <i>method-description</i> arguments deﬁne methods that will be associated with
the generic function. The <i>method-qualiﬁer</i> and <i>specialized-lambda-list</i> arguments
in a method description are the same as for <a 
href="#x179-416002r881">defmethod</a>.
<!--l. 3773--><p class="indent" >   The <i>form</i> arguments specify the method body. The body of the method is
enclosed in an implicit block. If function-name is a symbol, this block bears the
same name as the generic function. If <i>function-name</i> is a list of the form (setf
<i>symbol</i>), the name of the block is symbol.
<!--l. 3781--><p class="indent" >   The generic function object is returned as the result.
<!--l. 3784--><p class="indent" >   The eﬀect of the <a 
href="#x179-414002r878">defgeneric</a> macro is as if the following three steps were
performed: ﬁrst, methods deﬁned by previous <a 
href="#x179-414002r878">defgeneric</a> forms are removed;
second, <a 
href="#x179-417035r898">ensure-generic-function</a> is called; and ﬁnally, methods speciﬁed by the
current <a 
href="#x179-414002r878">defgeneric</a> form are added to the generic function.
<!--l. 3790--><p class="indent" >   If no method descriptions are speciﬁed and a generic function of the
same name does not already exist, a generic function with no methods is
created.
<!--l. 3794--><p class="indent" >   The <i>lambda-list</i> argument of <a 
href="#x179-414002r878">defgeneric</a> speciﬁes the shape of lambda-lists for
the methods on this generic function. All methods on the resulting generic
function must have lambda-lists that are congruent with this shape. If a
<a 
href="#x179-414002r878">defgeneric</a> form is evaluated and some methods for that generic function have
lambda-lists that are not congruent with that given in the <a 
href="#x179-414002r878">defgeneric</a>
form, an error is signaled. For further details on method congruence, see
section <a 
href="clmse145.html#x178-38200028.1.6">28.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a>.
<!--l. 3804--><p class="indent" >   Implementations can extend <a 
href="#x179-414002r878">defgeneric</a> to include other options. It is required
that an implementation signal an error if it observes an option that is not
implemented locally.
<!--l. 3808--><p class="indent" >   See section <a 
href="clmse145.html#x178-38200028.1.6">28.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a> as well as <a 
href="#x179-416002r881">defmethod</a>, <a 
href="#x179-417035r898">ensure-generic-function</a>, and
<a 
href="#x179-418002r905">generic-function</a>.
</div>
                                                                          

                                                                          
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> deﬁne-method-combination </b><a 
 id="dx179-415002"></a><a 
 id="x179-415003r879"></a> name  [[<span class="math"> ↓</span>short-form-option]]
</td></tr></table>
<!--l. 3814--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <i>[Макрос]</i><b> deﬁne-method-combination </b><a 
 id="dx179-415004"></a><a 
 id="x179-415005r880"></a> name lambda-list</td></tr></table>
<!--l. 3816--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">( {method-group-speciﬁer}* )</td></tr></table>
<!--l. 3817--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">[(<span class="math">: arguments!.!lambda − list)]</span></td></tr></table>
<!--l. 3818--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">[(<span class="math">: generic − function!generic − fn − symbol)]</span></td></tr></table>
<!--l. 3819--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> [[ {declaration}*  | doc-string]] </td></tr></table>
<!--l. 3820--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> { form}* </td></tr></table>
<!--l. 3821--><p class="indent" >
</div>
<!--l. 3821--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-41600028.2" id="x179-41600028.2"></a></span>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:172;" 
class="tabbing"><i>short-form-option</i> ::= </td><td  
class="tabbing">:documentation <i>string</i>
</td></tr></table>
<!--l. 3823--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:172;" 
class="tabbing">                           </td><td  
class="tabbing">| :identity-with-one-argument <i>boolean</i></td></tr></table>
<!--l. 3824--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         | :operator <i>operator</i> </td><td style="width:214;" 
class="tabbing"></td></tr></table>
<!--l. 3825--><p class="indent" >    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>method-group-speciﬁer</i> ::= (</td><td  
class="tabbing"><i>variable</i> {<i> {<i>qualiﬁer-pattern</i>}+ | predicate</i>} </td></tr></table>
<!--l. 3827--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:165;" 
class="tabbing">                                     [[<i><span class="math"> ↓</span><i>long-form-option</i></i>]] ) </td><td  
class="tabbing"></td></tr></table>
<!--l. 3828--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:165;" 
class="tabbing"><i>long-form-option</i> ::= </td><td  
class="tabbing">:description <i>format-string</i></td></tr></table>
<!--l. 3829--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                          </td><td  
class="tabbing">| :order <i>order</i></td></tr></table>
<!--l. 3830--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        | :required <i>boolean</i> </td><td  
class="tabbing"></td></tr></table>
<!--l. 3832--><p class="indent" >
</div>
<!--l. 3833--><p class="noindent" >The macro <a 
href="#x179-415005r880">deﬁne-method-combination</a> is used to deﬁne new types of method
combination.
<!--l. 3836--><p class="indent" >   There are two forms of <a 
href="#x179-415005r880">deﬁne-method-combination</a>. The short form is a simple
facility for the cases that are expected to be most commonly needed. The long
form is more powerful but more verbose. It resembles <a 
href="clmse45.html#x58-144004r118">defmacro</a> in that the body is
                                                                          

                                                                          
an expression, usually using backquote, that computes a Lisp form. Thus
arbitrary control structures can be implemented. The long form also allows
arbitrary processing of method qualiﬁers.
<!--l. 3848--><p class="indent" >   In both the short and long forms, <i>name</i> is a symbol. By convention,
non-keyword, non-<a 
href="clmse31.html#x42-74002r18">nil</a> symbols are usually used.
<!--l. 3853--><p class="indent" >   The short-form syntax of <a 
href="#x179-415005r880">deﬁne-method-combination</a> is recognized
when the second subform is a non-<a 
href="clmse31.html#x42-74002r18">nil</a> symbol or is not present. When the
short form is used, <i>name</i> is deﬁned as a type of method combination
that produces a Lisp form (<i>operator method-call method-call <span class="math">…</span> </i>). The
<i>operator</i> is a symbol that can be the name of a function, macro, or special
form. The <i>operator</i> can be speciﬁed by a keyword option; it defaults to
name.
<!--l. 3862--><p class="indent" >   Keyword options for the short form are the following:
      <ul class="itemize1">
      <li class="itemize">The    :documentation    option    is    used    to    document    the
      method-combination type.
      </li>
      <li class="itemize">The :identity-with-one-argument option enables an optimization when
      <i>boolean</i> is true (the default is false). If there is exactly one applicable
      method and it is a primary method, that method serves as the eﬀective
      method and <i>operator</i> is not called. This optimization avoids the need
      to create a new eﬀective method and avoids the overhead of a function
      call. This option is designed to be used with operators such as <a 
href="clmse38.html#x50-96002r71">progn</a>,
      <a 
href="clmse34.html#x45-79004r49">and</a>, <a 
href="clmse106.html#x131-239002r587">+</a>, and <a 
href="clmse63.html#x80-177014r179">max</a>.
      </li>
      <li class="itemize">The :operator option speciﬁes the name of the operator. The <i>operator</i>
      argument is a symbol that can be the name of a function, macro, or
      special form. By convention, <i>name</i> and <i>operator</i> are often the same
      symbol. This is the default, but it is not required.
      </li></ul>
<!--l. 3888--><p class="indent" >   None of the subforms is evaluated.
<!--l. 3890--><p class="indent" >   These types of method combination require exactly one qualiﬁer per method.
An error is signaled if there are applicable methods with no qualiﬁers
                                                                          

                                                                          
or with qualiﬁers that are not supported by the method combination
type.
<!--l. 3895--><p class="indent" >   A method combination procedure deﬁned in this way recognizes two roles for
methods. A method whose one qualiﬁer is the symbol naming this type of
method combination is deﬁned to be a primary method. At least one
primary method must be applicable or an error is signaled. A method with
:around as its one qualiﬁer is an auxiliary method that behaves the same
as an :around method in standard method combination. The function
<a 
href="#x179-413002r867">call-next-method</a> can be used only in :around methods; it cannot be used in
primary methods deﬁned by the short form of the <a 
href="#x179-415005r880">deﬁne-method-combination</a>
macro.
<!--l. 3905--><p class="indent" >   A method combination procedure deﬁned in this way accepts an optional
argument named <i>order</i>, which defaults to :most-speciﬁc-ﬁrst. A value of
:most-speciﬁc-last reverses the order of the primary methods without aﬀecting the
order of the auxiliary methods.
<!--l. 3911--><p class="indent" >   The short form automatically includes error checking and support for :around
methods.
<!--l. 3914--><p class="indent" >   For a discussion of built-in method combination types, see section <a 
href="clmse145.html#x178-38800028.1.7">28.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a>.
<!--l. 3919--><p class="indent" >   The long-form syntax of <a 
href="#x179-415005r880">deﬁne-method-combination</a> is recognized when the
second subform is a list.
<!--l. 3922--><p class="indent" >   The <i>lambda-list</i> argument is an ordinary lambda-list. It receives any
arguments provided after the name of the method combination type in the
:method-combination option to <a 
href="#x179-414002r878">defgeneric</a>.
<!--l. 3927--><p class="indent" >   A list of method group speciﬁers follows. Each speciﬁer selects a subset of the
applicable methods to play a particular role, either by matching their qualiﬁers
against some patterns or by testing their qualiﬁers with a predicate. These
method group speciﬁers deﬁne all method qualiﬁers that can be used with this
type of method combination. If an applicable method does not fall into any
method group, the system signals the error that the method is invalid for the kind
of method combination in use.
<!--l. 3935--><p class="indent" >   Each method group speciﬁer names a variable. During the execution of the
forms in the body of <a 
href="#x179-415005r880">deﬁne-method-combination</a>, this variable is bound to a list
of the methods in the method group. The methods in this list occur in
most-speciﬁc-ﬁrst order.
<!--l. 3940--><p class="indent" >   A qualiﬁer pattern is a list or the symbol <a 
href="clmse106.html#x131-239010r591">*</a>. A method matches a qualiﬁer
pattern if the method&#x2019;s list of qualiﬁers is <a 
href="clmse33.html#x44-78006r46">equal</a> to the qualiﬁer pattern (except
that the symbol <a 
href="clmse106.html#x131-239010r591">*</a> in a qualiﬁer pattern matches anything). Thus a qualiﬁer
                                                                          

                                                                          
pattern can be one of the following: the empty list (), which matches unqualiﬁed
methods; the symbol <a 
href="clmse106.html#x131-239010r591">*</a>, which matches all methods; a true list, which
matches methods with the same number of qualiﬁers as the length of the list
when each qualiﬁer matches the corresponding list element; or a dotted
list that ends in the symbol <a 
href="clmse106.html#x131-239010r591">*</a> (the <a 
href="clmse106.html#x131-239010r591">*</a> matches any number of additional
qualiﬁers).
<!--l. 3952--><p class="indent" >   Each applicable method is tested against the qualiﬁer patterns and predicates
in left-to-right order. As soon as a qualiﬁer pattern matches or a predicate returns
true, the method becomes a member of the corresponding method group and no
further tests are made. Thus if a method could be a member of more than one
method group, it joins only the ﬁrst such group. If a method group has more than
one qualiﬁer pattern, a method need only satisfy one of the qualiﬁer patterns to
be a member of the group.
<!--l. 3961--><p class="indent" >   The name of a predicate function can appear instead of qualiﬁer patterns in a
method group speciﬁer. The predicate is called for each method that
has not been assigned to an earlier method group; it is called with one
argument, the method&#x2019;s qualiﬁer list. The predicate should return true if
the method is to be a member of the method group. A predicate can be
distinguished from a qualiﬁer pattern because it is a symbol other than <a 
href="clmse31.html#x42-74002r18">nil</a> or
<a 
href="clmse106.html#x131-239010r591">*</a>.
<!--l. 3969--><p class="indent" >   If there is an applicable method whose qualiﬁers are not valid for the method
combination type, the function <a 
href="#x179-420006r909">invalid-method-error</a> is called.
<!--l. 3973--><p class="indent" >   Method group speciﬁers can have keyword options following the qualiﬁer
patterns or predicate. Keyword options can be distinguished from additional
qualiﬁer patterns because they are neither lists nor the symbol <a 
href="clmse106.html#x131-239010r591">*</a>. The keyword
options are:
      <ul class="itemize1">
      <li class="itemize">The :description option is used to provide a description of the role of
      methods in the method group. Programming environment tools use
      (apply #&#x2019;format stream <i>format-string</i> (method-qualiﬁers <i>method</i>)) to
      print this description, which is expected to be concise. This keyword
      option allows the description of a method qualiﬁer to be deﬁned in the
      same module that deﬁnes the meaning of the method qualiﬁer. In most
      cases, <i>format-string</i> will not contain any <a 
href="clmse112.html#x139-263003r687">format</a> directives, but they
      are available for generality. If :description is not speciﬁed, a default
      description is generated based on the variable name and the qualiﬁer
      patterns and on whether this method group includes the unqualiﬁed
                                                                          

                                                                          
      methods. The argument format-string is not evaluated.
      </li>
      <li class="itemize">The :order option speciﬁes the order of methods. The order argument
      is a form that evaluates to :most-speciﬁc-ﬁrst or :most-speciﬁc-last. If it
      evaluates to any other value, an error is signaled. This keyword option
      is a convenience and does not add any expressive power. If :order is not
      speciﬁed, it defaults to :most-speciﬁc-ﬁrst.
      </li>
      <li class="itemize">The  :required  option  speciﬁes  whether  at  least  one  method  in  this
      method group is required. If the <i>boolean</i> argument is non-<a 
href="clmse31.html#x42-74002r18">nil</a> and the
      method  group  is  empty  (that  is,  no  applicable  methods  match  the
      qualiﬁer patterns or satisfy the predicate), an error is signaled. This
      keyword option is a convenience and does not add any expressive power.
      If :required is not speciﬁed, it defaults to <a 
href="clmse31.html#x42-74002r18">nil</a>. The <i>boolean</i> argument is
      not evaluated.
      </li></ul>
<!--l. 4017--><p class="indent" >   The use of method group speciﬁers provides a convenient syntax to select
methods, to divide them among the possible roles, and to perform the necessary
error checking. It is possible to perform further ﬁltering of methods in the
body forms by using normal list-processing operations and the functions
<a 
href="#x179-420024r918">method-qualiﬁers</a> and <a 
href="#x179-420006r909">invalid-method-error</a>. It is permissible to use <a 
href="clmse35.html#x47-87002r59">setq</a> on the
variables named in the method group speciﬁers and to bind additional variables.
It is also possible to bypass the method group speciﬁer mechanism and do
everything in the body forms. This is accomplished by writing a single
method group with <a 
href="clmse106.html#x131-239010r591">*</a> as its only qualiﬁer pattern; the variable is then
bound to a list of all of the applicable methods, in most-speciﬁc-ﬁrst
order.
<!--l. 4030--><p class="indent" >   The body <i>forms</i> compute and return the Lisp form that speciﬁes how the
methods are combined, that is, the eﬀective method. The eﬀective method uses
the macro <a 
href="#x179-412011r866">call-method</a>. The deﬁnition of this macro has lexical scope and is
available only in an eﬀective method form. Given a method object in one of the
lists produced by the method group speciﬁers and a list of next methods, the
macro <a 
href="#x179-412011r866">call-method</a> will invoke the method so that <a 
href="#x179-413002r867">call-next-method</a> will have
available the next methods.
<!--l. 4039--><p class="indent" >   When an eﬀective method has no eﬀect other than to call a single method,
                                                                          

                                                                          
some implementations employ an optimization that uses the single method
directly as the eﬀective method, thus avoiding the need to create a new
eﬀective method. This optimization is active when the eﬀective method
form consists entirely of an invocation of the <a 
href="#x179-412011r866">call-method</a> macro whose
ﬁrst subform is a method object and whose second subform is <a 
href="clmse31.html#x42-74002r18">nil</a>. Each
<a 
href="#x179-415005r880">deﬁne-method-combination</a> body is responsible for stripping oﬀ redundant
invocations of <a 
href="clmse38.html#x50-96002r71">progn</a>, <a 
href="clmse34.html#x45-79004r49">and</a>, <a 
href="clmse43.html#x55-133002r110">multiple-value-prog1</a>, and the like, if this optimization
is desired.
<!--l. 4051--><p class="indent" >   The list (:arguments . <i>lambda-list</i>) can appear before any declaration or
documentation string. This form is useful when the method combination type
performs some speciﬁc behavior as part of the combined method and that
behavior needs access to the arguments to the generic function. Each parameter
variable deﬁned by lambda-list is bound to a form that can be inserted into the
eﬀective method. When this form is evaluated during execution of the eﬀective
method, its value is the corresponding argument to the generic function. If
<i>lambda-list</i> is not congruent to the generic function&#x2019;s lambda-list, additional
ignored parameters are automatically inserted until it is congruent. Thus it is
permissible for <i>lambda-list</i> to receive fewer arguments than the number that the
generic function expects.
<!--l. 4065--><p class="indent" >   Erroneous conditions detected by the body should be reported with
method-combination-error or invalid-method-error; these functions add any
necessary contextual information to the error message and will signal the
appropriate error.
<!--l. 4071--><p class="indent" >   The body <i>forms</i> are evaluated inside the bindings created by the lambda-list
and method group speciﬁers. Declarations at the head of the body are positioned
directly inside bindings created by the lambda-list and outside the bindings
of the method group variables. Thus method group variables cannot be
declared.
<!--l. 4077--><p class="indent" >   Within the body <i>forms</i>, <i>generic-function-symbol</i> is bound to the generic
function object.
<!--l. 4080--><p class="indent" >   If a <i>doc-string</i> argument is present, it provides the documentation for the
method combination type.
<!--l. 4083--><p class="indent" >   The functions <a 
href="#x179-420020r916">method-combination-error</a> and <a 
href="#x179-420006r909">invalid-method-error</a> can be called
from the body <i>forms</i> or from functions called by the body <i>forms</i>. The actions of
these two functions can depend on implementation-dependent dynamic variables
automatically bound before the generic function compute-eﬀective-method is
called.
<!--l. 4090--><p class="indent" >   Note that two methods with identical specializers, but with diﬀerent qualiﬁers,
                                                                          

                                                                          
are not ordered by the algorithm described in step 2 of the method selection and
combination process described in section <a 
href="clmse145.html#x178-38400028.1.7">28.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>. Normally the two methods play
diﬀerent roles in the eﬀective method because they have diﬀerent qualiﬁers, and
no matter how they are ordered in the result of step 2 the eﬀective method is the
same. If the two methods play the same role and their order matters, an error
is signaled. This happens as part of the qualiﬁer pattern matching in
<a 
href="#x179-415005r880">deﬁne-method-combination</a>.
                                                                          

                                                                          
<!--l. 4104--><p class="indent" >   The value returned by the <a 
href="#x179-415005r880">deﬁne-method-combination</a> macro is the new
method combination object.
<!--l. 4108--><p class="indent" >   Most examples of the long form of <a 
href="#x179-415005r880">deﬁne-method-combination</a> also illustrate
the use of the related functions that are provided as part of the declarative
method combination facility.<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Examples of the short form of deﬁne-method-combination
</td></tr></table>
<!--l. 4116--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4117--><p class="indent" >            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination and :identity-with-one-argument t)</td></tr></table>
<!--l. 4118--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4119--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod func and ((x class1) y)</td></tr></table>
<!--l. 4120--><p class="indent" >                                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ...)</td></tr></table>
<!--l. 4121--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4122--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The equivalent of this example in the long form is:</td></tr></table>
<!--l. 4123--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4124--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination and</td></tr></table>
<!--l. 4125--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (&#x0026;optional (order &#x2019;:most-speciﬁc-ﬁrst))</td></tr></table>
<!--l. 4126--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((around (:around))</td></tr></table>
<!--l. 4127--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (primary (and) :order order :required t))</td></tr></table>
<!--l. 4128--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((form (if (rest primary)</td></tr></table>
<!--l. 4129--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  ‘(and ,@(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4130--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                      ‘(call-method ,method ()))</td></tr></table>
<!--l. 4131--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                  primary))</td></tr></table>
<!--l. 4132--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  ‘(call-method ,(ﬁrst primary) ()))))</td></tr></table>
<!--l. 4133--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (if around</td></tr></table>
<!--l. 4134--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ‘(call-method ,(ﬁrst around)</td></tr></table>
<!--l. 4135--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (,@(rest around)</td></tr></table>
<!--l. 4136--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (make-method ,form)))</td></tr></table>
<!--l. 4137--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        form)))</td></tr></table>
<!--l. 4138--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4139--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4140--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Examples of the long form of deﬁne-method-combination</td></tr></table>
<!--l. 4141--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4142--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The default method-combination technique</td></tr></table>
                                                                          

                                                                          
<!--l. 4143--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4144--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination standard ()</td></tr></table>
<!--l. 4145--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((around (:around))</td></tr></table>
<!--l. 4146--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (before (:before))</td></tr></table>
<!--l. 4147--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (primary () :required t)</td></tr></table>
<!--l. 4148--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (after (:after)))</td></tr></table>
<!--l. 4149--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (ﬂet ((call-methods (methods)</td></tr></table>
<!--l. 4150--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           (mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4151--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       ‘(call-method ,method ()))</td></tr></table>
<!--l. 4152--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                   methods)))</td></tr></table>
<!--l. 4153--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (let ((form (if (or before after (rest primary))</td></tr></table>
<!--l. 4154--><p class="indent" >                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    ‘(multiple-value-prog1</td></tr></table>
<!--l. 4155--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (progn ,@(call-methods before)</td></tr></table>
<!--l. 4156--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                              (call-method ,(ﬁrst primary)</td></tr></table>
<!--l. 4157--><p class="indent" >       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                           ,(rest primary)))</td></tr></table>
<!--l. 4158--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       ,@(call-methods (reverse after)))</td></tr></table>
<!--l. 4159--><p class="indent" >                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    ‘(call-method ,(ﬁrst primary) ()))))</td></tr></table>
<!--l. 4160--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">      (if around</td></tr></table>
<!--l. 4161--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          ‘(call-method ,(ﬁrst around)</td></tr></table>
<!--l. 4162--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        (,@(rest around)</td></tr></table>
<!--l. 4163--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                         (make-method ,form)))</td></tr></table>
<!--l. 4164--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          form))))</td></tr></table>
<!--l. 4166--><p class="indent" >
</div>
</div><div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; A simple way to try several methods until one returns non-nil
</td></tr></table>
<!--l. 4170--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4171--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination or ()</td></tr></table>
<!--l. 4172--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((methods (or)))</td></tr></table>
<!--l. 4173--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ‘(or ,@(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4174--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                     ‘(call-method ,method ()))</td></tr></table>
<!--l. 4175--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 methods)))</td></tr></table>
<!--l. 4176--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
                                                                          

                                                                          
<!--l. 4177--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; A more complete version of the preceding</td></tr></table>
<!--l. 4178--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4179--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination or</td></tr></table>
<!--l. 4180--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (&#x0026;optional (order &#x2019;:most-speciﬁc-ﬁrst))</td></tr></table>
<!--l. 4181--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((around (:around))</td></tr></table>
<!--l. 4182--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (primary (or)))</td></tr></table>
<!--l. 4183--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Process the order argument</td></tr></table>
<!--l. 4184--><p class="indent" >                                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (case order</td></tr></table>
<!--l. 4185--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (:most-speciﬁc-ﬁrst)</td></tr></table>
<!--l. 4186--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (:most-speciﬁc-last (setq primary (reverse primary)))</td></tr></table>
<!--l. 4187--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (otherwise (method-combination-error</td></tr></table>
<!--l. 4188--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                 &#x0022;~S is an invalid order.~@</td></tr></table>
<!--l. 4189--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  :most-speciﬁc-ﬁrst and :most-speciﬁc-last ~</td></tr></table>
<!--l. 4190--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    are the possible values.&#x0022;</td></tr></table>
<!--l. 4191--><p class="indent" >                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                         order)))</td></tr></table>
<!--l. 4192--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Must have a primary method</td></tr></table>
<!--l. 4193--><p class="indent" >                                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (unless primary</td></tr></table>
<!--l. 4194--><p class="indent" >        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (method-combination-error &#x0022;A primary method is required.&#x0022;))</td></tr></table>
<!--l. 4195--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Construct the form that calls the primary methods</td></tr></table>
<!--l. 4196--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((form (if (rest primary)</td></tr></table>
<!--l. 4197--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  ‘(or ,@(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4198--><p class="indent" >     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                     ‘(call-method ,method ()))</td></tr></table>
<!--l. 4199--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 primary))</td></tr></table>
<!--l. 4200--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  ‘(call-method ,(ﬁrst primary) ()))))</td></tr></table>
<!--l. 4201--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ;; Wrap the around methods around that form</td></tr></table>
<!--l. 4202--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (if around</td></tr></table>
<!--l. 4203--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ‘(call-method ,(ﬁrst around)</td></tr></table>
<!--l. 4204--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (,@(rest around)</td></tr></table>
<!--l. 4205--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (make-method ,form)))</td></tr></table>
<!--l. 4206--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        form)))</td></tr></table>
<!--l. 4208--><p class="indent" >
</div>
</div><div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The same thing, using the :order and :required keyword options
</td></tr></table>
<!--l. 4212--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination or</td></tr></table>
<!--l. 4213--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (&#x0026;optional (order &#x2019;:most-speciﬁc-ﬁrst))</td></tr></table>
<!--l. 4214--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((around (:around))</td></tr></table>
<!--l. 4215--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">         (primary (or) :order order :required t))</td></tr></table>
<!--l. 4216--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((form (if (rest primary)</td></tr></table>
<!--l. 4217--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  ‘(or ,@(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4218--><p class="indent" >     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                     ‘(call-method ,method ()))</td></tr></table>
<!--l. 4219--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 primary))</td></tr></table>
<!--l. 4220--><p class="indent" >                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                  ‘(call-method ,(ﬁrst primary) ()))))</td></tr></table>
<!--l. 4221--><p class="indent" >                                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (if around</td></tr></table>
<!--l. 4222--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ‘(call-method ,(ﬁrst around)</td></tr></table>
<!--l. 4223--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      (,@(rest around)</td></tr></table>
<!--l. 4224--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                       (make-method ,form)))</td></tr></table>
<!--l. 4225--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        form)))</td></tr></table>
<!--l. 4226--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4227--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; This short-form call is behaviorally identical to the preceding.</td></tr></table>
<!--l. 4228--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination or :identity-with-one-argument t)</td></tr></table>
<!--l. 4229--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4230--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Order methods by positive integer qualiﬁers; note that :around</td></tr></table>
<!--l. 4231--><p class="indent" >         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; methods are disallowed here in order to keep the example small.</td></tr></table>
<!--l. 4232--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4233--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination example-method-combination ()</td></tr></table>
<!--l. 4234--><p class="indent" >                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((methods positive-integer-qualiﬁer-p))</td></tr></table>
<!--l. 4235--><p class="indent" >                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ‘(progn ,@(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4236--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        ‘(call-method ,method ()))</td></tr></table>
<!--l. 4237--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    (stable-sort methods #&#x2019;&#x003C;</td></tr></table>
<!--l. 4238--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                      :key #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4239--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                               (ﬁrst (method-qualiﬁers</td></tr></table>
<!--l. 4240--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                        method)))))))</td></tr></table>
<!--l. 4241--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4242--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defun positive-integer-qualiﬁer-p (method-qualiﬁers)</td></tr></table>
<!--l. 4243--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (and (= (length method-qualiﬁers) 1)</td></tr></table>
<!--l. 4244--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (typep (ﬁrst method-qualiﬁers) &#x2019;(integer 0 *))))</td></tr></table>
<!--l. 4245--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4246--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; Example of the use of :arguments</td></tr></table>
<!--l. 4247--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(deﬁne-method-combination progn-with-lock ()</td></tr></table>
<!--l. 4248--><p class="indent" >                                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        ((methods ()))</td></tr></table>
                                                                          

                                                                          
<!--l. 4249--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (:arguments object)</td></tr></table>
<!--l. 4250--><p class="indent" >                                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ‘(unwind-protect</td></tr></table>
<!--l. 4251--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (progn (lock (object-lock ,object))</td></tr></table>
<!--l. 4252--><p class="indent" >                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              ,@(mapcar #&#x2019;(lambda (method)</td></tr></table>
<!--l. 4253--><p class="indent" >               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                            ‘(call-method ,method ()))</td></tr></table>
<!--l. 4254--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                        methods))</td></tr></table>
<!--l. 4255--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (unlock (object-lock ,object))))</td></tr></table>
<!--l. 4257--><p class="indent" >
</div>
</div>
<!--l. 4261--><p class="indent" >   The :method-combination option of <a 
href="#x179-414002r878">defgeneric</a> is used to specify that a generic
function should use a particular method combination type. The argument to
the :method-combination option is the name of a method combination
type.
<!--l. 4266--><p class="indent" >   See sections <a 
href="clmse145.html#x178-38400028.1.7">28.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a> and <a 
href="clmse145.html#x178-38800028.1.7">28.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a> as well as <a 
href="#x179-412011r866">call-method</a>, <a 
href="#x179-420024r918">method-qualiﬁers</a>,
<a 
href="#x179-420020r916">method-combination-error</a>, <a 
href="#x179-420006r909">invalid-method-error</a>, and <a 
href="#x179-414002r878">defgeneric</a>.
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> defmethod </b><a 
 id="dx179-416001"></a><a 
 id="x179-416002r881"></a> function-name  {method-qualiﬁer}*
</td></tr></table>
<!--l. 4279--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">specialized-lambda-list</td></tr></table>
<!--l. 4280--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> [[ {declaration}*  | doc-string]]  { form}* </td></tr></table>
<!--l. 4281--><p class="indent" >
</div>
<!--l. 4281--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-41700028.2" id="x179-41700028.2"></a></span>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>function-name</i> ::=  {<i><i>symbol</i> | (setf <i>symbol</i>)</i>}
</td></tr></table>
<!--l. 4283--><p class="indent" >                                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>method-qualiﬁer</i> ::= <i>non-nil-atom</i></td></tr></table>
                                                                          

                                                                          
<!--l. 4284--><p class="indent" >          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>parameter-specializer-name</i> ::= <i>symbol</i> | (eql <i>eql-specializer-form</i>)</td></tr></table>
<!--l. 4286--><p class="indent" >
</div>
<!--l. 4287--><p class="noindent" >The macro <a 
href="#x179-416002r881">defmethod</a> deﬁnes a method on a generic function.
<!--l. 4289--><p class="indent" >   If (fboundp <i>function-name</i>) is <a 
href="clmse31.html#x42-74002r18">nil</a>, a generic function is created with
default values for the argument precedence order (each argument is more
speciﬁc than the arguments to its right in the argument list), for the
generic function class (the class standard-generic-function), for the method
class (the class standard-method), and for the method combination type
(the standard method combination type). The lambda-list of the generic
function is congruent with the lambda-list of the method being deﬁned; if
the <a 
href="#x179-416002r881">defmethod</a> form mentions keyword arguments, the lambda-list of
the generic function will mention &#x0026;key (but no keyword arguments). If
<i>function-name</i> names a non-generic function, a macro, or a special form, an error
is signaled.
<!--l. 4302--><p class="indent" >   If a generic function is currently named by function-name, where <i>function-name</i>
is a symbol or a list of the form (setf <i>symbol</i>), the lambda-list of the method must
be congruent with the lambda-list of the generic function. If this condition does
not hold, an error is signaled. See section <a 
href="clmse145.html#x178-38200028.1.6">28.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a> for a deﬁnition of congruence in
this context.
<!--l. 4313--><p class="indent" >   The <i>function-name</i> argument is a non-<a 
href="clmse31.html#x42-74002r18">nil</a> symbol or a list of the form (setf
<i>symbol</i>). It names the generic function on which the method is deﬁned.
<!--l. 4317--><p class="indent" >   Each <i>method-qualiﬁer</i> argument is an object that is used by method
combination to identify the given method. A method qualiﬁer is a non-<a 
href="clmse31.html#x42-74002r18">nil</a> atom.
The method combination type may further restrict what a method qualiﬁer may
be. The standard method combination type allows for unqualiﬁed methods or
methods whose sole qualiﬁer is the keyword :before, the keyword :after, or the
keyword :around.
<!--l. 4325--><p class="indent" >   A <i>specialized-lambda-list</i> is like an ordinary function lambda-list except that
the name of a required parameter can be replaced by a specialized parameter, a
list of the form (<i>variable-name parameter-specializer-name</i>). Only required
parameters may be specialized. A parameter specializer name is a symbol that
names a class or (eql <i>eql-specializer-form</i>). The parameter specializer name (eql
<i>eql-specializer-form</i>) indicates that the corresponding argument must be <a 
href="clmse33.html#x44-78004r45">eql</a> to
the object that is the value of <i>eql-specializer-form</i> for the method to be
applicable. If no parameter specializer name is speciﬁed for a given required
parameter, the parameter specializer defaults to the class named <a 
href="clmse31.html#x42-74004r19">t</a>. See section
                                                                          

                                                                          
<a 
href="clmse145.html#x178-38000028.1.6">28.1.6<!--tex4ht:ref: Introduction-to-Methods-SECTION --></a>.
<!--l. 4339--><p class="indent" >   The <i>form</i> arguments specify the method body. The body of the method is
enclosed in an implicit block. If <i>function-name</i> is a symbol, this block bears the
same name as the generic function. If <i>function-name</i> is a list of the form (setf
<i>symbol</i>), the name of the block is <i>symbol</i>.
<!--l. 4346--><p class="indent" >   The result of <a 
href="#x179-416002r881">defmethod</a> is the method object.
<!--l. 4349--><p class="indent" >   The class of the method object that is created is that given by the method
class option of the generic function on which the method is deﬁned.
<!--l. 4352--><p class="indent" >   If the generic function already has a method that agrees with the method
being deﬁned on parameter specializers and qualiﬁers, <a 
href="#x179-416002r881">defmethod</a> replaces the
existing method with the one now being deﬁned. See section <a 
href="clmse145.html#x178-38100028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> for a
deﬁnition of agreement in this context.
<!--l. 4359--><p class="indent" >   The parameter specializers are derived from the parameter specializer names
as described in section <a 
href="clmse145.html#x178-38000028.1.6">28.1.6<!--tex4ht:ref: Introduction-to-Methods-SECTION --></a>.
<!--l. 4362--><p class="indent" >   The expansion of the <a 
href="#x179-416002r881">defmethod</a> macro refers to each specialized parameter
(see the ignore declaration speciﬁer), including parameters that have an explicit
parameter specializer name of <a 
href="clmse31.html#x42-74004r19">t</a>. This means that a compiler warning does not
occur if the body of the method does not refer to a specialized parameter. Note
that a parameter that specializes on <a 
href="clmse31.html#x42-74004r19">t</a> is not synonymous with an unspecialized
parameter in this context.
<!--l. 4371--><p class="indent" >   See sections <a 
href="clmse145.html#x178-38000028.1.6">28.1.6<!--tex4ht:ref: Introduction-to-Methods-SECTION --></a>, <a 
href="clmse145.html#x178-38200028.1.6">28.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a>, and <a 
href="clmse145.html#x178-38100028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a>.
</div>
<!--l. 4377--><p class="indent" >   [At this point the original CLOS report <span class="cite">[<a 
href="clmli5.html#XSIGPLAN-CLOS">5</a>, <a 
href="clmli5.html#XLASC-CLOS-PART-2">7</a>]</span> contained a speciﬁcation for
<a 
href="clmse124.html#x154-305006r771">describe</a> as a generic function. This speciﬁcation is omitted here because X3J13
voted in March 1989 <a 
 id="dx179-417001"></a>not to make <a 
href="clmse124.html#x154-305006r771">describe</a> a generic function after all (see
<a 
href="clmse124.html#x154-305011r773">describe-object</a>).—GLS]
<div class=defun>
<!--l. 4383--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-417002"></a><a 
 id="x179-417003r882"></a><b> documentation</b>  <i>x</i> &#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417004"></a><a 
 id="x179-417005r883"></a><b> documentation</b>  <i>                                   </i>
(<i>method</i> standard-method) &#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417006"></a><a 
 id="x179-417007r884"></a><b> documentation</b>  <i>                                   </i>
(<i>generic-function</i> standard-generic-function) &#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417008"></a><a 
 id="x179-417009r885"></a><b> documentation</b>  (<i>class</i> standard-class) &#x0026;optional
<i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417010"></a><a 
 id="x179-417011r886"></a><b> documentation</b>  <i>                                   </i>
(<i>method-combination</i> method-combination) &#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417012"></a><a 
 id="x179-417013r887"></a><b> documentation</b>  <i>                                   </i>
(<i>slot-description</i> standard-slot-description) &#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417014"></a><a 
 id="x179-417015r888"></a><b> documentation</b>  (<i>symbol</i> symbol) &#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417016"></a><a 
 id="x179-417017r889"></a><b> documentation</b>  (<i>list</i> list) &#x0026;optional  <i>doc-type</i>
<!--l. 4396--><p class="noindent" >The ordinary function <a 
href="#x179-417017r889">documentation</a> (see section <a 
href="clmse123.html#x153-30100025.2">25.2<!--tex4ht:ref: DOCUMENTATION-SECTION --></a>) is replaced by a generic
function. The generic function <a 
href="#x179-417017r889">documentation</a> returns the documentation string
associated with the given object if it is available; otherwise <a 
href="#x179-417017r889">documentation</a> returns
<a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 4404--><p class="indent" >   The ﬁrst argument of <a 
href="#x179-417017r889">documentation</a> is a symbol, a function-name list of the
form (setf <i>symbol</i>), a method object, a class object, a generic function
object, a method combination object, or a slot description object. Whether
a second argument should be supplied depends on the type of the ﬁrst
argument.
      <ul class="itemize1">
      <li class="itemize">If  the  ﬁrst  argument  is  a  method  object,  a  class  object,  a  generic
      function object, a method combination object, or a slot description
      object,  the  second  argument  must  not  be  supplied,  or  an  error  is
      signaled.
      </li>
      <li class="itemize">If the ﬁrst argument is a symbol or a list of the form (setf <i>symbol</i>), the
      second argument must be supplied.
           <ul class="itemize2">
           <li class="itemize">The forms <div class=lisp><div class=tabbing>
           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:82;" 
class="tabbing"></td><td  
class="tabbing">(documentation <i>symbol</i> &#x2019;function)
</td></tr></table>
           <!--l. 4428--><p class="noindent" >
</div>
</div>
           <!--l. 4429--><p class="noindent" >and <div class=lisp><div class=tabbing>
           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td style="width:82;" 
class="tabbing"></td><td  
class="tabbing">(documentation &#x2019;(setf <i>symbol</i>) &#x2019;function)
</td></tr></table>
           <!--l. 4432--><p class="noindent" >
                                                                          

                                                                          
</div>
</div>
           <!--l. 4433--><p class="noindent" >return the documentation string of the function, generic function,
           special form, or macro named by the symbol or list.
           </li>
           <li class="itemize">The form (documentation <i>symbol</i> &#x2019;variable) returns the documentation
           string of the special variable or constant named by the symbol.
           </li>
           <li class="itemize">The form (documentation <i>symbol</i> &#x2019;structure) returns the
           documentation string of the <a 
href="clmse99.html#x123-227002r580">defstruct</a> structure named by the
           symbol.
           </li>
           <li class="itemize">The form (documentation <i>symbol</i> &#x2019;type) returns the documentation
           string of the class object named by the symbol, if there is such a class.
           If there is no such class, it returns the documentation string of the type
           speciﬁer named by the symbol.
           </li>
           <li class="itemize">The form (documentation <i>symbol</i> &#x2019;setf) returns the documentation
           string of the defsetf or deﬁne-setf-method deﬁnition associated with the
           symbol.
           </li>
           <li class="itemize">The form (documentation <i>symbol</i> &#x2019;method-combination) returns the
           documentation string of the method combination type named by the
           symbol.</li></ul>
      </li></ul>
<!--l. 4466--><p class="indent" >   An implementation may extend the set of symbols that are acceptable as the
second argument. If a symbol is not recognized as an acceptable argument by the
implementation, an error must be signaled.
<!--l. 4471--><p class="indent" >   The documentation string associated with the given object is returned unless
none is available, in which case <a 
href="#x179-417017r889">documentation</a> returns <a 
href="clmse31.html#x42-74002r18">nil</a>.
</div>
<div class=defun>
<!--l. 4478--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-417018"></a><a 
 id="x179-417019r890"></a><b> (setf</b>  <i>documentation)</i> <i>new-value</i> <i>x</i> &#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417020"></a><a 
 id="x179-417021r891"></a><b> (setf</b>  <i>documentation)</i> <i>new-value</i> (<i>method</i> standard-method)
&#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417022"></a><a 
 id="x179-417023r892"></a><b> (setf</b>  <i>documentation)</i> <i>new-value</i> (<i>generic-function</i> standard-generic-function)
&#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417024"></a><a 
 id="x179-417025r893"></a><b> (setf</b>  <i>documentation)</i> <i>new-value</i> (<i>class</i> standard-class)
&#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417026"></a><a 
 id="x179-417027r894"></a><b> (setf</b>  <i>documentation)</i> <i>new-value</i> (<i>method-combination</i> method-combination)
&#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417028"></a><a 
 id="x179-417029r895"></a><b> (setf</b>  <i>documentation)</i> <i>new-value</i> (<i>slot-description</i> standard-slot-description)
&#x0026;optional  <i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417030"></a><a 
 id="x179-417031r896"></a><b> (setf</b>  <i>documentation)</i> <i>new-value</i> (<i>symbol</i> symbol) &#x0026;optional
<i>doc-type</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417032"></a><a 
 id="x179-417033r897"></a><b> (setf</b>  <i>documentation)</i> <i>new-value</i> (<i>list</i> list) &#x0026;optional
<i>doc-type</i>
<!--l. 4487--><p class="noindent" >The generic function (setf documentation) is used to update the documentation.
<!--l. 4491--><p class="indent" >   The ﬁrst argument of (setf documentation) is the new documentation.
<!--l. 4493--><p class="indent" >   The second argument of <a 
href="#x179-417017r889">documentation</a> is a symbol, a function-name list of
the form (setf <i>symbol</i>), a method object, a class object, a generic function object,
a method combination object, or a slot description object. Whether a third
argument should be supplied depends on the type of the second argument. See
<a 
href="#x179-417017r889">documentation</a>.
</div>
<div class=defun>
<!--l. 4503--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-417034"></a><a 
 id="x179-417035r898"></a><b> ensure-generic-function</b>  <i>function-name</i> &#x0026;key  <i>:lambda-list</i>
<i>:argument-precedence-order</i> <i>:declare</i> <i>:documentation</i> <i>:generic-function-class</i>
<i>:method-combination</i> <i>:method-class</i> <i>:environment</i>
<!--l. 4512--><p class="noindent" ><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>function-name</i> ::=  {<i><i>symbol</i> | (setf <i>symbol</i>)</i>}
</td></tr></table>
<!--l. 4515--><p class="indent" >
</div>
<!--l. 4516--><p class="noindent" >The function <a 
href="#x179-417035r898">ensure-generic-function</a> is used to deﬁne a globally named generic
function with no methods or to specify or modify options and declarations that
pertain to a globally named generic function as a whole.
<!--l. 4521--><p class="indent" >   If (fboundp <i>function-name</i>) is <a 
href="clmse31.html#x42-74002r18">nil</a>, a new generic function is created. If
(fdeﬁnition function-name) is a non-generic function, a macro, or a special form,
an error is signaled.
                                                                          

                                                                          
<!--l. 4526--><p class="indent" >   [X3J13 voted in March 1989 <a 
 id="dx179-417036"></a>to use <a 
href="clmse35.html#x47-86008r55">fdeﬁnition</a> in the previous paragraph, as
shown, rather than <a 
href="clmse35.html#x47-86006r54">symbol-function</a>, as it appeared in the original report on
CLOS <span class="cite">[<a 
href="clmli5.html#XSIGPLAN-CLOS">5</a>, <a 
href="clmli5.html#XLASC-CLOS-PART-2">7</a>]</span>. The vote also changed all occurrences of <i>function-speciﬁer</i> in the
original report to <i>function-name</i>; this change is reﬂected here.—GLS]
<!--l. 4532--><p class="indent" >   If <i>function-name</i> speciﬁes a generic function that has a diﬀerent value for
any of the following arguments, the generic function is modiﬁed to have
the new value: :argument-precedence-order, :declare, :documentation,
:method-combination.
<!--l. 4538--><p class="indent" >   If <i>function-name</i> speciﬁes a generic function that has a diﬀerent value for the
:lambda-list argument, and the new value is congruent with the lambda-lists of all
existing methods or there are no methods, the value is changed; otherwise an error
is signaled.
<!--l. 4543--><p class="indent" >   If <i>function-name</i> speciﬁes a generic function that has a diﬀerent value for the
:generic-function-class argument and if the new generic function class is
compatible with the old, <a 
href="#x179-413008r870">change-class</a> is called to change the class of the generic
function; otherwise an error is signaled.
<!--l. 4549--><p class="indent" >   If <i>function-name</i> speciﬁes a generic function that has a diﬀerent :method-class
value, the value is changed but any existing methods are not changed.
<!--l. 4556--><p class="indent" >   The <i>function-name</i> argument is a symbol or a list of the form (setf
<i>symbol</i>).
<!--l. 4559--><p class="indent" >   The keyword arguments correspond to the <i>option</i> arguments of <a 
href="#x179-414002r878">defgeneric</a>,
except that the :method-class and :generic-function-class arguments can be class
objects as well as names.
<!--l. 4565--><p class="indent" >   The :environment argument is the same as the &#x0026;environment argument to
macro expansion functions. It is typically used to distinguish between
compile-time and run-time environments.
<!--l. 4569--><p class="indent" >   The :method-combination argument is a method combination object.
<!--l. 4572--><p class="indent" >   The generic function object is returned. See <a 
href="#x179-414002r878">defgeneric</a>.
</div>
<div class=defun>
<!--l. 4577--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-417037"></a><a 
 id="x179-417038r899"></a><b> ﬁnd-class</b>  <i>symbol</i> &#x0026;optional  <i>errorp</i> <i>environment</i>
<!--l. 4579--><p class="noindent" >The function <a 
href="#x179-417038r899">ﬁnd-class</a> returns the class object named by the given symbol in the
given environment.
<!--l. 4586--><p class="indent" >   The ﬁrst argument to <a 
href="#x179-417038r899">ﬁnd-class</a> is a symbol.
<!--l. 4588--><p class="indent" >   If there is no such class and the <i>errorp</i> argument is not supplied or
is non-<a 
href="clmse31.html#x42-74002r18">nil</a>, <a 
href="#x179-417038r899">ﬁnd-class</a> signals an error. If there is no such class and the
<i>errorp</i> argument is <a 
href="clmse31.html#x42-74002r18">nil</a>, <a 
href="#x179-417038r899">ﬁnd-class</a> returns <a 
href="clmse31.html#x42-74002r18">nil</a>. The default value of <i>errorp</i> is
<a 
href="clmse31.html#x42-74004r19">t</a>.
                                                                          

                                                                          
<!--l. 4594--><p class="indent" >   The optional <i>environment</i> argument is the same as the &#x0026;environment
argument to macro expansion functions. It is typically used to distinguish between
compile-time and run-time environments.
<!--l. 4599--><p class="indent" >   The result of <a 
href="#x179-417038r899">ﬁnd-class</a> is the class object named by the given symbol.
<!--l. 4602--><p class="indent" >   The class associated with a particular symbol can be changed by using <a 
href="clmse36.html#x48-90002r64">setf</a>
with <a 
href="#x179-417038r899">ﬁnd-class</a>. The results are undeﬁned if the user attempts to change the class
associated with a symbol that is deﬁned as a type speciﬁer in chapter <a 
href="clmch4.html#x26-440004">4<!--tex4ht:ref: DTSPEC --></a>. See
section <a 
href="clmse145.html#x178-37400028.1.4">28.1.4<!--tex4ht:ref: Integrating-Types-and-Classes-SECTION --></a>.
</div>
<div class=defun>
<!--l. 4611--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-417039"></a><a 
 id="x179-417040r900"></a><b> ﬁnd-method</b>  <i>generic-function</i> <i>method-qualiﬁers</i> <i>specializers</i>
&#x0026;optional  <i>errorp</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417041"></a><a 
 id="x179-417042r901"></a><b> ﬁnd-method</b>  (<i>generic-function</i> standard-generic-function)
<i>method-qualiﬁers</i> <i>specializers</i> &#x0026;optional  <i>errorp</i>
<!--l. 4615--><p class="noindent" >The generic function <a 
href="#x179-417042r901">ﬁnd-method</a> takes a generic function and returns the method
object that agrees on method qualiﬁers and parameter specializers with the
<i>method-qualiﬁers</i> and specializers arguments of <a 
href="#x179-417042r901">ﬁnd-method</a>. See section <a 
href="clmse145.html#x178-38100028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a>
for a deﬁnition of agreement in this context.
<!--l. 4627--><p class="indent" >   The <i>generic-function</i> argument is a generic function.
<!--l. 4629--><p class="indent" >   The <i>method-qualiﬁers</i> argument is a list of the method qualiﬁers for the
method. The order of the method qualiﬁers is signiﬁcant.
<!--l. 4633--><p class="indent" >   The <i>specializers</i> argument is a list of the parameter specializers for the
method. It must correspond in length to the number of required arguments of the
generic function, or an error is signaled. This means that to obtain the default
method on a given generic function, a list whose elements are the class named <a 
href="clmse31.html#x42-74004r19">t</a>
must be given.
<!--l. 4640--><p class="indent" >   If there is no such method and the <i>errorp</i> argument is not supplied or is
non-<a 
href="clmse31.html#x42-74002r18">nil</a>, <a 
href="#x179-417042r901">ﬁnd-method</a> signals an error. If there is no such method and the <i>errorp</i>
argument is <a 
href="clmse31.html#x42-74002r18">nil</a>, <a 
href="#x179-417042r901">ﬁnd-method</a> returns <a 
href="clmse31.html#x42-74002r18">nil</a>. The default value of <i>errorp</i> is
<a 
href="clmse31.html#x42-74004r19">t</a>.
<!--l. 4647--><p class="indent" >   The result of <a 
href="#x179-417042r901">ﬁnd-method</a> is the method object with the given method
qualiﬁers and parameter specializers.
<!--l. 4650--><p class="indent" >   See section <a 
href="clmse145.html#x178-38100028.1.6">28.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a>.
</div>
<div class=defun>
<!--l. 4655--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-417043"></a><a 
 id="x179-417044r902"></a><b> function-keywords</b>  <i>method</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-417045"></a><a 
 id="x179-417046r903"></a><b> function-keywords</b>  (<i>method</i> standard-method)
<!--l. 4658--><p class="noindent" >The generic function <a 
href="#x179-417046r903">function-keywords</a> is used to return the keyword parameter
                                                                          

                                                                          
speciﬁers for a given method.
<!--l. 4666--><p class="indent" >   The <i>method</i> argument is a method object.
<!--l. 4669--><p class="indent" >   The generic function <a 
href="#x179-417046r903">function-keywords</a> returns two values: a list of the
explicitly named keywords and a boolean that states whether &#x0026;allow-other-keys
had been speciﬁed in the method deﬁnition.
</div>
<div class=defspec>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Специальная форма]</i><b> generic-ﬂet </b><a 
 id="dx179-417047"></a><a 
 id="x179-417048r904"></a> ( {(function-name lambda-list
</td></tr></table>
<!--l. 4678--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> [[<span class="math"> ↓</span>option |  {method-description}* ]] )}* )</td></tr></table>
<!--l. 4679--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> { form}* </td></tr></table>
<!--l. 4680--><p class="indent" >
</div>
<!--l. 4680--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-41800028.2" id="x179-41800028.2"></a></span>
   The <a 
href="#x179-417048r904">generic-ﬂet</a> special form is analogous to the <a 
href="clmse39.html#x51-103002r77">ﬂet</a> special form. It produces
new generic functions and establishes new lexical function deﬁnition bindings.
Each generic function is created with the set of methods speciﬁed by its method
descriptions.
<!--l. 4688--><p class="indent" >   The special form <a 
href="#x179-417048r904">generic-ﬂet</a> is used to deﬁne generic functions whose names
are meaningful only locally and to execute a series of forms with these function
deﬁnition bindings. Any number of such local generic functions may be
deﬁned.
<!--l. 4694--><p class="indent" >   The names of functions deﬁned by <a 
href="#x179-417048r904">generic-ﬂet</a> have lexical scope; they retain
their local deﬁnitions only within the body of the <a 
href="#x179-417048r904">generic-ﬂet</a>. Any references
within the body of the <a 
href="#x179-417048r904">generic-ﬂet</a> to functions whose names are the same as those
deﬁned within the <a 
href="#x179-417048r904">generic-ﬂet</a> are thus references to the local functions instead of
to any global functions of the same names. The scope of these generic function
deﬁnition bindings, however, includes only the body of <a 
href="#x179-417048r904">generic-ﬂet</a>, not the
deﬁnitions themselves. Within the method bodies, local function names
that match those being deﬁned refer to global functions deﬁned outside
the <a 
href="#x179-417048r904">generic-ﬂet</a>. It is thus not possible to deﬁne recursive functions with
<a 
href="#x179-417048r904">generic-ﬂet</a>.
                                                                          

                                                                          
<!--l. 4708--><p class="indent" >   The <i>function-name</i>, <i>lambda-list</i>, <i>option</i>, <i> method-qualiﬁer</i>, and
<i>specialized-lambda-list</i> arguments are the same as for <a 
href="#x179-414002r878">defgeneric</a>.
<!--l. 4713--><p class="indent" >   A <a 
href="#x179-417048r904">generic-ﬂet</a> local method deﬁnition is identical in form to the method
deﬁnition part of a <a 
href="#x179-416002r881">defmethod</a>.
<!--l. 4717--><p class="indent" >   The body of each method is enclosed in an implicit block. If <i> function-name</i>
is a symbol, this block bears the same name as the generic function. If
<i>function-name</i> is a list of the form (setf <i>symbol</i>), the name of the block is <i>
symbol</i>.
<!--l. 4724--><p class="indent" >   The result returned by <a 
href="#x179-417048r904">generic-ﬂet</a> is the value or values returned
by the last form executed. If no forms are speciﬁed, <a 
href="#x179-417048r904">generic-ﬂet</a> returns
<a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 4728--><p class="indent" >   See <a 
href="#x179-419002r906">generic-labels</a>, <a 
href="#x179-416002r881">defmethod</a>, <a 
href="#x179-414002r878">defgeneric</a>, and <a 
href="#x179-418002r905">generic-function</a>.
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> generic-function </b><a 
 id="dx179-418001"></a><a 
 id="x179-418002r905"></a> lambda-list  [[<span class="math"> ↓</span>option |  {method-description}* ]]
</td></tr></table>
<!--l. 4734--><p class="indent" >
</div>
<!--l. 4734--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-41900028.2" id="x179-41900028.2"></a></span>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>option</i> ::= (:argument-precedence-order  {<i>parameter-name</i>}+ )
</td></tr></table>
<!--l. 4736--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    | (declare  {<i>declaration</i>}+ )</td></tr></table>
<!--l. 4737--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    | (:documentation <i>string</i>)</td></tr></table>
<!--l. 4739--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    | (:method-combination <i>symbol</i> {<i>arg</i>}* )</td></tr></table>
<!--l. 4740--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    | (:generic-function-class <i>class-name</i>)</td></tr></table>
<!--l. 4741--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    | (:method-class <i>class-name</i>)</td></tr></table>
<!--l. 4742--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 4742--><p class="indent" >   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>method-description</i> ::= (:method   {<i>method-qualiﬁer</i>}*  <i>specialized-lambda-list</i> {<i>declaration | documentation</i>}*  {<i> form</i>}* )</td></tr></table>
<!--l. 4746--><p class="indent" >
                                                                          

                                                                          
</div>
<!--l. 4747--><p class="noindent" >The <a 
href="#x179-418002r905">generic-function</a> macro creates an anonymous generic function. The
generic function is created with the set of methods speciﬁed by its method
descriptions.
<!--l. 4754--><p class="indent" >   The <i>option</i>, <i>method-qualiﬁer</i>, and specialized-lambda-list arguments are the
same as for <a 
href="#x179-414002r878">defgeneric</a>.
<!--l. 4759--><p class="indent" >   The generic function object is returned as the result.
<!--l. 4762--><p class="indent" >   If no method descriptions are speciﬁed, an anonymous generic function with
no methods is created.
<!--l. 4765--><p class="indent" >   See <a 
href="#x179-414002r878">defgeneric</a>, <a 
href="#x179-417048r904">generic-ﬂet</a>, <a 
href="#x179-419002r906">generic-labels</a>, and <a 
href="#x179-416002r881">defmethod</a>.
</div>
<div class=defspec>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Специальная форма]</i><b> generic-labels </b><a 
 id="dx179-419001"></a><a 
 id="x179-419002r906"></a> ( {(function-name lambda-list
</td></tr></table>
<!--l. 4771--><p class="indent" >                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> [[<span class="math"> ↓</span>option |  {method-description}* ]] )}* )</td></tr></table>
<!--l. 4772--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> { form}* </td></tr></table>
<!--l. 4773--><p class="indent" >
</div>
<!--l. 4773--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-42000028.2" id="x179-42000028.2"></a></span>
<!--l. 4775--><p class="indent" >   The <a 
href="#x179-419002r906">generic-labels</a> special form is analogous to the <a 
href="clmse39.html#x51-103004r78">labels</a> special form. It
produces new generic functions and establishes new lexical function deﬁnition
bindings. Each generic function is created with the set of methods speciﬁed by its
method descriptions.
<!--l. 4783--><p class="indent" >   The special form <a 
href="#x179-419002r906">generic-labels</a> is used to deﬁne generic functions whose names
are meaningful only locally and to execute a series of forms with these function
deﬁnition bindings. Any number of such local generic functions may be
deﬁned.
<!--l. 4790--><p class="indent" >   The names of functions deﬁned by <a 
href="#x179-419002r906">generic-labels</a> have lexical scope; they
retain their local deﬁnitions only within the body of the <a 
href="#x179-419002r906">generic-labels</a> construct.
Any references within the body of the <a 
href="#x179-419002r906">generic-labels</a> construct to functions whose
                                                                          

                                                                          
names are the same as those deﬁned within the <a 
href="#x179-419002r906">generic-labels</a> form are thus
references to the local functions instead of to any global functions of the same
names. The scope of these generic function deﬁnition bindings includes
the method bodies themselves as well as the body of the <a 
href="#x179-419002r906">generic-labels</a>
construct.
<!--l. 4803--><p class="indent" >   The <i>function-name</i>, <i>lambda-list</i>, <i>option</i>, method-qualiﬁer, and
<i>specialized-lambda-list</i> arguments are the same as for <a 
href="#x179-414002r878">defgeneric</a>.
<!--l. 4807--><p class="indent" >   A <a 
href="#x179-419002r906">generic-labels</a> local method deﬁnition is identical in form to the method
deﬁnition part of a <a 
href="#x179-416002r881">defmethod</a>.
<!--l. 4810--><p class="indent" >   The body of each method is enclosed in an implicit block. If function-name
is a symbol, this block bears the same name as the generic function. If
<i>function-name</i> is a list of the form (setf <i>symbol</i>), the name of the block is
symbol.
<!--l. 4817--><p class="indent" >   The result returned by <a 
href="#x179-419002r906">generic-labels</a> is the value or values returned by
the last form executed. If no forms are speciﬁed, <a 
href="#x179-419002r906">generic-labels</a> returns
<a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 4821--><p class="indent" >   See <a 
href="#x179-417048r904">generic-ﬂet</a>, <a 
href="#x179-416002r881">defmethod</a>, <a 
href="#x179-414002r878">defgeneric</a>, <a 
href="#x179-418002r905">generic-function</a>.
</div>
<div class=defun>
<!--l. 4825--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420001"></a><a 
 id="x179-420002r907"></a><b> initialize-instance</b>  <i>instance</i> &#x0026;rest  <i>initargs</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420003"></a><a 
 id="x179-420004r908"></a><b> initialize-instance</b>  (<i>instance</i> standard-object) &#x0026;rest
<i>initargs</i>
<!--l. 4828--><p class="noindent" >The generic function <a 
href="#x179-420004r908">initialize-instance</a> is called by <a 
href="#x179-420012r912">make-instance</a> to initialize a
newly created instance. The generic function <a 
href="#x179-420004r908">initialize-instance</a> is called with the
new instance and the defaulted initialization arguments.
<!--l. 4834--><p class="indent" >   The system-supplied primary method on <a 
href="#x179-420004r908">initialize-instance</a> initializes the slots
of the instance with values according to the initialization arguments and the
:initform forms of the slots. It does this by calling the generic function
<a 
href="#x179-420051r931">shared-initialize</a> with the following arguments: the instance, <a 
href="clmse31.html#x42-74004r19">t</a> (this indicates that
all slots for which no initialization arguments are provided should be
initialized according to their :initform forms) and the defaulted initialization
arguments.
<!--l. 4847--><p class="indent" >   The <i>instance</i> argument is the object to be initialized.
<!--l. 4849--><p class="indent" >   The <i>initargs</i> argument consists of alternating initialization argument names
and values.
<!--l. 4853--><p class="indent" >   The modiﬁed instance is returned as the result.
<!--l. 4856--><p class="indent" >   Programmers can deﬁne methods for <a 
href="#x179-420004r908">initialize-instance</a> to specify actions
to be taken when an instance is initialized. If only :after methods are
                                                                          

                                                                          
deﬁned, they will be run after the system-supplied primary method for
initialization and therefore will not interfere with the default behavior of
<a 
href="#x179-420004r908">initialize-instance</a>.
<!--l. 4862--><p class="indent" >   See sections <a 
href="clmse145.html#x178-39300028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>, <a 
href="clmse145.html#x178-39700028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, and <a 
href="clmse145.html#x178-39500028.1.9">28.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <a 
href="#x179-420051r931">shared-initialize</a>, <a 
href="#x179-420012r912">make-instance</a>,
<a 
href="#x179-420053r932">slot-boundp</a>, and <a 
href="#x179-420057r934">slot-makunbound</a>.
</div>
<div class=defun>
<!--l. 4872--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-420005"></a><a 
 id="x179-420006r909"></a><b> invalid-method-error</b>  <i>method</i> <i>format-string</i> &#x0026;rest  <i>args</i>
<!--l. 4874--><p class="noindent" >The function <a 
href="#x179-420006r909">invalid-method-error</a> is used to signal an error when there
is an applicable method whose qualiﬁers are not valid for the method
combination type. The error message is constructed by using a <a 
href="clmse112.html#x139-263003r687">format</a> string
and any arguments to it. Because an implementation may need to add
additional contextual information to the error message, <a 
href="#x179-420006r909">invalid-method-error</a>
should be called only within the dynamic extent of a method combination
function.
<!--l. 4883--><p class="indent" >   The function <a 
href="#x179-420006r909">invalid-method-error</a> is called automatically when a method fails
to satisfy every qualiﬁer pattern and predicate in a deﬁne-method-combination
form. A method combination function that imposes additional restrictions should
call <a 
href="#x179-420006r909">invalid-method-error</a> explicitly if it encounters a method it cannot
accept.
<!--l. 4895--><p class="indent" >   The <i>method</i> argument is the invalid method object.
<!--l. 4897--><p class="indent" >   The <i>format-string</i> argument is a control string that can be given to <a 
href="clmse112.html#x139-263003r687">format</a>,
and <i>args</i> are any arguments required by that string.
<!--l. 4902--><p class="indent" >   Whether <a 
href="#x179-420006r909">invalid-method-error</a> returns to its caller or exits via <a 
href="clmse44.html#x56-141002r116">throw</a> is
implementation-dependent.
<!--l. 4905--><p class="indent" >   See <a 
href="#x179-415005r880">deﬁne-method-combination</a>.
</div>
<div class=defun>
<!--l. 4910--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420007"></a><a 
 id="x179-420008r910"></a><b> make-instance</b>  <i>class</i> &#x0026;rest  <i>initargs</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420009"></a><a 
 id="x179-420010r911"></a><b> make-instance</b>  (<i>class</i> standard-class) &#x0026;rest  <i>initargs</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420011"></a><a 
 id="x179-420012r912"></a><b> make-instance</b>  (<i>class</i> symbol) &#x0026;rest  <i>initargs</i>
<!--l. 4914--><p class="noindent" >The generic function <a 
href="#x179-420012r912">make-instance</a> creates a new instance of the given
class.
<!--l. 4918--><p class="indent" >   The generic function <a 
href="#x179-420012r912">make-instance</a> may be used as described in
section <a 
href="clmse145.html#x178-39300028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>.
<!--l. 4925--><p class="indent" >   The <i>class</i> argument is a class object or a symbol that names a class. The
remaining arguments form a list of alternating initialization argument names and
values.
                                                                          

                                                                          
<!--l. 4929--><p class="indent" >   If the second of the preceding methods is selected, that method invokes
<a 
href="#x179-420012r912">make-instance</a> on the arguments (ﬁnd-class <i>class</i>) and <i>initargs</i>.
<!--l. 4933--><p class="indent" >   The initialization arguments are checked within <a 
href="#x179-420012r912">make-instance</a> (see
section <a 
href="clmse145.html#x178-39300028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>).
<!--l. 4937--><p class="indent" >   The new instance is returned.
<!--l. 4940--><p class="indent" >   The meta-object protocol can be used to deﬁne new methods on <a 
href="#x179-420012r912">make-instance</a>
to replace the object-creation protocol.
<!--l. 4943--><p class="indent" >   See section <a 
href="clmse145.html#x178-39300028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a> as well as <a 
href="#x179-413022r877">defclass</a>, <a 
href="#x179-420004r908">initialize-instance</a>, and <a 
href="#x179-413018r875">class-of</a>.
</div>
<div class=defun>
<!--l. 4949--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420013"></a><a 
 id="x179-420014r913"></a><b> make-instances-obsolete</b>  <i>class</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420015"></a><a 
 id="x179-420016r914"></a><b> make-instances-obsolete</b>  (<i>class</i> standard-class)<br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420017"></a><a 
 id="x179-420018r915"></a><b> make-instances-obsolete</b>  (<i>class</i> symbol)
<!--l. 4953--><p class="noindent" >The generic function <a 
href="#x179-420018r915">make-instances-obsolete</a> is invoked automatically by the
system when <a 
href="#x179-413022r877">defclass</a> has been used to redeﬁne an existing standard class and
the set of local slots accessible in an instance is changed or the order
of slots in storage is changed. It can also be explicitly invoked by the
user.
<!--l. 4960--><p class="indent" >   The function <a 
href="#x179-420018r915">make-instances-obsolete</a> has the eﬀect of initiating the process of
updating the instances of the class. During updating, the generic function
update-instance-for-redeﬁned-class will be invoked.
<!--l. 4969--><p class="indent" >   The <i>class</i> argument is a class object symbol that names the class whose
instances are to be made obsolete.
<!--l. 4972--><p class="indent" >   If the second of the preceding methods is selected, that method invokes
<a 
href="#x179-420018r915">make-instances-obsolete</a> on (ﬁnd-class <i>class</i>).
<!--l. 4976--><p class="indent" >   The modiﬁed class is returned. The result of <a 
href="#x179-420018r915">make-instances-obsolete</a> is <a 
href="clmse33.html#x44-78002r44">eq</a> to
the <i>class</i> argument supplied to the ﬁrst of the preceding methods.
<!--l. 4980--><p class="indent" >   See section <a 
href="clmse145.html#x178-40100028.1.10">28.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a> as well as update-instance-for-redeﬁned-class.
</div>
<div class=defun>
<!--l. 4986--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-420019"></a><a 
 id="x179-420020r916"></a><b> method-combination-error</b>  <i>format-string</i> &#x0026;rest  <i>args</i>
<!--l. 4988--><p class="noindent" >The function <a 
href="#x179-420020r916">method-combination-error</a> is used to signal an error in method
combination. The error message is constructed by using a <a 
href="clmse112.html#x139-263003r687">format</a> string and any
arguments to it. Because an implementation may need to add additional
contextual information to the error message, <a 
href="#x179-420020r916">method-combination-error</a>
should be called only within the dynamic extent of a method combination
function.
<!--l. 5000--><p class="indent" >   The <i>format-string</i> argument is a control string that can be given to <a 
href="clmse112.html#x139-263003r687">format</a>,
                                                                          

                                                                          
and <i>args</i> are any arguments required by that string.
<!--l. 5005--><p class="indent" >   Whether <a 
href="#x179-420020r916">method-combination-error</a> returns to its caller or exits via <a 
href="clmse44.html#x56-141002r116">throw</a> is
implementation-dependent.
<!--l. 5008--><p class="indent" >   See <a 
href="#x179-415005r880">deﬁne-method-combination</a>.
</div>
<div class=defun>
<!--l. 5014--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420021"></a><a 
 id="x179-420022r917"></a><b> method-qualiﬁers</b>  <i>method</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420023"></a><a 
 id="x179-420024r918"></a><b> method-qualiﬁers</b>  (<i>method</i> standard-method)
<!--l. 5017--><p class="noindent" >The generic function <a 
href="#x179-420024r918">method-qualiﬁers</a> returns a list of the qualiﬁers of the given
method.
<!--l. 5025--><p class="indent" >   The <i>method</i> argument is a method object.
<!--l. 5028--><p class="indent" >   A list of the qualiﬁers of the given method is returned.
<!--l. 5030--><p class="indent" >   Example: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(setq methods (remove-duplicates methods
</td></tr></table>
<!--l. 5032--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 :from-end t</td></tr></table>
<!--l. 5033--><p class="indent" >           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 :key #&#x2019;method-qualiﬁers</td></tr></table>
<!--l. 5034--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                                 :test #&#x2019;equal))</td></tr></table>
<!--l. 5036--><p class="indent" >
</div>
</div>
<!--l. 5038--><p class="indent" >   See <a 
href="#x179-415005r880">deﬁne-method-combination</a>.
</div>
<div class=defun>
<!--l. 5043--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-420025"></a><a 
 id="x179-420026r919"></a><b> next-method-p</b>
<!--l. 5045--><p class="noindent" >The locally deﬁned function <a 
href="#x179-420026r919">next-method-p</a> can be used within the body of a
method deﬁned by a method-deﬁning form to determine whether a next method
exists.
<!--l. 5054--><p class="indent" >   The function <a 
href="#x179-420026r919">next-method-p</a> takes no arguments.
<!--l. 5057--><p class="indent" >   The function <a 
href="#x179-420026r919">next-method-p</a> returns true or false.
<!--l. 5060--><p class="indent" >   Like <a 
href="#x179-413002r867">call-next-method</a>, the function <a 
href="#x179-420026r919">next-method-p</a> has lexical scope (for it is
deﬁned only within the body of a method deﬁned by a method-deﬁning form) and
indeﬁnite extent.
<!--l. 5065--><p class="indent" >   See <a 
href="#x179-413002r867">call-next-method</a>.
</div>
                                                                          

                                                                          
<div class=defun>
<!--l. 5070--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420027"></a><a 
 id="x179-420028r920"></a><b> no-applicable-method</b>  <i>generic-function</i> &#x0026;rest
<i>function-arguments</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420029"></a><a 
 id="x179-420030r921"></a><b> no-applicable-method</b>  (<i>generic-function</i> t) &#x0026;rest
<i>function-arguments</i>
<!--l. 5073--><p class="noindent" >The generic function <a 
href="#x179-420030r921">no-applicable-method</a> is called when a generic function of the
class standard-generic-function is invoked and no method on that generic function
is applicable. The default method signals an error.
<!--l. 5079--><p class="indent" >   The generic function <a 
href="#x179-420030r921">no-applicable-method</a> is not intended to be called by
programmers. Programmers may write methods for it.
<!--l. 5086--><p class="indent" >   The <i>generic-function</i> argument of <a 
href="#x179-420030r921">no-applicable-method</a> is the generic function
object on which no applicable method was found.
<!--l. 5089--><p class="indent" >   The <i>function-arguments</i> argument is a list of the arguments to that generic
function.
</div>
<div class=defun>
<!--l. 5094--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420031"></a><a 
 id="x179-420032r922"></a><b> no-next-method</b>  <i>generic-function</i> <i>method</i> &#x0026;rest
<i>args</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420033"></a><a 
 id="x179-420034r923"></a><b> no-next-method</b>  (<i>generic-function</i> standard-generic-function)
(<i>method</i> standard-method) &#x0026;rest  <i>args</i>
<!--l. 5098--><p class="noindent" >The generic function <a 
href="#x179-420034r923">no-next-method</a> is called by <a 
href="#x179-413002r867">call-next-method</a> when there is
no next method. The system-supplied method on <a 
href="#x179-420034r923">no-next-method</a> signals an
error.
<!--l. 5103--><p class="indent" >   The generic function <a 
href="#x179-420034r923">no-next-method</a> is not intended to be called by
programmers. Programmers may write methods for it.
<!--l. 5110--><p class="indent" >   The <i>generic-function</i> argument is the generic function object to which the
method that is the second argument belongs.
<!--l. 5113--><p class="indent" >   The <i>method</i> argument is the method that contains the call to <a 
href="#x179-413002r867">call-next-method</a>
for which there is no next method.
<!--l. 5116--><p class="indent" >   The <i>args</i> argument is a list of the arguments to <a 
href="#x179-413002r867">call-next-method</a>.
<!--l. 5119--><p class="indent" >   See <a 
href="#x179-413002r867">call-next-method</a>.
</div>
<div class=defun>
<!--l. 5124--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420035"></a><a 
 id="x179-420036r924"></a><b> print-object</b>  <i>object</i> <i>stream</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420037"></a><a 
 id="x179-420038r925"></a><b> print-object</b>  (<i>object</i> standard-object) <i>stream</i>
<!--l. 5127--><p class="noindent" >The generic function <a 
href="#x179-420038r925">print-object</a> writes the printed representation of an object to
a stream. The function <a 
href="#x179-420038r925">print-object</a> is called by the print system; it should not be
called by the user.
                                                                          

                                                                          
<!--l. 5135--><p class="indent" >   Each implementation must provide a method on the class standard-object and
methods on enough other classes so as to ensure that there is always an applicable
method. Implementations are free to add methods for other classes. Users can
write methods for <a 
href="#x179-420038r925">print-object</a> for their own classes if they do not wish to inherit
an implementation-supplied method.
<!--l. 5142--><p class="indent" >   The ﬁrst argument is any Lisp object. The second argument is a stream; it
cannot be <a 
href="clmse31.html#x42-74004r19">t</a> or <a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 5145--><p class="indent" >   The function <a 
href="#x179-420038r925">print-object</a> returns its ﬁrst argument, the object.
<!--l. 5147--><p class="indent" >   Methods on <a 
href="#x179-420038r925">print-object</a> must obey the print control special variables named
*print-<i>xxx</i>* for various <i>xxx</i>. The speciﬁc details are the following:
      <ul class="itemize1">
      <li class="itemize">Each method must implement <a 
href="clmse110.html#x137-254034r642">*print-escape*</a>.
      </li>
      <li class="itemize">The <a 
href="clmse110.html#x137-254036r643">*print-pretty*</a> control variable can be ignored by most methods
      other than the one for lists.
      </li>
      <li class="itemize">The *print-circle* control variable is handled by the printer and can be
      ignored by methods.
      </li>
      <li class="itemize">The printer takes care of *print-level* automatically, provided that
      each  method  handles  exactly  one  level  of  structure  and  calls  <a 
href="clmse112.html#x139-260006r668">write</a>
      (or  an  equivalent  function)  recursively  if  there  are  more  structural
      levels. The printer&#x2019;s decision of whether an object has components (and
      therefore should not be printed when the printing depth is not less than
      *print-level*) is implementation-dependent. In some implementations
      its <a 
href="#x179-420038r925">print-object</a> method is not called; in others the method is called, and
      the determination that the object has components is based on what it
      tries to write to the stream.
      </li>
      <li class="itemize">Methods   that   produce   output   of   indeﬁnite   length   must   obey
      *print-length*, but most methods other than the one for lists can ignore
      it.
                                                                          

                                                                          
      </li>
      <li class="itemize">The  *print-base*,  *print-radix*,  *print-case*,  *print-gensym*,  and
      *print-array* control variables apply to speciﬁc types of objects and
      are handled by the methods for those objects.
      </li>
      <li class="itemize">X3J13 voted in June 1989 <a 
 id="dx179-420039"></a>to add the following point. All methods
      for <a 
href="#x179-420038r925">print-object</a> must obey *print-readably*, which takes precedence
      over all other printer control variables. This includes both user-deﬁned
      methods and implementation-deﬁned methods.</li></ul>
<!--l. 5194--><p class="indent" >   If these rules are not obeyed, the results are undeﬁned.
<!--l. 5196--><p class="indent" >   In general, the printer and the <a 
href="#x179-420038r925">print-object</a> methods should not rebind the
print control variables as they operate recursively through the structure, but this
is implementation-dependent.
<!--l. 5200--><p class="indent" >   In some implementations the stream argument passed to a <a 
href="#x179-420038r925">print-object</a>
method is not the original stream but is an intermediate stream that implements
part of the printer. Methods should therefore not depend on the identity of this
stream.
<!--l. 5205--><p class="indent" >   All of the existing printing functions (<a 
href="clmse112.html#x139-260006r668">write</a>, prin1, <a 
href="clmse112.html#x139-260010r670">print</a>, <a 
href="clmse112.html#x139-260014r672">princ</a>, <a 
href="clmse112.html#x139-260012r671">pprint</a>,
<a 
href="clmse112.html#x139-260024r676">write-to-string</a>, prin1-to-string, <a 
href="clmse112.html#x139-260022r675">princ-to-string</a>, the ~S and ~A <a 
href="clmse112.html#x139-263003r687">format</a> operations,
and the ~B, ~D, ~E, ~F, ~G, ~$, ~O, ~R, and ~X <a 
href="clmse112.html#x139-263003r687">format</a> operations when they
encounter a non-numeric value) are required to be changed to go through the
<a 
href="#x179-420038r925">print-object</a> generic function. Each implementation is required to replace its
former implementation of printing with one or more <a 
href="#x179-420038r925">print-object</a> methods.
Exactly which classes have methods for <a 
href="#x179-420038r925">print-object</a> is not speciﬁed; it would be
valid for an implementation to have one default method that is inherited by all
system-deﬁned classes.
</div>
<div class=defun>
<!--l. 5222--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420040"></a><a 
 id="x179-420041r926"></a><b> reinitialize-instance</b>  <i>instance</i> &#x0026;rest  <i>initargs</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420042"></a><a 
 id="x179-420043r927"></a><b> reinitialize-instance</b>  (<i>instance</i> standard-object) &#x0026;rest
<i>initargs</i>
<!--l. 5225--><p class="noindent" >The generic function <a 
href="#x179-420043r927">reinitialize-instance</a> can be used to change the values of local
slots according to initialization arguments. This generic function is called by the
Meta-Object Protocol. It can also be called by users.
<!--l. 5231--><p class="indent" >   The system-supplied primary method for <a 
href="#x179-420043r927">reinitialize-instance</a> checks the
validity of initialization arguments and signals an error if an initialization
                                                                          

                                                                          
argument is supplied that is not declared valid. The method then calls the generic
function <a 
href="#x179-420051r931">shared-initialize</a> with the following arguments: the instance, <a 
href="clmse31.html#x42-74002r18">nil</a> (which
means no slots should be initialized according to their :initform forms) and the
initialization arguments it received.
<!--l. 5243--><p class="indent" >   The <i>instance</i> argument is the object to be initialized.
<!--l. 5245--><p class="indent" >   The <i>initargs</i> argument consists of alternating initialization argument names
and values.
<!--l. 5249--><p class="indent" >   The modiﬁed instance is returned as the result.
<!--l. 5252--><p class="indent" >   Initialization arguments are declared valid by using the :initarg option to
<a 
href="#x179-413022r877">defclass</a>, or by deﬁning methods for <a 
href="#x179-420043r927">reinitialize-instance</a> or shared-initialize. The
keyword name of each keyword parameter speciﬁer in the lambda-list of any
method deﬁned on <a 
href="#x179-420043r927">reinitialize-instance</a> or shared-initialize is declared a
valid initialization argument name for all classes for which that method is
applicable.
<!--l. 5260--><p class="indent" >   See sections <a 
href="clmse145.html#x178-41000028.1.12">28.1.12<!--tex4ht:ref: Reinitializing-an-Instance-SECTION --></a>, <a 
href="clmse145.html#x178-39700028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, <a 
href="clmse145.html#x178-39500028.1.9">28.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <a 
href="#x179-420004r908">initialize-instance</a>, <a 
href="#x179-420053r932">slot-boundp</a>,
update-instance-for-redeﬁned-class, update-instance-for-diﬀerent-class,
<a 
href="#x179-420057r934">slot-makunbound</a>, and <a 
href="#x179-420051r931">shared-initialize</a>.
</div>
<div class=defun>
<!--l. 5271--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420044"></a><a 
 id="x179-420045r928"></a><b> remove-method</b>  <i>generic-function</i> <i>method</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420046"></a><a 
 id="x179-420047r929"></a><b> remove-method</b>  (<i>generic-function</i> standard-generic-function)
<i>method</i>
<!--l. 5274--><p class="noindent" >The generic function <a 
href="#x179-420047r929">remove-method</a> removes a method from a generic function. It
destructively modiﬁes the speciﬁed generic function and returns the modiﬁed
generic function as its result.
<!--l. 5283--><p class="indent" >   The <i>generic-function</i> argument is a generic function object.
<!--l. 5286--><p class="indent" >   The <i>method</i> argument is a method object. The function <a 
href="#x179-420047r929">remove-method</a> does
not signal an error if the method is not one of the methods on the generic
function.
<!--l. 5291--><p class="indent" >   The modiﬁed generic function is returned. The result of <a 
href="#x179-420047r929">remove-method</a> is <a 
href="clmse33.html#x44-78002r44">eq</a>
to the <i>generic-function</i> argument.
<!--l. 5294--><p class="indent" >   See <a 
href="#x179-417042r901">ﬁnd-method</a>.
</div>
<div class=defun>
<!--l. 5297--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420048"></a><a 
 id="x179-420049r930"></a><b> shared-initialize</b>  <i>instance</i> <i>slot-names</i> &#x0026;rest  <i>initargs</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420050"></a><a 
 id="x179-420051r931"></a><b> shared-initialize</b>  (<i>instance</i> standard-object) <i>slot-names</i>
&#x0026;rest  <i>initargs</i>
<!--l. 5300--><p class="noindent" >The generic function <a 
href="#x179-420051r931">shared-initialize</a> is used to ﬁll the slots of an instance using
                                                                          

                                                                          
initialization arguments and :initform forms. It is called when an instance is
created, when an instance is re-initialized, when an instance is updated to
conform to a redeﬁned class, and when an instance is updated to conform to
a diﬀerent class. The generic function shared-initialize is called by the
system-supplied primary method for initialize-instance, reinitialize-instance,
update-instance-for-redeﬁned-class, and update-instance-for-diﬀerent-class.
<!--l. 5312--><p class="indent" >   The generic function <a 
href="#x179-420051r931">shared-initialize</a> takes the following arguments:
the instance to be initialized, a speciﬁcation of a set of names of slots
accessible in that instance, and any number of initialization arguments. The
arguments after the ﬁrst two must form an initialization argument list. The
system-supplied primary method on <a 
href="#x179-420051r931">shared-initialize</a> initializes the slots with
values according to the initialization arguments and speciﬁed :initform forms. The
second argument indicates which slots should be initialized according to
their :initform forms if no initialization arguments are provided for those
slots.
<!--l. 5323--><p class="indent" >   The system-supplied primary method behaves as follows, regardless of whether
the slots are local or shared:
      <ul class="itemize1">
      <li class="itemize">If an initialization argument in the initialization argument list speciﬁes
      a value for that slot, that value is stored into the slot, even if a value
      has already been stored in the slot before the method is run.
      </li>
      <li class="itemize">Any slots indicated by the second argument that are still unbound at
      this point are initialized according to their :initform forms. For any such
      slot that has an :initform form, that form is evaluated in the lexical
      environment of its deﬁning <a 
href="#x179-413022r877">defclass</a> form and the result is stored into
      the slot. For example, if a :before method stores a value in the slot, the
      :initform form will not be used to supply a value for the slot.
      </li>
      <li class="itemize">The rules mentioned in section <a 
href="clmse145.html#x178-39700028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a> are obeyed.
      </li></ul>
<!--l. 5349--><p class="indent" >   The <i>instance</i> argument is the object to be initialized.
<!--l. 5351--><p class="indent" >   The <i>slot-names</i> argument speciﬁes the slots that are to be initialized according
to their :initform forms if no initialization arguments apply. It is supplied in one of
                                                                          

                                                                          
three forms as follows:
      <ul class="itemize1">
      <li class="itemize">It can be a list of slot names, which speciﬁes the set of those slot names.
      </li>
      <li class="itemize">It can be <a 
href="clmse31.html#x42-74002r18">nil</a>, which speciﬁes the empty set of slot names.
      </li>
      <li class="itemize">It can be the symbol <a 
href="clmse31.html#x42-74004r19">t</a>, which speciﬁes the set of all of the slots.
      </li></ul>
<!--l. 5369--><p class="indent" >   The <i>initargs</i> argument consists of alternating initialization argument names
and values.
<!--l. 5373--><p class="indent" >   The modiﬁed instance is returned as the result.
<!--l. 5376--><p class="indent" >   Initialization arguments are declared valid by using the :initarg option to
<a 
href="#x179-413022r877">defclass</a>, or by deﬁning methods for <a 
href="#x179-420051r931">shared-initialize</a>. The keyword name of each
keyword parameter speciﬁer in the lambda-list of any method deﬁned on
<a 
href="#x179-420051r931">shared-initialize</a> is declared a valid initialization argument name for all classes for
which that method is applicable.
<!--l. 5383--><p class="indent" >   Implementations are permitted to optimize :initform forms that neither
produce nor depend on side eﬀects by evaluating these forms and storing them
into slots before running any <a 
href="#x179-420004r908">initialize-instance</a> methods, rather than by handling
them in the primary <a 
href="#x179-420004r908">initialize-instance</a> method. (This optimization might be
implemented by having the allocate-instance method copy a prototype
instance.)
<!--l. 5391--><p class="indent" >   Implementations are permitted to optimize default initial value forms for
initialization arguments associated with slots by not actually creating the
complete initialization argument list when the only method that would receive the
complete list is the method on standard-object. In this case, default initial value
forms can be treated like :initform forms. This optimization has no visible eﬀects
other than a performance improvement.
<!--l. 5399--><p class="indent" >   See sections <a 
href="clmse145.html#x178-39300028.1.9">28.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>, <a 
href="clmse145.html#x178-39700028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, <a 
href="clmse145.html#x178-39500028.1.9">28.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <a 
href="#x179-420004r908">initialize-instance</a>, <a 
href="#x179-420043r927">reinitialize-instance</a>,
update-instance-for-redeﬁned-class, update-instance-for-diﬀerent-class,
<a 
href="#x179-420053r932">slot-boundp</a>, and <a 
href="#x179-420057r934">slot-makunbound</a>.
</div>
<div class=defun>
                                                                          

                                                                          
<!--l. 5411--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-420052"></a><a 
 id="x179-420053r932"></a><b> slot-boundp</b>  <i>instance</i> <i>slot-name</i>
<!--l. 5413--><p class="noindent" >The function <a 
href="#x179-420053r932">slot-boundp</a> tests whether a speciﬁc slot in an instance is
bound.
<!--l. 5421--><p class="indent" >   The arguments are the instance and the name of the slot.
<!--l. 5424--><p class="indent" >   The function <a 
href="#x179-420053r932">slot-boundp</a> returns true or false.
<!--l. 5427--><p class="indent" >   This function allows for writing :after methods on <a 
href="#x179-420004r908">initialize-instance</a> in order
to initialize only those slots that have not already been bound.
<!--l. 5431--><p class="indent" >   If no slot of the given name exists in the instance, <a 
href="#x179-420061r936">slot-missing</a> is called as
follows: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(slot-missing (class-of <i>instance</i>)
</td></tr></table>
<!--l. 5434--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              <i>instance</i></td></tr></table>
<!--l. 5435--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              <i>slot-name</i></td></tr></table>
<!--l. 5436--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x2019;slot-boundp)</td></tr></table>
<!--l. 5438--><p class="indent" >
</div>
</div>
<!--l. 5440--><p class="indent" >   The function <a 
href="#x179-420053r932">slot-boundp</a> is implemented using slot-boundp-using-class. See
<a 
href="#x179-420061r936">slot-missing</a>.
</div>
<div class=defun>
<!--l. 5446--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-420054"></a><a 
 id="x179-420055r933"></a><b> slot-exists-p</b>  <i>object</i> <i>slot-name</i>
<!--l. 5448--><p class="noindent" >The function <a 
href="#x179-420055r933">slot-exists-p</a> tests whether the speciﬁed object has a slot of the given
name.
<!--l. 5456--><p class="indent" >   The <i>object</i> argument is any object. The <i>slot-name</i> argument is a symbol.
<!--l. 5460--><p class="indent" >   The function <a 
href="#x179-420055r933">slot-exists-p</a> returns true or false.
<!--l. 5463--><p class="indent" >   The function <a 
href="#x179-420055r933">slot-exists-p</a> is implemented using slot-exists-p-using-class.
</div>
<div class=defun>
<!--l. 5469--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-420056"></a><a 
 id="x179-420057r934"></a><b> slot-makunbound</b>  <i>instance</i> <i>slot-name</i>
<!--l. 5471--><p class="noindent" >The function <a 
href="#x179-420057r934">slot-makunbound</a> restores a slot in an instance to the unbound
state.
<!--l. 5479--><p class="indent" >   The arguments to <a 
href="#x179-420057r934">slot-makunbound</a> are the instance and the name of the
slot.
<!--l. 5483--><p class="indent" >   The instance is returned as the result.
                                                                          

                                                                          
<!--l. 5486--><p class="indent" >   If no slot of the given name exists in the instance, <a 
href="#x179-420061r936">slot-missing</a> is called as
follows: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(slot-missing (class-of <i>instance</i>)
</td></tr></table>
<!--l. 5489--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              <i>instance</i></td></tr></table>
<!--l. 5490--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              <i>slot-name</i></td></tr></table>
<!--l. 5491--><p class="indent" >                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x2019;slot-makunbound)</td></tr></table>
<!--l. 5493--><p class="indent" >
</div>
</div>
<!--l. 5495--><p class="indent" >   The function <a 
href="#x179-420057r934">slot-makunbound</a> is implemented using slot-makunbound-using-class.
See <a 
href="#x179-420061r936">slot-missing</a>.
</div>
<div class=defun>
<!--l. 5502--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420058"></a><a 
 id="x179-420059r935"></a><b> slot-missing</b>  <i>class</i> <i>object</i> <i>slot-name</i> <i>operation</i> &#x0026;optional
<i>new-value</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420060"></a><a 
 id="x179-420061r936"></a><b> slot-missing</b>  (<i>class</i> t) <i>object</i> <i>slot-name</i> <i>operation</i> &#x0026;optional
<i>new-value</i>
<!--l. 5505--><p class="noindent" >The generic function <a 
href="#x179-420061r936">slot-missing</a> is invoked when an attempt is made to access a
slot in an object whose metaclass is standard-class and the name of the slot
provided is not a name of a slot in that class. The default method signals an
error.
<!--l. 5512--><p class="indent" >   The generic function <a 
href="#x179-420061r936">slot-missing</a> is not intended to be called by programmers.
Programmers may write methods for it.
<!--l. 5519--><p class="indent" >   The required arguments to <a 
href="#x179-420061r936">slot-missing</a> are the class of the object that is
being accessed, the object, the slot name, and a symbol that indicates the
operation that caused <a 
href="#x179-420061r936">slot-missing</a> to be invoked. The optional argument to
<a 
href="#x179-420061r936">slot-missing</a> is used when the operation is attempting to set the value of the
slot.
<!--l. 5526--><p class="indent" >   If a method written for <a 
href="#x179-420061r936">slot-missing</a> returns values, these values get returned
as the values of the original function invocation.
<!--l. 5530--><p class="indent" >   The generic function <a 
href="#x179-420061r936">slot-missing</a> may be called during evaluation of <a 
href="#x179-420067r939">slot-value</a>,
(setf slot-value), <a 
href="#x179-420053r932">slot-boundp</a>, and <a 
href="#x179-420057r934">slot-makunbound</a>. For each of these operations
the corresponding symbol for the <i>operation</i> argument is <a 
href="#x179-420067r939">slot-value</a>, <a 
href="clmse36.html#x48-90002r64">setf</a>,
<a 
href="#x179-420053r932">slot-boundp</a>, and <a 
href="#x179-420057r934">slot-makunbound</a>, respectively.
                                                                          

                                                                          
<!--l. 5537--><p class="indent" >   The set of arguments (including the class of the instance) facilitates deﬁning
methods on the metaclass for <a 
href="#x179-420061r936">slot-missing</a>.
</div>
<div class=defun>
<!--l. 5543--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420062"></a><a 
 id="x179-420063r937"></a><b> slot-unbound</b>  <i>class</i> <i>instance</i> <i>slot-name</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420064"></a><a 
 id="x179-420065r938"></a><b> slot-unbound</b>  (<i>class</i> t) <i>instance</i> <i>slot-name</i>
<!--l. 5546--><p class="noindent" >The generic function <a 
href="#x179-420065r938">slot-unbound</a> is called when an unbound slot is read in an
instance whose metaclass is standard-class. The default method signals an
error.
<!--l. 5552--><p class="indent" >   The generic function <a 
href="#x179-420065r938">slot-unbound</a> is not intended to be called by
programmers. Programmers may write methods for it. The function <a 
href="#x179-420065r938">slot-unbound</a>
is called only by the function slot-value-using-class and thus indirectly by
<a 
href="#x179-420067r939">slot-value</a>.
<!--l. 5561--><p class="indent" >   The arguments to <a 
href="#x179-420065r938">slot-unbound</a> are the class of the instance whose slot was
accessed, the instance itself, and the name of the slot.
<!--l. 5566--><p class="indent" >   If a method written for <a 
href="#x179-420065r938">slot-unbound</a> returns values, these values get returned
as the values of the original function invocation.
<!--l. 5570--><p class="indent" >   An unbound slot may occur if no :initform form was speciﬁed for the slot and
the slot value has not been set, or if <a 
href="#x179-420057r934">slot-makunbound</a> has been called on the
slot.
<!--l. 5574--><p class="indent" >   See <a 
href="#x179-420057r934">slot-makunbound</a>.
</div>
<div class=defun>
<!--l. 5578--><p class="noindent" ><i>[Function]</i><a 
 id="dx179-420066"></a><a 
 id="x179-420067r939"></a><b> slot-value</b>  <i>object</i> <i>slot-name</i>
<!--l. 5580--><p class="noindent" >The function <a 
href="#x179-420067r939">slot-value</a> returns the value contained in the slot <i>slot-name</i> of the
given object. If there is no slot with that name, <a 
href="#x179-420061r936">slot-missing</a> is called. If the slot is
unbound, <a 
href="#x179-420065r938">slot-unbound</a> is called.
<!--l. 5586--><p class="indent" >   The macro <a 
href="clmse36.html#x48-90002r64">setf</a> can be used with <a 
href="#x179-420067r939">slot-value</a> to change the value of a
slot.
<!--l. 5593--><p class="indent" >   The arguments are the object and the name of the given slot.
<!--l. 5596--><p class="indent" >   The result is the value contained in the given slot.
<!--l. 5599--><p class="indent" >   If an attempt is made to read a slot and no slot of the given name exists in the
instance, <a 
href="#x179-420061r936">slot-missing</a> is called as follows: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(slot-missing (class-of <i>instance</i>)
</td></tr></table>
<!--l. 5602--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              <i>instance</i></td></tr></table>
                                                                          

                                                                          
<!--l. 5603--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              <i>slot-name</i></td></tr></table>
<!--l. 5604--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x2019;slot-value)</td></tr></table>
<!--l. 5606--><p class="indent" >
</div>
</div>
<!--l. 5608--><p class="indent" >   If an attempt is made to write a slot and no slot of the given name exists in
the instance, <a 
href="#x179-420061r936">slot-missing</a> is called as follows: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(slot-missing (class-of <i>instance</i>)
</td></tr></table>
<!--l. 5611--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              <i>instance</i></td></tr></table>
<!--l. 5612--><p class="indent" >                                                <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              <i>slot-name</i></td></tr></table>
<!--l. 5613--><p class="indent" >                                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              &#x2019;setf</td></tr></table>
<!--l. 5614--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">              <i>new-value</i>)</td></tr></table>
<!--l. 5616--><p class="indent" >
</div>
</div>
<!--l. 5618--><p class="indent" >   The function <a 
href="#x179-420067r939">slot-value</a> is implemented using slot-value-using-class.
<!--l. 5621--><p class="indent" >   Implementations may optimize <a 
href="#x179-420067r939">slot-value</a> by compiling it in-line.
<!--l. 5623--><p class="indent" >   See <a 
href="#x179-420061r936">slot-missing</a> and <a 
href="#x179-420065r938">slot-unbound</a>.
</div>
<!--l. 5627--><p class="indent" >   [At this point the original CLOS report <span class="cite">[<a 
href="clmli5.html#XSIGPLAN-CLOS">5</a>, <a 
href="clmli5.html#XLASC-CLOS-PART-2">7</a>]</span> contained a speciﬁcation for
<a 
href="clmse39.html#x51-104002r80">symbol-macrolet</a>. This speciﬁcation is omitted here. Instead, a description of
<a 
href="clmse39.html#x51-104002r80">symbol-macrolet</a> appears with those of related constructs in chapter <a 
href="clmch7.html#x46-820007">7<!--tex4ht:ref: CONTRL --></a>.—GLS]
<div class=defun>
<!--l. 5633--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420068"></a><a 
 id="x179-420069r940"></a><b> update-instance-for-diﬀerent-class</b>  <i>previous</i> <i>current</i>
&#x0026;rest  <i>initargs</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420070"></a><a 
 id="x179-420071r941"></a><b> update-instance-for-diﬀerent-class</b>  (<i>previous</i> standard-object)
(<i>current</i> standard-object) &#x0026;rest  <i>initargs</i>
<!--l. 5637--><p class="noindent" >The generic function update-instance-for-diﬀerent-class is not intended to be
called by programmers. Programmers may write methods for it. This function is
called only by the function <a 
href="#x179-413008r870">change-class</a>.
<!--l. 5642--><p class="indent" >   The system-supplied primary method on update-instance-for-diﬀerent-class
checks the validity of initialization arguments and signals an error if an
initialization argument is supplied that is not declared valid. This method then
initializes slots with values according to the initialization arguments and
                                                                          

                                                                          
initializes the newly added slots with values according to their :initform
forms. It does this by calling the generic function <a 
href="#x179-420051r931">shared-initialize</a> with the
following arguments: the instance, a list of names of the newly added
slots, and the initialization arguments it received. Newly added slots are
those local slots for which no slot of the same name exists in the previous
class.
<!--l. 5654--><p class="indent" >   Methods for update-instance-for-diﬀerent-class can be deﬁned to specify
actions to be taken when an instance is updated. If only :after methods for
update-instance-for-diﬀerent-class are deﬁned, they will be run after the
system-supplied primary method for initialization and therefore will not interfere
with the default behavior of update-instance-for-diﬀerent-class.
<!--l. 5667--><p class="indent" >   The arguments to update-instance-for-diﬀerent-class are computed
by <a 
href="#x179-413008r870">change-class</a>. When <a 
href="#x179-413008r870">change-class</a> is invoked on an instance, a copy of
that instance is made; <a 
href="#x179-413008r870">change-class</a> then destructively alters the original
instance. The ﬁrst argument to update-instance-for-diﬀerent-class, <i>previous</i>, is
that copy; it holds the old slot values temporarily. This argument has
dynamic extent within <a 
href="#x179-413008r870">change-class</a>; if it is referenced in any way once
update-instance-for-diﬀerent-class returns, the results are undeﬁned. The second
argument to update-instance-for-diﬀerent-class, <i>current</i>, is the altered original
instance.
<!--l. 5680--><p class="indent" >   The intended use of <i>previous</i> is to extract old slot values by using <a 
href="#x179-420067r939">slot-value</a> or
<a 
href="#x179-422002r946">with-slots</a> or by invoking a reader generic function, or to run other methods that
were applicable to instances of the original class.
<!--l. 5685--><p class="indent" >   The <i>initargs</i> argument consists of alternating initialization argument names
and values.
<!--l. 5689--><p class="indent" >   The value returned by update-instance-for-diﬀerent-class is ignored by
<a 
href="#x179-413008r870">change-class</a>.
<!--l. 5692--><p class="indent" >   See the example for the function <a 
href="#x179-413008r870">change-class</a>.
<!--l. 5695--><p class="indent" >   Initialization arguments are declared valid by using the :initarg option to
<a 
href="#x179-413022r877">defclass</a>, or by deﬁning methods for update-instance-for-diﬀerent-class or
<a 
href="#x179-420051r931">shared-initialize</a>. The keyword name of each keyword parameter speciﬁer in the
lambda-list of any method deﬁned on update-instance-for-diﬀerent-class or
<a 
href="#x179-420051r931">shared-initialize</a> is declared a valid initialization argument name for all classes for
which that method is applicable.
<!--l. 5703--><p class="indent" >   Methods on update-instance-for-diﬀerent-class can be deﬁned to initialize slots
diﬀerently from <a 
href="#x179-413008r870">change-class</a>. The default behavior of change-class is described in
section <a 
href="clmse145.html#x178-40600028.1.11">28.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a>.
<!--l. 5709--><p class="indent" >   See sections <a 
href="clmse145.html#x178-40600028.1.11">28.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a>, <a 
href="clmse145.html#x178-39700028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, and <a 
href="clmse145.html#x178-39500028.1.9">28.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <a 
href="#x179-413008r870">change-class</a> and
                                                                          

                                                                          
<a 
href="#x179-420051r931">shared-initialize</a>.
</div>
                                                                          

                                                                          
<div class=defun>
<!--l. 5717--><p class="noindent" ><i>[Generic function]</i><a 
 id="dx179-420072"></a><a 
 id="x179-420073r942"></a><b> update-instance-for-redeﬁned-class</b>  <i>instance</i> <i>added-slots</i>
<i>discarded-slots</i> <i>property-list</i> &#x0026;rest  <i>initargs</i><br 
class="newline" /><i>[Primary method]</i><a 
 id="dx179-420074"></a><a 
 id="x179-420075r943"></a><b> update-instance-for-redeﬁned-class</b>  (<i>instance</i> standard-object)
<i>added-slots</i> <i>discarded-slots</i> <i>property-list</i> &#x0026;rest  <i>initargs</i>
<!--l. 5722--><p class="noindent" >
<!--l. 5725--><p class="noindent" >The generic function update-instance-for-redeﬁned-class is not intended to be
called by programmers. Programmers may write methods for it. The generic
function update-instance-for-redeﬁned-class is called by the mechanism activated
by <a 
href="#x179-420018r915">make-instances-obsolete</a>.
<!--l. 5732--><p class="indent" >   The system-supplied primary method on update-instance-for-diﬀerent-class
checks the validity of initialization arguments and signals an error if an
initialization argument is supplied that is not declared valid. This method then
initializes slots with values according to the initialization arguments and initializes
the newly added slots with values according to their :initform forms. It does
this by calling the generic function <a 
href="#x179-420051r931">shared-initialize</a> with the following
arguments: the instance, a list of names of the newly added slots, and the
initialization arguments it received. Newly added slots are those local
slots for which no slot of the same name exists in the old version of the
class.
<!--l. 5748--><p class="indent" >   When <a 
href="#x179-420018r915">make-instances-obsolete</a> is invoked or when a class has been redeﬁned
and an instance is being updated, a property list is created that captures the slot
names and values of all the discarded slots with values in the original instance.
The structure of the instance is transformed so that it conforms to the current
class deﬁnition. The arguments to update-instance-for-redeﬁned-class
are this transformed instance, a list of the names of the new slots added
to the instance, a list of the names of the old slots discarded from the
instance, and the property list containing the slot names and values for slots
that were discarded and had values. Included in this list of discarded
slots are slots that were local in the old class and are shared in the new
class.
<!--l. 5761--><p class="indent" >   The <i>initargs</i> argument consists of alternating initialization argument names
and values.
<!--l. 5765--><p class="indent" >   The value returned by update-instance-for-redeﬁned-class is ignored.
<!--l. 5768--><p class="indent" >   Initialization arguments are declared valid by using the :initarg option to
<a 
href="#x179-413022r877">defclass</a> or by deﬁning methods for update-instance-for-redeﬁned-class or
<a 
href="#x179-420051r931">shared-initialize</a>. The keyword name of each keyword parameter speciﬁer in the
lambda-list of any method deﬁned on update-instance-for-redeﬁned-class or
                                                                          

                                                                          
<a 
href="#x179-420051r931">shared-initialize</a> is declared a valid initialization argument name for all classes for
which that method is applicable.
<!--l. 5777--><p class="indent" >   See sections <a 
href="clmse145.html#x178-40100028.1.10">28.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a>, <a 
href="clmse145.html#x178-39700028.1.9">28.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, and <a 
href="clmse145.html#x178-39500028.1.9">28.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <a 
href="#x179-420051r931">shared-initialize</a> and
make-instances-obsolete.
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass position () ())
</td></tr></table>
<!--l. 5784--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5785--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass x-y-position (position)</td></tr></table>
<!--l. 5786--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ((x :initform 0 :accessor position-x)</td></tr></table>
<!--l. 5787--><p class="indent" >                                   <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (y :initform 0 :accessor position-y)))</td></tr></table>
<!--l. 5788--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5789--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; It turns out polar coordinates are used more than Cartesian</td></tr></table>
<!--l. 5790--><p class="indent" >              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; coordinates, so the representation is altered and some new</td></tr></table>
<!--l. 5791--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; accessor methods are added.</td></tr></table>
<!--l. 5792--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5793--><p class="indent" >                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod update-instance-for-redeﬁned-class :before</td></tr></table>
<!--l. 5794--><p class="indent" >                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           ((pos x-y-position) added deleted plist &#x0026;key)</td></tr></table>
<!--l. 5795--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; Transform the x-y coordinates to polar coordinates</td></tr></table>
<!--l. 5796--><p class="indent" >                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  ;; and store into the new slots.</td></tr></table>
<!--l. 5797--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (let ((x (getf plist &#x2019;x))</td></tr></table>
<!--l. 5798--><p class="indent" >                                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        (y (getf plist &#x2019;y)))</td></tr></table>
<!--l. 5799--><p class="indent" >                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (setf (position-rho pos) (sqrt (+ (* x x) (* y y)))</td></tr></table>
<!--l. 5800--><p class="indent" >                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">          (position-theta pos) (atan y x))))</td></tr></table>
<!--l. 5801--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5802--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defclass x-y-position (position)</td></tr></table>
<!--l. 5803--><p class="indent" >                               <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    ((rho :initform 0 :accessor position-rho)</td></tr></table>
<!--l. 5804--><p class="indent" >                         <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (theta :initform 0 :accessor position-theta)))</td></tr></table>
<!--l. 5806--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
                                                                          

                                                                          
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; All instances of the old x-y-position class will be updated
</td></tr></table>
<!--l. 5810--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; automatically.</td></tr></table>
<!--l. 5811--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5812--><p class="indent" >             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">;;; The new representation has the look and feel of the old one.</td></tr></table>
<!--l. 5813--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5814--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod position-x ((pos x-y-position))</td></tr></table>
<!--l. 5815--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (with-slots (rho theta) pos (* rho (cos theta))))</td></tr></table>
<!--l. 5816--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5817--><p class="indent" >                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod (setf position-x) (new-x (pos x-y-position))</td></tr></table>
<!--l. 5818--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (with-slots (rho theta) pos</td></tr></table>
<!--l. 5819--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (let ((y (position-y pos)))</td></tr></table>
<!--l. 5820--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (setq rho (sqrt (+ (* new-x new-x) (* y y)))</td></tr></table>
<!--l. 5821--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             theta (atan y new-x))</td></tr></table>
<!--l. 5822--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       new-x)))</td></tr></table>
<!--l. 5823--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 5824--><p class="indent" >                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod position-y ((pos x-y-position))</td></tr></table>
<!--l. 5825--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (with-slots (rho theta) pos (* rho (sin theta))))</td></tr></table>
<!--l. 5827--><p class="indent" >
</div>
</div>
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(defmethod (setf position-y) (new-y (pos x-y-position))
</td></tr></table>
<!--l. 5829--><p class="indent" >                                             <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">   (with-slots (rho theta) pos</td></tr></table>
<!--l. 5830--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">     (let ((x (position-x pos)))</td></tr></table>
<!--l. 5831--><p class="indent" >                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       (setq rho (sqrt (+ (* x x) (* new-y new-y)))</td></tr></table>
<!--l. 5832--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">             theta (atan new-y x))</td></tr></table>
<!--l. 5833--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">       new-y)))</td></tr></table>
<!--l. 5835--><p class="indent" >
</div>
</div>
</div>
                                                                          

                                                                          
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> with-accessors </b><a 
 id="dx179-420076"></a><a 
 id="x179-420077r944"></a> ( {slot-entry}* ) instance-form
</td></tr></table>
<!--l. 5844--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> {declaration}*  { form}* </td></tr></table>
<!--l. 5845--><p class="indent" >
</div>
<!--l. 5845--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-42100028.2" id="x179-42100028.2"></a></span>
   The macro <a 
href="#x179-420077r944">with-accessors</a> creates a lexical environment in which speciﬁed slots
are lexically available through their accessors as if they were variables.
The macro <a 
href="#x179-420077r944">with-accessors</a> invokes the appropriate accessors to access the
speciﬁed slots. Both <a 
href="clmse36.html#x48-90002r64">setf</a> and <a 
href="clmse35.html#x47-87002r59">setq</a> can be used to set the value of the
slot.
<!--l. 5854--><p class="indent" >   The result returned is that obtained by executing the forms speciﬁed by the
<i>body</i> argument.
<!--l. 5857--><p class="indent" >   Example:
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-accessors ((x position-x) (y position-y)) p1
</td></tr></table>
<!--l. 5860--><p class="indent" >                                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (setq x y))</td></tr></table>
<!--l. 5862--><p class="indent" >
</div>
</div>
<!--l. 5865--><p class="indent" >   A <a 
href="#x179-420077r944">with-accessors</a> expression of the form <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-accessors (<span class="math">slot<sub>1</sub></span> ... <span class="math">slot<sub>n</sub></span>) <i>instance</i>
</td></tr></table>
                                                                          

                                                                          
<!--l. 5867--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <span class="math">declaration<sub>1</sub></span> ... <span class="math">declaration<sub>m</sub></span>)</td></tr></table>
<!--l. 5868--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <span class="math">form<sub>1</sub></span> ... <span class="math">form<sub>k</sub></span>)</td></tr></table>
<!--l. 5870--><p class="indent" >
</div>
</div>
<!--l. 5871--><p class="noindent" >expands into the equivalent of <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(let ((<i>in</i> <i>instance</i>))
</td></tr></table>
<!--l. 5873--><p class="indent" >                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (symbol-macrolet ((<span class="math">variable<sub>1</sub></span> (<span class="math">accessor<sub>1</sub></span> <i>in</i>))</td></tr></table>
<!--l. 5874--><p class="indent" >                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    ...</td></tr></table>
<!--l. 5875--><p class="indent" >                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">                    (<span class="math">variable<sub>n</sub></span> (<span class="math">accessor<sub>n</sub></span> <i>in</i>)))</td></tr></table>
<!--l. 5876--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    <span class="math">declaration<sub>1</sub></span> ... <span class="math">declaration<sub>m</sub></span>)</td></tr></table>
<!--l. 5877--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    <span class="math">form<sub>1</sub></span> ... <span class="math">form<sub>k</sub></span>)</td></tr></table>
<!--l. 5879--><p class="indent" >
</div>
</div>
<!--l. 5881--><p class="indent" >   [X3J13 voted in March 1989 <a 
 id="dx179-421001"></a>to modify the deﬁnition of <a 
href="clmse39.html#x51-104002r80">symbol-macrolet</a>
substantially and also voted <a 
 id="dx179-421002"></a>to allow declarations before the body of <a 
href="clmse39.html#x51-104002r80">symbol-macrolet</a>
but with peculiar treatment of special and type declarations. The syntactic
changes are reﬂected in this deﬁnition of <a 
href="#x179-420077r944">with-accessors</a>.—GLS]
<!--l. 5890--><p class="indent" >   See <a 
href="#x179-422002r946">with-slots</a> and <a 
href="clmse39.html#x51-104002r80">symbol-macrolet</a>.
</div>
<div class=defspec>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Специальная форма]</i><b> with-added-methods </b><a 
 id="dx179-421003"></a><a 
 id="x179-421004r945"></a> (function-name lambda-list
</td></tr></table>
<!--l. 5896--><p class="indent" >                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> [[<span class="math"> ↓</span>option |  {method-description}* ]] )</td></tr></table>
<!--l. 5897--><p class="indent" >                                                                 <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> { form}* </td></tr></table>
<!--l. 5898--><p class="indent" >
</div>
                                                                          

                                                                          
<!--l. 5898--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-42200028.2" id="x179-42200028.2"></a></span>
<!--l. 5901--><p class="noindent" >The <a 
href="#x179-421004r945">with-added-methods</a> special form produces new generic functions and
establishes new lexical function deﬁnition bindings. Each generic function is
created by adding the set of methods speciﬁed by its method deﬁnitions to a copy
of the lexically visible generic function of the same name and its methods. If such
a generic function does not already exist, a new generic function is created; this
generic function has lexical scope.
<!--l. 5910--><p class="indent" >   The special form <a 
href="#x179-421004r945">with-added-methods</a> is used to deﬁne functions whose names
are meaningful only locally and to execute a series of forms with these function
deﬁnition bindings.
<!--l. 5915--><p class="indent" >   The names of functions deﬁned by <a 
href="#x179-421004r945">with-added-methods</a> have lexical scope;
they retain their local deﬁnitions only within the body of the <a 
href="#x179-421004r945">with-added-methods</a>
construct. Any references within the body of the <a 
href="#x179-421004r945">with-added-methods</a>
construct to functions whose names are the same as those deﬁned within the
<a 
href="#x179-421004r945">with-added-methods</a> form are thus references to the local functions instead of to
any global functions of the same names. The scope of these generic function
deﬁnition bindings includes the method bodies themselves as well as the body of
the <a 
href="#x179-421004r945">with-added-methods</a> construct.
<!--l. 5929--><p class="indent" >   The <i>function-name</i>, <i>option</i>, <i>method-qualiﬁer</i>, and <i>specialized-lambda-list</i>
arguments are the same as for <a 
href="#x179-414002r878">defgeneric</a>.
<!--l. 5933--><p class="indent" >   The body of each method is enclosed in an implicit block. If <i>function-name</i>
is a symbol, this block bears the same name as the generic function. If
<i>function-name</i> is a list of the form (setf <i>symbol</i>), the name of the block is
<i>symbol</i>.
<!--l. 5939--><p class="indent" >   The result returned by <a 
href="#x179-421004r945">with-added-methods</a> is the value or values of the last
form executed. If no forms are speciﬁed, <a 
href="#x179-421004r945">with-added-methods</a> returns
<a 
href="clmse31.html#x42-74002r18">nil</a>.
<!--l. 5944--><p class="indent" >   If a generic function with the given name already exists, the lambda-list
speciﬁed in the <a 
href="#x179-421004r945">with-added-methods</a> form must be congruent with the
lambda-lists of all existing methods on that function as well as with the
lambda-lists of all methods deﬁned by the <a 
href="#x179-421004r945">with-added-methods</a> form; otherwise an
error is signaled.
<!--l. 5950--><p class="indent" >   If <i>function-name</i> speciﬁes an existing generic function that has a diﬀerent
value for any of the following <i>option</i> arguments, the copy of that generic function
is modiﬁed to have the new value: :argument-precedence-order, <a 
href="clmse48.html#x62-150003r123">declare</a>,
:documentation, :generic-function-class, :method-combination.
<!--l. 5956--><p class="indent" >   If <i>function-name</i> speciﬁes an existing generic function that has a diﬀerent
                                                                          

                                                                          
value for the :method-class <i>option</i> argument, that value is changed in the copy of
that generic function, but any methods copied from the existing generic function
are not changed.
<!--l. 5961--><p class="indent" >   If a function of the given name already exists, that function is copied into the
default method for a generic function of the given name. Note that this behavior
diﬀers from that of <a 
href="#x179-414002r878">defgeneric</a>.
<!--l. 5965--><p class="indent" >   If a macro or special form of the given name already exists, an error is
signaled.
<!--l. 5968--><p class="indent" >   If there is no existing generic function, the <i>option</i> arguments have the same
default values as the <i>option</i> arguments to <a 
href="#x179-414002r878">defgeneric</a>.
<!--l. 5971--><p class="indent" >   See <a 
href="#x179-419002r906">generic-labels</a>, <a 
href="#x179-417048r904">generic-ﬂet</a>, <a 
href="#x179-416002r881">defmethod</a>, <a 
href="#x179-414002r878">defgeneric</a>, and <a 
href="#x179-417035r898">ensure-generic-function</a>.
</div>
<div class=defmac>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"> <i>[Макрос]</i><b> with-slots </b><a 
 id="dx179-422001"></a><a 
 id="x179-422002r946"></a> ( {slot-entry}* ) instance-form  {declaration}*  { form}*
</td></tr></table>
<!--l. 5981--><p class="indent" >
</div>
<!--l. 5981--><p class="noindent" ><span class="paragraphHead"><a 
href="#x179-42300028.2" id="x179-42300028.2"></a></span>
   <div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"><i>slot-entry</i> ::= <i>slot-name</i> | (<i>variable-name</i> <i>slot-name</i>)
</td></tr></table>
<!--l. 5984--><p class="indent" >
</div>
<!--l. 5985--><p class="noindent" >The macro <a 
href="#x179-422002r946">with-slots</a> creates a lexical context for referring to speciﬁed slots as
though they were variables. Within such a context the value of the slot can be
speciﬁed by using its slot name, as if it were a lexically bound variable. Both <a 
href="clmse36.html#x48-90002r64">setf</a>
and <a 
href="clmse35.html#x47-87002r59">setq</a> can be used to set the value of the slot.
<!--l. 5991--><p class="indent" >   The macro <a 
href="#x179-422002r946">with-slots</a> translates an appearance of the slot name as a variable
into a call to <a 
href="#x179-420067r939">slot-value</a>.
                                                                          

                                                                          
<!--l. 5998--><p class="indent" >   The result returned is that obtained by executing the forms speciﬁed by the
<i>body</i> argument.
<!--l. 6001--><p class="indent" >   Example:
<div class=lisp>
<div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-slots (x y) position-1
</td></tr></table>
<!--l. 6004--><p class="indent" >                                              <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (sqrt (+ (* x x) (* y y))))</td></tr></table>
<!--l. 6005--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 6006--><p class="indent" >                                      <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-slots ((x1 x) (y1 y)) position-1</td></tr></table>
<!--l. 6007--><p class="indent" >                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (with-slots ((x2 x) (y2 y)) position-2</td></tr></table>
<!--l. 6008--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    (psetf x1 x2</td></tr></table>
<!--l. 6009--><p class="indent" >                                                    <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">           y1 y2))))</td></tr></table>
<!--l. 6010--><p class="indent" >                                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing"></td></tr></table>
<!--l. 6011--><p class="indent" >                                                  <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-slots (x y) position</td></tr></table>
<!--l. 6012--><p class="indent" >                                                          <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (setq x (1+ x)</td></tr></table>
<!--l. 6013--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">        y (1+ y)))</td></tr></table>
<!--l. 6015--><p class="indent" >
</div>
</div>
<!--l. 6018--><p class="indent" >   A <a 
href="#x179-422002r946">with-slots</a> expression of the form: <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(with-slots (<i><span class="math">slot<sub>1</sub></span></i> ... <span class="math">slot<sub>n</sub></span>) <i>instance</i>
</td></tr></table>
<!--l. 6020--><p class="indent" >                                           <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <span class="math">declaration<sub>1</sub></span> ... <span class="math">declaration<sub>m</sub></span>)</td></tr></table>
<!--l. 6021--><p class="indent" >                                                       <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  <span class="math">form<sub>1</sub></span> ... <span class="math">form<sub>k</sub></span>)</td></tr></table>
<!--l. 6023--><p class="indent" >
</div>
</div>
<!--l. 6024--><p class="noindent" >expands into the equivalent of <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(let ((<i>in</i> <i>instance</i>))
</td></tr></table>
                                                                          

                                                                          
<!--l. 6026--><p class="indent" >                                            <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">  (symbol-macrolet (<span class="math">Q<sub>1</sub></span> ... <span class="math">Q<sub>n</sub></span>)</td></tr></table>
<!--l. 6027--><p class="indent" >                                        <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    <span class="math">declaration<sub>1</sub></span> ... <span class="math">declaration<sub>m</sub></span>)</td></tr></table>
<!--l. 6028--><p class="indent" >                                                     <table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">    <span class="math">form<sub>1</sub></span> ... <span class="math">form<sub>k</sub></span>)</td></tr></table>
<!--l. 6030--><p class="indent" >
</div>
</div>
<!--l. 6031--><p class="noindent" >where <span class="math">Q<sub>j</sub></span> is <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(<span class="math">slot<i>-</i>entry<sub>j</sub></span> (slot-value <i>in</i> &#x2019;<i><span class="math">slot<i>-</i>entry<sub>j</sub></span></i>))
</td></tr></table>
<!--l. 6034--><p class="indent" >
</div>
</div>
<!--l. 6035--><p class="noindent" >if <span class="math">  slot-entry<sub>j</sub></span> is a symbol and is <div class=lisp><div class=tabbing>
<table  
cellpadding="0" border="0" cellspacing="0" 
class="tabbing"><tr  
style="vertical-align:baseline;" class="tabbing"><td  
class="tabbing">(<span class="math">variable<i>-</i>name<sub>j</sub></span> (slot-value <i>in</i> &#x2019;<span class="math">slot<i>-</i>name<sub>j</sub></span>))
</td></tr></table>
<!--l. 6038--><p class="indent" >
</div>
</div>
<!--l. 6039--><p class="noindent" >if <span class="math">  slot-entry<sub>j</sub></span> is of the form (<span class="math">variable<i>-</i>name<sub>j</sub></span> <span class="math">slot<i>-</i>name<sub>j</sub></span>).
<!--l. 6042--><p class="indent" >   [X3J13 voted in March 1989 <a 
 id="dx179-423001"></a>to modify the deﬁnition of <a 
href="clmse39.html#x51-104002r80">symbol-macrolet</a>
substantially and also voted <a 
 id="dx179-423002"></a>to allow declarations before the body of <a 
href="clmse39.html#x51-104002r80">symbol-macrolet</a>
but with peculiar treatment of special and type declarations. The syntactic
changes are reﬂected in this deﬁnition of <a 
href="#x179-422002r946">with-slots</a>.—GLS]
<!--l. 6051--><p class="indent" >   See <a 
href="#x179-420077r944">with-accessors</a> and <a 
href="clmse39.html#x51-104002r80">symbol-macrolet</a>.
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
   <!--l. 8--><div class="crosslinks"><p class="noindent"><tt>&#x003C;</tt><a 
href="clmch29.html" >Далее</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse145.html" >Назад</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse145.html#tailclmse145.html" >Назад-и-вниз</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmse146.html" >В-начало</a><tt>&#x003E;</tt><tt>&#x003C;</tt><a 
href="clmch28.html#clmse146.html" >Вверх</a><tt>&#x003E;</tt></p></div>
<!--l. 8--><p class="indent" >   <a 
 id="tailclmse146.html"></a>  
</body></html> 
